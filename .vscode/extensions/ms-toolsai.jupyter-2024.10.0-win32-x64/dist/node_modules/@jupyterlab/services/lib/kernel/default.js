"use strict";var F=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var Si=F((dn,Es)=>{(function(n,e){typeof dn=="object"&&typeof Es<"u"?e(dn):typeof define=="function"&&define.amd?define(["exports"],e):(n=typeof globalThis<"u"?globalThis:n||self,e(n.lumino_algorithm={}))})(dn,function(n){"use strict";n.ArrayExt=void 0,function(u){function d(_,y,l=0,o=-1){let a=_.length;if(a===0)return-1;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S;o<l?S=o+1+(a-l):S=o-l+1;for(let M=0;M<S;++M){let q=(l+M)%a;if(_[q]===y)return q}return-1}u.firstIndexOf=d;function m(_,y,l=-1,o=0){let a=_.length;if(a===0)return-1;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S;l<o?S=l+1+(a-o):S=l-o+1;for(let M=0;M<S;++M){let q=(l-M+a)%a;if(_[q]===y)return q}return-1}u.lastIndexOf=m;function w(_,y,l=0,o=-1){let a=_.length;if(a===0)return-1;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S;o<l?S=o+1+(a-l):S=o-l+1;for(let M=0;M<S;++M){let q=(l+M)%a;if(y(_[q],q))return q}return-1}u.findFirstIndex=w;function R(_,y,l=-1,o=0){let a=_.length;if(a===0)return-1;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S;l<o?S=l+1+(a-o):S=l-o+1;for(let M=0;M<S;++M){let q=(l-M+a)%a;if(y(_[q],q))return q}return-1}u.findLastIndex=R;function U(_,y,l=0,o=-1){let a=w(_,y,l,o);return a!==-1?_[a]:void 0}u.findFirstValue=U;function D(_,y,l=-1,o=0){let a=R(_,y,l,o);return a!==-1?_[a]:void 0}u.findLastValue=D;function k(_,y,l,o=0,a=-1){let S=_.length;if(S===0)return 0;o<0?o=Math.max(0,o+S):o=Math.min(o,S-1),a<0?a=Math.max(0,a+S):a=Math.min(a,S-1);let M=o,q=a-o+1;for(;q>0;){let K=q>>1,Q=M+K;l(_[Q],y)<0?(M=Q+1,q-=K+1):q=K}return M}u.lowerBound=k;function A(_,y,l,o=0,a=-1){let S=_.length;if(S===0)return 0;o<0?o=Math.max(0,o+S):o=Math.min(o,S-1),a<0?a=Math.max(0,a+S):a=Math.min(a,S-1);let M=o,q=a-o+1;for(;q>0;){let K=q>>1,Q=M+K;l(_[Q],y)>0?q=K:(M=Q+1,q-=K+1)}return M}u.upperBound=A;function T(_,y,l){if(_===y)return!0;if(_.length!==y.length)return!1;for(let o=0,a=_.length;o<a;++o)if(l?!l(_[o],y[o]):_[o]!==y[o])return!1;return!0}u.shallowEqual=T;function B(_,y={}){let{start:l,stop:o,step:a}=y;if(a===void 0&&(a=1),a===0)throw new Error("Slice `step` cannot be zero.");let S=_.length;l===void 0?l=a<0?S-1:0:l<0?l=Math.max(l+S,a<0?-1:0):l>=S&&(l=a<0?S-1:S),o===void 0?o=a<0?-1:S:o<0?o=Math.max(o+S,a<0?-1:0):o>=S&&(o=a<0?S-1:S);let M;a<0&&o>=l||a>0&&l>=o?M=0:a<0?M=Math.floor((o-l+1)/a+1):M=Math.floor((o-l-1)/a+1);let q=[];for(let K=0;K<M;++K)q[K]=_[l+K*a];return q}u.slice=B;function L(_,y,l){let o=_.length;if(o<=1||(y<0?y=Math.max(0,y+o):y=Math.min(y,o-1),l<0?l=Math.max(0,l+o):l=Math.min(l,o-1),y===l))return;let a=_[y],S=y<l?1:-1;for(let M=y;M!==l;M+=S)_[M]=_[M+S];_[l]=a}u.move=L;function W(_,y=0,l=-1){let o=_.length;if(!(o<=1))for(y<0?y=Math.max(0,y+o):y=Math.min(y,o-1),l<0?l=Math.max(0,l+o):l=Math.min(l,o-1);y<l;){let a=_[y],S=_[l];_[y++]=S,_[l--]=a}}u.reverse=W;function z(_,y,l=0,o=-1){let a=_.length;if(a<=1||(l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1),l>=o))return;let S=o-l+1;if(y>0?y=y%S:y<0&&(y=(y%S+S)%S),y===0)return;let M=l+y;W(_,l,M-1),W(_,M,o),W(_,l,o)}u.rotate=z;function G(_,y,l=0,o=-1){let a=_.length;if(a===0)return;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S;o<l?S=o+1+(a-l):S=o-l+1;for(let M=0;M<S;++M)_[(l+M)%a]=y}u.fill=G;function Ke(_,y,l){let o=_.length;y<0?y=Math.max(0,y+o):y=Math.min(y,o);for(let a=o;a>y;--a)_[a]=_[a-1];_[y]=l}u.insert=Ke;function Z(_,y){let l=_.length;if(y<0&&(y+=l),y<0||y>=l)return;let o=_[y];for(let a=y+1;a<l;++a)_[a-1]=_[a];return _.length=l-1,o}u.removeAt=Z;function ze(_,y,l=0,o=-1){let a=d(_,y,l,o);return a!==-1&&Z(_,a),a}u.removeFirstOf=ze;function He(_,y,l=-1,o=0){let a=m(_,y,l,o);return a!==-1&&Z(_,a),a}u.removeLastOf=He;function Ge(_,y,l=0,o=-1){let a=_.length;if(a===0)return 0;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S=0;for(let M=0;M<a;++M)l<=o&&M>=l&&M<=o&&_[M]===y||o<l&&(M<=o||M>=l)&&_[M]===y?S++:S>0&&(_[M-S]=_[M]);return S>0&&(_.length=a-S),S}u.removeAllOf=Ge;function Je(_,y,l=0,o=-1){let a,S=w(_,y,l,o);return S!==-1&&(a=Z(_,S)),{index:S,value:a}}u.removeFirstWhere=Je;function Ye(_,y,l=-1,o=0){let a,S=R(_,y,l,o);return S!==-1&&(a=Z(_,S)),{index:S,value:a}}u.removeLastWhere=Ye;function Xe(_,y,l=0,o=-1){let a=_.length;if(a===0)return 0;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S=0;for(let M=0;M<a;++M)l<=o&&M>=l&&M<=o&&y(_[M],M)||o<l&&(M<=o||M>=l)&&y(_[M],M)?S++:S>0&&(_[M-S]=_[M]);return S>0&&(_.length=a-S),S}u.removeAllWhere=Xe}(n.ArrayExt||(n.ArrayExt={}));function*e(...u){for(let d of u)yield*d}function*t(){}function*i(u,d=0){for(let m of u)yield[d++,m]}function*r(u,d){let m=0;for(let w of u)d(w,m++)&&(yield w)}function s(u,d){let m=0;for(let w of u)if(d(w,m++))return w}function c(u,d){let m=0;for(let w of u)if(d(w,m++))return m-1;return-1}function f(u,d){let m;for(let w of u){if(m===void 0){m=w;continue}d(w,m)<0&&(m=w)}return m}function v(u,d){let m;for(let w of u){if(m===void 0){m=w;continue}d(w,m)>0&&(m=w)}return m}function p(u,d){let m=!0,w,R;for(let U of u)m?(w=U,R=U,m=!1):d(U,w)<0?w=U:d(U,R)>0&&(R=U);return m?void 0:[w,R]}function h(u){return Array.from(u)}function g(u){let d={};for(let[m,w]of u)d[m]=w;return d}function b(u,d){let m=0;for(let w of u)if(d(w,m++)===!1)return}function C(u,d){let m=0;for(let w of u)if(d(w,m++)===!1)return!1;return!0}function P(u,d){let m=0;for(let w of u)if(d(w,m++))return!0;return!1}function*O(u,d){let m=0;for(let w of u)yield d(w,m++)}function*I(u,d,m){d===void 0?(d=u,u=0,m=1):m===void 0&&(m=1);let w=N.rangeLength(u,d,m);for(let R=0;R<w;R++)yield u+m*R}var N;(function(u){function d(m,w,R){return R===0?1/0:m>w&&R>0||m<w&&R<0?0:Math.ceil((w-m)/R)}u.rangeLength=d})(N||(N={}));function V(u,d,m){let w=u[Symbol.iterator](),R=0,U=w.next();if(U.done&&m===void 0)throw new TypeError("Reduce of empty iterable with no initial value.");if(U.done)return m;let D=w.next();if(D.done&&m===void 0)return U.value;if(D.done)return d(m,U.value,R++);let k;m===void 0?k=d(U.value,D.value,R++):k=d(d(m,U.value,R++),D.value,R++);let A;for(;!(A=w.next()).done;)k=d(k,A.value,R++);return k}function*$(u,d){for(;0<d--;)yield u}function*j(u){yield u}function*J(u){if(typeof u.retro=="function")yield*u.retro();else for(let d=u.length-1;d>-1;d--)yield u[d]}function X(u){let d=[],m=new Set,w=new Map;for(let D of u)R(D);for(let[D]of w)U(D);return d;function R(D){let[k,A]=D,T=w.get(A);T?T.push(k):w.set(A,[k])}function U(D){if(m.has(D))return;m.add(D);let k=w.get(D);if(k)for(let A of k)U(A);d.push(D)}}function*H(u,d){let m=0;for(let w of u)m++%d===0&&(yield w)}n.StringExt=void 0,function(u){function d(D,k,A=0){let T=new Array(k.length);for(let B=0,L=A,W=k.length;B<W;++B,++L){if(L=D.indexOf(k[B],L),L===-1)return null;T[B]=L}return T}u.findIndices=d;function m(D,k,A=0){let T=d(D,k,A);if(!T)return null;let B=0;for(let L=0,W=T.length;L<W;++L){let z=T[L]-A;B+=z*z}return{score:B,indices:T}}u.matchSumOfSquares=m;function w(D,k,A=0){let T=d(D,k,A);if(!T)return null;let B=0,L=A-1;for(let W=0,z=T.length;W<z;++W){let G=T[W];B+=G-L-1,L=G}return{score:B,indices:T}}u.matchSumOfDeltas=w;function R(D,k,A){let T=[],B=0,L=0,W=k.length;for(;B<W;){let z=k[B],G=k[B];for(;++B<W&&k[B]===G+1;)G++;L<z&&T.push(D.slice(L,z)),z<G+1&&T.push(A(D.slice(z,G+1))),L=G+1}return L<D.length&&T.push(D.slice(L)),T}u.highlight=R;function U(D,k){return D<k?-1:D>k?1:0}u.cmp=U}(n.StringExt||(n.StringExt={}));function*E(u,d){if(d<1)return;let m=u[Symbol.iterator](),w;for(;0<d--&&!(w=m.next()).done;)yield w.value}function*x(...u){let d=u.map(w=>w[Symbol.iterator]()),m=d.map(w=>w.next());for(;C(m,w=>!w.done);m=d.map(w=>w.next()))yield m.map(w=>w.value)}n.chain=e,n.each=b,n.empty=t,n.enumerate=i,n.every=C,n.filter=r,n.find=s,n.findIndex=c,n.map=O,n.max=v,n.min=f,n.minmax=p,n.once=j,n.range=I,n.reduce=V,n.repeat=$,n.retro=J,n.some=P,n.stride=H,n.take=E,n.toArray=h,n.toObject=g,n.topologicSort=X,n.zip=x})});var _n=F(de=>{"use strict";var Xa=Si();de.JSONExt=void 0;(function(n){n.emptyObject=Object.freeze({}),n.emptyArray=Object.freeze([]);function e(h){return h===null||typeof h=="boolean"||typeof h=="number"||typeof h=="string"}n.isPrimitive=e;function t(h){return Array.isArray(h)}n.isArray=t;function i(h){return!e(h)&&!t(h)}n.isObject=i;function r(h,g){if(h===g)return!0;if(e(h)||e(g))return!1;let b=t(h),C=t(g);return b!==C?!1:b&&C?c(h,g):f(h,g)}n.deepEqual=r;function s(h){return e(h)?h:t(h)?v(h):p(h)}n.deepCopy=s;function c(h,g){if(h===g)return!0;if(h.length!==g.length)return!1;for(let b=0,C=h.length;b<C;++b)if(!r(h[b],g[b]))return!1;return!0}function f(h,g){if(h===g)return!0;for(let b in h)if(h[b]!==void 0&&!(b in g))return!1;for(let b in g)if(g[b]!==void 0&&!(b in h))return!1;for(let b in h){let C=h[b],P=g[b];if(!(C===void 0&&P===void 0)&&(C===void 0||P===void 0||!r(C,P)))return!1}return!0}function v(h){let g=new Array(h.length);for(let b=0,C=h.length;b<C;++b)g[b]=s(h[b]);return g}function p(h){let g={};for(let b in h){let C=h[b];C!==void 0&&(g[b]=s(C))}return g}})(de.JSONExt||(de.JSONExt={}));var bi=class{constructor(){this._types=[],this._values=[]}types(){return this._types.slice()}hasData(e){return this._types.indexOf(e)!==-1}getData(e){let t=this._types.indexOf(e);return t!==-1?this._values[t]:void 0}setData(e,t){this.clearData(e),this._types.push(e),this._values.push(t)}clearData(e){let t=this._types.indexOf(e);t!==-1&&(this._types.splice(t,1),this._values.splice(t,1))}clear(){this._types.length=0,this._values.length=0}},Mi=class{constructor(e={}){this._application=null,this._validatePlugin=()=>!0,this._plugins=new Map,this._services=new Map,e.validatePlugin&&(console.info("Plugins may be rejected by the custom validation plugin method."),this._validatePlugin=e.validatePlugin)}get application(){return this._application}set application(e){if(this._application!==null)throw Error("PluginRegistry.application is already set. It cannot be overridden.");this._application=e}get deferredPlugins(){return Array.from(this._plugins).filter(([e,t])=>t.autoStart==="defer").map(([e,t])=>e)}getPluginDescription(e){var t,i;return(i=(t=this._plugins.get(e))===null||t===void 0?void 0:t.description)!==null&&i!==void 0?i:""}hasPlugin(e){return this._plugins.has(e)}isPluginActivated(e){var t,i;return(i=(t=this._plugins.get(e))===null||t===void 0?void 0:t.activated)!==null&&i!==void 0?i:!1}listPlugins(){return Array.from(this._plugins.keys())}registerPlugin(e){if(this._plugins.has(e.id))throw new TypeError(`Plugin '${e.id}' is already registered.`);if(!this._validatePlugin(e))throw new Error(`Plugin '${e.id}' is not valid.`);let t=bt.createPluginData(e);bt.ensureNoCycle(t,this._plugins,this._services),t.provides&&this._services.set(t.provides,t.id),this._plugins.set(t.id,t)}registerPlugins(e){for(let t of e)this.registerPlugin(t)}deregisterPlugin(e,t){let i=this._plugins.get(e);if(i){if(i.activated&&!t)throw new Error(`Plugin '${e}' is still active.`);this._plugins.delete(e)}}async activatePlugin(e){let t=this._plugins.get(e);if(!t)throw new ReferenceError(`Plugin '${e}' is not registered.`);if(t.activated)return;if(t.promise)return t.promise;let i=t.requires.map(s=>this.resolveRequiredService(s)),r=t.optional.map(s=>this.resolveOptionalService(s));return t.promise=Promise.all([...i,...r]).then(s=>t.activate.apply(void 0,[this.application,...s])).then(s=>{t.service=s,t.activated=!0,t.promise=null}).catch(s=>{throw t.promise=null,s}),t.promise}async activatePlugins(e,t={}){switch(e){case"defer":{let i=this.deferredPlugins.filter(r=>this._plugins.get(r).autoStart).map(r=>this.activatePlugin(r));await Promise.all(i);break}case"startUp":{let r=bt.collectStartupPlugins(this._plugins,t).map(async s=>{try{return await this.activatePlugin(s)}catch(c){console.error(`Plugin '${s}' failed to activate.`,c)}});await Promise.all(r);break}}}async deactivatePlugin(e){let t=this._plugins.get(e);if(!t)throw new ReferenceError(`Plugin '${e}' is not registered.`);if(!t.activated)return[];if(!t.deactivate)throw new TypeError(`Plugin '${e}'#deactivate() method missing`);let i=bt.findDependents(e,this._plugins,this._services),r=i.map(s=>this._plugins.get(s));for(let s of r)if(!s.deactivate)throw new TypeError(`Plugin ${s.id}#deactivate() method missing (depends on ${e})`);for(let s of r){let c=[...s.requires,...s.optional].map(f=>{let v=this._services.get(f);return v?this._plugins.get(v).service:null});await s.deactivate(this.application,...c),s.service=null,s.activated=!1}return i.pop(),i}async resolveRequiredService(e){let t=this._services.get(e);if(!t)throw new TypeError(`No provider for: ${e.name}.`);let i=this._plugins.get(t);return i.activated||await this.activatePlugin(t),i.service}async resolveOptionalService(e){let t=this._services.get(e);if(!t)return null;let i=this._plugins.get(t);if(!i.activated)try{await this.activatePlugin(t)}catch(r){return console.error(r),null}return i.service}},bt;(function(n){class e{constructor(f){var v,p,h,g;this._activated=!1,this._promise=null,this._service=null,this.id=f.id,this.description=(v=f.description)!==null&&v!==void 0?v:"",this.activate=f.activate,this.deactivate=(p=f.deactivate)!==null&&p!==void 0?p:null,this.provides=(h=f.provides)!==null&&h!==void 0?h:null,this.autoStart=(g=f.autoStart)!==null&&g!==void 0?g:!1,this.requires=f.requires?f.requires.slice():[],this.optional=f.optional?f.optional.slice():[]}get activated(){return this._activated}set activated(f){this._activated=f}get service(){return this._service}set service(f){this._service=f}get promise(){return this._promise}set promise(f){this._promise=f}}function t(c){return new e(c)}n.createPluginData=t;function i(c,f,v){let p=[...c.requires,...c.optional],h=b=>{if(b===c.provides)return!0;let C=v.get(b);if(!C)return!1;let P=f.get(C),O=[...P.requires,...P.optional];return O.length===0?!1:(g.push(C),O.some(h)?!0:(g.pop(),!1))};if(!c.provides||p.length===0)return;let g=[c.id];if(p.some(h))throw new ReferenceError(`Cycle detected: ${g.join(" -> ")}.`)}n.ensureNoCycle=i;function r(c,f,v){let p=new Array,h=O=>{let I=f.get(O),N=[...I.requires,...I.optional];p.push(...N.reduce((V,$)=>{let j=v.get($);return j&&V.push([O,j]),V},[]))};for(let O of f.keys())h(O);let g=p.filter(O=>O[1]===c),b=0;for(;g.length>b;){let O=g.length,I=new Set(g.map(N=>N[0]));for(let N of I)p.filter(V=>V[1]===N).forEach(V=>{g.includes(V)||g.push(V)});b=O}let C=Xa.topologicSort(g),P=C.findIndex(O=>O===c);return P===-1?[c]:C.slice(0,P+1)}n.findDependents=r;function s(c,f){let v=new Set;for(let p of c.keys())c.get(p).autoStart===!0&&v.add(p);if(f.startPlugins)for(let p of f.startPlugins)v.add(p);if(f.ignorePlugins)for(let p of f.ignorePlugins)v.delete(p);return Array.from(v)}n.collectStartupPlugins=s})(bt||(bt={}));var Ci=class{constructor(){this.promise=new Promise((e,t)=>{this._resolve=e,this._reject=t})}resolve(e){let t=this._resolve;t(e)}reject(e){let t=this._reject;t(e)}},Pi=class{constructor(e,t){this.name=e,this.description=t??"",this._tokenStructuralPropertyT=null}};function Za(n){let e=0;for(let t=0,i=n.length;t<i;++t)t%4===0&&(e=Math.random()*4294967295>>>0),n[t]=e&255,e>>>=8}de.Random=void 0;(function(n){n.getRandomValues=(()=>{let e=typeof require<"u"&&require("crypto")||null;return e&&typeof e.randomFillSync=="function"?function(i){return e.randomFillSync(i)}:e&&typeof e.randomBytes=="function"?function(i){let r=e.randomBytes(i.length);for(let s=0,c=r.length;s<c;++s)i[s]=r[s]}:Za})()})(de.Random||(de.Random={}));function Qa(n){let e=new Uint8Array(16),t=new Array(256);for(let i=0;i<16;++i)t[i]="0"+i.toString(16);for(let i=16;i<256;++i)t[i]=i.toString(16);return function(){return n(e),e[6]=64|e[6]&15,e[8]=128|e[8]&63,t[e[0]]+t[e[1]]+t[e[2]]+t[e[3]]+"-"+t[e[4]]+t[e[5]]+"-"+t[e[6]]+t[e[7]]+"-"+t[e[8]]+t[e[9]]+"-"+t[e[10]]+t[e[11]]+t[e[12]]+t[e[13]]+t[e[14]]+t[e[15]]}}de.UUID=void 0;(function(n){n.uuid4=Qa(de.Random.getRandomValues)})(de.UUID||(de.UUID={}));de.MimeData=bi;de.PluginRegistry=Mi;de.PromiseDelegate=Ci;de.Token=Pi});var Rs=F((gn,Os)=>{(function(n,e){typeof gn=="object"&&typeof Os<"u"?e(gn,Si(),_n()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm","@lumino/coreutils"],e):(n=typeof globalThis<"u"?globalThis:n||self,e(n.lumino_signaling={},n.lumino_algorithm,n.lumino_coreutils))})(gn,function(n,e,t){"use strict";class i{constructor(f){this.sender=f}connect(f,v){return s.connect(this,f,v)}disconnect(f,v){return s.disconnect(this,f,v)}emit(f){s.emit(this,f)}}(function(c){function f(P,O){s.disconnectBetween(P,O)}c.disconnectBetween=f;function v(P){s.disconnectSender(P)}c.disconnectSender=v;function p(P){s.disconnectReceiver(P)}c.disconnectReceiver=p;function h(P){s.disconnectAll(P)}c.disconnectAll=h;function g(P){s.disconnectAll(P)}c.clearData=g;function b(){return s.exceptionHandler}c.getExceptionHandler=b;function C(P){let O=s.exceptionHandler;return s.exceptionHandler=P,O}c.setExceptionHandler=C})(i||(i={}));class r extends i{constructor(){super(...arguments),this._pending=new t.PromiseDelegate}async*[Symbol.asyncIterator](){let f=this._pending;for(;;)try{let{args:v,next:p}=await f.promise;f=p,yield v}catch{return}}emit(f){let v=this._pending,p=this._pending=new t.PromiseDelegate;v.resolve({args:f,next:p}),super.emit(f)}stop(){this._pending.promise.catch(()=>{}),this._pending.reject("stop"),this._pending=new t.PromiseDelegate}}var s;(function(c){c.exceptionHandler=E=>{console.error(E)};function f(E,x,u){u=u||void 0;let d=P.get(E.sender);if(d||(d=[],P.set(E.sender,d)),V(d,E,x,u))return!1;let m=u||x,w=O.get(m);w||(w=[],O.set(m,w));let R={signal:E,slot:x,thisArg:u};return d.push(R),w.push(R),!0}c.connect=f;function v(E,x,u){u=u||void 0;let d=P.get(E.sender);if(!d||d.length===0)return!1;let m=V(d,E,x,u);if(!m)return!1;let w=u||x,R=O.get(w);return m.signal=null,j(d),j(R),!0}c.disconnect=v;function p(E,x){let u=P.get(E);if(!u||u.length===0)return;let d=O.get(x);if(!(!d||d.length===0)){for(let m of d)m.signal&&m.signal.sender===E&&(m.signal=null);j(u),j(d)}}c.disconnectBetween=p;function h(E){let x=P.get(E);if(!(!x||x.length===0)){for(let u of x){if(!u.signal)continue;let d=u.thisArg||u.slot;u.signal=null,j(O.get(d))}j(x)}}c.disconnectSender=h;function g(E){let x=O.get(E);if(!(!x||x.length===0)){for(let u of x){if(!u.signal)continue;let d=u.signal.sender;u.signal=null,j(P.get(d))}j(x)}}c.disconnectReceiver=g;function b(E){h(E),g(E)}c.disconnectAll=b;function C(E,x){let u=P.get(E.sender);if(!(!u||u.length===0))for(let d=0,m=u.length;d<m;++d){let w=u[d];w.signal===E&&$(w,x)}}c.emit=C;let P=new WeakMap,O=new WeakMap,I=new Set,N=(()=>typeof requestAnimationFrame=="function"?requestAnimationFrame:setImmediate)();function V(E,x,u,d){return e.find(E,m=>m.signal===x&&m.slot===u&&m.thisArg===d)}function $(E,x){let{signal:u,slot:d,thisArg:m}=E;try{d.call(m,u.sender,x)}catch(w){c.exceptionHandler(w)}}function j(E){I.size===0&&N(J),I.add(E)}function J(){I.forEach(X),I.clear()}function X(E){e.ArrayExt.removeAllWhere(E,H)}function H(E){return E.signal===null}})(s||(s={})),n.Signal=i,n.Stream=r})});var xs=F(pn=>{"use strict";Object.defineProperty(pn,"__esModule",{value:!0});pn.ActivityMonitor=void 0;var Ds=Rs(),Ei=class{constructor(e){this._timer=-1,this._timeout=-1,this._isDisposed=!1,this._activityStopped=new Ds.Signal(this),e.signal.connect(this._onSignalFired,this),this._timeout=e.timeout||1e3}get activityStopped(){return this._activityStopped}get timeout(){return this._timeout}set timeout(e){this._timeout=e}get isDisposed(){return this._isDisposed}dispose(){this._isDisposed||(this._isDisposed=!0,Ds.Signal.clearData(this))}_onSignalFired(e,t){clearTimeout(this._timer),this._sender=e,this._args=t,this._timer=setTimeout(()=>{this._activityStopped.emit({sender:this._sender,args:this._args})},this._timeout)}};pn.ActivityMonitor=Ei});var qs=F(ks=>{"use strict";Object.defineProperty(ks,"__esModule",{value:!0})});var js=F(mn=>{"use strict";Object.defineProperty(mn,"__esModule",{value:!0});mn.LruCache=void 0;var ec=128,Oi=class{constructor(e={}){this._map=new Map,this._maxSize=e?.maxSize||ec}get size(){return this._map.size}clear(){this._map.clear()}get(e){let t=this._map.get(e)||null;return t!=null&&(this._map.delete(e),this._map.set(e,t)),t}set(e,t){this._map.size>=this._maxSize&&this._map.delete(this._map.keys().next().value),this._map.set(e,t)}};mn.LruCache=Oi});var Is=F(vn=>{"use strict";Object.defineProperty(vn,"__esModule",{value:!0});vn.MarkdownCodeBlocks=void 0;var Ts;(function(n){n.CODE_BLOCK_MARKER="```";let e=[".markdown",".mdown",".mkdn",".md",".mkd",".mdwn",".mdtxt",".mdtext",".text",".txt",".Rmd"];class t{constructor(c){this.startLine=c,this.code="",this.endLine=-1}}n.MarkdownCodeBlock=t;function i(s){return e.indexOf(s)>-1}n.isMarkdown=i;function r(s){if(!s||s==="")return[];let c=s.split(`
`),f=[],v=null;for(let p=0;p<c.length;p++){let h=c[p],g=h.indexOf(n.CODE_BLOCK_MARKER)===0,b=v!=null;if(!(!g&&!b))if(b)v&&(g?(v.endLine=p-1,f.push(v),v=null):v.code+=h+`
`);else{v=new t(p);let C=h.indexOf(n.CODE_BLOCK_MARKER),P=h.lastIndexOf(n.CODE_BLOCK_MARKER);C!==P&&(v.code=h.substring(C+n.CODE_BLOCK_MARKER.length,P),v.endLine=p,f.push(v),v=null)}}return f}n.findMarkdownCodeBlocks=r})(Ts||(vn.MarkdownCodeBlocks=Ts={}))});var As=F((Bd,Ns)=>{"use strict";function tc(n,e){var t=n;e.slice(0,-1).forEach(function(r){t=t[r]||{}});var i=e[e.length-1];return i in t}function Us(n){return typeof n=="number"||/^0x[0-9a-f]+$/i.test(n)?!0:/^[-+]?(?:\d+(?:\.\d*)?|\.\d+)(e[-+]?\d+)?$/.test(n)}function Ls(n,e){return e==="constructor"&&typeof n[e]=="function"||e==="__proto__"}Ns.exports=function(n,e){e||(e={});var t={bools:{},strings:{},unknownFn:null};typeof e.unknown=="function"&&(t.unknownFn=e.unknown),typeof e.boolean=="boolean"&&e.boolean?t.allBools=!0:[].concat(e.boolean).filter(Boolean).forEach(function(j){t.bools[j]=!0});var i={};function r(j){return i[j].some(function(J){return t.bools[J]})}Object.keys(e.alias||{}).forEach(function(j){i[j]=[].concat(e.alias[j]),i[j].forEach(function(J){i[J]=[j].concat(i[j].filter(function(X){return J!==X}))})}),[].concat(e.string).filter(Boolean).forEach(function(j){t.strings[j]=!0,i[j]&&[].concat(i[j]).forEach(function(J){t.strings[J]=!0})});var s=e.default||{},c={_:[]};function f(j,J){return t.allBools&&/^--[^=]+$/.test(J)||t.strings[j]||t.bools[j]||i[j]}function v(j,J,X){for(var H=j,E=0;E<J.length-1;E++){var x=J[E];if(Ls(H,x))return;H[x]===void 0&&(H[x]={}),(H[x]===Object.prototype||H[x]===Number.prototype||H[x]===String.prototype)&&(H[x]={}),H[x]===Array.prototype&&(H[x]=[]),H=H[x]}var u=J[J.length-1];Ls(H,u)||((H===Object.prototype||H===Number.prototype||H===String.prototype)&&(H={}),H===Array.prototype&&(H=[]),H[u]===void 0||t.bools[u]||typeof H[u]=="boolean"?H[u]=X:Array.isArray(H[u])?H[u].push(X):H[u]=[H[u],X])}function p(j,J,X){if(!(X&&t.unknownFn&&!f(j,X)&&t.unknownFn(X)===!1)){var H=!t.strings[j]&&Us(J)?Number(J):J;v(c,j.split("."),H),(i[j]||[]).forEach(function(E){v(c,E.split("."),H)})}}Object.keys(t.bools).forEach(function(j){p(j,s[j]===void 0?!1:s[j])});var h=[];n.indexOf("--")!==-1&&(h=n.slice(n.indexOf("--")+1),n=n.slice(0,n.indexOf("--")));for(var g=0;g<n.length;g++){var b=n[g],C,P;if(/^--.+=/.test(b)){var O=b.match(/^--([^=]+)=([\s\S]*)$/);C=O[1];var I=O[2];t.bools[C]&&(I=I!=="false"),p(C,I,b)}else if(/^--no-.+/.test(b))C=b.match(/^--no-(.+)/)[1],p(C,!1,b);else if(/^--.+/.test(b))C=b.match(/^--(.+)/)[1],P=n[g+1],P!==void 0&&!/^(-|--)[^-]/.test(P)&&!t.bools[C]&&!t.allBools&&(!i[C]||!r(C))?(p(C,P,b),g+=1):/^(true|false)$/.test(P)?(p(C,P==="true",b),g+=1):p(C,t.strings[C]?"":!0,b);else if(/^-[^-]+/.test(b)){for(var N=b.slice(1,-1).split(""),V=!1,$=0;$<N.length;$++){if(P=b.slice($+2),P==="-"){p(N[$],P,b);continue}if(/[A-Za-z]/.test(N[$])&&P[0]==="="){p(N[$],P.slice(1),b),V=!0;break}if(/[A-Za-z]/.test(N[$])&&/-?\d+(\.\d*)?(e-?\d+)?$/.test(P)){p(N[$],P,b),V=!0;break}if(N[$+1]&&N[$+1].match(/\W/)){p(N[$],b.slice($+2),b),V=!0;break}else p(N[$],t.strings[N[$]]?"":!0,b)}C=b.slice(-1)[0],!V&&C!=="-"&&(n[g+1]&&!/^(-|--)[^-]/.test(n[g+1])&&!t.bools[C]&&(!i[C]||!r(C))?(p(C,n[g+1],b),g+=1):n[g+1]&&/^(true|false)$/.test(n[g+1])?(p(C,n[g+1]==="true",b),g+=1):p(C,t.strings[C]?"":!0,b))}else if((!t.unknownFn||t.unknownFn(b)!==!1)&&c._.push(t.strings._||!Us(b)?b:Number(b)),e.stopEarly){c._.push.apply(c._,n.slice(g+1));break}}return Object.keys(s).forEach(function(j){tc(c,j.split("."))||(v(c,j.split("."),s[j]),(i[j]||[]).forEach(function(J){v(c,J.split("."),s[j])}))}),e["--"]?c["--"]=h.slice():h.forEach(function(j){c._.push(j)}),c}});var Bs=F((Vd,Fs)=>{"use strict";Fs.exports=function(e,t){if(t=t.split(":")[0],e=+e,!e)return!1;switch(t){case"http":case"ws":return e!==80;case"https":case"wss":return e!==443;case"ftp":return e!==21;case"gopher":return e!==70;case"file":return!1}return e!==0}});var $s=F(Ri=>{"use strict";var nc=Object.prototype.hasOwnProperty,ic;function Vs(n){try{return decodeURIComponent(n.replace(/\+/g," "))}catch{return null}}function Ws(n){try{return encodeURIComponent(n)}catch{return null}}function rc(n){for(var e=/([^=?#&]+)=?([^&]*)/g,t={},i;i=e.exec(n);){var r=Vs(i[1]),s=Vs(i[2]);r===null||s===null||r in t||(t[r]=s)}return t}function sc(n,e){e=e||"";var t=[],i,r;typeof e!="string"&&(e="?");for(r in n)if(nc.call(n,r)){if(i=n[r],!i&&(i===null||i===ic||isNaN(i))&&(i=""),r=Ws(r),i=Ws(i),r===null||i===null)continue;t.push(r+"="+i)}return t.length?e+t.join("&"):""}Ri.stringify=sc;Ri.parse=rc});var Zs=F(($d,Xs)=>{"use strict";var zs=Bs(),yn=$s(),oc=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,Hs=/[\n\r\t]/g,lc=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,Gs=/:\d+$/,ac=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,cc=/^[a-zA-Z]:/;function xi(n){return(n||"").toString().replace(oc,"")}var Di=[["#","hash"],["?","query"],function(e,t){return je(t.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],Ks={hash:1,query:1};function Js(n){var e;typeof window<"u"?e=window:typeof global<"u"?e=global:typeof self<"u"?e=self:e={};var t=e.location||{};n=n||t;var i={},r=typeof n,s;if(n.protocol==="blob:")i=new Te(unescape(n.pathname),{});else if(r==="string"){i=new Te(n,{});for(s in Ks)delete i[s]}else if(r==="object"){for(s in n)s in Ks||(i[s]=n[s]);i.slashes===void 0&&(i.slashes=lc.test(n.href))}return i}function je(n){return n==="file:"||n==="ftp:"||n==="http:"||n==="https:"||n==="ws:"||n==="wss:"}function Ys(n,e){n=xi(n),n=n.replace(Hs,""),e=e||{};var t=ac.exec(n),i=t[1]?t[1].toLowerCase():"",r=!!t[2],s=!!t[3],c=0,f;return r?s?(f=t[2]+t[3]+t[4],c=t[2].length+t[3].length):(f=t[2]+t[4],c=t[2].length):s?(f=t[3]+t[4],c=t[3].length):f=t[4],i==="file:"?c>=2&&(f=f.slice(2)):je(i)?f=t[4]:i?r&&(f=f.slice(2)):c>=2&&je(e.protocol)&&(f=t[4]),{protocol:i,slashes:r||je(i),slashesCount:c,rest:f}}function uc(n,e){if(n==="")return e;for(var t=(e||"/").split("/").slice(0,-1).concat(n.split("/")),i=t.length,r=t[i-1],s=!1,c=0;i--;)t[i]==="."?t.splice(i,1):t[i]===".."?(t.splice(i,1),c++):c&&(i===0&&(s=!0),t.splice(i,1),c--);return s&&t.unshift(""),(r==="."||r==="..")&&t.push(""),t.join("/")}function Te(n,e,t){if(n=xi(n),n=n.replace(Hs,""),!(this instanceof Te))return new Te(n,e,t);var i,r,s,c,f,v,p=Di.slice(),h=typeof e,g=this,b=0;for(h!=="object"&&h!=="string"&&(t=e,e=null),t&&typeof t!="function"&&(t=yn.parse),e=Js(e),r=Ys(n||"",e),i=!r.protocol&&!r.slashes,g.slashes=r.slashes||i&&e.slashes,g.protocol=r.protocol||e.protocol||"",n=r.rest,(r.protocol==="file:"&&(r.slashesCount!==2||cc.test(n))||!r.slashes&&(r.protocol||r.slashesCount<2||!je(g.protocol)))&&(p[3]=[/(.*)/,"pathname"]);b<p.length;b++){if(c=p[b],typeof c=="function"){n=c(n,g);continue}s=c[0],v=c[1],s!==s?g[v]=n:typeof s=="string"?(f=s==="@"?n.lastIndexOf(s):n.indexOf(s),~f&&(typeof c[2]=="number"?(g[v]=n.slice(0,f),n=n.slice(f+c[2])):(g[v]=n.slice(f),n=n.slice(0,f)))):(f=s.exec(n))&&(g[v]=f[1],n=n.slice(0,f.index)),g[v]=g[v]||i&&c[3]&&e[v]||"",c[4]&&(g[v]=g[v].toLowerCase())}t&&(g.query=t(g.query)),i&&e.slashes&&g.pathname.charAt(0)!=="/"&&(g.pathname!==""||e.pathname!=="")&&(g.pathname=uc(g.pathname,e.pathname)),g.pathname.charAt(0)!=="/"&&je(g.protocol)&&(g.pathname="/"+g.pathname),zs(g.port,g.protocol)||(g.host=g.hostname,g.port=""),g.username=g.password="",g.auth&&(f=g.auth.indexOf(":"),~f?(g.username=g.auth.slice(0,f),g.username=encodeURIComponent(decodeURIComponent(g.username)),g.password=g.auth.slice(f+1),g.password=encodeURIComponent(decodeURIComponent(g.password))):g.username=encodeURIComponent(decodeURIComponent(g.auth)),g.auth=g.password?g.username+":"+g.password:g.username),g.origin=g.protocol!=="file:"&&je(g.protocol)&&g.host?g.protocol+"//"+g.host:"null",g.href=g.toString()}function fc(n,e,t){var i=this;switch(n){case"query":typeof e=="string"&&e.length&&(e=(t||yn.parse)(e)),i[n]=e;break;case"port":i[n]=e,zs(e,i.protocol)?e&&(i.host=i.hostname+":"+e):(i.host=i.hostname,i[n]="");break;case"hostname":i[n]=e,i.port&&(e+=":"+i.port),i.host=e;break;case"host":i[n]=e,Gs.test(e)?(e=e.split(":"),i.port=e.pop(),i.hostname=e.join(":")):(i.hostname=e,i.port="");break;case"protocol":i.protocol=e.toLowerCase(),i.slashes=!t;break;case"pathname":case"hash":if(e){var r=n==="pathname"?"/":"#";i[n]=e.charAt(0)!==r?r+e:e}else i[n]=e;break;case"username":case"password":i[n]=encodeURIComponent(e);break;case"auth":var s=e.indexOf(":");~s?(i.username=e.slice(0,s),i.username=encodeURIComponent(decodeURIComponent(i.username)),i.password=e.slice(s+1),i.password=encodeURIComponent(decodeURIComponent(i.password))):i.username=encodeURIComponent(decodeURIComponent(e))}for(var c=0;c<Di.length;c++){var f=Di[c];f[4]&&(i[f[1]]=i[f[1]].toLowerCase())}return i.auth=i.password?i.username+":"+i.password:i.username,i.origin=i.protocol!=="file:"&&je(i.protocol)&&i.host?i.protocol+"//"+i.host:"null",i.href=i.toString(),i}function hc(n){(!n||typeof n!="function")&&(n=yn.stringify);var e,t=this,i=t.host,r=t.protocol;r&&r.charAt(r.length-1)!==":"&&(r+=":");var s=r+(t.protocol&&t.slashes||je(t.protocol)?"//":"");return t.username?(s+=t.username,t.password&&(s+=":"+t.password),s+="@"):t.password?(s+=":"+t.password,s+="@"):t.protocol!=="file:"&&je(t.protocol)&&!i&&t.pathname!=="/"&&(s+="@"),(i[i.length-1]===":"||Gs.test(t.hostname)&&!t.port)&&(i+=":"),s+=i+t.pathname,e=typeof t.query=="object"?n(t.query):t.query,e&&(s+=e.charAt(0)!=="?"?"?"+e:e),t.hash&&(s+=t.hash),s}Te.prototype={set:fc,toString:hc};Te.extractProtocol=Ys;Te.location=Js;Te.trimLeft=xi;Te.qs=yn;Xs.exports=Te});var ki=F(Mt=>{"use strict";var dc=Mt&&Mt.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Mt,"__esModule",{value:!0});Mt.URLExt=void 0;var _c=require("path"),wn=dc(Zs()),Qs;(function(n){function e(p){if(typeof document<"u"&&document){let h=document.createElement("a");return h.href=p,h}return(0,wn.default)(p)}n.parse=e;function t(p){return(0,wn.default)(p).hostname}n.getHostName=t;function i(p){return p&&e(p).toString()}n.normalize=i;function r(...p){let h=(0,wn.default)(p[0],{}),g=h.protocol===""&&h.slashes;g&&(h=(0,wn.default)(p[0],"https:"+p[0]));let b=`${g?"":h.protocol}${h.slashes?"//":""}${h.auth}${h.auth?"@":""}${h.host}`,C=_c.posix.join(`${b&&h.pathname[0]!=="/"?"/":""}${h.pathname}`,...p.slice(1));return`${b}${C==="."?"":C}`}n.join=r;function s(p){return r(...p.split("/").map(encodeURIComponent))}n.encodeParts=s;function c(p){let h=Object.keys(p).filter(g=>g.length>0);return h.length?"?"+h.map(g=>{let b=encodeURIComponent(String(p[g]));return g+(b?"="+b:"")}).join("&"):""}n.objectToQueryString=c;function f(p){return p.replace(/^\?/,"").split("&").reduce((h,g)=>{let[b,C]=g.split("=");return b.length>0&&(h[b]=decodeURIComponent(C||"")),h},{})}n.queryStringToObject=f;function v(p,h=!1){let{protocol:g}=e(p);return(!g||p.toLowerCase().indexOf(g)!==0)&&(h?p.indexOf("//")!==0:p.indexOf("/")!==0)}n.isLocal=v})(Qs||(Mt.URLExt=Qs={}))});var eo=F((exports,module)=>{"use strict";var __importDefault=exports&&exports.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(exports,"__esModule",{value:!0});exports.PageConfig=void 0;var coreutils_1=_n(),minimist_1=__importDefault(As()),url_1=ki(),PageConfig;(function(PageConfig){function getOption(name){if(configData)return configData[name]||getBodyData(name);configData=Object.create(null);let found=!1;if(typeof document<"u"&&document){let n=document.getElementById("jupyter-config-data");n&&(configData=JSON.parse(n.textContent||""),found=!0)}if(!found&&typeof process<"u"&&process.argv)try{let cli=(0,minimist_1.default)(process.argv.slice(2)),path=require("path"),fullPath="";"jupyter-config-data"in cli?fullPath=path.resolve(cli["jupyter-config-data"]):"JUPYTER_CONFIG_DATA"in process.env&&(fullPath=path.resolve(process.env.JUPYTER_CONFIG_DATA)),fullPath&&(configData=eval("require")(fullPath))}catch(n){console.error(n)}if(!coreutils_1.JSONExt.isObject(configData))configData=Object.create(null);else for(let n in configData)typeof configData[n]!="string"&&(configData[n]=JSON.stringify(configData[n]));return configData[name]||getBodyData(name)}PageConfig.getOption=getOption;function setOption(n,e){let t=getOption(n);return configData[n]=e,t}PageConfig.setOption=setOption;function getBaseUrl(){return url_1.URLExt.normalize(getOption("baseUrl")||"/")}PageConfig.getBaseUrl=getBaseUrl;function getTreeUrl(){return url_1.URLExt.join(getBaseUrl(),getOption("treeUrl"))}PageConfig.getTreeUrl=getTreeUrl;function getShareUrl(){return url_1.URLExt.normalize(getOption("shareUrl")||getBaseUrl())}PageConfig.getShareUrl=getShareUrl;function getTreeShareUrl(){return url_1.URLExt.normalize(url_1.URLExt.join(getShareUrl(),getOption("treeUrl")))}PageConfig.getTreeShareUrl=getTreeShareUrl;function getUrl(n){var e,t,i,r;let s=n.toShare?getShareUrl():getBaseUrl(),c=(e=n.mode)!==null&&e!==void 0?e:getOption("mode"),f=(t=n.workspace)!==null&&t!==void 0?t:getOption("workspace"),v=c==="single-document"?"doc":"lab";s=url_1.URLExt.join(s,v),f!==PageConfig.defaultWorkspace&&(s=url_1.URLExt.join(s,"workspaces",encodeURIComponent((i=getOption("workspace"))!==null&&i!==void 0?i:PageConfig.defaultWorkspace)));let p=(r=n.treePath)!==null&&r!==void 0?r:getOption("treePath");return p&&(s=url_1.URLExt.join(s,"tree",url_1.URLExt.encodeParts(p))),s}PageConfig.getUrl=getUrl,PageConfig.defaultWorkspace="default";function getWsUrl(n){let e=getOption("wsUrl");if(!e){if(n=n?url_1.URLExt.normalize(n):getBaseUrl(),n.indexOf("http")!==0)return"";e="ws"+n.slice(4)}return url_1.URLExt.normalize(e)}PageConfig.getWsUrl=getWsUrl;function getNBConvertURL({path:n,format:e,download:t}){let i=url_1.URLExt.encodeParts(n),r=url_1.URLExt.join(getBaseUrl(),"nbconvert",e,i);return t?r+"?download=true":r}PageConfig.getNBConvertURL=getNBConvertURL;function getToken(){return getOption("token")||getBodyData("jupyterApiToken")}PageConfig.getToken=getToken;function getNotebookVersion(){let n=getOption("notebookVersion");return n===""?[0,0,0]:JSON.parse(n)}PageConfig.getNotebookVersion=getNotebookVersion;let configData=null;function getBodyData(n){if(typeof document>"u"||!document.body)return"";let e=document.body.dataset[n];return typeof e>"u"?"":decodeURIComponent(e)}let Extension;(function(n){function e(r){try{let s=getOption(r);if(s)return JSON.parse(s)}catch(s){console.warn(`Unable to parse ${r}.`,s)}return[]}n.deferred=e("deferredExtensions"),n.disabled=e("disabledExtensions");function t(r){let s=r.indexOf(":"),c="";return s!==-1&&(c=r.slice(0,s)),n.deferred.some(f=>f===r||c&&f===c)}n.isDeferred=t;function i(r){let s=r.indexOf(":"),c="";return s!==-1&&(c=r.slice(0,s)),n.disabled.some(f=>f===r||c&&f===c)}n.isDisabled=i})(Extension=PageConfig.Extension||(PageConfig.Extension={}))})(PageConfig||(exports.PageConfig=PageConfig={}))});var no=F(Sn=>{"use strict";Object.defineProperty(Sn,"__esModule",{value:!0});Sn.PathExt=void 0;var rt=require("path"),to;(function(n){function e(...g){let b=rt.posix.join(...g);return b==="."?"":h(b)}n.join=e;function t(...g){let b=rt.posix.join(...g);return b==="."?"":b}n.joinWithLeadingSlash=t;function i(g,b){return rt.posix.basename(g,b)}n.basename=i;function r(g){let b=h(rt.posix.dirname(g));return b==="."?"":b}n.dirname=r;function s(g){return rt.posix.extname(g)}n.extname=s;function c(g){return g===""?"":h(rt.posix.normalize(g))}n.normalize=c;function f(...g){return h(rt.posix.resolve(...g))}n.resolve=f;function v(g,b){return h(rt.posix.relative(g,b))}n.relative=v;function p(g){return g.length>0&&g.indexOf(".")!==0&&(g=`.${g}`),g}n.normalizeExtension=p;function h(g){return g.indexOf("/")===0&&(g=g.slice(1)),g}n.removeSlash=h})(to||(Sn.PathExt=to={}))});var io=F(bn=>{"use strict";Object.defineProperty(bn,"__esModule",{value:!0});bn.signalToPromise=void 0;var gc=_n();function pc(n,e){let t=new gc.PromiseDelegate;function i(){n.disconnect(r)}function r(s,c){i(),t.resolve([s,c])}return n.connect(r),(e??0)>0&&setTimeout(()=>{i(),t.reject(`Signal not emitted within ${e} ms.`)},e),t.promise}bn.signalToPromise=pc});var so=F(Mn=>{"use strict";Object.defineProperty(Mn,"__esModule",{value:!0});Mn.Text=void 0;var ro;(function(n){let e=2>1;function t(c,f){if(e)return c;let v=c;for(let p=0;p+1<f.length&&p<c;p++){let h=f.charCodeAt(p);if(h>=55296&&h<=56319){let g=f.charCodeAt(p+1);g>=56320&&g<=57343&&(v--,p++)}}return v}n.jsIndexToCharIndex=t;function i(c,f){if(e)return c;let v=c;for(let p=0;p+1<f.length&&p<v;p++){let h=f.charCodeAt(p);if(h>=55296&&h<=56319){let g=f.charCodeAt(p+1);g>=56320&&g<=57343&&(v++,p++)}}return v}n.charIndexToJsIndex=i;function r(c,f=!1){return c.replace(/^(\w)|[\s-_:]+(\w)/g,function(v,p,h){return h?h.toUpperCase():f?p.toUpperCase():p.toLowerCase()})}n.camelCase=r;function s(c){return(c||"").toLowerCase().split(" ").map(f=>f.charAt(0).toUpperCase()+f.slice(1)).join(" ")}n.titleCase=s})(ro||(Mn.Text=ro={}))});var lo=F(Cn=>{"use strict";Object.defineProperty(Cn,"__esModule",{value:!0});Cn.Time=void 0;var mc=[{name:"years",milliseconds:365*24*60*60*1e3},{name:"months",milliseconds:30*24*60*60*1e3},{name:"days",milliseconds:24*60*60*1e3},{name:"hours",milliseconds:60*60*1e3},{name:"minutes",milliseconds:60*1e3},{name:"seconds",milliseconds:1e3}],oo;(function(n){function e(i,r="long"){let s=document.documentElement.lang||"en",c=new Intl.RelativeTimeFormat(s,{numeric:"auto",style:r}),f=new Date(i).getTime()-Date.now();for(let v of mc){let p=Math.ceil(f/v.milliseconds);if(p!==0)return c.format(p,v.name)}return c.format(0,"seconds")}n.formatHuman=e;function t(i){let r=document.documentElement.lang||"en";return new Intl.DateTimeFormat(r,{dateStyle:"short",timeStyle:"short"}).format(new Date(i))}n.format=t})(oo||(Cn.Time=oo={}))});var ue=F(ce=>{"use strict";var vc=ce&&ce.__createBinding||(Object.create?function(n,e,t,i){i===void 0&&(i=t);var r=Object.getOwnPropertyDescriptor(e,t);(!r||("get"in r?!e.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,i,r)}:function(n,e,t,i){i===void 0&&(i=t),n[i]=e[t]}),Ie=ce&&ce.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&vc(e,n,t)};Object.defineProperty(ce,"__esModule",{value:!0});Ie(xs(),ce);Ie(qs(),ce);Ie(js(),ce);Ie(Is(),ce);Ie(eo(),ce);Ie(no(),ce);Ie(io(),ce);Ie(so(),ce);Ie(lo(),ce);Ie(ki(),ce)});var qi=F((Pn,ao)=>{(function(n,e){typeof Pn=="object"&&typeof ao<"u"?e(Pn):typeof define=="function"&&define.amd?define(["exports"],e):(n=typeof globalThis<"u"?globalThis:n||self,e(n.lumino_algorithm={}))})(Pn,function(n){"use strict";n.ArrayExt=void 0,function(u){function d(_,y,l=0,o=-1){let a=_.length;if(a===0)return-1;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S;o<l?S=o+1+(a-l):S=o-l+1;for(let M=0;M<S;++M){let q=(l+M)%a;if(_[q]===y)return q}return-1}u.firstIndexOf=d;function m(_,y,l=-1,o=0){let a=_.length;if(a===0)return-1;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S;l<o?S=l+1+(a-o):S=l-o+1;for(let M=0;M<S;++M){let q=(l-M+a)%a;if(_[q]===y)return q}return-1}u.lastIndexOf=m;function w(_,y,l=0,o=-1){let a=_.length;if(a===0)return-1;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S;o<l?S=o+1+(a-l):S=o-l+1;for(let M=0;M<S;++M){let q=(l+M)%a;if(y(_[q],q))return q}return-1}u.findFirstIndex=w;function R(_,y,l=-1,o=0){let a=_.length;if(a===0)return-1;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S;l<o?S=l+1+(a-o):S=l-o+1;for(let M=0;M<S;++M){let q=(l-M+a)%a;if(y(_[q],q))return q}return-1}u.findLastIndex=R;function U(_,y,l=0,o=-1){let a=w(_,y,l,o);return a!==-1?_[a]:void 0}u.findFirstValue=U;function D(_,y,l=-1,o=0){let a=R(_,y,l,o);return a!==-1?_[a]:void 0}u.findLastValue=D;function k(_,y,l,o=0,a=-1){let S=_.length;if(S===0)return 0;o<0?o=Math.max(0,o+S):o=Math.min(o,S-1),a<0?a=Math.max(0,a+S):a=Math.min(a,S-1);let M=o,q=a-o+1;for(;q>0;){let K=q>>1,Q=M+K;l(_[Q],y)<0?(M=Q+1,q-=K+1):q=K}return M}u.lowerBound=k;function A(_,y,l,o=0,a=-1){let S=_.length;if(S===0)return 0;o<0?o=Math.max(0,o+S):o=Math.min(o,S-1),a<0?a=Math.max(0,a+S):a=Math.min(a,S-1);let M=o,q=a-o+1;for(;q>0;){let K=q>>1,Q=M+K;l(_[Q],y)>0?q=K:(M=Q+1,q-=K+1)}return M}u.upperBound=A;function T(_,y,l){if(_===y)return!0;if(_.length!==y.length)return!1;for(let o=0,a=_.length;o<a;++o)if(l?!l(_[o],y[o]):_[o]!==y[o])return!1;return!0}u.shallowEqual=T;function B(_,y={}){let{start:l,stop:o,step:a}=y;if(a===void 0&&(a=1),a===0)throw new Error("Slice `step` cannot be zero.");let S=_.length;l===void 0?l=a<0?S-1:0:l<0?l=Math.max(l+S,a<0?-1:0):l>=S&&(l=a<0?S-1:S),o===void 0?o=a<0?-1:S:o<0?o=Math.max(o+S,a<0?-1:0):o>=S&&(o=a<0?S-1:S);let M;a<0&&o>=l||a>0&&l>=o?M=0:a<0?M=Math.floor((o-l+1)/a+1):M=Math.floor((o-l-1)/a+1);let q=[];for(let K=0;K<M;++K)q[K]=_[l+K*a];return q}u.slice=B;function L(_,y,l){let o=_.length;if(o<=1||(y<0?y=Math.max(0,y+o):y=Math.min(y,o-1),l<0?l=Math.max(0,l+o):l=Math.min(l,o-1),y===l))return;let a=_[y],S=y<l?1:-1;for(let M=y;M!==l;M+=S)_[M]=_[M+S];_[l]=a}u.move=L;function W(_,y=0,l=-1){let o=_.length;if(!(o<=1))for(y<0?y=Math.max(0,y+o):y=Math.min(y,o-1),l<0?l=Math.max(0,l+o):l=Math.min(l,o-1);y<l;){let a=_[y],S=_[l];_[y++]=S,_[l--]=a}}u.reverse=W;function z(_,y,l=0,o=-1){let a=_.length;if(a<=1||(l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1),l>=o))return;let S=o-l+1;if(y>0?y=y%S:y<0&&(y=(y%S+S)%S),y===0)return;let M=l+y;W(_,l,M-1),W(_,M,o),W(_,l,o)}u.rotate=z;function G(_,y,l=0,o=-1){let a=_.length;if(a===0)return;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S;o<l?S=o+1+(a-l):S=o-l+1;for(let M=0;M<S;++M)_[(l+M)%a]=y}u.fill=G;function Ke(_,y,l){let o=_.length;y<0?y=Math.max(0,y+o):y=Math.min(y,o);for(let a=o;a>y;--a)_[a]=_[a-1];_[y]=l}u.insert=Ke;function Z(_,y){let l=_.length;if(y<0&&(y+=l),y<0||y>=l)return;let o=_[y];for(let a=y+1;a<l;++a)_[a-1]=_[a];return _.length=l-1,o}u.removeAt=Z;function ze(_,y,l=0,o=-1){let a=d(_,y,l,o);return a!==-1&&Z(_,a),a}u.removeFirstOf=ze;function He(_,y,l=-1,o=0){let a=m(_,y,l,o);return a!==-1&&Z(_,a),a}u.removeLastOf=He;function Ge(_,y,l=0,o=-1){let a=_.length;if(a===0)return 0;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S=0;for(let M=0;M<a;++M)l<=o&&M>=l&&M<=o&&_[M]===y||o<l&&(M<=o||M>=l)&&_[M]===y?S++:S>0&&(_[M-S]=_[M]);return S>0&&(_.length=a-S),S}u.removeAllOf=Ge;function Je(_,y,l=0,o=-1){let a,S=w(_,y,l,o);return S!==-1&&(a=Z(_,S)),{index:S,value:a}}u.removeFirstWhere=Je;function Ye(_,y,l=-1,o=0){let a,S=R(_,y,l,o);return S!==-1&&(a=Z(_,S)),{index:S,value:a}}u.removeLastWhere=Ye;function Xe(_,y,l=0,o=-1){let a=_.length;if(a===0)return 0;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S=0;for(let M=0;M<a;++M)l<=o&&M>=l&&M<=o&&y(_[M],M)||o<l&&(M<=o||M>=l)&&y(_[M],M)?S++:S>0&&(_[M-S]=_[M]);return S>0&&(_.length=a-S),S}u.removeAllWhere=Xe}(n.ArrayExt||(n.ArrayExt={}));function*e(...u){for(let d of u)yield*d}function*t(){}function*i(u,d=0){for(let m of u)yield[d++,m]}function*r(u,d){let m=0;for(let w of u)d(w,m++)&&(yield w)}function s(u,d){let m=0;for(let w of u)if(d(w,m++))return w}function c(u,d){let m=0;for(let w of u)if(d(w,m++))return m-1;return-1}function f(u,d){let m;for(let w of u){if(m===void 0){m=w;continue}d(w,m)<0&&(m=w)}return m}function v(u,d){let m;for(let w of u){if(m===void 0){m=w;continue}d(w,m)>0&&(m=w)}return m}function p(u,d){let m=!0,w,R;for(let U of u)m?(w=U,R=U,m=!1):d(U,w)<0?w=U:d(U,R)>0&&(R=U);return m?void 0:[w,R]}function h(u){return Array.from(u)}function g(u){let d={};for(let[m,w]of u)d[m]=w;return d}function b(u,d){let m=0;for(let w of u)if(d(w,m++)===!1)return}function C(u,d){let m=0;for(let w of u)if(d(w,m++)===!1)return!1;return!0}function P(u,d){let m=0;for(let w of u)if(d(w,m++))return!0;return!1}function*O(u,d){let m=0;for(let w of u)yield d(w,m++)}function*I(u,d,m){d===void 0?(d=u,u=0,m=1):m===void 0&&(m=1);let w=N.rangeLength(u,d,m);for(let R=0;R<w;R++)yield u+m*R}var N;(function(u){function d(m,w,R){return R===0?1/0:m>w&&R>0||m<w&&R<0?0:Math.ceil((w-m)/R)}u.rangeLength=d})(N||(N={}));function V(u,d,m){let w=u[Symbol.iterator](),R=0,U=w.next();if(U.done&&m===void 0)throw new TypeError("Reduce of empty iterable with no initial value.");if(U.done)return m;let D=w.next();if(D.done&&m===void 0)return U.value;if(D.done)return d(m,U.value,R++);let k;m===void 0?k=d(U.value,D.value,R++):k=d(d(m,U.value,R++),D.value,R++);let A;for(;!(A=w.next()).done;)k=d(k,A.value,R++);return k}function*$(u,d){for(;0<d--;)yield u}function*j(u){yield u}function*J(u){if(typeof u.retro=="function")yield*u.retro();else for(let d=u.length-1;d>-1;d--)yield u[d]}function X(u){let d=[],m=new Set,w=new Map;for(let D of u)R(D);for(let[D]of w)U(D);return d;function R(D){let[k,A]=D,T=w.get(A);T?T.push(k):w.set(A,[k])}function U(D){if(m.has(D))return;m.add(D);let k=w.get(D);if(k)for(let A of k)U(A);d.push(D)}}function*H(u,d){let m=0;for(let w of u)m++%d===0&&(yield w)}n.StringExt=void 0,function(u){function d(D,k,A=0){let T=new Array(k.length);for(let B=0,L=A,W=k.length;B<W;++B,++L){if(L=D.indexOf(k[B],L),L===-1)return null;T[B]=L}return T}u.findIndices=d;function m(D,k,A=0){let T=d(D,k,A);if(!T)return null;let B=0;for(let L=0,W=T.length;L<W;++L){let z=T[L]-A;B+=z*z}return{score:B,indices:T}}u.matchSumOfSquares=m;function w(D,k,A=0){let T=d(D,k,A);if(!T)return null;let B=0,L=A-1;for(let W=0,z=T.length;W<z;++W){let G=T[W];B+=G-L-1,L=G}return{score:B,indices:T}}u.matchSumOfDeltas=w;function R(D,k,A){let T=[],B=0,L=0,W=k.length;for(;B<W;){let z=k[B],G=k[B];for(;++B<W&&k[B]===G+1;)G++;L<z&&T.push(D.slice(L,z)),z<G+1&&T.push(A(D.slice(z,G+1))),L=G+1}return L<D.length&&T.push(D.slice(L)),T}u.highlight=R;function U(D,k){return D<k?-1:D>k?1:0}u.cmp=U}(n.StringExt||(n.StringExt={}));function*E(u,d){if(d<1)return;let m=u[Symbol.iterator](),w;for(;0<d--&&!(w=m.next()).done;)yield w.value}function*x(...u){let d=u.map(w=>w[Symbol.iterator]()),m=d.map(w=>w.next());for(;C(m,w=>!w.done);m=d.map(w=>w.next()))yield m.map(w=>w.value)}n.chain=e,n.each=b,n.empty=t,n.enumerate=i,n.every=C,n.filter=r,n.find=s,n.findIndex=c,n.map=O,n.max=v,n.min=f,n.minmax=p,n.once=j,n.range=I,n.reduce=V,n.repeat=$,n.retro=J,n.some=P,n.stride=H,n.take=E,n.toArray=h,n.toObject=g,n.topologicSort=X,n.zip=x})});var Ue=F(_e=>{"use strict";var yc=qi();_e.JSONExt=void 0;(function(n){n.emptyObject=Object.freeze({}),n.emptyArray=Object.freeze([]);function e(h){return h===null||typeof h=="boolean"||typeof h=="number"||typeof h=="string"}n.isPrimitive=e;function t(h){return Array.isArray(h)}n.isArray=t;function i(h){return!e(h)&&!t(h)}n.isObject=i;function r(h,g){if(h===g)return!0;if(e(h)||e(g))return!1;let b=t(h),C=t(g);return b!==C?!1:b&&C?c(h,g):f(h,g)}n.deepEqual=r;function s(h){return e(h)?h:t(h)?v(h):p(h)}n.deepCopy=s;function c(h,g){if(h===g)return!0;if(h.length!==g.length)return!1;for(let b=0,C=h.length;b<C;++b)if(!r(h[b],g[b]))return!1;return!0}function f(h,g){if(h===g)return!0;for(let b in h)if(h[b]!==void 0&&!(b in g))return!1;for(let b in g)if(g[b]!==void 0&&!(b in h))return!1;for(let b in h){let C=h[b],P=g[b];if(!(C===void 0&&P===void 0)&&(C===void 0||P===void 0||!r(C,P)))return!1}return!0}function v(h){let g=new Array(h.length);for(let b=0,C=h.length;b<C;++b)g[b]=s(h[b]);return g}function p(h){let g={};for(let b in h){let C=h[b];C!==void 0&&(g[b]=s(C))}return g}})(_e.JSONExt||(_e.JSONExt={}));var ji=class{constructor(){this._types=[],this._values=[]}types(){return this._types.slice()}hasData(e){return this._types.indexOf(e)!==-1}getData(e){let t=this._types.indexOf(e);return t!==-1?this._values[t]:void 0}setData(e,t){this.clearData(e),this._types.push(e),this._values.push(t)}clearData(e){let t=this._types.indexOf(e);t!==-1&&(this._types.splice(t,1),this._values.splice(t,1))}clear(){this._types.length=0,this._values.length=0}},Ti=class{constructor(e={}){this._application=null,this._validatePlugin=()=>!0,this._plugins=new Map,this._services=new Map,e.validatePlugin&&(console.info("Plugins may be rejected by the custom validation plugin method."),this._validatePlugin=e.validatePlugin)}get application(){return this._application}set application(e){if(this._application!==null)throw Error("PluginRegistry.application is already set. It cannot be overridden.");this._application=e}get deferredPlugins(){return Array.from(this._plugins).filter(([e,t])=>t.autoStart==="defer").map(([e,t])=>e)}getPluginDescription(e){var t,i;return(i=(t=this._plugins.get(e))===null||t===void 0?void 0:t.description)!==null&&i!==void 0?i:""}hasPlugin(e){return this._plugins.has(e)}isPluginActivated(e){var t,i;return(i=(t=this._plugins.get(e))===null||t===void 0?void 0:t.activated)!==null&&i!==void 0?i:!1}listPlugins(){return Array.from(this._plugins.keys())}registerPlugin(e){if(this._plugins.has(e.id))throw new TypeError(`Plugin '${e.id}' is already registered.`);if(!this._validatePlugin(e))throw new Error(`Plugin '${e.id}' is not valid.`);let t=Ct.createPluginData(e);Ct.ensureNoCycle(t,this._plugins,this._services),t.provides&&this._services.set(t.provides,t.id),this._plugins.set(t.id,t)}registerPlugins(e){for(let t of e)this.registerPlugin(t)}deregisterPlugin(e,t){let i=this._plugins.get(e);if(i){if(i.activated&&!t)throw new Error(`Plugin '${e}' is still active.`);this._plugins.delete(e)}}async activatePlugin(e){let t=this._plugins.get(e);if(!t)throw new ReferenceError(`Plugin '${e}' is not registered.`);if(t.activated)return;if(t.promise)return t.promise;let i=t.requires.map(s=>this.resolveRequiredService(s)),r=t.optional.map(s=>this.resolveOptionalService(s));return t.promise=Promise.all([...i,...r]).then(s=>t.activate.apply(void 0,[this.application,...s])).then(s=>{t.service=s,t.activated=!0,t.promise=null}).catch(s=>{throw t.promise=null,s}),t.promise}async activatePlugins(e,t={}){switch(e){case"defer":{let i=this.deferredPlugins.filter(r=>this._plugins.get(r).autoStart).map(r=>this.activatePlugin(r));await Promise.all(i);break}case"startUp":{let r=Ct.collectStartupPlugins(this._plugins,t).map(async s=>{try{return await this.activatePlugin(s)}catch(c){console.error(`Plugin '${s}' failed to activate.`,c)}});await Promise.all(r);break}}}async deactivatePlugin(e){let t=this._plugins.get(e);if(!t)throw new ReferenceError(`Plugin '${e}' is not registered.`);if(!t.activated)return[];if(!t.deactivate)throw new TypeError(`Plugin '${e}'#deactivate() method missing`);let i=Ct.findDependents(e,this._plugins,this._services),r=i.map(s=>this._plugins.get(s));for(let s of r)if(!s.deactivate)throw new TypeError(`Plugin ${s.id}#deactivate() method missing (depends on ${e})`);for(let s of r){let c=[...s.requires,...s.optional].map(f=>{let v=this._services.get(f);return v?this._plugins.get(v).service:null});await s.deactivate(this.application,...c),s.service=null,s.activated=!1}return i.pop(),i}async resolveRequiredService(e){let t=this._services.get(e);if(!t)throw new TypeError(`No provider for: ${e.name}.`);let i=this._plugins.get(t);return i.activated||await this.activatePlugin(t),i.service}async resolveOptionalService(e){let t=this._services.get(e);if(!t)return null;let i=this._plugins.get(t);if(!i.activated)try{await this.activatePlugin(t)}catch(r){return console.error(r),null}return i.service}},Ct;(function(n){class e{constructor(f){var v,p,h,g;this._activated=!1,this._promise=null,this._service=null,this.id=f.id,this.description=(v=f.description)!==null&&v!==void 0?v:"",this.activate=f.activate,this.deactivate=(p=f.deactivate)!==null&&p!==void 0?p:null,this.provides=(h=f.provides)!==null&&h!==void 0?h:null,this.autoStart=(g=f.autoStart)!==null&&g!==void 0?g:!1,this.requires=f.requires?f.requires.slice():[],this.optional=f.optional?f.optional.slice():[]}get activated(){return this._activated}set activated(f){this._activated=f}get service(){return this._service}set service(f){this._service=f}get promise(){return this._promise}set promise(f){this._promise=f}}function t(c){return new e(c)}n.createPluginData=t;function i(c,f,v){let p=[...c.requires,...c.optional],h=b=>{if(b===c.provides)return!0;let C=v.get(b);if(!C)return!1;let P=f.get(C),O=[...P.requires,...P.optional];return O.length===0?!1:(g.push(C),O.some(h)?!0:(g.pop(),!1))};if(!c.provides||p.length===0)return;let g=[c.id];if(p.some(h))throw new ReferenceError(`Cycle detected: ${g.join(" -> ")}.`)}n.ensureNoCycle=i;function r(c,f,v){let p=new Array,h=O=>{let I=f.get(O),N=[...I.requires,...I.optional];p.push(...N.reduce((V,$)=>{let j=v.get($);return j&&V.push([O,j]),V},[]))};for(let O of f.keys())h(O);let g=p.filter(O=>O[1]===c),b=0;for(;g.length>b;){let O=g.length,I=new Set(g.map(N=>N[0]));for(let N of I)p.filter(V=>V[1]===N).forEach(V=>{g.includes(V)||g.push(V)});b=O}let C=yc.topologicSort(g),P=C.findIndex(O=>O===c);return P===-1?[c]:C.slice(0,P+1)}n.findDependents=r;function s(c,f){let v=new Set;for(let p of c.keys())c.get(p).autoStart===!0&&v.add(p);if(f.startPlugins)for(let p of f.startPlugins)v.add(p);if(f.ignorePlugins)for(let p of f.ignorePlugins)v.delete(p);return Array.from(v)}n.collectStartupPlugins=s})(Ct||(Ct={}));var Ii=class{constructor(){this.promise=new Promise((e,t)=>{this._resolve=e,this._reject=t})}resolve(e){let t=this._resolve;t(e)}reject(e){let t=this._reject;t(e)}},Ui=class{constructor(e,t){this.name=e,this.description=t??"",this._tokenStructuralPropertyT=null}};function wc(n){let e=0;for(let t=0,i=n.length;t<i;++t)t%4===0&&(e=Math.random()*4294967295>>>0),n[t]=e&255,e>>>=8}_e.Random=void 0;(function(n){n.getRandomValues=(()=>{let e=typeof require<"u"&&require("crypto")||null;return e&&typeof e.randomFillSync=="function"?function(i){return e.randomFillSync(i)}:e&&typeof e.randomBytes=="function"?function(i){let r=e.randomBytes(i.length);for(let s=0,c=r.length;s<c;++s)i[s]=r[s]}:wc})()})(_e.Random||(_e.Random={}));function Sc(n){let e=new Uint8Array(16),t=new Array(256);for(let i=0;i<16;++i)t[i]="0"+i.toString(16);for(let i=16;i<256;++i)t[i]=i.toString(16);return function(){return n(e),e[6]=64|e[6]&15,e[8]=128|e[8]&63,t[e[0]]+t[e[1]]+t[e[2]]+t[e[3]]+"-"+t[e[4]]+t[e[5]]+"-"+t[e[6]]+t[e[7]]+"-"+t[e[8]]+t[e[9]]+"-"+t[e[10]]+t[e[11]]+t[e[12]]+t[e[13]]+t[e[14]]+t[e[15]]}}_e.UUID=void 0;(function(n){n.uuid4=Sc(_e.Random.getRandomValues)})(_e.UUID||(_e.UUID={}));_e.MimeData=ji;_e.PluginRegistry=Ti;_e.PromiseDelegate=Ii;_e.Token=Ui});var Oe=F((En,co)=>{(function(n,e){typeof En=="object"&&typeof co<"u"?e(En,qi(),Ue()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm","@lumino/coreutils"],e):(n=typeof globalThis<"u"?globalThis:n||self,e(n.lumino_signaling={},n.lumino_algorithm,n.lumino_coreutils))})(En,function(n,e,t){"use strict";class i{constructor(f){this.sender=f}connect(f,v){return s.connect(this,f,v)}disconnect(f,v){return s.disconnect(this,f,v)}emit(f){s.emit(this,f)}}(function(c){function f(P,O){s.disconnectBetween(P,O)}c.disconnectBetween=f;function v(P){s.disconnectSender(P)}c.disconnectSender=v;function p(P){s.disconnectReceiver(P)}c.disconnectReceiver=p;function h(P){s.disconnectAll(P)}c.disconnectAll=h;function g(P){s.disconnectAll(P)}c.clearData=g;function b(){return s.exceptionHandler}c.getExceptionHandler=b;function C(P){let O=s.exceptionHandler;return s.exceptionHandler=P,O}c.setExceptionHandler=C})(i||(i={}));class r extends i{constructor(){super(...arguments),this._pending=new t.PromiseDelegate}async*[Symbol.asyncIterator](){let f=this._pending;for(;;)try{let{args:v,next:p}=await f.promise;f=p,yield v}catch{return}}emit(f){let v=this._pending,p=this._pending=new t.PromiseDelegate;v.resolve({args:f,next:p}),super.emit(f)}stop(){this._pending.promise.catch(()=>{}),this._pending.reject("stop"),this._pending=new t.PromiseDelegate}}var s;(function(c){c.exceptionHandler=E=>{console.error(E)};function f(E,x,u){u=u||void 0;let d=P.get(E.sender);if(d||(d=[],P.set(E.sender,d)),V(d,E,x,u))return!1;let m=u||x,w=O.get(m);w||(w=[],O.set(m,w));let R={signal:E,slot:x,thisArg:u};return d.push(R),w.push(R),!0}c.connect=f;function v(E,x,u){u=u||void 0;let d=P.get(E.sender);if(!d||d.length===0)return!1;let m=V(d,E,x,u);if(!m)return!1;let w=u||x,R=O.get(w);return m.signal=null,j(d),j(R),!0}c.disconnect=v;function p(E,x){let u=P.get(E);if(!u||u.length===0)return;let d=O.get(x);if(!(!d||d.length===0)){for(let m of d)m.signal&&m.signal.sender===E&&(m.signal=null);j(u),j(d)}}c.disconnectBetween=p;function h(E){let x=P.get(E);if(!(!x||x.length===0)){for(let u of x){if(!u.signal)continue;let d=u.thisArg||u.slot;u.signal=null,j(O.get(d))}j(x)}}c.disconnectSender=h;function g(E){let x=O.get(E);if(!(!x||x.length===0)){for(let u of x){if(!u.signal)continue;let d=u.signal.sender;u.signal=null,j(P.get(d))}j(x)}}c.disconnectReceiver=g;function b(E){h(E),g(E)}c.disconnectAll=b;function C(E,x){let u=P.get(E.sender);if(!(!u||u.length===0))for(let d=0,m=u.length;d<m;++d){let w=u[d];w.signal===E&&$(w,x)}}c.emit=C;let P=new WeakMap,O=new WeakMap,I=new Set,N=(()=>typeof requestAnimationFrame=="function"?requestAnimationFrame:setImmediate)();function V(E,x,u,d){return e.find(E,m=>m.signal===x&&m.slot===u&&m.thisArg===d)}function $(E,x){let{signal:u,slot:d,thisArg:m}=E;try{d.call(m,u.sender,x)}catch(w){c.exceptionHandler(w)}}function j(E){I.size===0&&N(J),I.add(E)}function J(){I.forEach(X),I.clear()}function X(E){e.ArrayExt.removeAllWhere(E,H)}function H(E){return E.signal===null}})(s||(s={})),n.Signal=i,n.Stream=r})});var Pt=F(Y=>{"use strict";Object.defineProperty(Y,"__esModule",{value:!0});Y.supportedKernelWebSocketProtocols=Y.isInputReplyMsg=Y.isInputRequestMsg=Y.isDebugReplyMsg=Y.isDebugRequestMsg=Y.isExecuteReplyMsg=Y.isInfoRequestMsg=Y.isCommMsgMsg=Y.isCommCloseMsg=Y.isCommOpenMsg=Y.isDebugEventMsg=Y.isClearOutputMsg=Y.isStatusMsg=Y.isErrorMsg=Y.isExecuteResultMsg=Y.isExecuteInputMsg=Y.isUpdateDisplayDataMsg=Y.isDisplayDataMsg=Y.isStreamMsg=Y.createMessage=void 0;var bc=Ue();function Mc(n){var e,t,i,r,s;return{buffers:(e=n.buffers)!==null&&e!==void 0?e:[],channel:n.channel,content:n.content,header:{date:new Date().toISOString(),msg_id:(t=n.msgId)!==null&&t!==void 0?t:bc.UUID.uuid4(),msg_type:n.msgType,session:n.session,username:(i=n.username)!==null&&i!==void 0?i:"",version:"5.2"},metadata:(r=n.metadata)!==null&&r!==void 0?r:{},parent_header:(s=n.parentHeader)!==null&&s!==void 0?s:{}}}Y.createMessage=Mc;function Cc(n){return n.header.msg_type==="stream"}Y.isStreamMsg=Cc;function Pc(n){return n.header.msg_type==="display_data"}Y.isDisplayDataMsg=Pc;function Ec(n){return n.header.msg_type==="update_display_data"}Y.isUpdateDisplayDataMsg=Ec;function Oc(n){return n.header.msg_type==="execute_input"}Y.isExecuteInputMsg=Oc;function Rc(n){return n.header.msg_type==="execute_result"}Y.isExecuteResultMsg=Rc;function Dc(n){return n.header.msg_type==="error"}Y.isErrorMsg=Dc;function xc(n){return n.header.msg_type==="status"}Y.isStatusMsg=xc;function kc(n){return n.header.msg_type==="clear_output"}Y.isClearOutputMsg=kc;function qc(n){return n.header.msg_type==="debug_event"}Y.isDebugEventMsg=qc;function jc(n){return n.header.msg_type==="comm_open"}Y.isCommOpenMsg=jc;function Tc(n){return n.header.msg_type==="comm_close"}Y.isCommCloseMsg=Tc;function Ic(n){return n.header.msg_type==="comm_msg"}Y.isCommMsgMsg=Ic;function Uc(n){return n.header.msg_type==="kernel_info_request"}Y.isInfoRequestMsg=Uc;function Lc(n){return n.header.msg_type==="execute_reply"}Y.isExecuteReplyMsg=Lc;function Nc(n){return n.header.msg_type==="debug_request"}Y.isDebugRequestMsg=Nc;function Ac(n){return n.header.msg_type==="debug_reply"}Y.isDebugReplyMsg=Ac;function Fc(n){return n.header.msg_type==="input_request"}Y.isInputRequestMsg=Fc;function Bc(n){return n.header.msg_type==="input_reply"}Y.isInputReplyMsg=Bc;var uo;(function(n){n.v1KernelWebsocketJupyterOrg="v1.kernel.websocket.jupyter.org"})(uo||(Y.supportedKernelWebSocketProtocols=uo={}))});var ho=F(xe=>{"use strict";var Vc=xe&&xe.__createBinding||(Object.create?function(n,e,t,i){i===void 0&&(i=t);var r=Object.getOwnPropertyDescriptor(e,t);(!r||("get"in r?!e.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,i,r)}:function(n,e,t,i){i===void 0&&(i=t),n[i]=e[t]}),Wc=xe&&xe.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),$c=xe&&xe.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.prototype.hasOwnProperty.call(n,t)&&Vc(e,n,t);return Wc(e,n),e};Object.defineProperty(xe,"__esModule",{value:!0});xe.deserialize=xe.serialize=void 0;var fo=$c(Pt());function Kc(n,e=""){switch(e){case fo.supportedKernelWebSocketProtocols.v1KernelWebsocketJupyterOrg:return Et.serializeV1KernelWebsocketJupyterOrg(n);default:return Et.serializeDefault(n)}}xe.serialize=Kc;function zc(n,e=""){switch(e){case fo.supportedKernelWebSocketProtocols.v1KernelWebsocketJupyterOrg:return Et.deserializeV1KernelWebsocketJupyterOrg(n);default:return Et.deserializeDefault(n)}}xe.deserialize=zc;var Et;(function(n){function e(f){let v,p=new DataView(f),h=Number(p.getBigUint64(0,!0)),g=[];for(let $=0;$<h;$++)g.push(Number(p.getBigUint64(8*($+1),!0)));let b=new TextDecoder("utf8"),C=b.decode(f.slice(g[0],g[1])),P=JSON.parse(b.decode(f.slice(g[1],g[2]))),O=JSON.parse(b.decode(f.slice(g[2],g[3]))),I=JSON.parse(b.decode(f.slice(g[3],g[4]))),N=JSON.parse(b.decode(f.slice(g[4],g[5]))),V=[];for(let $=5;$<g.length-1;$++)V.push(new DataView(f.slice(g[$],g[$+1])));return v={channel:C,header:P,parent_header:O,metadata:I,content:N,buffers:V},v}n.deserializeV1KernelWebsocketJupyterOrg=e;function t(f){let v=JSON.stringify(f.header),p=f.parent_header==null?"{}":JSON.stringify(f.parent_header),h=JSON.stringify(f.metadata),g=JSON.stringify(f.content),b=f.buffers!==void 0?f.buffers:[],C=1+4+b.length+1,P=[];P.push(8*(1+C)),P.push(f.channel.length+P[P.length-1]);let O=new TextEncoder,I=O.encode(f.channel),N=O.encode(v),V=O.encode(p),$=O.encode(h),j=O.encode(g),J=new Uint8Array(I.length+N.length+V.length+$.length+j.length);J.set(I),J.set(N,I.length),J.set(V,I.length+N.length),J.set($,I.length+N.length+V.length),J.set(j,I.length+N.length+V.length+$.length);for(let u of[N.length,V.length,$.length,j.length])P.push(u+P[P.length-1]);let X=0;for(let u of b){let d=u.byteLength;P.push(d+P[P.length-1]),X+=d}let H=new Uint8Array(8*(1+C)+J.byteLength+X),E=new ArrayBuffer(8),x=new DataView(E);x.setBigUint64(0,BigInt(C),!0),H.set(new Uint8Array(E),0);for(let u=0;u<P.length;u++)x.setBigUint64(0,BigInt(P[u]),!0),H.set(new Uint8Array(E),8*(u+1));H.set(J,P[0]);for(let u=0;u<b.length;u++){let d=b[u];H.set(new Uint8Array(ArrayBuffer.isView(d)?d.buffer:d),P[5+u])}return H.buffer}n.serializeV1KernelWebsocketJupyterOrg=t;function i(f){let v;return typeof f=="string"?v=JSON.parse(f):v=s(f),v}n.deserializeDefault=i;function r(f){var v;let p;return!((v=f.buffers)===null||v===void 0)&&v.length?p=c(f):p=JSON.stringify(f),p}n.serializeDefault=r;function s(f){let v=new DataView(f),p=v.getUint32(0),h=[];if(p<2)throw new Error("Invalid incoming Kernel Message");for(let C=1;C<=p;C++)h.push(v.getUint32(C*4));let g=new Uint8Array(f.slice(h[0],h[1])),b=JSON.parse(new TextDecoder("utf8").decode(g));b.buffers=[];for(let C=1;C<p;C++){let P=h[C],O=h[C+1]||f.byteLength;b.buffers.push(new DataView(f.slice(P,O)))}return b}function c(f){let v=[],p=[],h=new TextEncoder,g=[];f.buffers!==void 0&&(g=f.buffers,delete f.buffers);let b=h.encode(JSON.stringify(f));p.push(b.buffer);for(let I=0;I<g.length;I++){let N=g[I];p.push(ArrayBuffer.isView(N)?N.buffer:N)}let C=p.length;v.push(4*(C+1));for(let I=0;I+1<p.length;I++)v.push(v[v.length-1]+p[I].byteLength);let P=new Uint8Array(v[v.length-1]+p[p.length-1].byteLength),O=new DataView(P.buffer);O.setUint32(0,C);for(let I=0;I<v.length;I++)O.setUint32(4*(I+1),v[I]);for(let I=0;I<p.length;I++)P.set(new Uint8Array(p[I]),v[I]);return P.buffer}})(Et||(Et={}))});var gt=F((e_,_o)=>{"use strict";_o.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),EMPTY_BUFFER:Buffer.alloc(0),NOOP:()=>{}}});var xo=F((t_,Do)=>{var vo=require("fs"),Ze=require("path"),yo=require("os"),wo=typeof __webpack_require__=="function"?__non_webpack_require__:require,Hc=process.config&&process.config.variables||{},Gc=!!process.env.PREBUILDS_ONLY,go=process.versions.modules,Li=Xc()?"electron":Yc()?"node-webkit":"node",Ni=process.env.npm_config_arch||yo.arch(),Ai=process.env.npm_config_platform||yo.platform(),So=process.env.LIBC||(Zc(Ai)?"musl":"glibc"),Fi=process.env.ARM_VERSION||(Ni==="arm64"?"8":Hc.arm_version)||"",bo=(process.versions.uv||"").split(".")[0];Do.exports=Le;function Le(n){return wo(Le.resolve(n))}Le.resolve=Le.path=function(n){n=Ze.resolve(n||".");try{var e=wo(Ze.join(n,"package.json")).name.toUpperCase().replace(/-/g,"_");process.env[e+"_PREBUILD"]&&(n=process.env[e+"_PREBUILD"])}catch{}if(!Gc){var t=po(Ze.join(n,"build/Release"),mo);if(t)return t;var i=po(Ze.join(n,"build/Debug"),mo);if(i)return i}var r=f(n);if(r)return r;var s=f(Ze.dirname(process.execPath));if(s)return s;var c=["platform="+Ai,"arch="+Ni,"runtime="+Li,"abi="+go,"uv="+bo,Fi?"armv="+Fi:"","libc="+So,"node="+process.versions.node,process.versions.electron?"electron="+process.versions.electron:"",typeof __webpack_require__=="function"?"webpack=true":""].filter(Boolean).join(" ");throw new Error("No native build was found for "+c+`
    loaded from: `+n+`
`);function f(v){var p=Bi(Ze.join(v,"prebuilds")).map(Mo),h=p.filter(Co(Ai,Ni)).sort(Po)[0];if(h){var g=Ze.join(v,"prebuilds",h.name),b=Bi(g).map(Eo),C=b.filter(Oo(Li,go)),P=C.sort(Ro(Li))[0];if(P)return Ze.join(g,P.file)}}};function Bi(n){try{return vo.readdirSync(n)}catch{return[]}}function po(n,e){var t=Bi(n).filter(e);return t[0]&&Ze.join(n,t[0])}function mo(n){return/\.node$/.test(n)}function Mo(n){var e=n.split("-");if(e.length===2){var t=e[0],i=e[1].split("+");if(t&&i.length&&i.every(Boolean))return{name:n,platform:t,architectures:i}}}function Co(n,e){return function(t){return t==null||t.platform!==n?!1:t.architectures.includes(e)}}function Po(n,e){return n.architectures.length-e.architectures.length}function Eo(n){var e=n.split("."),t=e.pop(),i={file:n,specificity:0};if(t==="node"){for(var r=0;r<e.length;r++){var s=e[r];if(s==="node"||s==="electron"||s==="node-webkit")i.runtime=s;else if(s==="napi")i.napi=!0;else if(s.slice(0,3)==="abi")i.abi=s.slice(3);else if(s.slice(0,2)==="uv")i.uv=s.slice(2);else if(s.slice(0,4)==="armv")i.armv=s.slice(4);else if(s==="glibc"||s==="musl")i.libc=s;else continue;i.specificity++}return i}}function Oo(n,e){return function(t){return!(t==null||t.runtime!==n&&!Jc(t)||t.abi!==e&&!t.napi||t.uv&&t.uv!==bo||t.armv&&t.armv!==Fi||t.libc&&t.libc!==So)}}function Jc(n){return n.runtime==="node"&&n.napi}function Ro(n){return function(e,t){return e.runtime!==t.runtime?e.runtime===n?-1:1:e.abi!==t.abi?e.abi?-1:1:e.specificity!==t.specificity?e.specificity>t.specificity?-1:1:0}}function Yc(){return!!(process.versions&&process.versions.nw)}function Xc(){return process.versions&&process.versions.electron||process.env.ELECTRON_RUN_AS_NODE?!0:typeof window<"u"&&window.process&&window.process.type==="renderer"}function Zc(n){return n==="linux"&&vo.existsSync("/etc/alpine-release")}Le.parseTags=Eo;Le.matchTags=Oo;Le.compareTags=Ro;Le.parseTuple=Mo;Le.matchTuple=Co;Le.compareTuples=Po});var Wi=F((n_,Vi)=>{typeof process.addon=="function"?Vi.exports=process.addon.bind(process):Vi.exports=xo()});var qo=F((i_,ko)=>{"use strict";var Qc=(n,e,t,i,r)=>{for(var s=0;s<r;s++)t[i+s]=n[s]^e[s&3]},eu=(n,e)=>{let t=n.length;for(var i=0;i<t;i++)n[i]^=e[i&3]};ko.exports={mask:Qc,unmask:eu}});var jo=F((r_,$i)=>{"use strict";try{$i.exports=Wi()(__dirname)}catch{$i.exports=qo()}});var Lt=F((s_,Ki)=>{"use strict";var{EMPTY_BUFFER:tu}=gt();function To(n,e){if(n.length===0)return tu;if(n.length===1)return n[0];let t=Buffer.allocUnsafe(e),i=0;for(let r=0;r<n.length;r++){let s=n[r];t.set(s,i),i+=s.length}return i<e?t.slice(0,i):t}function Io(n,e,t,i,r){for(let s=0;s<r;s++)t[i+s]=n[s]^e[s&3]}function Uo(n,e){let t=n.length;for(let i=0;i<t;i++)n[i]^=e[i&3]}function Lo(n){return n.byteLength===n.buffer.byteLength?n.buffer:n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength)}function On(n){if(On.readOnly=!0,Buffer.isBuffer(n))return n;let e;return n instanceof ArrayBuffer?e=Buffer.from(n):ArrayBuffer.isView(n)?e=Buffer.from(n.buffer,n.byteOffset,n.byteLength):(e=Buffer.from(n),On.readOnly=!1),e}try{let n=jo(),e=n.BufferUtil||n;Ki.exports={concat:To,mask(t,i,r,s,c){c<48?Io(t,i,r,s,c):e.mask(t,i,r,s,c)},toArrayBuffer:Lo,toBuffer:On,unmask(t,i){t.length<32?Uo(t,i):e.unmask(t,i)}}}catch{Ki.exports={concat:To,mask:Io,toArrayBuffer:Lo,toBuffer:On,unmask:Uo}}});var Fo=F((o_,Ao)=>{"use strict";var No=Symbol("kDone"),zi=Symbol("kRun"),Hi=class{constructor(e){this[No]=()=>{this.pending--,this[zi]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[zi]()}[zi](){if(this.pending!==this.concurrency&&this.jobs.length){let e=this.jobs.shift();this.pending++,e(this[No])}}};Ao.exports=Hi});var Ft=F((l_,$o)=>{"use strict";var Nt=require("zlib"),Bo=Lt(),nu=Fo(),{kStatusCode:Vo,NOOP:iu}=gt(),ru=Buffer.from([0,0,255,255]),xn=Symbol("permessage-deflate"),Qe=Symbol("total-length"),At=Symbol("callback"),st=Symbol("buffers"),Dn=Symbol("error"),Rn,Gi=class{constructor(e,t,i){if(this._maxPayload=i|0,this._options=e||{},this._threshold=this._options.threshold!==void 0?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,!Rn){let r=this._options.concurrencyLimit!==void 0?this._options.concurrencyLimit:10;Rn=new nu(r)}}static get extensionName(){return"permessage-deflate"}offer(){let e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:this._options.clientMaxWindowBits==null&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let e=this._deflate[At];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){let t=this._options,i=e.find(r=>!(t.serverNoContextTakeover===!1&&r.server_no_context_takeover||r.server_max_window_bits&&(t.serverMaxWindowBits===!1||typeof t.serverMaxWindowBits=="number"&&t.serverMaxWindowBits>r.server_max_window_bits)||typeof t.clientMaxWindowBits=="number"&&!r.client_max_window_bits));if(!i)throw new Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(i.server_no_context_takeover=!0),t.clientNoContextTakeover&&(i.client_no_context_takeover=!0),typeof t.serverMaxWindowBits=="number"&&(i.server_max_window_bits=t.serverMaxWindowBits),typeof t.clientMaxWindowBits=="number"?i.client_max_window_bits=t.clientMaxWindowBits:(i.client_max_window_bits===!0||t.clientMaxWindowBits===!1)&&delete i.client_max_window_bits,i}acceptAsClient(e){let t=e[0];if(this._options.clientNoContextTakeover===!1&&t.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(!t.client_max_window_bits)typeof this._options.clientMaxWindowBits=="number"&&(t.client_max_window_bits=this._options.clientMaxWindowBits);else if(this._options.clientMaxWindowBits===!1||typeof this._options.clientMaxWindowBits=="number"&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"');return t}normalizeParams(e){return e.forEach(t=>{Object.keys(t).forEach(i=>{let r=t[i];if(r.length>1)throw new Error(`Parameter "${i}" must have only a single value`);if(r=r[0],i==="client_max_window_bits"){if(r!==!0){let s=+r;if(!Number.isInteger(s)||s<8||s>15)throw new TypeError(`Invalid value for parameter "${i}": ${r}`);r=s}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${i}": ${r}`)}else if(i==="server_max_window_bits"){let s=+r;if(!Number.isInteger(s)||s<8||s>15)throw new TypeError(`Invalid value for parameter "${i}": ${r}`);r=s}else if(i==="client_no_context_takeover"||i==="server_no_context_takeover"){if(r!==!0)throw new TypeError(`Invalid value for parameter "${i}": ${r}`)}else throw new Error(`Unknown parameter "${i}"`);t[i]=r})}),e}decompress(e,t,i){Rn.add(r=>{this._decompress(e,t,(s,c)=>{r(),i(s,c)})})}compress(e,t,i){Rn.add(r=>{this._compress(e,t,(s,c)=>{r(),i(s,c)})})}_decompress(e,t,i){let r=this._isServer?"client":"server";if(!this._inflate){let s=`${r}_max_window_bits`,c=typeof this.params[s]!="number"?Nt.Z_DEFAULT_WINDOWBITS:this.params[s];this._inflate=Nt.createInflateRaw({...this._options.zlibInflateOptions,windowBits:c}),this._inflate[xn]=this,this._inflate[Qe]=0,this._inflate[st]=[],this._inflate.on("error",ou),this._inflate.on("data",Wo)}this._inflate[At]=i,this._inflate.write(e),t&&this._inflate.write(ru),this._inflate.flush(()=>{let s=this._inflate[Dn];if(s){this._inflate.close(),this._inflate=null,i(s);return}let c=Bo.concat(this._inflate[st],this._inflate[Qe]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[Qe]=0,this._inflate[st]=[],t&&this.params[`${r}_no_context_takeover`]&&this._inflate.reset()),i(null,c)})}_compress(e,t,i){let r=this._isServer?"server":"client";if(!this._deflate){let s=`${r}_max_window_bits`,c=typeof this.params[s]!="number"?Nt.Z_DEFAULT_WINDOWBITS:this.params[s];this._deflate=Nt.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:c}),this._deflate[Qe]=0,this._deflate[st]=[],this._deflate.on("error",iu),this._deflate.on("data",su)}this._deflate[At]=i,this._deflate.write(e),this._deflate.flush(Nt.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let s=Bo.concat(this._deflate[st],this._deflate[Qe]);t&&(s=s.slice(0,s.length-4)),this._deflate[At]=null,this._deflate[Qe]=0,this._deflate[st]=[],t&&this.params[`${r}_no_context_takeover`]&&this._deflate.reset(),i(null,s)})}};$o.exports=Gi;function su(n){this[st].push(n),this[Qe]+=n.length}function Wo(n){if(this[Qe]+=n.length,this[xn]._maxPayload<1||this[Qe]<=this[xn]._maxPayload){this[st].push(n);return}this[Dn]=new RangeError("Max payload size exceeded"),this[Dn].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[Dn][Vo]=1009,this.removeListener("data",Wo),this.reset()}function ou(n){this[xn]._inflate=null,n[Vo]=1007,this[At](n)}});var zo=F((a_,Ko)=>{"use strict";function lu(n){let e=n.length,t=0;for(;t<e;)if(!(n[t]&128))t++;else if((n[t]&224)===192){if(t+1===e||(n[t+1]&192)!==128||(n[t]&254)===192)return!1;t+=2}else if((n[t]&240)===224){if(t+2>=e||(n[t+1]&192)!==128||(n[t+2]&192)!==128||n[t]===224&&(n[t+1]&224)===128||n[t]===237&&(n[t+1]&224)===160)return!1;t+=3}else if((n[t]&248)===240){if(t+3>=e||(n[t+1]&192)!==128||(n[t+2]&192)!==128||(n[t+3]&192)!==128||n[t]===240&&(n[t+1]&240)===128||n[t]===244&&n[t+1]>143||n[t]>244)return!1;t+=4}else return!1;return!0}Ko.exports=lu});var Ho=F((c_,Ji)=>{"use strict";try{Ji.exports=Wi()(__dirname)}catch{Ji.exports=zo()}});var Xi=F((u_,Yi)=>{"use strict";function Go(n){return n>=1e3&&n<=1014&&n!==1004&&n!==1005&&n!==1006||n>=3e3&&n<=4999}function Jo(n){let e=n.length,t=0;for(;t<e;)if(!(n[t]&128))t++;else if((n[t]&224)===192){if(t+1===e||(n[t+1]&192)!==128||(n[t]&254)===192)return!1;t+=2}else if((n[t]&240)===224){if(t+2>=e||(n[t+1]&192)!==128||(n[t+2]&192)!==128||n[t]===224&&(n[t+1]&224)===128||n[t]===237&&(n[t+1]&224)===160)return!1;t+=3}else if((n[t]&248)===240){if(t+3>=e||(n[t+1]&192)!==128||(n[t+2]&192)!==128||(n[t+3]&192)!==128||n[t]===240&&(n[t+1]&240)===128||n[t]===244&&n[t+1]>143||n[t]>244)return!1;t+=4}else return!1;return!0}try{let n=Ho();typeof n=="object"&&(n=n.Validation.isValidUTF8),Yi.exports={isValidStatusCode:Go,isValidUTF8(e){return e.length<150?Jo(e):n(e)}}}catch{Yi.exports={isValidStatusCode:Go,isValidUTF8:Jo}}});var tr=F((f_,tl)=>{"use strict";var{Writable:au}=require("stream"),Yo=Ft(),{BINARY_TYPES:cu,EMPTY_BUFFER:uu,kStatusCode:fu,kWebSocket:hu}=gt(),{concat:Zi,toArrayBuffer:du,unmask:_u}=Lt(),{isValidStatusCode:gu,isValidUTF8:Xo}=Xi(),Bt=0,Zo=1,Qo=2,el=3,Qi=4,pu=5,er=class extends au{constructor(e,t,i,r){super(),this._binaryType=e||cu[0],this[hu]=void 0,this._extensions=t||{},this._isServer=!!i,this._maxPayload=r|0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._state=Bt,this._loop=!1}_write(e,t,i){if(this._opcode===8&&this._state==Bt)return i();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(i)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){let i=this._buffers[0];return this._buffers[0]=i.slice(e),i.slice(0,e)}let t=Buffer.allocUnsafe(e);do{let i=this._buffers[0],r=t.length-e;e>=i.length?t.set(this._buffers.shift(),r):(t.set(new Uint8Array(i.buffer,i.byteOffset,e),r),this._buffers[0]=i.slice(e)),e-=i.length}while(e>0);return t}startLoop(e){let t;this._loop=!0;do switch(this._state){case Bt:t=this.getInfo();break;case Zo:t=this.getPayloadLength16();break;case Qo:t=this.getPayloadLength64();break;case el:this.getMask();break;case Qi:t=this.getData(e);break;default:this._loop=!1;return}while(this._loop);e(t)}getInfo(){if(this._bufferedBytes<2){this._loop=!1;return}let e=this.consume(2);if(e[0]&48)return this._loop=!1,re(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");let t=(e[0]&64)===64;if(t&&!this._extensions[Yo.extensionName])return this._loop=!1,re(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._fin=(e[0]&128)===128,this._opcode=e[0]&15,this._payloadLength=e[1]&127,this._opcode===0){if(t)return this._loop=!1,re(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(!this._fragmented)return this._loop=!1,re(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");this._opcode=this._fragmented}else if(this._opcode===1||this._opcode===2){if(this._fragmented)return this._loop=!1,re(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");this._compressed=t}else if(this._opcode>7&&this._opcode<11){if(!this._fin)return this._loop=!1,re(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");if(t)return this._loop=!1,re(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._payloadLength>125)return this._loop=!1,re(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH")}else return this._loop=!1,re(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");if(!this._fin&&!this._fragmented&&(this._fragmented=this._opcode),this._masked=(e[1]&128)===128,this._isServer){if(!this._masked)return this._loop=!1,re(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK")}else if(this._masked)return this._loop=!1,re(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");if(this._payloadLength===126)this._state=Zo;else if(this._payloadLength===127)this._state=Qo;else return this.haveLength()}getPayloadLength16(){if(this._bufferedBytes<2){this._loop=!1;return}return this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength()}getPayloadLength64(){if(this._bufferedBytes<8){this._loop=!1;return}let e=this.consume(8),t=e.readUInt32BE(0);return t>Math.pow(2,53-32)-1?(this._loop=!1,re(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=t*Math.pow(2,32)+e.readUInt32BE(4),this.haveLength())}haveLength(){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return this._loop=!1,re(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");this._masked?this._state=el:this._state=Qi}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=Qi}getData(e){let t=uu;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}t=this.consume(this._payloadLength),this._masked&&_u(t,this._mask)}if(this._opcode>7)return this.controlMessage(t);if(this._compressed){this._state=pu,this.decompress(t,e);return}return t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage()}decompress(e,t){this._extensions[Yo.extensionName].decompress(e,this._fin,(r,s)=>{if(r)return t(r);if(s.length){if(this._messageLength+=s.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return t(re(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(s)}let c=this.dataMessage();if(c)return t(c);this.startLoop(t)})}dataMessage(){if(this._fin){let e=this._messageLength,t=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],this._opcode===2){let i;this._binaryType==="nodebuffer"?i=Zi(t,e):this._binaryType==="arraybuffer"?i=du(Zi(t,e)):i=t,this.emit("message",i)}else{let i=Zi(t,e);if(!Xo(i))return this._loop=!1,re(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("message",i.toString())}}this._state=Bt}controlMessage(e){if(this._opcode===8)if(this._loop=!1,e.length===0)this.emit("conclude",1005,""),this.end();else{if(e.length===1)return re(RangeError,"invalid payload length 1",!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH");{let t=e.readUInt16BE(0);if(!gu(t))return re(RangeError,`invalid status code ${t}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");let i=e.slice(2);if(!Xo(i))return re(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("conclude",t,i.toString()),this.end()}}else this._opcode===9?this.emit("ping",e):this.emit("pong",e);this._state=Bt}};tl.exports=er;function re(n,e,t,i,r){let s=new n(t?`Invalid WebSocket frame: ${e}`:e);return Error.captureStackTrace(s,re),s.code=r,s[fu]=i,s}});var ir=F((__,rl)=>{"use strict";var h_=require("net"),d_=require("tls"),{randomFillSync:mu}=require("crypto"),nl=Ft(),{EMPTY_BUFFER:vu}=gt(),{isValidStatusCode:yu}=Xi(),{mask:il,toBuffer:et}=Lt(),pt=Buffer.alloc(4),nr=class n{constructor(e,t){this._extensions=t||{},this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(e,t){let i=t.mask&&t.readOnly,r=t.mask?6:2,s=e.length;e.length>=65536?(r+=8,s=127):e.length>125&&(r+=2,s=126);let c=Buffer.allocUnsafe(i?e.length+r:r);return c[0]=t.fin?t.opcode|128:t.opcode,t.rsv1&&(c[0]|=64),c[1]=s,s===126?c.writeUInt16BE(e.length,2):s===127&&(c.writeUInt32BE(0,2),c.writeUInt32BE(e.length,6)),t.mask?(mu(pt,0,4),c[1]|=128,c[r-4]=pt[0],c[r-3]=pt[1],c[r-2]=pt[2],c[r-1]=pt[3],i?(il(e,pt,c,r,e.length),[c]):(il(e,pt,e,0,e.length),[c,e])):[c,e]}close(e,t,i,r){let s;if(e===void 0)s=vu;else{if(typeof e!="number"||!yu(e))throw new TypeError("First argument must be a valid error code number");if(t===void 0||t==="")s=Buffer.allocUnsafe(2),s.writeUInt16BE(e,0);else{let c=Buffer.byteLength(t);if(c>123)throw new RangeError("The message must not be greater than 123 bytes");s=Buffer.allocUnsafe(2+c),s.writeUInt16BE(e,0),s.write(t,2)}}this._deflating?this.enqueue([this.doClose,s,i,r]):this.doClose(s,i,r)}doClose(e,t,i){this.sendFrame(n.frame(e,{fin:!0,rsv1:!1,opcode:8,mask:t,readOnly:!1}),i)}ping(e,t,i){let r=et(e);if(r.length>125)throw new RangeError("The data size must not be greater than 125 bytes");this._deflating?this.enqueue([this.doPing,r,t,et.readOnly,i]):this.doPing(r,t,et.readOnly,i)}doPing(e,t,i,r){this.sendFrame(n.frame(e,{fin:!0,rsv1:!1,opcode:9,mask:t,readOnly:i}),r)}pong(e,t,i){let r=et(e);if(r.length>125)throw new RangeError("The data size must not be greater than 125 bytes");this._deflating?this.enqueue([this.doPong,r,t,et.readOnly,i]):this.doPong(r,t,et.readOnly,i)}doPong(e,t,i,r){this.sendFrame(n.frame(e,{fin:!0,rsv1:!1,opcode:10,mask:t,readOnly:i}),r)}send(e,t,i){let r=et(e),s=this._extensions[nl.extensionName],c=t.binary?2:1,f=t.compress;if(this._firstFragment?(this._firstFragment=!1,f&&s&&(f=r.length>=s._threshold),this._compress=f):(f=!1,c=0),t.fin&&(this._firstFragment=!0),s){let v={fin:t.fin,rsv1:f,opcode:c,mask:t.mask,readOnly:et.readOnly};this._deflating?this.enqueue([this.dispatch,r,this._compress,v,i]):this.dispatch(r,this._compress,v,i)}else this.sendFrame(n.frame(r,{fin:t.fin,rsv1:!1,opcode:c,mask:t.mask,readOnly:et.readOnly}),i)}dispatch(e,t,i,r){if(!t){this.sendFrame(n.frame(e,i),r);return}let s=this._extensions[nl.extensionName];this._bufferedBytes+=e.length,this._deflating=!0,s.compress(e,i.fin,(c,f)=>{if(this._socket.destroyed){let v=new Error("The socket was closed while data was being compressed");typeof r=="function"&&r(v);for(let p=0;p<this._queue.length;p++){let h=this._queue[p][4];typeof h=="function"&&h(v)}return}this._bufferedBytes-=e.length,this._deflating=!1,i.readOnly=!1,this.sendFrame(n.frame(f,i),r),this.dequeue()})}dequeue(){for(;!this._deflating&&this._queue.length;){let e=this._queue.shift();this._bufferedBytes-=e[1].length,Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[1].length,this._queue.push(e)}sendFrame(e,t){e.length===2?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}};rl.exports=nr});var ol=F((g_,sl)=>{"use strict";var Ot=class{constructor(e,t){this.target=t,this.type=e}},rr=class extends Ot{constructor(e,t){super("message",t),this.data=e}},sr=class extends Ot{constructor(e,t,i){super("close",i),this.wasClean=i._closeFrameReceived&&i._closeFrameSent,this.reason=t,this.code=e}},or=class extends Ot{constructor(e){super("open",e)}},lr=class extends Ot{constructor(e,t){super("error",t),this.message=e.message,this.error=e}},wu={addEventListener(n,e,t){if(typeof e!="function")return;function i(v){e.call(this,new rr(v,this))}function r(v,p){e.call(this,new sr(v,p,this))}function s(v){e.call(this,new lr(v,this))}function c(){e.call(this,new or(this))}let f=t&&t.once?"once":"on";n==="message"?(i._listener=e,this[f](n,i)):n==="close"?(r._listener=e,this[f](n,r)):n==="error"?(s._listener=e,this[f](n,s)):n==="open"?(c._listener=e,this[f](n,c)):this[f](n,e)},removeEventListener(n,e){let t=this.listeners(n);for(let i=0;i<t.length;i++)(t[i]===e||t[i]._listener===e)&&this.removeListener(n,t[i])}};sl.exports=wu});var ar=F((p_,ll)=>{"use strict";var Vt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function Ne(n,e,t){n[e]===void 0?n[e]=[t]:n[e].push(t)}function Su(n){let e=Object.create(null);if(n===void 0||n==="")return e;let t=Object.create(null),i=!1,r=!1,s=!1,c,f,v=-1,p=-1,h=0;for(;h<n.length;h++){let b=n.charCodeAt(h);if(c===void 0)if(p===-1&&Vt[b]===1)v===-1&&(v=h);else if(b===32||b===9)p===-1&&v!==-1&&(p=h);else if(b===59||b===44){if(v===-1)throw new SyntaxError(`Unexpected character at index ${h}`);p===-1&&(p=h);let C=n.slice(v,p);b===44?(Ne(e,C,t),t=Object.create(null)):c=C,v=p=-1}else throw new SyntaxError(`Unexpected character at index ${h}`);else if(f===void 0)if(p===-1&&Vt[b]===1)v===-1&&(v=h);else if(b===32||b===9)p===-1&&v!==-1&&(p=h);else if(b===59||b===44){if(v===-1)throw new SyntaxError(`Unexpected character at index ${h}`);p===-1&&(p=h),Ne(t,n.slice(v,p),!0),b===44&&(Ne(e,c,t),t=Object.create(null),c=void 0),v=p=-1}else if(b===61&&v!==-1&&p===-1)f=n.slice(v,h),v=p=-1;else throw new SyntaxError(`Unexpected character at index ${h}`);else if(r){if(Vt[b]!==1)throw new SyntaxError(`Unexpected character at index ${h}`);v===-1?v=h:i||(i=!0),r=!1}else if(s)if(Vt[b]===1)v===-1&&(v=h);else if(b===34&&v!==-1)s=!1,p=h;else if(b===92)r=!0;else throw new SyntaxError(`Unexpected character at index ${h}`);else if(b===34&&n.charCodeAt(h-1)===61)s=!0;else if(p===-1&&Vt[b]===1)v===-1&&(v=h);else if(v!==-1&&(b===32||b===9))p===-1&&(p=h);else if(b===59||b===44){if(v===-1)throw new SyntaxError(`Unexpected character at index ${h}`);p===-1&&(p=h);let C=n.slice(v,p);i&&(C=C.replace(/\\/g,""),i=!1),Ne(t,f,C),b===44&&(Ne(e,c,t),t=Object.create(null),c=void 0),f=void 0,v=p=-1}else throw new SyntaxError(`Unexpected character at index ${h}`)}if(v===-1||s)throw new SyntaxError("Unexpected end of input");p===-1&&(p=h);let g=n.slice(v,p);return c===void 0?Ne(e,g,t):(f===void 0?Ne(t,g,!0):i?Ne(t,f,g.replace(/\\/g,"")):Ne(t,f,g),Ne(e,c,t)),e}function bu(n){return Object.keys(n).map(e=>{let t=n[e];return Array.isArray(t)||(t=[t]),t.map(i=>[e].concat(Object.keys(i).map(r=>{let s=i[r];return Array.isArray(s)||(s=[s]),s.map(c=>c===!0?r:`${r}=${c}`).join("; ")})).join("; ")).join(", ")}).join(", ")}ll.exports={format:bu,parse:Su}});var _r=F((v_,ml)=>{"use strict";var Mu=require("events"),Cu=require("https"),Pu=require("http"),ul=require("net"),Eu=require("tls"),{randomBytes:Ou,createHash:Ru}=require("crypto"),{Readable:m_}=require("stream"),{URL:cr}=require("url"),ot=Ft(),Du=tr(),xu=ir(),{BINARY_TYPES:al,EMPTY_BUFFER:ur,GUID:ku,kStatusCode:qu,kWebSocket:fe,NOOP:fl}=gt(),{addEventListener:ju,removeEventListener:Tu}=ol(),{format:Iu,parse:Uu}=ar(),{toBuffer:Lu}=Lt(),tt=["CONNECTING","OPEN","CLOSING","CLOSED"],fr=[8,13],Nu=30*1e3,ne=class n extends Mu{constructor(e,t,i){super(),this._binaryType=al[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage="",this._closeTimer=null,this._extensions={},this._protocol="",this._readyState=n.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,e!==null?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,Array.isArray(t)?t=t.join(", "):typeof t=="object"&&t!==null&&(i=t,t=void 0),hl(this,e,t,i)):this._isServer=!0}get binaryType(){return this._binaryType}set binaryType(e){al.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get onclose(){}set onclose(e){}get onerror(){}set onerror(e){}get onopen(){}set onopen(e){}get onmessage(){}set onmessage(e){}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,t,i){let r=new Du(this.binaryType,this._extensions,this._isServer,i);this._sender=new xu(e,this._extensions),this._receiver=r,this._socket=e,r[fe]=this,e[fe]=this,r.on("conclude",Bu),r.on("drain",Vu),r.on("error",Wu),r.on("message",$u),r.on("ping",Ku),r.on("pong",zu),e.setTimeout(0),e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",_l),e.on("data",kn),e.on("end",gl),e.on("error",pl),this._readyState=n.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=n.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[ot.extensionName]&&this._extensions[ot.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=n.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==n.CLOSED){if(this.readyState===n.CONNECTING){let i="WebSocket was closed before the connection was established";return Re(this,this._req,i)}if(this.readyState===n.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=n.CLOSING,this._sender.close(e,t,!this._isServer,i=>{i||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),Nu)}}ping(e,t,i){if(this.readyState===n.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof e=="function"?(i=e,e=t=void 0):typeof t=="function"&&(i=t,t=void 0),typeof e=="number"&&(e=e.toString()),this.readyState!==n.OPEN){dr(this,e,i);return}t===void 0&&(t=!this._isServer),this._sender.ping(e||ur,t,i)}pong(e,t,i){if(this.readyState===n.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof e=="function"?(i=e,e=t=void 0):typeof t=="function"&&(i=t,t=void 0),typeof e=="number"&&(e=e.toString()),this.readyState!==n.OPEN){dr(this,e,i);return}t===void 0&&(t=!this._isServer),this._sender.pong(e||ur,t,i)}send(e,t,i){if(this.readyState===n.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof t=="function"&&(i=t,t={}),typeof e=="number"&&(e=e.toString()),this.readyState!==n.OPEN){dr(this,e,i);return}let r={binary:typeof e!="string",mask:!this._isServer,compress:!0,fin:!0,...t};this._extensions[ot.extensionName]||(r.compress=!1),this._sender.send(e||ur,r,i)}terminate(){if(this.readyState!==n.CLOSED){if(this.readyState===n.CONNECTING){let e="WebSocket was closed before the connection was established";return Re(this,this._req,e)}this._socket&&(this._readyState=n.CLOSING,this._socket.destroy())}}};Object.defineProperty(ne,"CONNECTING",{enumerable:!0,value:tt.indexOf("CONNECTING")});Object.defineProperty(ne.prototype,"CONNECTING",{enumerable:!0,value:tt.indexOf("CONNECTING")});Object.defineProperty(ne,"OPEN",{enumerable:!0,value:tt.indexOf("OPEN")});Object.defineProperty(ne.prototype,"OPEN",{enumerable:!0,value:tt.indexOf("OPEN")});Object.defineProperty(ne,"CLOSING",{enumerable:!0,value:tt.indexOf("CLOSING")});Object.defineProperty(ne.prototype,"CLOSING",{enumerable:!0,value:tt.indexOf("CLOSING")});Object.defineProperty(ne,"CLOSED",{enumerable:!0,value:tt.indexOf("CLOSED")});Object.defineProperty(ne.prototype,"CLOSED",{enumerable:!0,value:tt.indexOf("CLOSED")});["binaryType","bufferedAmount","extensions","protocol","readyState","url"].forEach(n=>{Object.defineProperty(ne.prototype,n,{enumerable:!0})});["open","error","close","message"].forEach(n=>{Object.defineProperty(ne.prototype,`on${n}`,{enumerable:!0,get(){let e=this.listeners(n);for(let t=0;t<e.length;t++)if(e[t]._listener)return e[t]._listener},set(e){let t=this.listeners(n);for(let i=0;i<t.length;i++)t[i]._listener&&this.removeListener(n,t[i]);this.addEventListener(n,e)}})});ne.prototype.addEventListener=ju;ne.prototype.removeEventListener=Tu;ml.exports=ne;function hl(n,e,t,i){let r={protocolVersion:fr[1],maxPayload:104857600,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...i,createConnection:void 0,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:void 0,host:void 0,path:void 0,port:void 0};if(!fr.includes(r.protocolVersion))throw new RangeError(`Unsupported protocol version: ${r.protocolVersion} (supported versions: ${fr.join(", ")})`);let s;e instanceof cr?(s=e,n._url=e.href):(s=new cr(e),n._url=e);let c=s.protocol==="ws+unix:";if(!s.host&&(!c||!s.pathname)){let C=new Error(`Invalid URL: ${n.url}`);if(n._redirects===0)throw C;hr(n,C);return}let f=s.protocol==="wss:"||s.protocol==="https:",v=f?443:80,p=Ou(16).toString("base64"),h=f?Cu.get:Pu.get,g;if(r.createConnection=f?Fu:Au,r.defaultPort=r.defaultPort||v,r.port=s.port||v,r.host=s.hostname.startsWith("[")?s.hostname.slice(1,-1):s.hostname,r.headers={"Sec-WebSocket-Version":r.protocolVersion,"Sec-WebSocket-Key":p,Connection:"Upgrade",Upgrade:"websocket",...r.headers},r.path=s.pathname+s.search,r.timeout=r.handshakeTimeout,r.perMessageDeflate&&(g=new ot(r.perMessageDeflate!==!0?r.perMessageDeflate:{},!1,r.maxPayload),r.headers["Sec-WebSocket-Extensions"]=Iu({[ot.extensionName]:g.offer()})),t&&(r.headers["Sec-WebSocket-Protocol"]=t),r.origin&&(r.protocolVersion<13?r.headers["Sec-WebSocket-Origin"]=r.origin:r.headers.Origin=r.origin),(s.username||s.password)&&(r.auth=`${s.username}:${s.password}`),c){let C=r.path.split(":");r.socketPath=C[0],r.path=C[1]}if(r.followRedirects){if(n._redirects===0){n._originalUnixSocket=c,n._originalSecure=f,n._originalHostOrSocketPath=c?r.socketPath:s.host;let C=i&&i.headers;if(i={...i,headers:{}},C)for(let[P,O]of Object.entries(C))i.headers[P.toLowerCase()]=O}else{let C=c?n._originalUnixSocket?r.socketPath===n._originalHostOrSocketPath:!1:n._originalUnixSocket?!1:s.host===n._originalHostOrSocketPath;(!C||n._originalSecure&&!f)&&(delete r.headers.authorization,delete r.headers.cookie,C||delete r.headers.host,r.auth=void 0)}r.auth&&!i.headers.authorization&&(i.headers.authorization="Basic "+Buffer.from(r.auth).toString("base64"))}let b=n._req=h(r);r.timeout&&b.on("timeout",()=>{Re(n,b,"Opening handshake has timed out")}),b.on("error",C=>{b===null||b.aborted||(b=n._req=null,hr(n,C))}),b.on("response",C=>{let P=C.headers.location,O=C.statusCode;if(P&&r.followRedirects&&O>=300&&O<400){if(++n._redirects>r.maxRedirects){Re(n,b,"Maximum redirects exceeded");return}b.abort();let I;try{I=new cr(P,e)}catch(N){hr(n,N);return}hl(n,I,t,i)}else n.emit("unexpected-response",b,C)||Re(n,b,`Unexpected server response: ${C.statusCode}`)}),b.on("upgrade",(C,P,O)=>{if(n.emit("upgrade",C),n.readyState!==ne.CONNECTING)return;b=n._req=null;let I=C.headers.upgrade;if(I===void 0||I.toLowerCase()!=="websocket"){Re(n,P,"Invalid Upgrade header");return}let N=Ru("sha1").update(p+ku).digest("base64");if(C.headers["sec-websocket-accept"]!==N){Re(n,P,"Invalid Sec-WebSocket-Accept header");return}let V=C.headers["sec-websocket-protocol"],$=(t||"").split(/, */),j;if(!t&&V?j="Server sent a subprotocol but none was requested":t&&!V?j="Server sent no subprotocol":V&&!$.includes(V)&&(j="Server sent an invalid subprotocol"),j){Re(n,P,j);return}V&&(n._protocol=V);let J=C.headers["sec-websocket-extensions"];if(J!==void 0){if(!g){Re(n,P,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");return}let X;try{X=Uu(J)}catch{Re(n,P,"Invalid Sec-WebSocket-Extensions header");return}let H=Object.keys(X);if(H.length){if(H.length!==1||H[0]!==ot.extensionName){Re(n,P,"Server indicated an extension that was not requested");return}try{g.accept(X[ot.extensionName])}catch{Re(n,P,"Invalid Sec-WebSocket-Extensions header");return}n._extensions[ot.extensionName]=g}}n.setSocket(P,O,r.maxPayload)})}function hr(n,e){n._readyState=ne.CLOSING,n.emit("error",e),n.emitClose()}function Au(n){return n.path=n.socketPath,ul.connect(n)}function Fu(n){return n.path=void 0,!n.servername&&n.servername!==""&&(n.servername=ul.isIP(n.host)?"":n.host),Eu.connect(n)}function Re(n,e,t){n._readyState=ne.CLOSING;let i=new Error(t);Error.captureStackTrace(i,Re),e.setHeader?(e.abort(),e.socket&&!e.socket.destroyed&&e.socket.destroy(),e.once("abort",n.emitClose.bind(n)),n.emit("error",i)):(e.destroy(i),e.once("error",n.emit.bind(n,"error")),e.once("close",n.emitClose.bind(n)))}function dr(n,e,t){if(e){let i=Lu(e).length;n._socket?n._sender._bufferedBytes+=i:n._bufferedAmount+=i}if(t){let i=new Error(`WebSocket is not open: readyState ${n.readyState} (${tt[n.readyState]})`);t(i)}}function Bu(n,e){let t=this[fe];t._closeFrameReceived=!0,t._closeMessage=e,t._closeCode=n,t._socket[fe]!==void 0&&(t._socket.removeListener("data",kn),process.nextTick(dl,t._socket),n===1005?t.close():t.close(n,e))}function Vu(){this[fe]._socket.resume()}function Wu(n){let e=this[fe];e._socket[fe]!==void 0&&(e._socket.removeListener("data",kn),process.nextTick(dl,e._socket),e.close(n[qu])),e.emit("error",n)}function cl(){this[fe].emitClose()}function $u(n){this[fe].emit("message",n)}function Ku(n){let e=this[fe];e.pong(n,!e._isServer,fl),e.emit("ping",n)}function zu(n){this[fe].emit("pong",n)}function dl(n){n.resume()}function _l(){let n=this[fe];this.removeListener("close",_l),this.removeListener("data",kn),this.removeListener("end",gl),n._readyState=ne.CLOSING;let e;!this._readableState.endEmitted&&!n._closeFrameReceived&&!n._receiver._writableState.errorEmitted&&(e=n._socket.read())!==null&&n._receiver.write(e),n._receiver.end(),this[fe]=void 0,clearTimeout(n._closeTimer),n._receiver._writableState.finished||n._receiver._writableState.errorEmitted?n.emitClose():(n._receiver.on("error",cl),n._receiver.on("finish",cl))}function kn(n){this[fe]._receiver.write(n)||this.pause()}function gl(){let n=this[fe];n._readyState=ne.CLOSING,n._receiver.end(),this.end()}function pl(){let n=this[fe];this.removeListener("error",pl),this.on("error",fl),n&&(n._readyState=ne.CLOSING,this.destroy())}});var Sl=F((y_,wl)=>{"use strict";var{Duplex:Hu}=require("stream");function vl(n){n.emit("close")}function Gu(){!this.destroyed&&this._writableState.finished&&this.destroy()}function yl(n){this.removeListener("error",yl),this.destroy(),this.listenerCount("error")===0&&this.emit("error",n)}function Ju(n,e){let t=!0,i=!0;function r(){t&&n._socket.resume()}n.readyState===n.CONNECTING?n.once("open",function(){n._receiver.removeAllListeners("drain"),n._receiver.on("drain",r)}):(n._receiver.removeAllListeners("drain"),n._receiver.on("drain",r));let s=new Hu({...e,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return n.on("message",function(f){s.push(f)||(t=!1,n._socket.pause())}),n.once("error",function(f){s.destroyed||(i=!1,s.destroy(f))}),n.once("close",function(){s.destroyed||s.push(null)}),s._destroy=function(c,f){if(n.readyState===n.CLOSED){f(c),process.nextTick(vl,s);return}let v=!1;n.once("error",function(h){v=!0,f(h)}),n.once("close",function(){v||f(c),process.nextTick(vl,s)}),i&&n.terminate()},s._final=function(c){if(n.readyState===n.CONNECTING){n.once("open",function(){s._final(c)});return}n._socket!==null&&(n._socket._writableState.finished?(c(),s._readableState.endEmitted&&s.destroy()):(n._socket.once("finish",function(){c()}),n.close()))},s._read=function(){(n.readyState===n.OPEN||n.readyState===n.CLOSING)&&!t&&(t=!0,n._receiver._writableState.needDrain||n._socket.resume())},s._write=function(c,f,v){if(n.readyState===n.CONNECTING){n.once("open",function(){s._write(c,f,v)});return}n.send(c,v)},s.on("end",Gu),s.on("error",yl),s}wl.exports=Ju});var El=F((M_,Pl)=>{"use strict";var Yu=require("events"),qn=require("http"),w_=require("https"),S_=require("net"),b_=require("tls"),{createHash:Xu}=require("crypto"),mt=Ft(),Zu=_r(),{format:Qu,parse:ef}=ar(),{GUID:tf,kWebSocket:nf}=gt(),rf=/^[+/0-9A-Za-z]{22}==$/,bl=0,Ml=1,Cl=2,pr=class extends Yu{constructor(e,t){if(super(),e={maxPayload:100*1024*1024,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,...e},e.port==null&&!e.server&&!e.noServer||e.port!=null&&(e.server||e.noServer)||e.server&&e.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(e.port!=null?(this._server=qn.createServer((i,r)=>{let s=qn.STATUS_CODES[426];r.writeHead(426,{"Content-Length":s.length,"Content-Type":"text/plain"}),r.end(s)}),this._server.listen(e.port,e.host,e.backlog,t)):e.server&&(this._server=e.server),this._server){let i=this.emit.bind(this,"connection");this._removeListeners=sf(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(r,s,c)=>{this.handleUpgrade(r,s,c,i)}})}e.perMessageDeflate===!0&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set),this.options=e,this._state=bl}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(e&&this.once("close",e),this._state===Cl){process.nextTick(gr,this);return}if(this._state===Ml)return;if(this._state=Ml,this.clients)for(let i of this.clients)i.terminate();let t=this._server;if(t&&(this._removeListeners(),this._removeListeners=this._server=null,this.options.port!=null)){t.close(gr.bind(void 0,this));return}process.nextTick(gr,this)}shouldHandle(e){if(this.options.path){let t=e.url.indexOf("?");if((t!==-1?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,t,i,r){t.on("error",mr);let s=e.headers["sec-websocket-key"]!==void 0?e.headers["sec-websocket-key"].trim():!1,c=e.headers.upgrade,f=+e.headers["sec-websocket-version"],v={};if(e.method!=="GET"||c===void 0||c.toLowerCase()!=="websocket"||!s||!rf.test(s)||f!==8&&f!==13||!this.shouldHandle(e))return Wt(t,400);if(this.options.perMessageDeflate){let p=new mt(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let h=ef(e.headers["sec-websocket-extensions"]);h[mt.extensionName]&&(p.accept(h[mt.extensionName]),v[mt.extensionName]=p)}catch{return Wt(t,400)}}if(this.options.verifyClient){let p={origin:e.headers[`${f===8?"sec-websocket-origin":"origin"}`],secure:!!(e.socket.authorized||e.socket.encrypted),req:e};if(this.options.verifyClient.length===2){this.options.verifyClient(p,(h,g,b,C)=>{if(!h)return Wt(t,g||401,b,C);this.completeUpgrade(s,v,e,t,i,r)});return}if(!this.options.verifyClient(p))return Wt(t,401)}this.completeUpgrade(s,v,e,t,i,r)}completeUpgrade(e,t,i,r,s,c){if(!r.readable||!r.writable)return r.destroy();if(r[nf])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>bl)return Wt(r,503);let v=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${Xu("sha1").update(e+tf).digest("base64")}`],p=new Zu(null),h=i.headers["sec-websocket-protocol"];if(h&&(h=h.split(",").map(of),this.options.handleProtocols?h=this.options.handleProtocols(h,i):h=h[0],h&&(v.push(`Sec-WebSocket-Protocol: ${h}`),p._protocol=h)),t[mt.extensionName]){let g=t[mt.extensionName].params,b=Qu({[mt.extensionName]:[g]});v.push(`Sec-WebSocket-Extensions: ${b}`),p._extensions=t}this.emit("headers",v,i),r.write(v.concat(`\r
`).join(`\r
`)),r.removeListener("error",mr),p.setSocket(r,s,this.options.maxPayload),this.clients&&(this.clients.add(p),p.on("close",()=>this.clients.delete(p))),c(p,i)}};Pl.exports=pr;function sf(n,e){for(let t of Object.keys(e))n.on(t,e[t]);return function(){for(let i of Object.keys(e))n.removeListener(i,e[i])}}function gr(n){n._state=Cl,n.emit("close")}function mr(){this.destroy()}function Wt(n,e,t,i){n.writable&&(t=t||qn.STATUS_CODES[e],i={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(t),...i},n.write(`HTTP/1.1 ${e} ${qn.STATUS_CODES[e]}\r
`+Object.keys(i).map(r=>`${r}: ${i[r]}`).join(`\r
`)+`\r
\r
`+t)),n.removeListener("error",mr),n.destroy()}function of(n){return n.trim()}});var Rl=F((C_,Ol)=>{"use strict";var $t=_r();$t.createWebSocketStream=Sl();$t.Server=El();$t.Receiver=tr();$t.Sender=ir();Ol.exports=$t});var ge=F(Tn=>{"use strict";Object.defineProperty(Tn,"__esModule",{value:!0});Tn.ServerConnection=void 0;var lt=ue(),Dl=ho(),vr;typeof window>"u"?vr=Rl():vr=WebSocket;var yr;(function(n){function e(s){return jn.makeSettings(s)}n.makeSettings=e;function t(s,c,f){return jn.handleRequest(s,c,f)}n.makeRequest=t;class i extends Error{static async create(c){try{let f=await c.json(),{message:v,traceback:p}=f;return p&&console.error(p),new i(c,v??i._defaultMessage(c),p??"")}catch(f){return console.debug(f),new i(c)}}constructor(c,f=i._defaultMessage(c),v=""){super(f),this.response=c,this.traceback=v}static _defaultMessage(c){return`Invalid response: ${c.status} ${c.statusText}`}}n.ResponseError=i;class r extends TypeError{constructor(c){super(c.message),this.stack=c.stack}}n.NetworkError=r})(yr||(Tn.ServerConnection=yr={}));var jn;(function(n){function e(r={}){var s;let c=lt.PageConfig.getBaseUrl(),f=lt.PageConfig.getWsUrl(),v=lt.URLExt.normalize(r.baseUrl)||c,p=r.wsUrl;!p&&v===c&&(p=f),!p&&v.indexOf("http")===0&&(p="ws"+v.slice(4)),p=p??f;let h=lt.PageConfig.getOption("appendToken").toLowerCase(),g;return h===""?g=typeof window>"u"||typeof process<"u"&&((s=process==null?void 0:process.env)===null||s===void 0?void 0:s.JEST_WORKER_ID)!==void 0||lt.URLExt.getHostName(c)!==lt.URLExt.getHostName(p):g=h==="true",{init:{cache:"no-store",credentials:"same-origin"},fetch,Headers,Request,WebSocket:vr,token:lt.PageConfig.getToken(),appUrl:lt.PageConfig.getOption("appUrl"),appendToken:g,serializer:{serialize:Dl.serialize,deserialize:Dl.deserialize},...r,baseUrl:v,wsUrl:p}}n.makeSettings=e;function t(r,s,c){var f;if(r.indexOf(c.baseUrl)!==0)throw new Error("Can only be used for notebook server requests");((f=s.cache)!==null&&f!==void 0?f:c.init.cache)==="no-store"&&(r+=(/\?/.test(r)?"&":"?")+new Date().getTime());let p=new c.Request(r,{...c.init,...s}),h=!1;if(c.token&&(h=!0,p.headers.append("Authorization",`token ${c.token}`)),typeof document<"u"){let g=i("_xsrf");g!==void 0&&(h=!0,p.headers.append("X-XSRFToken",g))}return!p.headers.has("Content-Type")&&h&&p.headers.set("Content-Type","application/json"),c.fetch.call(null,p).catch(g=>{throw new yr.NetworkError(g)})}n.handleRequest=t;function i(r){let s="";try{s=document.cookie}catch{return}let c=s.match("\\b"+r+"=([^;]*)\\b");return c?.[1]}})(jn||(jn={}))});var vt=F(In=>{"use strict";Object.defineProperty(In,"__esModule",{value:!0});In.BaseManager=void 0;var xl=Oe(),lf=ge(),wr=class{constructor(e){var t;this._isDisposed=!1,this._disposed=new xl.Signal(this),this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:lf.ServerConnection.makeSettings()}get disposed(){return this._disposed}get isDisposed(){return this._isDisposed}get isActive(){return!0}dispose(){this.isDisposed||(this._isDisposed=!0,this._disposed.emit(void 0),xl.Signal.clearData(this))}};In.BaseManager=wr});var ql=F(Rt=>{"use strict";Object.defineProperty(Rt,"__esModule",{value:!0});Rt.ConfigWithDefaults=Rt.ConfigSection=void 0;var af=ue(),Kt=at(),cf="api/config",kl;(function(n){function e(t){let i=new Sr(t);return i.load().then(()=>i)}n.create=e})(kl||(Rt.ConfigSection=kl={}));var Sr=class{constructor(e){var t;this._url="unknown";let i=this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:Kt.ServerConnection.makeSettings();this._url=af.URLExt.join(i.baseUrl,cf,encodeURIComponent(e.name))}get data(){return this._data}async load(){let e=await Kt.ServerConnection.makeRequest(this._url,{},this.serverSettings);if(e.status!==200)throw await Kt.ServerConnection.ResponseError.create(e);this._data=await e.json()}async update(e){this._data={...this._data,...e};let t={method:"PATCH",body:JSON.stringify(e)},i=await Kt.ServerConnection.makeRequest(this._url,t,this.serverSettings);if(i.status!==200)throw await Kt.ServerConnection.ResponseError.create(i);return this._data=await i.json(),this._data}},br=class{constructor(e){var t,i;this._className="",this._section=e.section,this._defaults=(t=e.defaults)!==null&&t!==void 0?t:{},this._className=(i=e.className)!==null&&i!==void 0?i:""}get(e){let t=this._classData();return e in t?t[e]:this._defaults[e]}set(e,t){let i={};if(i[e]=t,this._className){let r={};return r[this._className]=i,this._section.update(r)}else return this._section.update(i)}_classData(){let e=this._section.data;return this._className&&this._className in e?e[this._className]:e}};Rt.ConfigWithDefaults=br});var zt=F(Un=>{"use strict";Object.defineProperty(Un,"__esModule",{value:!0});Un.validateProperty=void 0;function uf(n,e,t,i=[]){if(!n.hasOwnProperty(e))throw Error(`Missing property '${e}'`);let r=n[e];if(t!==void 0){let s=!0;switch(t){case"array":s=Array.isArray(r);break;case"object":s=typeof r<"u";break;default:s=typeof r===t}if(!s)throw new Error(`Property '${e}' is not of type '${t}'`);if(i.length>0){let c=!0;switch(t){case"string":case"number":case"boolean":c=i.includes(r);break;default:c=i.findIndex(f=>f===r)>=0;break}if(!c)throw new Error(`Property '${e}' is not one of the valid values ${JSON.stringify(i)}`)}}}Un.validateProperty=uf});var jl=F(Dt=>{"use strict";Object.defineProperty(Dt,"__esModule",{value:!0});Dt.validateCheckpointModel=Dt.validateContentsModel=void 0;var Ae=zt();function ff(n){(0,Ae.validateProperty)(n,"name","string"),(0,Ae.validateProperty)(n,"path","string"),(0,Ae.validateProperty)(n,"type","string"),(0,Ae.validateProperty)(n,"created","string"),(0,Ae.validateProperty)(n,"last_modified","string"),(0,Ae.validateProperty)(n,"mimetype","object"),(0,Ae.validateProperty)(n,"content","object"),(0,Ae.validateProperty)(n,"format","object")}Dt.validateContentsModel=ff;function hf(n){(0,Ae.validateProperty)(n,"id","string"),(0,Ae.validateProperty)(n,"last_modified","string")}Dt.validateCheckpointModel=hf});var Pr=F(Me=>{"use strict";var df=Me&&Me.__createBinding||(Object.create?function(n,e,t,i){i===void 0&&(i=t);var r=Object.getOwnPropertyDescriptor(e,t);(!r||("get"in r?!e.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,i,r)}:function(n,e,t,i){i===void 0&&(i=t),n[i]=e[t]}),_f=Me&&Me.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),gf=Me&&Me.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.prototype.hasOwnProperty.call(n,t)&&df(e,n,t);return _f(e,n),e};Object.defineProperty(Me,"__esModule",{value:!0});Me.Drive=Me.ContentsManager=Me.Contents=void 0;var De=ue(),Ln=Oe(),ee=at(),nt=gf(jl()),pf="api/contents",mf="files",Tl;(function(n){function e(i){nt.validateContentsModel(i)}n.validateContentsModel=e;function t(i){nt.validateCheckpointModel(i)}n.validateCheckpointModel=t})(Tl||(Me.Contents=Tl={}));var Mr=class{constructor(e={}){var t,i;this._isDisposed=!1,this._additionalDrives=new Map,this._fileChanged=new Ln.Signal(this);let r=this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:ee.ServerConnection.makeSettings();this._defaultDrive=(i=e.defaultDrive)!==null&&i!==void 0?i:new Nn({serverSettings:r}),this._defaultDrive.fileChanged.connect(this._onFileChanged,this)}get fileChanged(){return this._fileChanged}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,Ln.Signal.clearData(this))}addDrive(e){this._additionalDrives.set(e.name,e),e.fileChanged.connect(this._onFileChanged,this)}getSharedModelFactory(e){var t;let[i]=this._driveForPath(e);return(t=i?.sharedModelFactory)!==null&&t!==void 0?t:null}localPath(e){let t=e.split("/"),i=t[0].split(":");return i.length===1||!this._additionalDrives.has(i[0])?De.PathExt.removeSlash(e):De.PathExt.join(i.slice(1).join(":"),...t.slice(1))}normalize(e){let t=e.split(":");return t.length===1?De.PathExt.normalize(e):`${t[0]}:${De.PathExt.normalize(t.slice(1).join(":"))}`}resolvePath(e,t){let i=this.driveName(e),r=this.localPath(e),s=De.PathExt.resolve("/",r,t);return i?`${i}:${s}`:s}driveName(e){let i=e.split("/")[0].split(":");return i.length===1?"":this._additionalDrives.has(i[0])?i[0]:""}get(e,t){let[i,r]=this._driveForPath(e);return i.get(r,t).then(s=>{let c=[];if(s.type==="directory"&&s.content){for(let f of s.content)c.push({...f,path:this._toGlobalPath(i,f.path)});return{...s,path:this._toGlobalPath(i,r),content:c,serverPath:s.path}}else return{...s,path:this._toGlobalPath(i,r),serverPath:s.path}})}getDownloadUrl(e){let[t,i]=this._driveForPath(e);return t.getDownloadUrl(i)}newUntitled(e={}){if(e.path){let t=this.normalize(e.path),[i,r]=this._driveForPath(t);return i.newUntitled({...e,path:r}).then(s=>({...s,path:De.PathExt.join(t,s.name),serverPath:s.path}))}else return this._defaultDrive.newUntitled(e)}delete(e){let[t,i]=this._driveForPath(e);return t.delete(i)}rename(e,t){let[i,r]=this._driveForPath(e),[s,c]=this._driveForPath(t);if(i!==s)throw Error("ContentsManager: renaming files must occur within a Drive");return i.rename(r,c).then(f=>({...f,path:this._toGlobalPath(i,c),serverPath:f.path}))}save(e,t={}){let i=this.normalize(e),[r,s]=this._driveForPath(e);return r.save(s,{...t,path:s}).then(c=>({...c,path:i,serverPath:c.path}))}copy(e,t){let[i,r]=this._driveForPath(e),[s,c]=this._driveForPath(t);if(i===s)return i.copy(r,c).then(f=>({...f,path:this._toGlobalPath(i,f.path),serverPath:f.path}));throw Error("Copying files between drives is not currently implemented")}createCheckpoint(e){let[t,i]=this._driveForPath(e);return t.createCheckpoint(i)}listCheckpoints(e){let[t,i]=this._driveForPath(e);return t.listCheckpoints(i)}restoreCheckpoint(e,t){let[i,r]=this._driveForPath(e);return i.restoreCheckpoint(r,t)}deleteCheckpoint(e,t){let[i,r]=this._driveForPath(e);return i.deleteCheckpoint(r,t)}_toGlobalPath(e,t){return e===this._defaultDrive?De.PathExt.removeSlash(t):`${e.name}:${De.PathExt.removeSlash(t)}`}_driveForPath(e){let t=this.driveName(e),i=this.localPath(e);return t?[this._additionalDrives.get(t),i]:[this._defaultDrive,i]}_onFileChanged(e,t){var i,r;if(e===this._defaultDrive)this._fileChanged.emit(t);else{let s=null,c=null;!((i=t.newValue)===null||i===void 0)&&i.path&&(s={...t.newValue,path:this._toGlobalPath(e,t.newValue.path)}),!((r=t.oldValue)===null||r===void 0)&&r.path&&(c={...t.oldValue,path:this._toGlobalPath(e,t.oldValue.path)}),this._fileChanged.emit({type:t.type,newValue:s,oldValue:c})}}};Me.ContentsManager=Mr;var Nn=class{constructor(e={}){var t,i,r;this._isDisposed=!1,this._fileChanged=new Ln.Signal(this),this.name=(t=e.name)!==null&&t!==void 0?t:"Default",this._apiEndpoint=(i=e.apiEndpoint)!==null&&i!==void 0?i:pf,this.serverSettings=(r=e.serverSettings)!==null&&r!==void 0?r:ee.ServerConnection.makeSettings()}get fileChanged(){return this._fileChanged}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,Ln.Signal.clearData(this))}async get(e,t){let i=this._getUrl(e);if(t){t.type==="notebook"&&delete t.format;let f=t.content?"1":"0",v=t.hash?"1":"0",p={...t,content:f,hash:v};i+=De.URLExt.objectToQueryString(p)}let r=this.serverSettings,s=await ee.ServerConnection.makeRequest(i,{},r);if(s.status!==200)throw await ee.ServerConnection.ResponseError.create(s);let c=await s.json();return nt.validateContentsModel(c),c}getDownloadUrl(e){let t=this.serverSettings.baseUrl,i=De.URLExt.join(t,mf,De.URLExt.encodeParts(e)),r="";try{r=document.cookie}catch{}let s=r.match("\\b_xsrf=([^;]*)\\b");if(s){let c=new URL(i);c.searchParams.append("_xsrf",s[1]),i=c.toString()}return Promise.resolve(i)}async newUntitled(e={}){var t;let i="{}";e&&(e.ext&&(e.ext=Cr.normalizeExtension(e.ext)),i=JSON.stringify(e));let r=this.serverSettings,s=this._getUrl((t=e.path)!==null&&t!==void 0?t:""),c={method:"POST",body:i},f=await ee.ServerConnection.makeRequest(s,c,r);if(f.status!==201)throw await ee.ServerConnection.ResponseError.create(f);let v=await f.json();return nt.validateContentsModel(v),this._fileChanged.emit({type:"new",oldValue:null,newValue:v}),v}async delete(e){let t=this._getUrl(e),i=this.serverSettings,r={method:"DELETE"},s=await ee.ServerConnection.makeRequest(t,r,i);if(s.status!==204)throw await ee.ServerConnection.ResponseError.create(s);this._fileChanged.emit({type:"delete",oldValue:{path:e},newValue:null})}async rename(e,t){let i=this.serverSettings,r=this._getUrl(e),s={method:"PATCH",body:JSON.stringify({path:t})},c=await ee.ServerConnection.makeRequest(r,s,i);if(c.status!==200)throw await ee.ServerConnection.ResponseError.create(c);let f=await c.json();return nt.validateContentsModel(f),this._fileChanged.emit({type:"rename",oldValue:{path:e},newValue:f}),f}async save(e,t={}){let i=this.serverSettings,r=this._getUrl(e),s={method:"PUT",body:JSON.stringify(t)},c=await ee.ServerConnection.makeRequest(r,s,i);if(c.status!==200&&c.status!==201)throw await ee.ServerConnection.ResponseError.create(c);let f=await c.json();return nt.validateContentsModel(f),this._fileChanged.emit({type:"save",oldValue:null,newValue:f}),f}async copy(e,t){let i=this.serverSettings,r=this._getUrl(t),s={method:"POST",body:JSON.stringify({copy_from:e})},c=await ee.ServerConnection.makeRequest(r,s,i);if(c.status!==201)throw await ee.ServerConnection.ResponseError.create(c);let f=await c.json();return nt.validateContentsModel(f),this._fileChanged.emit({type:"new",oldValue:null,newValue:f}),f}async createCheckpoint(e){let t=this._getUrl(e,"checkpoints"),i={method:"POST"},r=await ee.ServerConnection.makeRequest(t,i,this.serverSettings);if(r.status!==201)throw await ee.ServerConnection.ResponseError.create(r);let s=await r.json();return nt.validateCheckpointModel(s),s}async listCheckpoints(e){let t=this._getUrl(e,"checkpoints"),i=await ee.ServerConnection.makeRequest(t,{},this.serverSettings);if(i.status!==200)throw await ee.ServerConnection.ResponseError.create(i);let r=await i.json();if(!Array.isArray(r))throw new Error("Invalid Checkpoint list");for(let s=0;s<r.length;s++)nt.validateCheckpointModel(r[s]);return r}async restoreCheckpoint(e,t){let i=this._getUrl(e,"checkpoints",t),r={method:"POST"},s=await ee.ServerConnection.makeRequest(i,r,this.serverSettings);if(s.status!==204)throw await ee.ServerConnection.ResponseError.create(s)}async deleteCheckpoint(e,t){let i=this._getUrl(e,"checkpoints",t),r={method:"DELETE"},s=await ee.ServerConnection.makeRequest(i,r,this.serverSettings);if(s.status!==204)throw await ee.ServerConnection.ResponseError.create(s)}_getUrl(...e){let t=e.map(r=>De.URLExt.encodeParts(r)),i=this.serverSettings.baseUrl;return De.URLExt.join(i,this._apiEndpoint,...t)}};Me.Drive=Nn;var Cr;(function(n){function e(t){return t.length>0&&t.indexOf(".")!==0&&(t=`.${t}`),t}n.normalizeExtension=e})(Cr||(Cr={}))});var Er=F((An,Il)=>{(function(n,e){typeof An=="object"&&typeof Il<"u"?e(An):typeof define=="function"&&define.amd?define(["exports"],e):(n=typeof globalThis<"u"?globalThis:n||self,e(n.lumino_algorithm={}))})(An,function(n){"use strict";n.ArrayExt=void 0,function(u){function d(_,y,l=0,o=-1){let a=_.length;if(a===0)return-1;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S;o<l?S=o+1+(a-l):S=o-l+1;for(let M=0;M<S;++M){let q=(l+M)%a;if(_[q]===y)return q}return-1}u.firstIndexOf=d;function m(_,y,l=-1,o=0){let a=_.length;if(a===0)return-1;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S;l<o?S=l+1+(a-o):S=l-o+1;for(let M=0;M<S;++M){let q=(l-M+a)%a;if(_[q]===y)return q}return-1}u.lastIndexOf=m;function w(_,y,l=0,o=-1){let a=_.length;if(a===0)return-1;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S;o<l?S=o+1+(a-l):S=o-l+1;for(let M=0;M<S;++M){let q=(l+M)%a;if(y(_[q],q))return q}return-1}u.findFirstIndex=w;function R(_,y,l=-1,o=0){let a=_.length;if(a===0)return-1;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S;l<o?S=l+1+(a-o):S=l-o+1;for(let M=0;M<S;++M){let q=(l-M+a)%a;if(y(_[q],q))return q}return-1}u.findLastIndex=R;function U(_,y,l=0,o=-1){let a=w(_,y,l,o);return a!==-1?_[a]:void 0}u.findFirstValue=U;function D(_,y,l=-1,o=0){let a=R(_,y,l,o);return a!==-1?_[a]:void 0}u.findLastValue=D;function k(_,y,l,o=0,a=-1){let S=_.length;if(S===0)return 0;o<0?o=Math.max(0,o+S):o=Math.min(o,S-1),a<0?a=Math.max(0,a+S):a=Math.min(a,S-1);let M=o,q=a-o+1;for(;q>0;){let K=q>>1,Q=M+K;l(_[Q],y)<0?(M=Q+1,q-=K+1):q=K}return M}u.lowerBound=k;function A(_,y,l,o=0,a=-1){let S=_.length;if(S===0)return 0;o<0?o=Math.max(0,o+S):o=Math.min(o,S-1),a<0?a=Math.max(0,a+S):a=Math.min(a,S-1);let M=o,q=a-o+1;for(;q>0;){let K=q>>1,Q=M+K;l(_[Q],y)>0?q=K:(M=Q+1,q-=K+1)}return M}u.upperBound=A;function T(_,y,l){if(_===y)return!0;if(_.length!==y.length)return!1;for(let o=0,a=_.length;o<a;++o)if(l?!l(_[o],y[o]):_[o]!==y[o])return!1;return!0}u.shallowEqual=T;function B(_,y={}){let{start:l,stop:o,step:a}=y;if(a===void 0&&(a=1),a===0)throw new Error("Slice `step` cannot be zero.");let S=_.length;l===void 0?l=a<0?S-1:0:l<0?l=Math.max(l+S,a<0?-1:0):l>=S&&(l=a<0?S-1:S),o===void 0?o=a<0?-1:S:o<0?o=Math.max(o+S,a<0?-1:0):o>=S&&(o=a<0?S-1:S);let M;a<0&&o>=l||a>0&&l>=o?M=0:a<0?M=Math.floor((o-l+1)/a+1):M=Math.floor((o-l-1)/a+1);let q=[];for(let K=0;K<M;++K)q[K]=_[l+K*a];return q}u.slice=B;function L(_,y,l){let o=_.length;if(o<=1||(y<0?y=Math.max(0,y+o):y=Math.min(y,o-1),l<0?l=Math.max(0,l+o):l=Math.min(l,o-1),y===l))return;let a=_[y],S=y<l?1:-1;for(let M=y;M!==l;M+=S)_[M]=_[M+S];_[l]=a}u.move=L;function W(_,y=0,l=-1){let o=_.length;if(!(o<=1))for(y<0?y=Math.max(0,y+o):y=Math.min(y,o-1),l<0?l=Math.max(0,l+o):l=Math.min(l,o-1);y<l;){let a=_[y],S=_[l];_[y++]=S,_[l--]=a}}u.reverse=W;function z(_,y,l=0,o=-1){let a=_.length;if(a<=1||(l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1),l>=o))return;let S=o-l+1;if(y>0?y=y%S:y<0&&(y=(y%S+S)%S),y===0)return;let M=l+y;W(_,l,M-1),W(_,M,o),W(_,l,o)}u.rotate=z;function G(_,y,l=0,o=-1){let a=_.length;if(a===0)return;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S;o<l?S=o+1+(a-l):S=o-l+1;for(let M=0;M<S;++M)_[(l+M)%a]=y}u.fill=G;function Ke(_,y,l){let o=_.length;y<0?y=Math.max(0,y+o):y=Math.min(y,o);for(let a=o;a>y;--a)_[a]=_[a-1];_[y]=l}u.insert=Ke;function Z(_,y){let l=_.length;if(y<0&&(y+=l),y<0||y>=l)return;let o=_[y];for(let a=y+1;a<l;++a)_[a-1]=_[a];return _.length=l-1,o}u.removeAt=Z;function ze(_,y,l=0,o=-1){let a=d(_,y,l,o);return a!==-1&&Z(_,a),a}u.removeFirstOf=ze;function He(_,y,l=-1,o=0){let a=m(_,y,l,o);return a!==-1&&Z(_,a),a}u.removeLastOf=He;function Ge(_,y,l=0,o=-1){let a=_.length;if(a===0)return 0;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S=0;for(let M=0;M<a;++M)l<=o&&M>=l&&M<=o&&_[M]===y||o<l&&(M<=o||M>=l)&&_[M]===y?S++:S>0&&(_[M-S]=_[M]);return S>0&&(_.length=a-S),S}u.removeAllOf=Ge;function Je(_,y,l=0,o=-1){let a,S=w(_,y,l,o);return S!==-1&&(a=Z(_,S)),{index:S,value:a}}u.removeFirstWhere=Je;function Ye(_,y,l=-1,o=0){let a,S=R(_,y,l,o);return S!==-1&&(a=Z(_,S)),{index:S,value:a}}u.removeLastWhere=Ye;function Xe(_,y,l=0,o=-1){let a=_.length;if(a===0)return 0;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S=0;for(let M=0;M<a;++M)l<=o&&M>=l&&M<=o&&y(_[M],M)||o<l&&(M<=o||M>=l)&&y(_[M],M)?S++:S>0&&(_[M-S]=_[M]);return S>0&&(_.length=a-S),S}u.removeAllWhere=Xe}(n.ArrayExt||(n.ArrayExt={}));function*e(...u){for(let d of u)yield*d}function*t(){}function*i(u,d=0){for(let m of u)yield[d++,m]}function*r(u,d){let m=0;for(let w of u)d(w,m++)&&(yield w)}function s(u,d){let m=0;for(let w of u)if(d(w,m++))return w}function c(u,d){let m=0;for(let w of u)if(d(w,m++))return m-1;return-1}function f(u,d){let m;for(let w of u){if(m===void 0){m=w;continue}d(w,m)<0&&(m=w)}return m}function v(u,d){let m;for(let w of u){if(m===void 0){m=w;continue}d(w,m)>0&&(m=w)}return m}function p(u,d){let m=!0,w,R;for(let U of u)m?(w=U,R=U,m=!1):d(U,w)<0?w=U:d(U,R)>0&&(R=U);return m?void 0:[w,R]}function h(u){return Array.from(u)}function g(u){let d={};for(let[m,w]of u)d[m]=w;return d}function b(u,d){let m=0;for(let w of u)if(d(w,m++)===!1)return}function C(u,d){let m=0;for(let w of u)if(d(w,m++)===!1)return!1;return!0}function P(u,d){let m=0;for(let w of u)if(d(w,m++))return!0;return!1}function*O(u,d){let m=0;for(let w of u)yield d(w,m++)}function*I(u,d,m){d===void 0?(d=u,u=0,m=1):m===void 0&&(m=1);let w=N.rangeLength(u,d,m);for(let R=0;R<w;R++)yield u+m*R}var N;(function(u){function d(m,w,R){return R===0?1/0:m>w&&R>0||m<w&&R<0?0:Math.ceil((w-m)/R)}u.rangeLength=d})(N||(N={}));function V(u,d,m){let w=u[Symbol.iterator](),R=0,U=w.next();if(U.done&&m===void 0)throw new TypeError("Reduce of empty iterable with no initial value.");if(U.done)return m;let D=w.next();if(D.done&&m===void 0)return U.value;if(D.done)return d(m,U.value,R++);let k;m===void 0?k=d(U.value,D.value,R++):k=d(d(m,U.value,R++),D.value,R++);let A;for(;!(A=w.next()).done;)k=d(k,A.value,R++);return k}function*$(u,d){for(;0<d--;)yield u}function*j(u){yield u}function*J(u){if(typeof u.retro=="function")yield*u.retro();else for(let d=u.length-1;d>-1;d--)yield u[d]}function X(u){let d=[],m=new Set,w=new Map;for(let D of u)R(D);for(let[D]of w)U(D);return d;function R(D){let[k,A]=D,T=w.get(A);T?T.push(k):w.set(A,[k])}function U(D){if(m.has(D))return;m.add(D);let k=w.get(D);if(k)for(let A of k)U(A);d.push(D)}}function*H(u,d){let m=0;for(let w of u)m++%d===0&&(yield w)}n.StringExt=void 0,function(u){function d(D,k,A=0){let T=new Array(k.length);for(let B=0,L=A,W=k.length;B<W;++B,++L){if(L=D.indexOf(k[B],L),L===-1)return null;T[B]=L}return T}u.findIndices=d;function m(D,k,A=0){let T=d(D,k,A);if(!T)return null;let B=0;for(let L=0,W=T.length;L<W;++L){let z=T[L]-A;B+=z*z}return{score:B,indices:T}}u.matchSumOfSquares=m;function w(D,k,A=0){let T=d(D,k,A);if(!T)return null;let B=0,L=A-1;for(let W=0,z=T.length;W<z;++W){let G=T[W];B+=G-L-1,L=G}return{score:B,indices:T}}u.matchSumOfDeltas=w;function R(D,k,A){let T=[],B=0,L=0,W=k.length;for(;B<W;){let z=k[B],G=k[B];for(;++B<W&&k[B]===G+1;)G++;L<z&&T.push(D.slice(L,z)),z<G+1&&T.push(A(D.slice(z,G+1))),L=G+1}return L<D.length&&T.push(D.slice(L)),T}u.highlight=R;function U(D,k){return D<k?-1:D>k?1:0}u.cmp=U}(n.StringExt||(n.StringExt={}));function*E(u,d){if(d<1)return;let m=u[Symbol.iterator](),w;for(;0<d--&&!(w=m.next()).done;)yield w.value}function*x(...u){let d=u.map(w=>w[Symbol.iterator]()),m=d.map(w=>w.next());for(;C(m,w=>!w.done);m=d.map(w=>w.next()))yield m.map(w=>w.value)}n.chain=e,n.each=b,n.empty=t,n.enumerate=i,n.every=C,n.filter=r,n.find=s,n.findIndex=c,n.map=O,n.max=v,n.min=f,n.minmax=p,n.once=j,n.range=I,n.reduce=V,n.repeat=$,n.retro=J,n.some=P,n.stride=H,n.take=E,n.toArray=h,n.toObject=g,n.topologicSort=X,n.zip=x})});var kr=F(pe=>{"use strict";var vf=Er();pe.JSONExt=void 0;(function(n){n.emptyObject=Object.freeze({}),n.emptyArray=Object.freeze([]);function e(h){return h===null||typeof h=="boolean"||typeof h=="number"||typeof h=="string"}n.isPrimitive=e;function t(h){return Array.isArray(h)}n.isArray=t;function i(h){return!e(h)&&!t(h)}n.isObject=i;function r(h,g){if(h===g)return!0;if(e(h)||e(g))return!1;let b=t(h),C=t(g);return b!==C?!1:b&&C?c(h,g):f(h,g)}n.deepEqual=r;function s(h){return e(h)?h:t(h)?v(h):p(h)}n.deepCopy=s;function c(h,g){if(h===g)return!0;if(h.length!==g.length)return!1;for(let b=0,C=h.length;b<C;++b)if(!r(h[b],g[b]))return!1;return!0}function f(h,g){if(h===g)return!0;for(let b in h)if(h[b]!==void 0&&!(b in g))return!1;for(let b in g)if(g[b]!==void 0&&!(b in h))return!1;for(let b in h){let C=h[b],P=g[b];if(!(C===void 0&&P===void 0)&&(C===void 0||P===void 0||!r(C,P)))return!1}return!0}function v(h){let g=new Array(h.length);for(let b=0,C=h.length;b<C;++b)g[b]=s(h[b]);return g}function p(h){let g={};for(let b in h){let C=h[b];C!==void 0&&(g[b]=s(C))}return g}})(pe.JSONExt||(pe.JSONExt={}));var Or=class{constructor(){this._types=[],this._values=[]}types(){return this._types.slice()}hasData(e){return this._types.indexOf(e)!==-1}getData(e){let t=this._types.indexOf(e);return t!==-1?this._values[t]:void 0}setData(e,t){this.clearData(e),this._types.push(e),this._values.push(t)}clearData(e){let t=this._types.indexOf(e);t!==-1&&(this._types.splice(t,1),this._values.splice(t,1))}clear(){this._types.length=0,this._values.length=0}},Rr=class{constructor(e={}){this._application=null,this._validatePlugin=()=>!0,this._plugins=new Map,this._services=new Map,e.validatePlugin&&(console.info("Plugins may be rejected by the custom validation plugin method."),this._validatePlugin=e.validatePlugin)}get application(){return this._application}set application(e){if(this._application!==null)throw Error("PluginRegistry.application is already set. It cannot be overridden.");this._application=e}get deferredPlugins(){return Array.from(this._plugins).filter(([e,t])=>t.autoStart==="defer").map(([e,t])=>e)}getPluginDescription(e){var t,i;return(i=(t=this._plugins.get(e))===null||t===void 0?void 0:t.description)!==null&&i!==void 0?i:""}hasPlugin(e){return this._plugins.has(e)}isPluginActivated(e){var t,i;return(i=(t=this._plugins.get(e))===null||t===void 0?void 0:t.activated)!==null&&i!==void 0?i:!1}listPlugins(){return Array.from(this._plugins.keys())}registerPlugin(e){if(this._plugins.has(e.id))throw new TypeError(`Plugin '${e.id}' is already registered.`);if(!this._validatePlugin(e))throw new Error(`Plugin '${e.id}' is not valid.`);let t=xt.createPluginData(e);xt.ensureNoCycle(t,this._plugins,this._services),t.provides&&this._services.set(t.provides,t.id),this._plugins.set(t.id,t)}registerPlugins(e){for(let t of e)this.registerPlugin(t)}deregisterPlugin(e,t){let i=this._plugins.get(e);if(i){if(i.activated&&!t)throw new Error(`Plugin '${e}' is still active.`);this._plugins.delete(e)}}async activatePlugin(e){let t=this._plugins.get(e);if(!t)throw new ReferenceError(`Plugin '${e}' is not registered.`);if(t.activated)return;if(t.promise)return t.promise;let i=t.requires.map(s=>this.resolveRequiredService(s)),r=t.optional.map(s=>this.resolveOptionalService(s));return t.promise=Promise.all([...i,...r]).then(s=>t.activate.apply(void 0,[this.application,...s])).then(s=>{t.service=s,t.activated=!0,t.promise=null}).catch(s=>{throw t.promise=null,s}),t.promise}async activatePlugins(e,t={}){switch(e){case"defer":{let i=this.deferredPlugins.filter(r=>this._plugins.get(r).autoStart).map(r=>this.activatePlugin(r));await Promise.all(i);break}case"startUp":{let r=xt.collectStartupPlugins(this._plugins,t).map(async s=>{try{return await this.activatePlugin(s)}catch(c){console.error(`Plugin '${s}' failed to activate.`,c)}});await Promise.all(r);break}}}async deactivatePlugin(e){let t=this._plugins.get(e);if(!t)throw new ReferenceError(`Plugin '${e}' is not registered.`);if(!t.activated)return[];if(!t.deactivate)throw new TypeError(`Plugin '${e}'#deactivate() method missing`);let i=xt.findDependents(e,this._plugins,this._services),r=i.map(s=>this._plugins.get(s));for(let s of r)if(!s.deactivate)throw new TypeError(`Plugin ${s.id}#deactivate() method missing (depends on ${e})`);for(let s of r){let c=[...s.requires,...s.optional].map(f=>{let v=this._services.get(f);return v?this._plugins.get(v).service:null});await s.deactivate(this.application,...c),s.service=null,s.activated=!1}return i.pop(),i}async resolveRequiredService(e){let t=this._services.get(e);if(!t)throw new TypeError(`No provider for: ${e.name}.`);let i=this._plugins.get(t);return i.activated||await this.activatePlugin(t),i.service}async resolveOptionalService(e){let t=this._services.get(e);if(!t)return null;let i=this._plugins.get(t);if(!i.activated)try{await this.activatePlugin(t)}catch(r){return console.error(r),null}return i.service}},xt;(function(n){class e{constructor(f){var v,p,h,g;this._activated=!1,this._promise=null,this._service=null,this.id=f.id,this.description=(v=f.description)!==null&&v!==void 0?v:"",this.activate=f.activate,this.deactivate=(p=f.deactivate)!==null&&p!==void 0?p:null,this.provides=(h=f.provides)!==null&&h!==void 0?h:null,this.autoStart=(g=f.autoStart)!==null&&g!==void 0?g:!1,this.requires=f.requires?f.requires.slice():[],this.optional=f.optional?f.optional.slice():[]}get activated(){return this._activated}set activated(f){this._activated=f}get service(){return this._service}set service(f){this._service=f}get promise(){return this._promise}set promise(f){this._promise=f}}function t(c){return new e(c)}n.createPluginData=t;function i(c,f,v){let p=[...c.requires,...c.optional],h=b=>{if(b===c.provides)return!0;let C=v.get(b);if(!C)return!1;let P=f.get(C),O=[...P.requires,...P.optional];return O.length===0?!1:(g.push(C),O.some(h)?!0:(g.pop(),!1))};if(!c.provides||p.length===0)return;let g=[c.id];if(p.some(h))throw new ReferenceError(`Cycle detected: ${g.join(" -> ")}.`)}n.ensureNoCycle=i;function r(c,f,v){let p=new Array,h=O=>{let I=f.get(O),N=[...I.requires,...I.optional];p.push(...N.reduce((V,$)=>{let j=v.get($);return j&&V.push([O,j]),V},[]))};for(let O of f.keys())h(O);let g=p.filter(O=>O[1]===c),b=0;for(;g.length>b;){let O=g.length,I=new Set(g.map(N=>N[0]));for(let N of I)p.filter(V=>V[1]===N).forEach(V=>{g.includes(V)||g.push(V)});b=O}let C=vf.topologicSort(g),P=C.findIndex(O=>O===c);return P===-1?[c]:C.slice(0,P+1)}n.findDependents=r;function s(c,f){let v=new Set;for(let p of c.keys())c.get(p).autoStart===!0&&v.add(p);if(f.startPlugins)for(let p of f.startPlugins)v.add(p);if(f.ignorePlugins)for(let p of f.ignorePlugins)v.delete(p);return Array.from(v)}n.collectStartupPlugins=s})(xt||(xt={}));var Dr=class{constructor(){this.promise=new Promise((e,t)=>{this._resolve=e,this._reject=t})}resolve(e){let t=this._resolve;t(e)}reject(e){let t=this._reject;t(e)}},xr=class{constructor(e,t){this.name=e,this.description=t??"",this._tokenStructuralPropertyT=null}};function yf(n){let e=0;for(let t=0,i=n.length;t<i;++t)t%4===0&&(e=Math.random()*4294967295>>>0),n[t]=e&255,e>>>=8}pe.Random=void 0;(function(n){n.getRandomValues=(()=>{let e=typeof require<"u"&&require("crypto")||null;return e&&typeof e.randomFillSync=="function"?function(i){return e.randomFillSync(i)}:e&&typeof e.randomBytes=="function"?function(i){let r=e.randomBytes(i.length);for(let s=0,c=r.length;s<c;++s)i[s]=r[s]}:yf})()})(pe.Random||(pe.Random={}));function wf(n){let e=new Uint8Array(16),t=new Array(256);for(let i=0;i<16;++i)t[i]="0"+i.toString(16);for(let i=16;i<256;++i)t[i]=i.toString(16);return function(){return n(e),e[6]=64|e[6]&15,e[8]=128|e[8]&63,t[e[0]]+t[e[1]]+t[e[2]]+t[e[3]]+"-"+t[e[4]]+t[e[5]]+"-"+t[e[6]]+t[e[7]]+"-"+t[e[8]]+t[e[9]]+"-"+t[e[10]]+t[e[11]]+t[e[12]]+t[e[13]]+t[e[14]]+t[e[15]]}}pe.UUID=void 0;(function(n){n.uuid4=wf(pe.Random.getRandomValues)})(pe.UUID||(pe.UUID={}));pe.MimeData=Or;pe.PluginRegistry=Rr;pe.PromiseDelegate=Dr;pe.Token=xr});var Ll=F((Fn,Ul)=>{(function(n,e){typeof Fn=="object"&&typeof Ul<"u"?e(Fn,Er(),kr()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm","@lumino/coreutils"],e):(n=typeof globalThis<"u"?globalThis:n||self,e(n.lumino_signaling={},n.lumino_algorithm,n.lumino_coreutils))})(Fn,function(n,e,t){"use strict";class i{constructor(f){this.sender=f}connect(f,v){return s.connect(this,f,v)}disconnect(f,v){return s.disconnect(this,f,v)}emit(f){s.emit(this,f)}}(function(c){function f(P,O){s.disconnectBetween(P,O)}c.disconnectBetween=f;function v(P){s.disconnectSender(P)}c.disconnectSender=v;function p(P){s.disconnectReceiver(P)}c.disconnectReceiver=p;function h(P){s.disconnectAll(P)}c.disconnectAll=h;function g(P){s.disconnectAll(P)}c.clearData=g;function b(){return s.exceptionHandler}c.getExceptionHandler=b;function C(P){let O=s.exceptionHandler;return s.exceptionHandler=P,O}c.setExceptionHandler=C})(i||(i={}));class r extends i{constructor(){super(...arguments),this._pending=new t.PromiseDelegate}async*[Symbol.asyncIterator](){let f=this._pending;for(;;)try{let{args:v,next:p}=await f.promise;f=p,yield v}catch{return}}emit(f){let v=this._pending,p=this._pending=new t.PromiseDelegate;v.resolve({args:f,next:p}),super.emit(f)}stop(){this._pending.promise.catch(()=>{}),this._pending.reject("stop"),this._pending=new t.PromiseDelegate}}var s;(function(c){c.exceptionHandler=E=>{console.error(E)};function f(E,x,u){u=u||void 0;let d=P.get(E.sender);if(d||(d=[],P.set(E.sender,d)),V(d,E,x,u))return!1;let m=u||x,w=O.get(m);w||(w=[],O.set(m,w));let R={signal:E,slot:x,thisArg:u};return d.push(R),w.push(R),!0}c.connect=f;function v(E,x,u){u=u||void 0;let d=P.get(E.sender);if(!d||d.length===0)return!1;let m=V(d,E,x,u);if(!m)return!1;let w=u||x,R=O.get(w);return m.signal=null,j(d),j(R),!0}c.disconnect=v;function p(E,x){let u=P.get(E);if(!u||u.length===0)return;let d=O.get(x);if(!(!d||d.length===0)){for(let m of d)m.signal&&m.signal.sender===E&&(m.signal=null);j(u),j(d)}}c.disconnectBetween=p;function h(E){let x=P.get(E);if(!(!x||x.length===0)){for(let u of x){if(!u.signal)continue;let d=u.thisArg||u.slot;u.signal=null,j(O.get(d))}j(x)}}c.disconnectSender=h;function g(E){let x=O.get(E);if(!(!x||x.length===0)){for(let u of x){if(!u.signal)continue;let d=u.signal.sender;u.signal=null,j(P.get(d))}j(x)}}c.disconnectReceiver=g;function b(E){h(E),g(E)}c.disconnectAll=b;function C(E,x){let u=P.get(E.sender);if(!(!u||u.length===0))for(let d=0,m=u.length;d<m;++d){let w=u[d];w.signal===E&&$(w,x)}}c.emit=C;let P=new WeakMap,O=new WeakMap,I=new Set,N=(()=>typeof requestAnimationFrame=="function"?requestAnimationFrame:setImmediate)();function V(E,x,u,d){return e.find(E,m=>m.signal===x&&m.slot===u&&m.thisArg===d)}function $(E,x){let{signal:u,slot:d,thisArg:m}=E;try{d.call(m,u.sender,x)}catch(w){c.exceptionHandler(w)}}function j(E){I.size===0&&N(J),I.add(E)}function J(){I.forEach(X),I.clear()}function X(E){e.ArrayExt.removeAllWhere(E,H)}function H(E){return E.signal===null}})(s||(s={})),n.Signal=i,n.Stream=r})});var yt=F((Bn,Nl)=>{(function(n,e){typeof Bn=="object"&&typeof Nl<"u"?e(Bn,kr(),Ll()):typeof define=="function"&&define.amd?define(["exports","@lumino/coreutils","@lumino/signaling"],e):(n=typeof globalThis<"u"?globalThis:n||self,e(n.lumino_polling={},n.lumino_coreutils,n.lumino_signaling))})(Bn,function(n,e,t){"use strict";class i{constructor(p){var h;this._disposed=new t.Signal(this),this._lingered=0,this._tick=new e.PromiseDelegate,this._ticked=new t.Signal(this),this._factory=p.factory,this._linger=(h=p.linger)!==null&&h!==void 0?h:r.DEFAULT_LINGER,this._standby=p.standby||r.DEFAULT_STANDBY,this._state={...r.DEFAULT_STATE,timestamp:new Date().getTime()};let g=p.frequency||{},b=Math.max(g.interval||0,g.max||0,r.DEFAULT_FREQUENCY.max);this.frequency={...r.DEFAULT_FREQUENCY,...g,max:b},this.name=p.name||r.DEFAULT_NAME,(!("auto"in p)||p.auto)&&setTimeout(()=>this.start())}get disposed(){return this._disposed}get frequency(){return this._frequency}set frequency(p){if(this.isDisposed||e.JSONExt.deepEqual(p,this.frequency||{}))return;let{backoff:h,interval:g,max:b}=p;if(g=Math.round(g),b=Math.round(b),typeof h=="number"&&h<1)throw new Error("Poll backoff growth factor must be at least 1");if((g<0||g>b)&&g!==i.NEVER)throw new Error("Poll interval must be between 0 and max");if(b>i.MAX_INTERVAL&&b!==i.NEVER)throw new Error(`Max interval must be less than ${i.MAX_INTERVAL}`);this._frequency={backoff:h,interval:g,max:b}}get isDisposed(){return this.state.phase==="disposed"}get standby(){return this._standby}set standby(p){this.isDisposed||this.standby===p||(this._standby=p)}get state(){return this._state}get tick(){return this._tick.promise}get ticked(){return this._ticked}async*[Symbol.asyncIterator](){for(;!this.isDisposed;)yield this.state,await this.tick.catch(()=>{})}dispose(){this.isDisposed||(this._state={...r.DISPOSED_STATE,timestamp:new Date().getTime()},this._tick.promise.catch(p=>{}),this._tick.reject(new Error(`Poll (${this.name}) is disposed.`)),this._disposed.emit(void 0),t.Signal.clearData(this))}refresh(){return this.schedule({cancel:({phase:p})=>p==="refreshed",interval:i.IMMEDIATE,phase:"refreshed"})}async schedule(p={}){if(this.isDisposed||p.cancel&&p.cancel(this.state))return;let h=this._tick,g=new e.PromiseDelegate,b={interval:this.frequency.interval,payload:null,phase:"standby",timestamp:new Date().getTime(),...p};if(this._state=b,this._tick=g,clearTimeout(this._timeout),this._ticked.emit(this.state),h.resolve(this),await h.promise,b.interval===i.NEVER){this._timeout=void 0;return}let C=()=>{this.isDisposed||this.tick!==g.promise||this._execute()};this._timeout=setTimeout(C,b.interval)}start(){return this.schedule({cancel:({phase:p})=>p!=="constructed"&&p!=="standby"&&p!=="stopped",interval:i.IMMEDIATE,phase:"started"})}stop(){return this.schedule({cancel:({phase:p})=>p==="stopped",interval:i.NEVER,phase:"stopped"})}get hidden(){return r.hidden}_execute(){let p=typeof this.standby=="function"?this.standby():this.standby;if(p==="never"?p=!1:p==="when-hidden"&&(this.hidden?p=++this._lingered>this._linger:(this._lingered=0,p=!1)),p){this.schedule();return}let h=this.tick;this._factory(this.state).then(g=>{this.isDisposed||this.tick!==h||this.schedule({payload:g,phase:this.state.phase==="rejected"?"reconnected":"resolved"})}).catch(g=>{this.isDisposed||this.tick!==h||this.schedule({interval:r.sleep(this.frequency,this.state),payload:g,phase:"rejected"})})}}(function(v){v.IMMEDIATE=0,v.MAX_INTERVAL=2147483647,v.NEVER=1/0})(i||(i={}));var r;(function(v){v.DEFAULT_BACKOFF=3,v.DEFAULT_FREQUENCY={backoff:!0,interval:1e3,max:30*1e3},v.DEFAULT_LINGER=1,v.DEFAULT_NAME="unknown",v.DEFAULT_STANDBY="when-hidden",v.DEFAULT_STATE={interval:i.NEVER,payload:null,phase:"constructed",timestamp:new Date(0).getTime()},v.DISPOSED_STATE={interval:i.NEVER,payload:null,phase:"disposed",timestamp:new Date(0).getTime()};function p(g,b){let{backoff:C,interval:P,max:O}=g;if(P===i.NEVER)return P;let I=C===!0?v.DEFAULT_BACKOFF:C===!1?1:C,N=h(P,b.interval*I);return Math.min(O,N)}v.sleep=p,v.hidden=(()=>typeof document>"u"?!1:(document.addEventListener("visibilitychange",()=>{v.hidden=document.visibilityState==="hidden"}),document.addEventListener("pagehide",()=>{v.hidden=document.visibilityState==="hidden"}),document.visibilityState==="hidden"))();function h(g,b){return g=Math.ceil(g),b=Math.floor(b),Math.floor(Math.random()*(b-g+1))+g}})(r||(r={}));class s{constructor(p,h=500){this.args=void 0,this.payload=null,this.limit=h,this.poll=new i({auto:!1,factory:async()=>{let{args:g}=this;return this.args=void 0,p(...g)},frequency:{backoff:!1,interval:i.NEVER,max:i.NEVER},standby:"never"}),this.payload=new e.PromiseDelegate,this.poll.ticked.connect((g,b)=>{let{payload:C}=this;if(b.phase==="resolved"){this.payload=new e.PromiseDelegate,C.resolve(b.payload);return}if(b.phase==="rejected"||b.phase==="stopped"){this.payload=new e.PromiseDelegate,C.promise.catch(P=>{}),C.reject(b.payload);return}},this)}get isDisposed(){return this.payload===null}dispose(){this.isDisposed||(this.args=void 0,this.payload=null,this.poll.dispose())}async stop(){return this.poll.stop()}}class c extends s{invoke(...p){return this.args=p,this.poll.schedule({interval:this.limit,phase:"invoked"}),this.payload.promise}}class f extends s{constructor(p,h){super(p,typeof h=="number"?h:h&&h.limit),this._trailing=!1,typeof h!="number"&&h&&h.edge==="trailing"&&(this._trailing=!0),this._interval=this._trailing?this.limit:i.IMMEDIATE}invoke(...p){let h=this.poll.state.phase!=="invoked";return(h||this._trailing)&&(this.args=p),h&&this.poll.schedule({interval:this._interval,phase:"invoked"}),this.payload.promise}}n.Debouncer=c,n.Poll=i,n.RateLimiter=s,n.Throttler=f})});var jr=F(Vn=>{"use strict";Object.defineProperty(Vn,"__esModule",{value:!0});Vn.EventManager=void 0;var Al=ue(),Sf=yt(),Fl=Oe(),Bl=ge(),Vl="api/events",qr=class{constructor(e={}){var t;this._socket=null,this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:Bl.ServerConnection.makeSettings(),this._poll=new Sf.Poll({factory:()=>this._subscribe()}),this._stream=new Fl.Stream(this),this._poll.start()}get isDisposed(){return this._poll.isDisposed}get stream(){return this._stream}dispose(){if(this.isDisposed)return;this._poll.dispose();let e=this._socket;e&&(this._socket=null,e.onopen=()=>{},e.onerror=()=>{},e.onmessage=()=>{},e.onclose=()=>{},e.close()),Fl.Signal.clearData(this),this._stream.stop()}async emit(e){let{serverSettings:t}=this,{baseUrl:i}=t,{makeRequest:r,ResponseError:s}=Bl.ServerConnection,c=Al.URLExt.join(i,Vl),f={body:JSON.stringify(e),method:"POST"},v=await r(c,f,t);if(v.status!==204)throw new s(v)}_subscribe(){return new Promise((e,t)=>{if(this.isDisposed)return;let{appendToken:i,token:r,WebSocket:s,wsUrl:c}=this.serverSettings,f=Al.URLExt.join(c,Vl,"subscribe");i&&r!==""&&(f+=`?token=${encodeURIComponent(r)}`);let v=this._socket=new s(f),p=this._stream;v.onclose=()=>t(new Error("EventManager socket closed")),v.onmessage=h=>h.data&&p.emit(JSON.parse(h.data))})}};Vn.EventManager=qr});var $l=F(Wl=>{"use strict";Object.defineProperty(Wl,"__esModule",{value:!0})});var Wn=F(ct=>{"use strict";Object.defineProperty(ct,"__esModule",{value:!0});ct.validateModels=ct.validateModel=ct.validateMessage=void 0;var wt=zt(),Kl=["username","version","session","msg_id","msg_type"],bf={stream:{name:"string",text:"string"},display_data:{data:"object",metadata:"object"},execute_input:{code:"string",execution_count:"number"},execute_result:{execution_count:"number",data:"object",metadata:"object"},error:{ename:"string",evalue:"string",traceback:"object"},status:{execution_state:["string",["starting","idle","busy","restarting","dead"]]},clear_output:{wait:"boolean"},comm_open:{comm_id:"string",target_name:"string",data:"object"},comm_msg:{comm_id:"string",data:"object"},comm_close:{comm_id:"string"},shutdown_reply:{restart:"boolean"}};function Mf(n){for(let e=0;e<Kl.length;e++)(0,wt.validateProperty)(n,Kl[e],"string")}function Cf(n){(0,wt.validateProperty)(n,"metadata","object"),(0,wt.validateProperty)(n,"content","object"),(0,wt.validateProperty)(n,"channel","string"),Mf(n.header),n.channel==="iopub"&&Pf(n)}ct.validateMessage=Cf;function Pf(n){if(n.channel==="iopub"){let e=bf[n.header.msg_type];if(e===void 0)return;let t=Object.keys(e),i=n.content;for(let r=0;r<t.length;r++){let s=e[t[r]];Array.isArray(s)||(s=[s]),(0,wt.validateProperty)(i,t[r],...s)}}}function zl(n){(0,wt.validateProperty)(n,"name","string"),(0,wt.validateProperty)(n,"id","string")}ct.validateModel=zl;function Ef(n){if(!Array.isArray(n))throw new Error("Invalid kernel list");n.forEach(e=>zl(e))}ct.validateModels=Ef});var Kn=F(te=>{"use strict";Object.defineProperty(te,"__esModule",{value:!0});te.getKernelModel=te.shutdownKernel=te.interruptKernel=te.restartKernel=te.startNew=te.listRunning=te.KERNEL_SERVICE_URL=void 0;var le=ge(),kt=ue(),$n=Wn();te.KERNEL_SERVICE_URL="api/kernels";async function Of(n=le.ServerConnection.makeSettings()){let e=kt.URLExt.join(n.baseUrl,te.KERNEL_SERVICE_URL),t=await le.ServerConnection.makeRequest(e,{},n);if(t.status!==200)throw await le.ServerConnection.ResponseError.create(t);let i=await t.json();return(0,$n.validateModels)(i),i}te.listRunning=Of;async function Rf(n={},e=le.ServerConnection.makeSettings()){let t=kt.URLExt.join(e.baseUrl,te.KERNEL_SERVICE_URL),i={method:"POST",body:JSON.stringify(n)},r=await le.ServerConnection.makeRequest(t,i,e);if(r.status!==201)throw await le.ServerConnection.ResponseError.create(r);let s=await r.json();return(0,$n.validateModel)(s),s}te.startNew=Rf;async function Df(n,e=le.ServerConnection.makeSettings()){let t=kt.URLExt.join(e.baseUrl,te.KERNEL_SERVICE_URL,encodeURIComponent(n),"restart"),i={method:"POST"},r=await le.ServerConnection.makeRequest(t,i,e);if(r.status!==200)throw await le.ServerConnection.ResponseError.create(r);let s=await r.json();(0,$n.validateModel)(s)}te.restartKernel=Df;async function xf(n,e=le.ServerConnection.makeSettings()){let t=kt.URLExt.join(e.baseUrl,te.KERNEL_SERVICE_URL,encodeURIComponent(n),"interrupt"),i={method:"POST"},r=await le.ServerConnection.makeRequest(t,i,e);if(r.status!==204)throw await le.ServerConnection.ResponseError.create(r)}te.interruptKernel=xf;async function kf(n,e=le.ServerConnection.makeSettings()){let t=kt.URLExt.join(e.baseUrl,te.KERNEL_SERVICE_URL,encodeURIComponent(n)),i={method:"DELETE"},r=await le.ServerConnection.makeRequest(t,i,e);if(r.status===404){let s=`The kernel "${n}" does not exist on the server`;console.warn(s)}else if(r.status!==204)throw await le.ServerConnection.ResponseError.create(r)}te.shutdownKernel=kf;async function qf(n,e=le.ServerConnection.makeSettings()){let t=kt.URLExt.join(e.baseUrl,te.KERNEL_SERVICE_URL,encodeURIComponent(n)),i=await le.ServerConnection.makeRequest(t,{},e);if(i.status===404)return;if(i.status!==200)throw await le.ServerConnection.ResponseError.create(i);let r=await i.json();return(0,$n.validateModel)(r),r}te.getKernelModel=qf});var Gl=F(Gt=>{"use strict";Object.defineProperty(Gt,"__esModule",{value:!0});Gt.KernelManager=void 0;var jf=yt(),Hl=Oe(),Tf=at(),If=vt(),zn=Kn(),Uf=Tr(),Ht=class extends If.BaseManager{constructor(e={}){var t;super(e),this._isReady=!1,this._kernelConnections=new Set,this._models=new Map,this._runningChanged=new Hl.Signal(this),this._connectionFailure=new Hl.Signal(this),this._pollModels=new jf.Poll({auto:!1,factory:()=>this.requestRunning(),frequency:{interval:10*1e3,backoff:!0,max:300*1e3},name:"@jupyterlab/services:KernelManager#models",standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"}),this._ready=(async()=>{await this._pollModels.start(),await this._pollModels.tick,this._isReady=!0})()}get isReady(){return this._isReady}get ready(){return this._ready}get runningChanged(){return this._runningChanged}get connectionFailure(){return this._connectionFailure}dispose(){this.isDisposed||(this._models.clear(),this._kernelConnections.forEach(e=>e.dispose()),this._pollModels.dispose(),super.dispose())}connectTo(e){var t;let{id:i}=e.model,r=(t=e.handleComms)!==null&&t!==void 0?t:!0;if(e.handleComms===void 0){for(let c of this._kernelConnections)if(c.id===i&&c.handleComms){r=!1;break}}let s=new Uf.KernelConnection({handleComms:r,...e,serverSettings:this.serverSettings});return this._onStarted(s),this._models.has(i)||this.refreshRunning().catch(()=>{}),s}running(){return this._models.values()}async refreshRunning(){await this._pollModels.refresh(),await this._pollModels.tick}async startNew(e={},t={}){let i=await(0,zn.startNew)(e,this.serverSettings);return this.connectTo({...t,model:i})}async shutdown(e){await(0,zn.shutdownKernel)(e,this.serverSettings),await this.refreshRunning()}async shutdownAll(){await this.refreshRunning(),await Promise.all([...this._models.keys()].map(e=>(0,zn.shutdownKernel)(e,this.serverSettings))),await this.refreshRunning()}async findById(e){return this._models.has(e)?this._models.get(e):(await this.refreshRunning(),this._models.get(e))}async requestRunning(){var e,t;let i;try{i=await(0,zn.listRunning)(this.serverSettings)}catch(r){throw(r instanceof Tf.ServerConnection.NetworkError||((e=r.response)===null||e===void 0?void 0:e.status)===503||((t=r.response)===null||t===void 0?void 0:t.status)===424)&&this._connectionFailure.emit(r),r}this.isDisposed||this._models.size===i.length&&i.every(r=>{let s=this._models.get(r.id);return s?s.connections===r.connections&&s.execution_state===r.execution_state&&s.last_activity===r.last_activity&&s.name===r.name&&s.reason===r.reason&&s.traceback===r.traceback:!1})||(this._models=new Map(i.map(r=>[r.id,r])),this._kernelConnections.forEach(r=>{this._models.has(r.id)||r.handleShutdown()}),this._runningChanged.emit(i))}_onStarted(e){this._kernelConnections.add(e),e.statusChanged.connect(this._onStatusChanged,this),e.disposed.connect(this._onDisposed,this)}_onDisposed(e){this._kernelConnections.delete(e),this.refreshRunning().catch(()=>{})}_onStatusChanged(e,t){t==="dead"&&this.refreshRunning().catch(()=>{})}};Gt.KernelManager=Ht;(function(n){class e extends n{constructor(){super(...arguments),this._readyPromise=new Promise(()=>{})}get isActive(){return!1}get parentReady(){return super.ready}async startNew(i={},r={}){return Promise.reject(new Error("Not implemented in no-op Kernel Manager"))}connectTo(i){throw new Error("Not implemented in no-op Kernel Manager")}async shutdown(i){return Promise.reject(new Error("Not implemented in no-op Kernel Manager"))}get ready(){return this.parentReady.then(()=>this._readyPromise)}async requestRunning(){return Promise.resolve()}}n.NoopManager=e})(Ht||(Gt.KernelManager=Ht={}))});var Ur=F(se=>{"use strict";var Jl=se&&se.__createBinding||(Object.create?function(n,e,t,i){i===void 0&&(i=t);var r=Object.getOwnPropertyDescriptor(e,t);(!r||("get"in r?!e.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,i,r)}:function(n,e,t,i){i===void 0&&(i=t),n[i]=e[t]}),Lf=se&&se.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),Ir=se&&se.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.prototype.hasOwnProperty.call(n,t)&&Jl(e,n,t);return Lf(e,n),e},Nf=se&&se.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Jl(e,n,t)};Object.defineProperty(se,"__esModule",{value:!0});se.KernelConnection=se.KernelAPI=se.KernelMessage=se.Kernel=void 0;var Af=Ir($l());se.Kernel=Af;var Ff=Ir(Pt());se.KernelMessage=Ff;var Bf=Ir(Kn());se.KernelAPI=Bf;var Vf=Tr();Object.defineProperty(se,"KernelConnection",{enumerable:!0,get:function(){return Vf.KernelConnection}});Nf(Gl(),se)});var Xl=F(Yl=>{"use strict";Object.defineProperty(Yl,"__esModule",{value:!0})});var Ql=F(qt=>{"use strict";Object.defineProperty(qt,"__esModule",{value:!0});qt.validateSpecModels=qt.validateSpecModel=void 0;var St=zt();function Zl(n){let e=n.spec;if(!e)throw new Error("Invalid kernel spec");(0,St.validateProperty)(n,"name","string"),(0,St.validateProperty)(n,"resources","object"),(0,St.validateProperty)(e,"language","string"),(0,St.validateProperty)(e,"display_name","string"),(0,St.validateProperty)(e,"argv","array");let t=null;e.hasOwnProperty("metadata")&&((0,St.validateProperty)(e,"metadata","object"),t=e.metadata);let i=null;return e.hasOwnProperty("env")&&((0,St.validateProperty)(e,"env","object"),i=e.env),{name:n.name,resources:n.resources,language:e.language,display_name:e.display_name,argv:e.argv,metadata:t,env:i}}qt.validateSpecModel=Zl;function Wf(n){if(!n.hasOwnProperty("kernelspecs"))throw new Error("No kernelspecs found");let e=Object.keys(n.kernelspecs),t=Object.create(null),i=n.default;for(let r=0;r<e.length;r++){let s=n.kernelspecs[e[r]];try{t[e[r]]=Zl(s)}catch{console.warn(`Removing errant kernel spec: ${e[r]}`)}}if(e=Object.keys(t),!e.length)throw new Error("No valid kernelspecs found");return(!i||typeof i!="string"||!(i in t))&&(i=e[0],console.warn(`Default kernel not found, using '${e[0]}'`)),{default:i,kernelspecs:t}}qt.validateSpecModels=Wf});var Nr=F(Hn=>{"use strict";Object.defineProperty(Hn,"__esModule",{value:!0});Hn.getSpecs=void 0;var Lr=ge(),$f=Ql(),Kf=ue(),zf="api/kernelspecs";async function Hf(n=Lr.ServerConnection.makeSettings()){let e=Kf.URLExt.join(n.baseUrl,zf),t=await Lr.ServerConnection.makeRequest(e,{},n);if(t.status!==200)throw await Lr.ServerConnection.ResponseError.create(t);let i=await t.json();return(0,$f.validateSpecModels)(i)}Hn.getSpecs=Hf});var ta=F(Fe=>{"use strict";var Gf=Fe&&Fe.__createBinding||(Object.create?function(n,e,t,i){i===void 0&&(i=t);var r=Object.getOwnPropertyDescriptor(e,t);(!r||("get"in r?!e.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,i,r)}:function(n,e,t,i){i===void 0&&(i=t),n[i]=e[t]}),Jf=Fe&&Fe.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),Yf=Fe&&Fe.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.prototype.hasOwnProperty.call(n,t)&&Gf(e,n,t);return Jf(e,n),e};Object.defineProperty(Fe,"__esModule",{value:!0});Fe.KernelSpecManager=void 0;var Xf=Ue(),Zf=yt(),ea=Oe(),Qf=Yf(Nr()),eh=vt(),Ar=class extends eh.BaseManager{constructor(e={}){var t;super(e),this._isReady=!1,this._connectionFailure=new ea.Signal(this),this._specs=null,this._specsChanged=new ea.Signal(this),this._ready=Promise.all([this.requestSpecs()]).then(i=>{}).catch(i=>{}).then(()=>{this.isDisposed||(this._isReady=!0)}),this._pollSpecs=new Zf.Poll({auto:!1,factory:()=>this.requestSpecs(),frequency:{interval:61*1e3,backoff:!0,max:300*1e3},name:"@jupyterlab/services:KernelSpecManager#specs",standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"}),this.ready.then(()=>{this._pollSpecs.start()})}get isReady(){return this._isReady}get ready(){return this._ready}get specs(){return this._specs}get specsChanged(){return this._specsChanged}get connectionFailure(){return this._connectionFailure}dispose(){this._pollSpecs.dispose(),super.dispose()}async refreshSpecs(){await this._pollSpecs.refresh(),await this._pollSpecs.tick}async requestSpecs(){let e=await Qf.getSpecs(this.serverSettings);this.isDisposed||Xf.JSONExt.deepEqual(e,this._specs)||(this._specs=e,this._specsChanged.emit(e))}};Fe.KernelSpecManager=Ar});var Gn=F(me=>{"use strict";var na=me&&me.__createBinding||(Object.create?function(n,e,t,i){i===void 0&&(i=t);var r=Object.getOwnPropertyDescriptor(e,t);(!r||("get"in r?!e.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,i,r)}:function(n,e,t,i){i===void 0&&(i=t),n[i]=e[t]}),th=me&&me.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),ia=me&&me.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.prototype.hasOwnProperty.call(n,t)&&na(e,n,t);return th(e,n),e},nh=me&&me.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&na(e,n,t)};Object.defineProperty(me,"__esModule",{value:!0});me.KernelSpecAPI=me.KernelSpec=void 0;var ih=ia(Xl());me.KernelSpec=ih;var rh=ia(Nr());me.KernelSpecAPI=rh;nh(ta(),me)});var ra=F(Jn=>{"use strict";Object.defineProperty(Jn,"__esModule",{value:!0});Jn.BuildManager=void 0;var Fr=ue(),ut=ge(),sh="api/build",Br=class{constructor(e={}){var t;this._url="",this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:ut.ServerConnection.makeSettings();let{baseUrl:i,appUrl:r}=this.serverSettings;this._url=Fr.URLExt.join(i,r,sh)}get isAvailable(){return Fr.PageConfig.getOption("buildAvailable").toLowerCase()==="true"}get shouldCheck(){return Fr.PageConfig.getOption("buildCheck").toLowerCase()==="true"}getStatus(){let{_url:e,serverSettings:t}=this;return ut.ServerConnection.makeRequest(e,{},t).then(r=>{if(r.status!==200)throw new ut.ServerConnection.ResponseError(r);return r.json()}).then(r=>{if(typeof r.status!="string")throw new Error("Invalid data");if(typeof r.message!="string")throw new Error("Invalid data");return r})}build(){let{_url:e,serverSettings:t}=this,i={method:"POST"};return ut.ServerConnection.makeRequest(e,i,t).then(s=>{if(s.status===400)throw new ut.ServerConnection.ResponseError(s,"Build aborted");if(s.status!==200){let c=`Build failed with ${s.status}.

        If you are experiencing the build failure after installing an extension (or trying to include previously installed extension after updating JupyterLab) please check the extension repository for new installation instructions as many extensions migrated to the prebuilt extensions system which no longer requires rebuilding JupyterLab (but uses a different installation procedure, typically involving a package manager such as 'pip' or 'conda').

        If you specifically intended to install a source extension, please run 'jupyter lab build' on the server for full output.`;throw new ut.ServerConnection.ResponseError(s,c)}})}cancel(){let{_url:e,serverSettings:t}=this,i={method:"DELETE"};return ut.ServerConnection.makeRequest(e,i,t).then(s=>{if(s.status!==204)throw new ut.ServerConnection.ResponseError(s)})}};Jn.BuildManager=Br});var $r=F(Yn=>{"use strict";Object.defineProperty(Yn,"__esModule",{value:!0});Yn.NbConvertManager=void 0;var oh=ue(),Vr=ge(),lh=Ue(),ah="api/nbconvert",Wr=class{constructor(e={}){var t;this._exportFormats=null,this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:Vr.ServerConnection.makeSettings()}async fetchExportFormats(){this._requestingFormats=new lh.PromiseDelegate,this._exportFormats=null;let e=this.serverSettings.baseUrl,t=oh.URLExt.join(e,ah),{serverSettings:i}=this,r=await Vr.ServerConnection.makeRequest(t,{},i);if(r.status!==200)throw await Vr.ServerConnection.ResponseError.create(r);let s=await r.json(),c={};return Object.keys(s).forEach(function(v){let p=s[v].output_mimetype;c[v]={output_mimetype:p}}),this._exportFormats=c,this._requestingFormats.resolve(c),c}async getExportFormats(e=!0){return this._requestingFormats?this._requestingFormats.promise:e||!this._exportFormats?await this.fetchExportFormats():this._exportFormats}};Yn.NbConvertManager=Wr});var oa=F(sa=>{"use strict";Object.defineProperty(sa,"__esModule",{value:!0})});var aa=F(ft=>{"use strict";Object.defineProperty(ft,"__esModule",{value:!0});ft.validateModels=ft.updateLegacySessionModel=ft.validateModel=void 0;var ch=Wn(),Jt=zt();function la(n){(0,Jt.validateProperty)(n,"id","string"),(0,Jt.validateProperty)(n,"type","string"),(0,Jt.validateProperty)(n,"name","string"),(0,Jt.validateProperty)(n,"path","string"),(0,Jt.validateProperty)(n,"kernel","object"),(0,ch.validateModel)(n.kernel)}ft.validateModel=la;function uh(n){n.path===void 0&&n.notebook!==void 0&&(n.path=n.notebook.path,n.type="notebook",n.name="")}ft.updateLegacySessionModel=uh;function fh(n){if(!Array.isArray(n))throw new Error("Invalid session list");n.forEach(e=>la(e))}ft.validateModels=fh});var Qn=F(oe=>{"use strict";Object.defineProperty(oe,"__esModule",{value:!0});oe.updateSession=oe.startSession=oe.getSessionModel=oe.shutdownSession=oe.getSessionUrl=oe.listRunning=oe.SESSION_SERVICE_URL=void 0;var he=ge(),Xn=ue(),ht=aa();oe.SESSION_SERVICE_URL="api/sessions";async function hh(n=he.ServerConnection.makeSettings()){let e=Xn.URLExt.join(n.baseUrl,oe.SESSION_SERVICE_URL),t=await he.ServerConnection.makeRequest(e,{},n);if(t.status!==200)throw await he.ServerConnection.ResponseError.create(t);let i=await t.json();if(!Array.isArray(i))throw new Error("Invalid Session list");return i.forEach(r=>{(0,ht.updateLegacySessionModel)(r),(0,ht.validateModel)(r)}),i}oe.listRunning=hh;function Zn(n,e){let t=Xn.URLExt.join(n,oe.SESSION_SERVICE_URL),i=Xn.URLExt.join(t,e);if(!i.startsWith(t))throw new Error("Can only be used for services requests");return i}oe.getSessionUrl=Zn;async function dh(n,e=he.ServerConnection.makeSettings()){var t;let i=Zn(e.baseUrl,n),r={method:"DELETE"},s=await he.ServerConnection.makeRequest(i,r,e);if(s.status===404){let f=(t=(await s.json()).message)!==null&&t!==void 0?t:`The session "${n}"" does not exist on the server`;console.warn(f)}else{if(s.status===410)throw new he.ServerConnection.ResponseError(s,"The kernel was deleted but the session was not");if(s.status!==204)throw await he.ServerConnection.ResponseError.create(s)}}oe.shutdownSession=dh;async function _h(n,e=he.ServerConnection.makeSettings()){let t=Zn(e.baseUrl,n),i=await he.ServerConnection.makeRequest(t,{},e);if(i.status!==200)throw await he.ServerConnection.ResponseError.create(i);let r=await i.json();return(0,ht.updateLegacySessionModel)(r),(0,ht.validateModel)(r),r}oe.getSessionModel=_h;async function gh(n,e=he.ServerConnection.makeSettings()){let t=Xn.URLExt.join(e.baseUrl,oe.SESSION_SERVICE_URL),i={method:"POST",body:JSON.stringify(n)},r=await he.ServerConnection.makeRequest(t,i,e);if(r.status!==201)throw await he.ServerConnection.ResponseError.create(r);let s=await r.json();return(0,ht.updateLegacySessionModel)(s),(0,ht.validateModel)(s),s}oe.startSession=gh;async function ph(n,e=he.ServerConnection.makeSettings()){let t=Zn(e.baseUrl,n.id),i={method:"PATCH",body:JSON.stringify(n)},r=await he.ServerConnection.makeRequest(t,i,e);if(r.status!==200)throw await he.ServerConnection.ResponseError.create(r);let s=await r.json();return(0,ht.updateLegacySessionModel)(s),(0,ht.validateModel)(s),s}oe.updateSession=ph});var ua=F(ei=>{"use strict";Object.defineProperty(ei,"__esModule",{value:!0});ei.SessionConnection=void 0;var Be=Oe(),mh=at(),ca=Qn(),vh=Ue(),Kr=class{constructor(e){var t,i,r,s;this._id="",this._path="",this._name="",this._type="",this._kernel=null,this._isDisposed=!1,this._disposed=new Be.Signal(this),this._kernelChanged=new Be.Signal(this),this._statusChanged=new Be.Signal(this),this._connectionStatusChanged=new Be.Signal(this),this._pendingInput=new Be.Signal(this),this._iopubMessage=new Be.Signal(this),this._unhandledMessage=new Be.Signal(this),this._anyMessage=new Be.Signal(this),this._propertyChanged=new Be.Signal(this),this._id=e.model.id,this._name=e.model.name,this._path=e.model.path,this._type=e.model.type,this._username=(t=e.username)!==null&&t!==void 0?t:"",this._clientId=(i=e.clientId)!==null&&i!==void 0?i:vh.UUID.uuid4(),this._connectToKernel=e.connectToKernel,this._kernelConnectionOptions=(r=e.kernelConnectionOptions)!==null&&r!==void 0?r:{},this.serverSettings=(s=e.serverSettings)!==null&&s!==void 0?s:mh.ServerConnection.makeSettings(),this.setupKernel(e.model.kernel)}get disposed(){return this._disposed}get kernelChanged(){return this._kernelChanged}get statusChanged(){return this._statusChanged}get connectionStatusChanged(){return this._connectionStatusChanged}get pendingInput(){return this._pendingInput}get iopubMessage(){return this._iopubMessage}get unhandledMessage(){return this._unhandledMessage}get anyMessage(){return this._anyMessage}get propertyChanged(){return this._propertyChanged}get id(){return this._id}get kernel(){return this._kernel}get path(){return this._path}get type(){return this._type}get name(){return this._name}get model(){return{id:this.id,kernel:this.kernel&&{id:this.kernel.id,name:this.kernel.name},path:this._path,type:this._type,name:this._name}}get isDisposed(){return this._isDisposed}update(e){let t=this.model;if(this._path=e.path,this._name=e.name,this._type=e.type,this._kernel===null&&e.kernel!==null||this._kernel!==null&&e.kernel===null||this._kernel!==null&&e.kernel!==null&&this._kernel.id!==e.kernel.id){this._kernel!==null&&this._kernel.dispose();let i=this._kernel||null;this.setupKernel(e.kernel);let r=this._kernel||null;this._kernelChanged.emit({name:"kernel",oldValue:i,newValue:r})}this._handleModelChange(t)}dispose(){if(!this.isDisposed){if(this._isDisposed=!0,this._disposed.emit(),this._kernel){this._kernel.dispose();let e=this._kernel;this._kernel=null;let t=this._kernel;this._kernelChanged.emit({name:"kernel",oldValue:e,newValue:t})}Be.Signal.clearData(this)}}async setPath(e){if(this.isDisposed)throw new Error("Session is disposed");await this._patch({path:e})}async setName(e){if(this.isDisposed)throw new Error("Session is disposed");await this._patch({name:e})}async setType(e){if(this.isDisposed)throw new Error("Session is disposed");await this._patch({type:e})}async changeKernel(e){if(this.isDisposed)throw new Error("Session is disposed");return await this._patch({kernel:e}),this.kernel}async shutdown(){if(this.isDisposed)throw new Error("Session is disposed");await(0,ca.shutdownSession)(this.id,this.serverSettings),this.dispose()}setupKernel(e){if(e===null){this._kernel=null;return}let t=this._connectToKernel({...this._kernelConnectionOptions,model:e,username:this._username,clientId:this._clientId,serverSettings:this.serverSettings});this._kernel=t,t.statusChanged.connect(this.onKernelStatus,this),t.connectionStatusChanged.connect(this.onKernelConnectionStatus,this),t.pendingInput.connect(this.onPendingInput,this),t.unhandledMessage.connect(this.onUnhandledMessage,this),t.iopubMessage.connect(this.onIOPubMessage,this),t.anyMessage.connect(this.onAnyMessage,this)}onKernelStatus(e,t){this._statusChanged.emit(t)}onKernelConnectionStatus(e,t){this._connectionStatusChanged.emit(t)}onPendingInput(e,t){this._pendingInput.emit(t)}onIOPubMessage(e,t){this._iopubMessage.emit(t)}onUnhandledMessage(e,t){this._unhandledMessage.emit(t)}onAnyMessage(e,t){this._anyMessage.emit(t)}async _patch(e){let t=await(0,ca.updateSession)({...e,id:this._id},this.serverSettings);return this.update(t),t}_handleModelChange(e){e.name!==this._name&&this._propertyChanged.emit("name"),e.type!==this._type&&this._propertyChanged.emit("type"),e.path!==this._path&&this._propertyChanged.emit("path")}};ei.SessionConnection=Kr});var ha=F(Zt=>{"use strict";Object.defineProperty(Zt,"__esModule",{value:!0});Zt.SessionManager=void 0;var yh=yt(),fa=Oe(),wh=ge(),Sh=vt(),bh=ua(),Yt=Qn(),Xt=class extends Sh.BaseManager{constructor(e){var t;super(e),this._isReady=!1,this._sessionConnections=new Set,this._models=new Map,this._runningChanged=new fa.Signal(this),this._connectionFailure=new fa.Signal(this),this._connectToKernel=i=>this._kernelManager.connectTo(i),this._kernelManager=e.kernelManager,this._pollModels=new yh.Poll({auto:!1,factory:()=>this.requestRunning(),frequency:{interval:10*1e3,backoff:!0,max:300*1e3},name:"@jupyterlab/services:SessionManager#models",standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"}),this._ready=(async()=>{await this._pollModels.start(),await this._pollModels.tick,this._kernelManager.isActive&&await this._kernelManager.ready,this._isReady=!0})()}get isReady(){return this._isReady}get ready(){return this._ready}get runningChanged(){return this._runningChanged}get connectionFailure(){return this._connectionFailure}dispose(){this.isDisposed||(this._models.clear(),this._sessionConnections.forEach(e=>e.dispose()),this._pollModels.dispose(),super.dispose())}connectTo(e){let t=new bh.SessionConnection({...e,connectToKernel:this._connectToKernel,serverSettings:this.serverSettings});return this._onStarted(t),this._models.has(e.model.id)||this.refreshRunning().catch(()=>{}),t}running(){return this._models.values()}async refreshRunning(){await this._pollModels.refresh(),await this._pollModels.tick}async startNew(e,t={}){let i=await(0,Yt.startSession)(e,this.serverSettings);return await this.refreshRunning(),this.connectTo({...t,model:i})}async shutdown(e){await(0,Yt.shutdownSession)(e,this.serverSettings),await this.refreshRunning()}async shutdownAll(){await this.refreshRunning(),await Promise.all([...this._models.keys()].map(e=>(0,Yt.shutdownSession)(e,this.serverSettings))),await this.refreshRunning()}async stopIfNeeded(e){try{let i=(await(0,Yt.listRunning)(this.serverSettings)).filter(r=>r.path===e);if(i.length===1){let r=i[0].id;await this.shutdown(r)}}catch{}}async findById(e){return this._models.has(e)?this._models.get(e):(await this.refreshRunning(),this._models.get(e))}async findByPath(e){for(let t of this._models.values())if(t.path===e)return t;await this.refreshRunning();for(let t of this._models.values())if(t.path===e)return t}async requestRunning(){var e,t;let i;try{i=await(0,Yt.listRunning)(this.serverSettings)}catch(r){throw(r instanceof wh.ServerConnection.NetworkError||((e=r.response)===null||e===void 0?void 0:e.status)===503||((t=r.response)===null||t===void 0?void 0:t.status)===424)&&this._connectionFailure.emit(r),r}this.isDisposed||this._models.size===i.length&&i.every(r=>{var s,c,f,v;let p=this._models.get(r.id);return p?((s=p.kernel)===null||s===void 0?void 0:s.id)===((c=r.kernel)===null||c===void 0?void 0:c.id)&&((f=p.kernel)===null||f===void 0?void 0:f.name)===((v=r.kernel)===null||v===void 0?void 0:v.name)&&p.name===r.name&&p.path===r.path&&p.type===r.type:!1})||(this._models=new Map(i.map(r=>[r.id,r])),this._sessionConnections.forEach(r=>{this._models.has(r.id)?r.update(this._models.get(r.id)):r.dispose()}),this._runningChanged.emit(i))}_onStarted(e){this._sessionConnections.add(e),e.disposed.connect(this._onDisposed,this),e.propertyChanged.connect(this._onChanged,this),e.kernelChanged.connect(this._onChanged,this)}_onDisposed(e){this._sessionConnections.delete(e),this.refreshRunning().catch(()=>{})}_onChanged(){this.refreshRunning().catch(()=>{})}};Zt.SessionManager=Xt;(function(n){class e extends n{constructor(){super(...arguments),this._readyPromise=new Promise(()=>{})}get isActive(){return!1}get parentReady(){return super.ready}async startNew(i,r={}){return Promise.reject(new Error("Not implemented in no-op Session Manager"))}connectTo(i){throw Error("Not implemented in no-op Session Manager")}get ready(){return this.parentReady.then(()=>this._readyPromise)}async shutdown(i){return Promise.reject(new Error("Not implemented in no-op Session Manager"))}async requestRunning(){return Promise.resolve()}}n.NoopManager=e})(Xt||(Zt.SessionManager=Xt={}))});var zr=F(ve=>{"use strict";var da=ve&&ve.__createBinding||(Object.create?function(n,e,t,i){i===void 0&&(i=t);var r=Object.getOwnPropertyDescriptor(e,t);(!r||("get"in r?!e.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,i,r)}:function(n,e,t,i){i===void 0&&(i=t),n[i]=e[t]}),Mh=ve&&ve.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),_a=ve&&ve.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.prototype.hasOwnProperty.call(n,t)&&da(e,n,t);return Mh(e,n),e},Ch=ve&&ve.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&da(e,n,t)};Object.defineProperty(ve,"__esModule",{value:!0});ve.SessionAPI=ve.Session=void 0;var Ph=_a(oa());ve.Session=Ph;var Eh=_a(Qn());ve.SessionAPI=Eh;Ch(ha(),ve)});var ga=F(ti=>{"use strict";Object.defineProperty(ti,"__esModule",{value:!0});ti.DataConnector=void 0;var Hr=class{async list(e){throw new Error("DataConnector#list method has not been implemented.")}async remove(e){throw new Error("DataConnector#remove method has not been implemented.")}async save(e,t){throw new Error("DataConnector#save method has not been implemented.")}};ti.DataConnector=Hr});var ma=F(pa=>{"use strict";Object.defineProperty(pa,"__esModule",{value:!0})});var Gr=F((ni,va)=>{(function(n,e){typeof ni=="object"&&typeof va<"u"?e(ni):typeof define=="function"&&define.amd?define(["exports"],e):(n=typeof globalThis<"u"?globalThis:n||self,e(n.lumino_algorithm={}))})(ni,function(n){"use strict";n.ArrayExt=void 0,function(u){function d(_,y,l=0,o=-1){let a=_.length;if(a===0)return-1;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S;o<l?S=o+1+(a-l):S=o-l+1;for(let M=0;M<S;++M){let q=(l+M)%a;if(_[q]===y)return q}return-1}u.firstIndexOf=d;function m(_,y,l=-1,o=0){let a=_.length;if(a===0)return-1;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S;l<o?S=l+1+(a-o):S=l-o+1;for(let M=0;M<S;++M){let q=(l-M+a)%a;if(_[q]===y)return q}return-1}u.lastIndexOf=m;function w(_,y,l=0,o=-1){let a=_.length;if(a===0)return-1;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S;o<l?S=o+1+(a-l):S=o-l+1;for(let M=0;M<S;++M){let q=(l+M)%a;if(y(_[q],q))return q}return-1}u.findFirstIndex=w;function R(_,y,l=-1,o=0){let a=_.length;if(a===0)return-1;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S;l<o?S=l+1+(a-o):S=l-o+1;for(let M=0;M<S;++M){let q=(l-M+a)%a;if(y(_[q],q))return q}return-1}u.findLastIndex=R;function U(_,y,l=0,o=-1){let a=w(_,y,l,o);return a!==-1?_[a]:void 0}u.findFirstValue=U;function D(_,y,l=-1,o=0){let a=R(_,y,l,o);return a!==-1?_[a]:void 0}u.findLastValue=D;function k(_,y,l,o=0,a=-1){let S=_.length;if(S===0)return 0;o<0?o=Math.max(0,o+S):o=Math.min(o,S-1),a<0?a=Math.max(0,a+S):a=Math.min(a,S-1);let M=o,q=a-o+1;for(;q>0;){let K=q>>1,Q=M+K;l(_[Q],y)<0?(M=Q+1,q-=K+1):q=K}return M}u.lowerBound=k;function A(_,y,l,o=0,a=-1){let S=_.length;if(S===0)return 0;o<0?o=Math.max(0,o+S):o=Math.min(o,S-1),a<0?a=Math.max(0,a+S):a=Math.min(a,S-1);let M=o,q=a-o+1;for(;q>0;){let K=q>>1,Q=M+K;l(_[Q],y)>0?q=K:(M=Q+1,q-=K+1)}return M}u.upperBound=A;function T(_,y,l){if(_===y)return!0;if(_.length!==y.length)return!1;for(let o=0,a=_.length;o<a;++o)if(l?!l(_[o],y[o]):_[o]!==y[o])return!1;return!0}u.shallowEqual=T;function B(_,y={}){let{start:l,stop:o,step:a}=y;if(a===void 0&&(a=1),a===0)throw new Error("Slice `step` cannot be zero.");let S=_.length;l===void 0?l=a<0?S-1:0:l<0?l=Math.max(l+S,a<0?-1:0):l>=S&&(l=a<0?S-1:S),o===void 0?o=a<0?-1:S:o<0?o=Math.max(o+S,a<0?-1:0):o>=S&&(o=a<0?S-1:S);let M;a<0&&o>=l||a>0&&l>=o?M=0:a<0?M=Math.floor((o-l+1)/a+1):M=Math.floor((o-l-1)/a+1);let q=[];for(let K=0;K<M;++K)q[K]=_[l+K*a];return q}u.slice=B;function L(_,y,l){let o=_.length;if(o<=1||(y<0?y=Math.max(0,y+o):y=Math.min(y,o-1),l<0?l=Math.max(0,l+o):l=Math.min(l,o-1),y===l))return;let a=_[y],S=y<l?1:-1;for(let M=y;M!==l;M+=S)_[M]=_[M+S];_[l]=a}u.move=L;function W(_,y=0,l=-1){let o=_.length;if(!(o<=1))for(y<0?y=Math.max(0,y+o):y=Math.min(y,o-1),l<0?l=Math.max(0,l+o):l=Math.min(l,o-1);y<l;){let a=_[y],S=_[l];_[y++]=S,_[l--]=a}}u.reverse=W;function z(_,y,l=0,o=-1){let a=_.length;if(a<=1||(l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1),l>=o))return;let S=o-l+1;if(y>0?y=y%S:y<0&&(y=(y%S+S)%S),y===0)return;let M=l+y;W(_,l,M-1),W(_,M,o),W(_,l,o)}u.rotate=z;function G(_,y,l=0,o=-1){let a=_.length;if(a===0)return;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S;o<l?S=o+1+(a-l):S=o-l+1;for(let M=0;M<S;++M)_[(l+M)%a]=y}u.fill=G;function Ke(_,y,l){let o=_.length;y<0?y=Math.max(0,y+o):y=Math.min(y,o);for(let a=o;a>y;--a)_[a]=_[a-1];_[y]=l}u.insert=Ke;function Z(_,y){let l=_.length;if(y<0&&(y+=l),y<0||y>=l)return;let o=_[y];for(let a=y+1;a<l;++a)_[a-1]=_[a];return _.length=l-1,o}u.removeAt=Z;function ze(_,y,l=0,o=-1){let a=d(_,y,l,o);return a!==-1&&Z(_,a),a}u.removeFirstOf=ze;function He(_,y,l=-1,o=0){let a=m(_,y,l,o);return a!==-1&&Z(_,a),a}u.removeLastOf=He;function Ge(_,y,l=0,o=-1){let a=_.length;if(a===0)return 0;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S=0;for(let M=0;M<a;++M)l<=o&&M>=l&&M<=o&&_[M]===y||o<l&&(M<=o||M>=l)&&_[M]===y?S++:S>0&&(_[M-S]=_[M]);return S>0&&(_.length=a-S),S}u.removeAllOf=Ge;function Je(_,y,l=0,o=-1){let a,S=w(_,y,l,o);return S!==-1&&(a=Z(_,S)),{index:S,value:a}}u.removeFirstWhere=Je;function Ye(_,y,l=-1,o=0){let a,S=R(_,y,l,o);return S!==-1&&(a=Z(_,S)),{index:S,value:a}}u.removeLastWhere=Ye;function Xe(_,y,l=0,o=-1){let a=_.length;if(a===0)return 0;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S=0;for(let M=0;M<a;++M)l<=o&&M>=l&&M<=o&&y(_[M],M)||o<l&&(M<=o||M>=l)&&y(_[M],M)?S++:S>0&&(_[M-S]=_[M]);return S>0&&(_.length=a-S),S}u.removeAllWhere=Xe}(n.ArrayExt||(n.ArrayExt={}));function*e(...u){for(let d of u)yield*d}function*t(){}function*i(u,d=0){for(let m of u)yield[d++,m]}function*r(u,d){let m=0;for(let w of u)d(w,m++)&&(yield w)}function s(u,d){let m=0;for(let w of u)if(d(w,m++))return w}function c(u,d){let m=0;for(let w of u)if(d(w,m++))return m-1;return-1}function f(u,d){let m;for(let w of u){if(m===void 0){m=w;continue}d(w,m)<0&&(m=w)}return m}function v(u,d){let m;for(let w of u){if(m===void 0){m=w;continue}d(w,m)>0&&(m=w)}return m}function p(u,d){let m=!0,w,R;for(let U of u)m?(w=U,R=U,m=!1):d(U,w)<0?w=U:d(U,R)>0&&(R=U);return m?void 0:[w,R]}function h(u){return Array.from(u)}function g(u){let d={};for(let[m,w]of u)d[m]=w;return d}function b(u,d){let m=0;for(let w of u)if(d(w,m++)===!1)return}function C(u,d){let m=0;for(let w of u)if(d(w,m++)===!1)return!1;return!0}function P(u,d){let m=0;for(let w of u)if(d(w,m++))return!0;return!1}function*O(u,d){let m=0;for(let w of u)yield d(w,m++)}function*I(u,d,m){d===void 0?(d=u,u=0,m=1):m===void 0&&(m=1);let w=N.rangeLength(u,d,m);for(let R=0;R<w;R++)yield u+m*R}var N;(function(u){function d(m,w,R){return R===0?1/0:m>w&&R>0||m<w&&R<0?0:Math.ceil((w-m)/R)}u.rangeLength=d})(N||(N={}));function V(u,d,m){let w=u[Symbol.iterator](),R=0,U=w.next();if(U.done&&m===void 0)throw new TypeError("Reduce of empty iterable with no initial value.");if(U.done)return m;let D=w.next();if(D.done&&m===void 0)return U.value;if(D.done)return d(m,U.value,R++);let k;m===void 0?k=d(U.value,D.value,R++):k=d(d(m,U.value,R++),D.value,R++);let A;for(;!(A=w.next()).done;)k=d(k,A.value,R++);return k}function*$(u,d){for(;0<d--;)yield u}function*j(u){yield u}function*J(u){if(typeof u.retro=="function")yield*u.retro();else for(let d=u.length-1;d>-1;d--)yield u[d]}function X(u){let d=[],m=new Set,w=new Map;for(let D of u)R(D);for(let[D]of w)U(D);return d;function R(D){let[k,A]=D,T=w.get(A);T?T.push(k):w.set(A,[k])}function U(D){if(m.has(D))return;m.add(D);let k=w.get(D);if(k)for(let A of k)U(A);d.push(D)}}function*H(u,d){let m=0;for(let w of u)m++%d===0&&(yield w)}n.StringExt=void 0,function(u){function d(D,k,A=0){let T=new Array(k.length);for(let B=0,L=A,W=k.length;B<W;++B,++L){if(L=D.indexOf(k[B],L),L===-1)return null;T[B]=L}return T}u.findIndices=d;function m(D,k,A=0){let T=d(D,k,A);if(!T)return null;let B=0;for(let L=0,W=T.length;L<W;++L){let z=T[L]-A;B+=z*z}return{score:B,indices:T}}u.matchSumOfSquares=m;function w(D,k,A=0){let T=d(D,k,A);if(!T)return null;let B=0,L=A-1;for(let W=0,z=T.length;W<z;++W){let G=T[W];B+=G-L-1,L=G}return{score:B,indices:T}}u.matchSumOfDeltas=w;function R(D,k,A){let T=[],B=0,L=0,W=k.length;for(;B<W;){let z=k[B],G=k[B];for(;++B<W&&k[B]===G+1;)G++;L<z&&T.push(D.slice(L,z)),z<G+1&&T.push(A(D.slice(z,G+1))),L=G+1}return L<D.length&&T.push(D.slice(L)),T}u.highlight=R;function U(D,k){return D<k?-1:D>k?1:0}u.cmp=U}(n.StringExt||(n.StringExt={}));function*E(u,d){if(d<1)return;let m=u[Symbol.iterator](),w;for(;0<d--&&!(w=m.next()).done;)yield w.value}function*x(...u){let d=u.map(w=>w[Symbol.iterator]()),m=d.map(w=>w.next());for(;C(m,w=>!w.done);m=d.map(w=>w.next()))yield m.map(w=>w.value)}n.chain=e,n.each=b,n.empty=t,n.enumerate=i,n.every=C,n.filter=r,n.find=s,n.findIndex=c,n.map=O,n.max=v,n.min=f,n.minmax=p,n.once=j,n.range=I,n.reduce=V,n.repeat=$,n.retro=J,n.some=P,n.stride=H,n.take=E,n.toArray=h,n.toObject=g,n.topologicSort=X,n.zip=x})});var ii=F(ye=>{"use strict";var Oh=Gr();ye.JSONExt=void 0;(function(n){n.emptyObject=Object.freeze({}),n.emptyArray=Object.freeze([]);function e(h){return h===null||typeof h=="boolean"||typeof h=="number"||typeof h=="string"}n.isPrimitive=e;function t(h){return Array.isArray(h)}n.isArray=t;function i(h){return!e(h)&&!t(h)}n.isObject=i;function r(h,g){if(h===g)return!0;if(e(h)||e(g))return!1;let b=t(h),C=t(g);return b!==C?!1:b&&C?c(h,g):f(h,g)}n.deepEqual=r;function s(h){return e(h)?h:t(h)?v(h):p(h)}n.deepCopy=s;function c(h,g){if(h===g)return!0;if(h.length!==g.length)return!1;for(let b=0,C=h.length;b<C;++b)if(!r(h[b],g[b]))return!1;return!0}function f(h,g){if(h===g)return!0;for(let b in h)if(h[b]!==void 0&&!(b in g))return!1;for(let b in g)if(g[b]!==void 0&&!(b in h))return!1;for(let b in h){let C=h[b],P=g[b];if(!(C===void 0&&P===void 0)&&(C===void 0||P===void 0||!r(C,P)))return!1}return!0}function v(h){let g=new Array(h.length);for(let b=0,C=h.length;b<C;++b)g[b]=s(h[b]);return g}function p(h){let g={};for(let b in h){let C=h[b];C!==void 0&&(g[b]=s(C))}return g}})(ye.JSONExt||(ye.JSONExt={}));var Jr=class{constructor(){this._types=[],this._values=[]}types(){return this._types.slice()}hasData(e){return this._types.indexOf(e)!==-1}getData(e){let t=this._types.indexOf(e);return t!==-1?this._values[t]:void 0}setData(e,t){this.clearData(e),this._types.push(e),this._values.push(t)}clearData(e){let t=this._types.indexOf(e);t!==-1&&(this._types.splice(t,1),this._values.splice(t,1))}clear(){this._types.length=0,this._values.length=0}},Yr=class{constructor(e={}){this._application=null,this._validatePlugin=()=>!0,this._plugins=new Map,this._services=new Map,e.validatePlugin&&(console.info("Plugins may be rejected by the custom validation plugin method."),this._validatePlugin=e.validatePlugin)}get application(){return this._application}set application(e){if(this._application!==null)throw Error("PluginRegistry.application is already set. It cannot be overridden.");this._application=e}get deferredPlugins(){return Array.from(this._plugins).filter(([e,t])=>t.autoStart==="defer").map(([e,t])=>e)}getPluginDescription(e){var t,i;return(i=(t=this._plugins.get(e))===null||t===void 0?void 0:t.description)!==null&&i!==void 0?i:""}hasPlugin(e){return this._plugins.has(e)}isPluginActivated(e){var t,i;return(i=(t=this._plugins.get(e))===null||t===void 0?void 0:t.activated)!==null&&i!==void 0?i:!1}listPlugins(){return Array.from(this._plugins.keys())}registerPlugin(e){if(this._plugins.has(e.id))throw new TypeError(`Plugin '${e.id}' is already registered.`);if(!this._validatePlugin(e))throw new Error(`Plugin '${e.id}' is not valid.`);let t=jt.createPluginData(e);jt.ensureNoCycle(t,this._plugins,this._services),t.provides&&this._services.set(t.provides,t.id),this._plugins.set(t.id,t)}registerPlugins(e){for(let t of e)this.registerPlugin(t)}deregisterPlugin(e,t){let i=this._plugins.get(e);if(i){if(i.activated&&!t)throw new Error(`Plugin '${e}' is still active.`);this._plugins.delete(e)}}async activatePlugin(e){let t=this._plugins.get(e);if(!t)throw new ReferenceError(`Plugin '${e}' is not registered.`);if(t.activated)return;if(t.promise)return t.promise;let i=t.requires.map(s=>this.resolveRequiredService(s)),r=t.optional.map(s=>this.resolveOptionalService(s));return t.promise=Promise.all([...i,...r]).then(s=>t.activate.apply(void 0,[this.application,...s])).then(s=>{t.service=s,t.activated=!0,t.promise=null}).catch(s=>{throw t.promise=null,s}),t.promise}async activatePlugins(e,t={}){switch(e){case"defer":{let i=this.deferredPlugins.filter(r=>this._plugins.get(r).autoStart).map(r=>this.activatePlugin(r));await Promise.all(i);break}case"startUp":{let r=jt.collectStartupPlugins(this._plugins,t).map(async s=>{try{return await this.activatePlugin(s)}catch(c){console.error(`Plugin '${s}' failed to activate.`,c)}});await Promise.all(r);break}}}async deactivatePlugin(e){let t=this._plugins.get(e);if(!t)throw new ReferenceError(`Plugin '${e}' is not registered.`);if(!t.activated)return[];if(!t.deactivate)throw new TypeError(`Plugin '${e}'#deactivate() method missing`);let i=jt.findDependents(e,this._plugins,this._services),r=i.map(s=>this._plugins.get(s));for(let s of r)if(!s.deactivate)throw new TypeError(`Plugin ${s.id}#deactivate() method missing (depends on ${e})`);for(let s of r){let c=[...s.requires,...s.optional].map(f=>{let v=this._services.get(f);return v?this._plugins.get(v).service:null});await s.deactivate(this.application,...c),s.service=null,s.activated=!1}return i.pop(),i}async resolveRequiredService(e){let t=this._services.get(e);if(!t)throw new TypeError(`No provider for: ${e.name}.`);let i=this._plugins.get(t);return i.activated||await this.activatePlugin(t),i.service}async resolveOptionalService(e){let t=this._services.get(e);if(!t)return null;let i=this._plugins.get(t);if(!i.activated)try{await this.activatePlugin(t)}catch(r){return console.error(r),null}return i.service}},jt;(function(n){class e{constructor(f){var v,p,h,g;this._activated=!1,this._promise=null,this._service=null,this.id=f.id,this.description=(v=f.description)!==null&&v!==void 0?v:"",this.activate=f.activate,this.deactivate=(p=f.deactivate)!==null&&p!==void 0?p:null,this.provides=(h=f.provides)!==null&&h!==void 0?h:null,this.autoStart=(g=f.autoStart)!==null&&g!==void 0?g:!1,this.requires=f.requires?f.requires.slice():[],this.optional=f.optional?f.optional.slice():[]}get activated(){return this._activated}set activated(f){this._activated=f}get service(){return this._service}set service(f){this._service=f}get promise(){return this._promise}set promise(f){this._promise=f}}function t(c){return new e(c)}n.createPluginData=t;function i(c,f,v){let p=[...c.requires,...c.optional],h=b=>{if(b===c.provides)return!0;let C=v.get(b);if(!C)return!1;let P=f.get(C),O=[...P.requires,...P.optional];return O.length===0?!1:(g.push(C),O.some(h)?!0:(g.pop(),!1))};if(!c.provides||p.length===0)return;let g=[c.id];if(p.some(h))throw new ReferenceError(`Cycle detected: ${g.join(" -> ")}.`)}n.ensureNoCycle=i;function r(c,f,v){let p=new Array,h=O=>{let I=f.get(O),N=[...I.requires,...I.optional];p.push(...N.reduce((V,$)=>{let j=v.get($);return j&&V.push([O,j]),V},[]))};for(let O of f.keys())h(O);let g=p.filter(O=>O[1]===c),b=0;for(;g.length>b;){let O=g.length,I=new Set(g.map(N=>N[0]));for(let N of I)p.filter(V=>V[1]===N).forEach(V=>{g.includes(V)||g.push(V)});b=O}let C=Oh.topologicSort(g),P=C.findIndex(O=>O===c);return P===-1?[c]:C.slice(0,P+1)}n.findDependents=r;function s(c,f){let v=new Set;for(let p of c.keys())c.get(p).autoStart===!0&&v.add(p);if(f.startPlugins)for(let p of f.startPlugins)v.add(p);if(f.ignorePlugins)for(let p of f.ignorePlugins)v.delete(p);return Array.from(v)}n.collectStartupPlugins=s})(jt||(jt={}));var Xr=class{constructor(){this.promise=new Promise((e,t)=>{this._resolve=e,this._reject=t})}resolve(e){let t=this._resolve;t(e)}reject(e){let t=this._reject;t(e)}},Zr=class{constructor(e,t){this.name=e,this.description=t??"",this._tokenStructuralPropertyT=null}};function Rh(n){let e=0;for(let t=0,i=n.length;t<i;++t)t%4===0&&(e=Math.random()*4294967295>>>0),n[t]=e&255,e>>>=8}ye.Random=void 0;(function(n){n.getRandomValues=(()=>{let e=typeof require<"u"&&require("crypto")||null;return e&&typeof e.randomFillSync=="function"?function(i){return e.randomFillSync(i)}:e&&typeof e.randomBytes=="function"?function(i){let r=e.randomBytes(i.length);for(let s=0,c=r.length;s<c;++s)i[s]=r[s]}:Rh})()})(ye.Random||(ye.Random={}));function Dh(n){let e=new Uint8Array(16),t=new Array(256);for(let i=0;i<16;++i)t[i]="0"+i.toString(16);for(let i=16;i<256;++i)t[i]=i.toString(16);return function(){return n(e),e[6]=64|e[6]&15,e[8]=128|e[8]&63,t[e[0]]+t[e[1]]+t[e[2]]+t[e[3]]+"-"+t[e[4]]+t[e[5]]+"-"+t[e[6]]+t[e[7]]+"-"+t[e[8]]+t[e[9]]+"-"+t[e[10]]+t[e[11]]+t[e[12]]+t[e[13]]+t[e[14]]+t[e[15]]}}ye.UUID=void 0;(function(n){n.uuid4=Dh(ye.Random.getRandomValues)})(ye.UUID||(ye.UUID={}));ye.MimeData=Jr;ye.PluginRegistry=Yr;ye.PromiseDelegate=Xr;ye.Token=Zr});var wa=F((ri,ya)=>{(function(n,e){typeof ri=="object"&&typeof ya<"u"?e(ri):typeof define=="function"&&define.amd?define(["exports"],e):(n=typeof globalThis<"u"?globalThis:n||self,e(n.lumino_properties={}))})(ri,function(n){"use strict";class e{constructor(r){this._pid=t.nextPID(),this.name=r.name,this._create=r.create,this._coerce=r.coerce||null,this._compare=r.compare||null,this._changed=r.changed||null}get(r){let s,c=t.ensureMap(r);return this._pid in c?s=c[this._pid]:s=c[this._pid]=this._createValue(r),s}set(r,s){let c,f=t.ensureMap(r);this._pid in f?c=f[this._pid]:c=f[this._pid]=this._createValue(r);let v=this._coerceValue(r,s);this._maybeNotify(r,c,f[this._pid]=v)}coerce(r){let s,c=t.ensureMap(r);this._pid in c?s=c[this._pid]:s=c[this._pid]=this._createValue(r);let f=this._coerceValue(r,s);this._maybeNotify(r,s,c[this._pid]=f)}_createValue(r){let s=this._create;return s(r)}_coerceValue(r,s){let c=this._coerce;return c?c(r,s):s}_compareValue(r,s){let c=this._compare;return c?c(r,s):r===s}_maybeNotify(r,s,c){let f=this._changed;f&&!this._compareValue(s,c)&&f(r,s,c)}}(function(i){function r(s){t.ownerData.delete(s)}i.clearData=r})(e||(e={}));var t;(function(i){i.ownerData=new WeakMap,i.nextPID=(()=>{let s=0;return()=>`pid-${`${Math.random()}`.slice(2)}-${s++}`})();function r(s){let c=i.ownerData.get(s);return c||(c=Object.create(null),i.ownerData.set(s,c),c)}i.ensureMap=r})(t||(t={})),n.AttachedProperty=e})});var Qr=F((si,Sa)=>{(function(n,e){typeof si=="object"&&typeof Sa<"u"?e(si,Gr(),ii()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm","@lumino/coreutils"],e):(n=typeof globalThis<"u"?globalThis:n||self,e(n.lumino_signaling={},n.lumino_algorithm,n.lumino_coreutils))})(si,function(n,e,t){"use strict";class i{constructor(f){this.sender=f}connect(f,v){return s.connect(this,f,v)}disconnect(f,v){return s.disconnect(this,f,v)}emit(f){s.emit(this,f)}}(function(c){function f(P,O){s.disconnectBetween(P,O)}c.disconnectBetween=f;function v(P){s.disconnectSender(P)}c.disconnectSender=v;function p(P){s.disconnectReceiver(P)}c.disconnectReceiver=p;function h(P){s.disconnectAll(P)}c.disconnectAll=h;function g(P){s.disconnectAll(P)}c.clearData=g;function b(){return s.exceptionHandler}c.getExceptionHandler=b;function C(P){let O=s.exceptionHandler;return s.exceptionHandler=P,O}c.setExceptionHandler=C})(i||(i={}));class r extends i{constructor(){super(...arguments),this._pending=new t.PromiseDelegate}async*[Symbol.asyncIterator](){let f=this._pending;for(;;)try{let{args:v,next:p}=await f.promise;f=p,yield v}catch{return}}emit(f){let v=this._pending,p=this._pending=new t.PromiseDelegate;v.resolve({args:f,next:p}),super.emit(f)}stop(){this._pending.promise.catch(()=>{}),this._pending.reject("stop"),this._pending=new t.PromiseDelegate}}var s;(function(c){c.exceptionHandler=E=>{console.error(E)};function f(E,x,u){u=u||void 0;let d=P.get(E.sender);if(d||(d=[],P.set(E.sender,d)),V(d,E,x,u))return!1;let m=u||x,w=O.get(m);w||(w=[],O.set(m,w));let R={signal:E,slot:x,thisArg:u};return d.push(R),w.push(R),!0}c.connect=f;function v(E,x,u){u=u||void 0;let d=P.get(E.sender);if(!d||d.length===0)return!1;let m=V(d,E,x,u);if(!m)return!1;let w=u||x,R=O.get(w);return m.signal=null,j(d),j(R),!0}c.disconnect=v;function p(E,x){let u=P.get(E);if(!u||u.length===0)return;let d=O.get(x);if(!(!d||d.length===0)){for(let m of d)m.signal&&m.signal.sender===E&&(m.signal=null);j(u),j(d)}}c.disconnectBetween=p;function h(E){let x=P.get(E);if(!(!x||x.length===0)){for(let u of x){if(!u.signal)continue;let d=u.thisArg||u.slot;u.signal=null,j(O.get(d))}j(x)}}c.disconnectSender=h;function g(E){let x=O.get(E);if(!(!x||x.length===0)){for(let u of x){if(!u.signal)continue;let d=u.signal.sender;u.signal=null,j(P.get(d))}j(x)}}c.disconnectReceiver=g;function b(E){h(E),g(E)}c.disconnectAll=b;function C(E,x){let u=P.get(E.sender);if(!(!u||u.length===0))for(let d=0,m=u.length;d<m;++d){let w=u[d];w.signal===E&&$(w,x)}}c.emit=C;let P=new WeakMap,O=new WeakMap,I=new Set,N=(()=>typeof requestAnimationFrame=="function"?requestAnimationFrame:setImmediate)();function V(E,x,u,d){return e.find(E,m=>m.signal===x&&m.slot===u&&m.thisArg===d)}function $(E,x){let{signal:u,slot:d,thisArg:m}=E;try{d.call(m,u.sender,x)}catch(w){c.exceptionHandler(w)}}function j(E){I.size===0&&N(J),I.add(E)}function J(){I.forEach(X),I.clear()}function X(E){e.ArrayExt.removeAllWhere(E,H)}function H(E){return E.signal===null}})(s||(s={})),n.Signal=i,n.Stream=r})});var Ma=F(li=>{"use strict";Object.defineProperty(li,"__esModule",{value:!0});li.RestorablePool=void 0;var xh=ii(),ba=wa(),oi=Qr(),es=class{constructor(e){this._added=new oi.Signal(this),this._current=null,this._currentChanged=new oi.Signal(this),this._hasRestored=!1,this._isDisposed=!1,this._objects=new Set,this._restore=null,this._restored=new xh.PromiseDelegate,this._updated=new oi.Signal(this),this.namespace=e.namespace}get added(){return this._added}get current(){return this._current}set current(e){this._current!==e&&e!==null&&this._objects.has(e)&&(this._current=e,this._currentChanged.emit(this._current))}get currentChanged(){return this._currentChanged}get isDisposed(){return this._isDisposed}get restored(){return this._restored.promise}get size(){return this._objects.size}get updated(){return this._updated}async add(e){var t,i;if(e.isDisposed){let r="A disposed object cannot be added.";throw console.warn(r,e),new Error(r)}if(this._objects.has(e)){let r="This object already exists in the pool.";throw console.warn(r,e),new Error(r)}if(this._objects.add(e),e.disposed.connect(this._onInstanceDisposed,this),!Ve.injectedProperty.get(e)){if(this._restore){let{connector:r}=this._restore,s=this._restore.name(e);if(s){let c=`${this.namespace}:${s}`,f=(i=(t=this._restore).args)===null||i===void 0?void 0:i.call(t,e);Ve.nameProperty.set(e,c),await r.save(c,{data:f})}}this._added.emit(e)}}dispose(){this.isDisposed||(this._current=null,this._isDisposed=!0,this._objects.clear(),oi.Signal.clearData(this))}find(e){let t=this._objects.values();for(let i of t)if(e(i))return i}forEach(e){this._objects.forEach(e)}filter(e){let t=[];return this.forEach(i=>{e(i)&&t.push(i)}),t}inject(e){return Ve.injectedProperty.set(e,!0),this.add(e)}has(e){return this._objects.has(e)}async restore(e){if(this._hasRestored)throw new Error("This pool has already been restored.");this._hasRestored=!0;let{command:t,connector:i,registry:r,when:s}=e,c=this.namespace,f=s?[i.list(c)].concat(s):[i.list(c)];this._restore=e;let[v]=await Promise.all(f),p=await Promise.all(v.ids.map(async(h,g)=>{let b=v.values[g],C=b&&b.data;return C===void 0?i.remove(h):r.execute(t,C).catch(()=>i.remove(h))}));return this._restored.resolve(),p}async save(e){var t,i;let r=Ve.injectedProperty.get(e);if(!this._restore||!this.has(e)||r)return;let{connector:s}=this._restore,c=this._restore.name(e),f=Ve.nameProperty.get(e),v=c?`${this.namespace}:${c}`:"";if(f&&f!==v&&await s.remove(f),Ve.nameProperty.set(e,v),v){let p=(i=(t=this._restore).args)===null||i===void 0?void 0:i.call(t,e);await s.save(v,{data:p})}f!==v&&this._updated.emit(e)}_onInstanceDisposed(e){if(this._objects.delete(e),e===this._current&&(this._current=null,this._currentChanged.emit(this._current)),Ve.injectedProperty.get(e)||!this._restore)return;let{connector:t}=this._restore,i=Ve.nameProperty.get(e);i&&t.remove(i)}};li.RestorablePool=es;var Ve;(function(n){n.injectedProperty=new ba.AttachedProperty({name:"injected",create:()=>!1}),n.nameProperty=new ba.AttachedProperty({name:"name",create:()=>""})})(Ve||(Ve={}))});var Ca=F(en=>{"use strict";Object.defineProperty(en,"__esModule",{value:!0});en.StateDB=void 0;var kh=Qr(),Qt=class n{constructor(e={}){this._changed=new kh.Signal(this);let{connector:t,transform:i}=e;this._connector=t||new n.Connector,i?this._ready=i.then(r=>{let{contents:s,type:c}=r;switch(c){case"cancel":return;case"clear":return this._clear();case"merge":return this._merge(s||{});case"overwrite":return this._overwrite(s||{});default:return}}):this._ready=Promise.resolve(void 0)}get changed(){return this._changed}async clear(){await this._ready,await this._clear()}async fetch(e){return await this._ready,this._fetch(e)}async list(e){return await this._ready,this._list(e)}async remove(e){await this._ready,await this._remove(e),this._changed.emit({id:e,type:"remove"})}async save(e,t){await this._ready,await this._save(e,t),this._changed.emit({id:e,type:"save"})}async toJSON(){await this._ready;let{ids:e,values:t}=await this._list();return t.reduce((i,r,s)=>(i[e[s]]=r,i),{})}async _clear(){await Promise.all((await this._list()).ids.map(e=>this._remove(e)))}async _fetch(e){let t=await this._connector.fetch(e);if(t)return JSON.parse(t).v}async _list(e=""){let{ids:t,values:i}=await this._connector.list(e);return{ids:t,values:i.map(r=>JSON.parse(r).v)}}async _merge(e){await Promise.all(Object.keys(e).map(t=>e[t]&&this._save(t,e[t])))}async _overwrite(e){await this._clear(),await this._merge(e)}async _remove(e){return this._connector.remove(e)}async _save(e,t){return this._connector.save(e,JSON.stringify({v:t}))}};en.StateDB=Qt;(function(n){class e{constructor(){this._storage={}}async fetch(i){return this._storage[i]}async list(i=""){return Object.keys(this._storage).reduce((r,s)=>((i===""||i===s.split(":")[0])&&(r.ids.push(s),r.values.push(this._storage[s])),r),{ids:[],values:[]})}async remove(i){delete this._storage[i]}async save(i,r){this._storage[i]=r}}n.Connector=e})(Qt||(en.StateDB=Qt={}))});var Pa=F(ai=>{"use strict";Object.defineProperty(ai,"__esModule",{value:!0});ai.IStateDB=void 0;var qh=ii();ai.IStateDB=new qh.Token("@jupyterlab/coreutils:IStateDB",`A service for the JupyterLab state database.
  Use this if you want to store data that will persist across page loads.
  See "state database" for more information.`)});var ts=F(qe=>{"use strict";var jh=qe&&qe.__createBinding||(Object.create?function(n,e,t,i){i===void 0&&(i=t);var r=Object.getOwnPropertyDescriptor(e,t);(!r||("get"in r?!e.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,i,r)}:function(n,e,t,i){i===void 0&&(i=t),n[i]=e[t]}),tn=qe&&qe.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&jh(e,n,t)};Object.defineProperty(qe,"__esModule",{value:!0});tn(ga(),qe);tn(ma(),qe);tn(Ma(),qe);tn(Ca(),qe);tn(Pa(),qe)});var rs=F(ui=>{"use strict";Object.defineProperty(ui,"__esModule",{value:!0});ui.SettingManager=void 0;var ns=ue(),Th=ts(),ci=ge(),Ih="api/settings",is=class extends Th.DataConnector{constructor(e={}){var t;super(),this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:ci.ServerConnection.makeSettings()}async fetch(e){if(!e)throw new Error("Plugin `id` parameter is required for settings fetch.");let{serverSettings:t}=this,{baseUrl:i,appUrl:r}=t,{makeRequest:s,ResponseError:c}=ci.ServerConnection,f=i+r,v=nn.url(f,e),p=await s(v,{},t);if(p.status!==200)throw await c.create(p);return p.json()}async list(e){var t,i,r,s;let{serverSettings:c}=this,{baseUrl:f,appUrl:v}=c,{makeRequest:p,ResponseError:h}=ci.ServerConnection,g=f+v,b=nn.url(g,"",e==="ids"),C=await p(b,{},c);if(C.status!==200)throw new h(C);let P=await C.json(),O=(i=(t=P?.settings)===null||t===void 0?void 0:t.map(N=>N.id))!==null&&i!==void 0?i:[],I=[];return e||(I=(s=(r=P?.settings)===null||r===void 0?void 0:r.map(N=>(N.data={composite:{},user:{}},N)))!==null&&s!==void 0?s:[]),{ids:O,values:I}}async save(e,t){let{serverSettings:i}=this,{baseUrl:r,appUrl:s}=i,{makeRequest:c,ResponseError:f}=ci.ServerConnection,v=r+s,p=nn.url(v,e),h={body:JSON.stringify({raw:t}),method:"PUT"},g=await c(p,h,i);if(g.status!==204)throw new f(g)}};ui.SettingManager=is;var nn;(function(n){function e(t,i,r){let s=r?ns.URLExt.objectToQueryString({ids_only:!0}):"",c=ns.URLExt.join(t,Ih),f=ns.URLExt.join(c,i);if(!f.startsWith(c))throw new Error("Can only be used for workspaces requests");return`${f}${s}`}n.url=e})(nn||(nn={}))});var on=F(we=>{"use strict";Object.defineProperty(we,"__esModule",{value:!0});we.shutdownTerminal=we.listRunning=we.startNew=we.isAvailable=we.TERMINAL_SERVICE_URL=void 0;var rn=ue(),it=ge();we.TERMINAL_SERVICE_URL="api/terminals";function Ea(){return String(rn.PageConfig.getOption("terminalsAvailable")).toLowerCase()==="true"}we.isAvailable=Ea;async function Uh(n=it.ServerConnection.makeSettings(),e,t){sn.errorIfNotAvailable();let i=rn.URLExt.join(n.baseUrl,we.TERMINAL_SERVICE_URL),r={method:"POST",body:JSON.stringify({name:e,cwd:t})},s=await it.ServerConnection.makeRequest(i,r,n);if(s.status!==200)throw await it.ServerConnection.ResponseError.create(s);return await s.json()}we.startNew=Uh;async function Lh(n=it.ServerConnection.makeSettings()){sn.errorIfNotAvailable();let e=rn.URLExt.join(n.baseUrl,we.TERMINAL_SERVICE_URL),t=await it.ServerConnection.makeRequest(e,{},n);if(t.status!==200)throw await it.ServerConnection.ResponseError.create(t);let i=await t.json();if(!Array.isArray(i))throw new Error("Invalid terminal list");return i}we.listRunning=Lh;async function Nh(n,e=it.ServerConnection.makeSettings()){var t;sn.errorIfNotAvailable();let i=rn.URLExt.join(e.baseUrl,we.TERMINAL_SERVICE_URL),r=rn.URLExt.join(i,n);if(!r.startsWith(i))throw new Error("Can only be used for terminal requests");let s={method:"DELETE"},c=await it.ServerConnection.makeRequest(r,s,e);if(c.status===404){let v=(t=(await c.json()).message)!==null&&t!==void 0?t:`The terminal session "${n}"" does not exist on the server`;console.warn(v)}else if(c.status!==204)throw await it.ServerConnection.ResponseError.create(c)}we.shutdownTerminal=Nh;var sn;(function(n){function e(){if(!Ea())throw new Error("Terminals Unavailable")}n.errorIfNotAvailable=e})(sn||(sn={}))});var Oa=F(fi=>{"use strict";Object.defineProperty(fi,"__esModule",{value:!0});fi.isAvailable=void 0;var Ah=on();Object.defineProperty(fi,"isAvailable",{enumerable:!0,get:function(){return Ah.isAvailable}})});var xa=F(di=>{"use strict";Object.defineProperty(di,"__esModule",{value:!0});di.TerminalConnection=void 0;var Ra=ue(),Fh=Ue(),hi=Oe(),Bh=at(),Da=on(),ss=class n{constructor(e){var t;this._createSocket=()=>{this._errorIfDisposed(),this._clearSocket(),this._updateConnectionStatus("connecting");let i=this._name,r=this.serverSettings,s=Ra.URLExt.join(r.wsUrl,"terminals","websocket",encodeURIComponent(i)),c=r.token;r.appendToken&&c!==""&&(s=s+`?token=${encodeURIComponent(c)}`),this._ws=new r.WebSocket(s),this._ws.onmessage=this._onWSMessage,this._ws.onclose=this._onWSClose,this._ws.onerror=this._onWSClose},this._onWSMessage=i=>{if(this._isDisposed)return;let r=JSON.parse(i.data);if(r[0]==="disconnect"&&this.dispose(),this._connectionStatus==="connecting"){r[0]==="setup"&&this._updateConnectionStatus("connected");return}this._messageReceived.emit({type:r[0],content:r.slice(1)})},this._onWSClose=i=>{console.warn(`Terminal websocket closed: ${i.code}`),this.isDisposed||this._reconnect()},this._connectionStatus="connecting",this._connectionStatusChanged=new hi.Signal(this),this._isDisposed=!1,this._disposed=new hi.Signal(this),this._messageReceived=new hi.Signal(this),this._reconnectTimeout=null,this._ws=null,this._noOp=()=>{},this._reconnectLimit=7,this._reconnectAttempt=0,this._pendingMessages=[],this._name=e.model.name,this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:Bh.ServerConnection.makeSettings(),this._createSocket()}get disposed(){return this._disposed}get messageReceived(){return this._messageReceived}get name(){return this._name}get model(){return{name:this._name}}get isDisposed(){return this._isDisposed}dispose(){this._isDisposed||(this._isDisposed=!0,this._disposed.emit(),this._updateConnectionStatus("disconnected"),this._clearSocket(),hi.Signal.clearData(this))}send(e){this._sendMessage(e)}_sendMessage(e,t=!0){if(!(this._isDisposed||!e.content))if(this.connectionStatus==="connected"&&this._ws){let i=[e.type,...e.content];this._ws.send(JSON.stringify(i))}else if(t)this._pendingMessages.push(e);else throw new Error(`Could not send message: ${JSON.stringify(e)}`)}_sendPending(){for(;this.connectionStatus==="connected"&&this._pendingMessages.length>0;)this._sendMessage(this._pendingMessages[0],!1),this._pendingMessages.shift()}reconnect(){this._errorIfDisposed();let e=new Fh.PromiseDelegate,t=(i,r)=>{r==="connected"?(e.resolve(),this.connectionStatusChanged.disconnect(t,this)):r==="disconnected"&&(e.reject(new Error("Terminal connection disconnected")),this.connectionStatusChanged.disconnect(t,this))};return this.connectionStatusChanged.connect(t,this),this._reconnectAttempt=0,this._reconnect(),e.promise}_reconnect(){if(this._errorIfDisposed(),clearTimeout(this._reconnectTimeout),this._reconnectAttempt<this._reconnectLimit){this._updateConnectionStatus("connecting");let e=os.getRandomIntInclusive(0,1e3*(Math.pow(2,this._reconnectAttempt)-1));console.error(`Connection lost, reconnecting in ${Math.floor(e/1e3)} seconds.`),this._reconnectTimeout=setTimeout(this._createSocket,e),this._reconnectAttempt+=1}else this._updateConnectionStatus("disconnected");this._clearSocket()}_clearSocket(){this._ws!==null&&(this._ws.onopen=this._noOp,this._ws.onclose=this._noOp,this._ws.onerror=this._noOp,this._ws.onmessage=this._noOp,this._ws.close(),this._ws=null)}async shutdown(){await(0,Da.shutdownTerminal)(this.name,this.serverSettings),this.dispose()}clone(){return new n(this)}_updateConnectionStatus(e){this._connectionStatus!==e&&(this._connectionStatus=e,e!=="connecting"&&(this._reconnectAttempt=0,clearTimeout(this._reconnectTimeout)),e==="connected"&&this._sendPending(),this._connectionStatusChanged.emit(e))}_errorIfDisposed(){if(this.isDisposed)throw new Error("Terminal connection is disposed")}get connectionStatusChanged(){return this._connectionStatusChanged}get connectionStatus(){return this._connectionStatus}};di.TerminalConnection=ss;var os;(function(n){function e(i,r){return Ra.URLExt.join(i,Da.TERMINAL_SERVICE_URL,encodeURIComponent(r))}n.getTermUrl=e;function t(i,r){return i=Math.ceil(i),r=Math.floor(r),Math.floor(Math.random()*(r-i+1))+i}n.getRandomIntInclusive=t})(os||(os={}))});var qa=F(cn=>{"use strict";Object.defineProperty(cn,"__esModule",{value:!0});cn.TerminalManager=void 0;var Vh=yt(),ka=Oe(),Wh=at(),$h=vt(),ln=on(),Kh=xa(),an=class extends $h.BaseManager{constructor(e={}){var t;if(super(e),this._isReady=!1,this._names=[],this._terminalConnections=new Set,this._runningChanged=new ka.Signal(this),this._connectionFailure=new ka.Signal(this),!this.isAvailable()){this._ready=Promise.reject("Terminals unavailable"),this._ready.catch(i=>{});return}this._pollModels=new Vh.Poll({auto:!1,factory:()=>this.requestRunning(),frequency:{interval:10*1e3,backoff:!0,max:300*1e3},name:"@jupyterlab/services:TerminalManager#models",standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"}),this._ready=(async()=>{await this._pollModels.start(),await this._pollModels.tick,this._isReady=!0})()}get isReady(){return this._isReady}get ready(){return this._ready}get runningChanged(){return this._runningChanged}get connectionFailure(){return this._connectionFailure}dispose(){this.isDisposed||(this._names.length=0,this._terminalConnections.forEach(e=>e.dispose()),this._pollModels.dispose(),super.dispose())}isAvailable(){return(0,ln.isAvailable)()}connectTo(e){let t=new Kh.TerminalConnection({...e,serverSettings:this.serverSettings});return this._onStarted(t),this._names.includes(e.model.name)||this.refreshRunning().catch(()=>{}),t}running(){return this._models[Symbol.iterator]()}async refreshRunning(){await this._pollModels.refresh(),await this._pollModels.tick}async startNew(e){let t=await(0,ln.startNew)(this.serverSettings,e?.name,e?.cwd);return await this.refreshRunning(),this.connectTo({model:t})}async shutdown(e){await(0,ln.shutdownTerminal)(e,this.serverSettings),await this.refreshRunning()}async shutdownAll(){await this.refreshRunning(),await Promise.all(this._names.map(e=>(0,ln.shutdownTerminal)(e,this.serverSettings))),await this.refreshRunning()}async requestRunning(){var e,t;let i;try{i=await(0,ln.listRunning)(this.serverSettings)}catch(s){throw(s instanceof Wh.ServerConnection.NetworkError||((e=s.response)===null||e===void 0?void 0:e.status)===503||((t=s.response)===null||t===void 0?void 0:t.status)===424)&&this._connectionFailure.emit(s),s}if(this.isDisposed)return;let r=i.map(({name:s})=>s).sort();r!==this._names&&(this._names=r,this._terminalConnections.forEach(s=>{r.includes(s.name)||s.dispose()}),this._runningChanged.emit(this._models))}_onStarted(e){this._terminalConnections.add(e),e.disposed.connect(this._onDisposed,this)}_onDisposed(e){this._terminalConnections.delete(e),this.refreshRunning().catch(()=>{})}get _models(){return this._names.map(e=>({name:e}))}};cn.TerminalManager=an;(function(n){class e extends n{constructor(){super(...arguments),this._readyPromise=new Promise(()=>{})}get isActive(){return!1}get parentReady(){return super.ready}get ready(){return this.parentReady.then(()=>this._readyPromise)}async startNew(i){return Promise.reject(new Error("Not implemented in no-op Terminal Manager"))}connectTo(i){throw Error("Not implemented in no-op Terminal Manager")}async shutdown(i){return Promise.reject(new Error("Not implemented in no-op Terminal Manager"))}async requestRunning(){return Promise.resolve()}}n.NoopManager=e})(an||(cn.TerminalManager=an={}))});var ls=F(Se=>{"use strict";var ja=Se&&Se.__createBinding||(Object.create?function(n,e,t,i){i===void 0&&(i=t);var r=Object.getOwnPropertyDescriptor(e,t);(!r||("get"in r?!e.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,i,r)}:function(n,e,t,i){i===void 0&&(i=t),n[i]=e[t]}),zh=Se&&Se.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),Ta=Se&&Se.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.prototype.hasOwnProperty.call(n,t)&&ja(e,n,t);return zh(e,n),e},Hh=Se&&Se.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&ja(e,n,t)};Object.defineProperty(Se,"__esModule",{value:!0});Se.TerminalAPI=Se.Terminal=void 0;var Gh=Ta(Oa());Se.Terminal=Gh;var Jh=Ta(on());Se.TerminalAPI=Jh;Hh(qa(),Se)});var fs=F(_i=>{"use strict";Object.defineProperty(_i,"__esModule",{value:!0});_i.UserManager=void 0;var Yh=ue(),Xh=Ue(),Zh=yt(),Ia=Oe(),Qh=ge(),ed=vt(),td="api/me",as="@jupyterlab/services:UserManager#user",cs=class extends ed.BaseManager{constructor(e={}){var t;super(e),this._isReady=!1,this._userChanged=new Ia.Signal(this),this._connectionFailure=new Ia.Signal(this),this._ready=this.requestUser().then(()=>{this.isDisposed||(this._isReady=!0)}).catch(i=>new Promise(()=>{})),this._pollSpecs=new Zh.Poll({auto:!1,factory:()=>this.requestUser(),frequency:{interval:61*1e3,backoff:!0,max:300*1e3},name:as,standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"}),this.ready.then(()=>{this._pollSpecs.start()})}get isReady(){return this._isReady}get ready(){return this._ready}get identity(){return this._identity}get permissions(){return this._permissions}get userChanged(){return this._userChanged}get connectionFailure(){return this._connectionFailure}dispose(){this._pollSpecs.dispose(),super.dispose()}async refreshUser(){await this._pollSpecs.refresh(),await this._pollSpecs.tick}async requestUser(){if(this.isDisposed)return;let{baseUrl:e}=this.serverSettings,{makeRequest:t,ResponseError:i}=Qh.ServerConnection,r=Yh.URLExt.join(e,td),s=await t(r,{},this.serverSettings);if(s.status!==200)throw await i.create(s);let c={identity:this._identity,permissions:this._permissions},f=await s.json(),v=f.identity,{localStorage:p}=window,h=p.getItem(as);if(h&&(!v.initials||!v.color)){let g=JSON.parse(h);v.initials=v.initials||g.initials||v.name.substring(0,1),v.color=v.color||g.color||us.getRandomColor()}Xh.JSONExt.deepEqual(f,c)||(this._identity=v,this._permissions=f.permissions,p.setItem(as,JSON.stringify(v)),this._userChanged.emit(f))}};_i.UserManager=cs;var us;(function(n){let e=["var(--jp-collaborator-color1)","var(--jp-collaborator-color2)","var(--jp-collaborator-color3)","var(--jp-collaborator-color4)","var(--jp-collaborator-color5)","var(--jp-collaborator-color6)","var(--jp-collaborator-color7)"];n.getRandomColor=()=>e[Math.floor(Math.random()*e.length)]})(us||(us={}))});var ds=F(gi=>{"use strict";Object.defineProperty(gi,"__esModule",{value:!0});gi.WorkspaceManager=void 0;var Ua=ue(),nd=ts(),un=ge(),id="api/workspaces",hs=class extends nd.DataConnector{constructor(e={}){var t;super(),this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:un.ServerConnection.makeSettings()}async fetch(e){let{serverSettings:t}=this,{baseUrl:i,appUrl:r}=t,{makeRequest:s,ResponseError:c}=un.ServerConnection,f=i+r,v=Tt.url(f,e),p=await s(v,{},t);if(p.status!==200)throw await c.create(p);return p.json()}async list(){let{serverSettings:e}=this,{baseUrl:t,appUrl:i}=e,{makeRequest:r,ResponseError:s}=un.ServerConnection,c=t+i,f=Tt.url(c,""),v=await r(f,{},e);if(v.status!==200)throw await s.create(v);return(await v.json()).workspaces}async remove(e){let{serverSettings:t}=this,{baseUrl:i,appUrl:r}=t,{makeRequest:s,ResponseError:c}=un.ServerConnection,f=i+r,v=Tt.url(f,e),h=await s(v,{method:"DELETE"},t);if(h.status!==204)throw await c.create(h)}async save(e,t){let{serverSettings:i}=this,{baseUrl:r,appUrl:s}=i,{makeRequest:c,ResponseError:f}=un.ServerConnection,v=r+s,p=Tt.url(v,e),h={body:JSON.stringify(t),method:"PUT"},g=await c(p,h,i);if(g.status!==204)throw await f.create(g)}};gi.WorkspaceManager=hs;var Tt;(function(n){function e(t,i){let r=Ua.URLExt.join(t,id),s=Ua.URLExt.join(r,i);if(!s.startsWith(r))throw new Error("Can only be used for workspaces requests");return s}n.url=e})(Tt||(Tt={}))});var Na=F(pi=>{"use strict";Object.defineProperty(pi,"__esModule",{value:!0});pi.ServiceManager=void 0;var La=Oe(),rd=ra(),sd=Pr(),od=jr(),ld=Ur(),ad=Gn(),cd=$r(),ud=ge(),fd=zr(),hd=rs(),dd=ls(),_d=fs(),gd=ds(),_s=class{constructor(e={}){var t,i;this._isDisposed=!1,this._connectionFailure=new La.Signal(this),this._isReady=!1;let r=e.defaultDrive,s=(t=e.serverSettings)!==null&&t!==void 0?t:ud.ServerConnection.makeSettings(),c=(i=e.standby)!==null&&i!==void 0?i:"when-hidden",f={defaultDrive:r,serverSettings:s,standby:c};this.serverSettings=s,this.contents=e.contents||new sd.ContentsManager(f),this.events=e.events||new od.EventManager(f),this.kernels=e.kernels||new ld.KernelManager(f),this.sessions=e.sessions||new fd.SessionManager({...f,kernelManager:this.kernels}),this.settings=e.settings||new hd.SettingManager(f),this.terminals=e.terminals||new dd.TerminalManager(f),this.builder=e.builder||new rd.BuildManager(f),this.workspaces=e.workspaces||new gd.WorkspaceManager(f),this.nbconvert=e.nbconvert||new cd.NbConvertManager(f),this.kernelspecs=e.kernelspecs||new ad.KernelSpecManager(f),this.user=e.user||new _d.UserManager(f),this.kernelspecs.connectionFailure.connect(this._onConnectionFailure,this),this.sessions.connectionFailure.connect(this._onConnectionFailure,this),this.terminals.connectionFailure.connect(this._onConnectionFailure,this);let v=[this.sessions.ready,this.kernelspecs.ready];this.terminals.isAvailable()&&v.push(this.terminals.ready),this._readyPromise=Promise.all(v).then(()=>{this._isReady=!0})}get connectionFailure(){return this._connectionFailure}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,La.Signal.clearData(this),this.contents.dispose(),this.events.dispose(),this.sessions.dispose(),this.terminals.dispose())}get isReady(){return this._isReady}get ready(){return this._readyPromise}_onConnectionFailure(e,t){this._connectionFailure.emit(t)}};pi.ServiceManager=_s});var at=F(ie=>{"use strict";var pd=ie&&ie.__createBinding||(Object.create?function(n,e,t,i){i===void 0&&(i=t);var r=Object.getOwnPropertyDescriptor(e,t);(!r||("get"in r?!e.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,i,r)}:function(n,e,t,i){i===void 0&&(i=t),n[i]=e[t]}),Ce=ie&&ie.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&pd(e,n,t)};Object.defineProperty(ie,"__esModule",{value:!0});Ce(vt(),ie);Ce(ql(),ie);Ce(Pr(),ie);Ce(jr(),ie);Ce(Ur(),ie);Ce(Gn(),ie);Ce(Na(),ie);Ce(ge(),ie);Ce(zr(),ie);Ce(rs(),ie);Ce(ls(),ie);Ce(fs(),ie);Ce(ds(),ie);Ce($r(),ie)});var gs=F((mi,Aa)=>{(function(n,e){typeof mi=="object"&&typeof Aa<"u"?e(mi):typeof define=="function"&&define.amd?define(["exports"],e):(n=typeof globalThis<"u"?globalThis:n||self,e(n.lumino_algorithm={}))})(mi,function(n){"use strict";n.ArrayExt=void 0,function(u){function d(_,y,l=0,o=-1){let a=_.length;if(a===0)return-1;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S;o<l?S=o+1+(a-l):S=o-l+1;for(let M=0;M<S;++M){let q=(l+M)%a;if(_[q]===y)return q}return-1}u.firstIndexOf=d;function m(_,y,l=-1,o=0){let a=_.length;if(a===0)return-1;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S;l<o?S=l+1+(a-o):S=l-o+1;for(let M=0;M<S;++M){let q=(l-M+a)%a;if(_[q]===y)return q}return-1}u.lastIndexOf=m;function w(_,y,l=0,o=-1){let a=_.length;if(a===0)return-1;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S;o<l?S=o+1+(a-l):S=o-l+1;for(let M=0;M<S;++M){let q=(l+M)%a;if(y(_[q],q))return q}return-1}u.findFirstIndex=w;function R(_,y,l=-1,o=0){let a=_.length;if(a===0)return-1;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S;l<o?S=l+1+(a-o):S=l-o+1;for(let M=0;M<S;++M){let q=(l-M+a)%a;if(y(_[q],q))return q}return-1}u.findLastIndex=R;function U(_,y,l=0,o=-1){let a=w(_,y,l,o);return a!==-1?_[a]:void 0}u.findFirstValue=U;function D(_,y,l=-1,o=0){let a=R(_,y,l,o);return a!==-1?_[a]:void 0}u.findLastValue=D;function k(_,y,l,o=0,a=-1){let S=_.length;if(S===0)return 0;o<0?o=Math.max(0,o+S):o=Math.min(o,S-1),a<0?a=Math.max(0,a+S):a=Math.min(a,S-1);let M=o,q=a-o+1;for(;q>0;){let K=q>>1,Q=M+K;l(_[Q],y)<0?(M=Q+1,q-=K+1):q=K}return M}u.lowerBound=k;function A(_,y,l,o=0,a=-1){let S=_.length;if(S===0)return 0;o<0?o=Math.max(0,o+S):o=Math.min(o,S-1),a<0?a=Math.max(0,a+S):a=Math.min(a,S-1);let M=o,q=a-o+1;for(;q>0;){let K=q>>1,Q=M+K;l(_[Q],y)>0?q=K:(M=Q+1,q-=K+1)}return M}u.upperBound=A;function T(_,y,l){if(_===y)return!0;if(_.length!==y.length)return!1;for(let o=0,a=_.length;o<a;++o)if(l?!l(_[o],y[o]):_[o]!==y[o])return!1;return!0}u.shallowEqual=T;function B(_,y={}){let{start:l,stop:o,step:a}=y;if(a===void 0&&(a=1),a===0)throw new Error("Slice `step` cannot be zero.");let S=_.length;l===void 0?l=a<0?S-1:0:l<0?l=Math.max(l+S,a<0?-1:0):l>=S&&(l=a<0?S-1:S),o===void 0?o=a<0?-1:S:o<0?o=Math.max(o+S,a<0?-1:0):o>=S&&(o=a<0?S-1:S);let M;a<0&&o>=l||a>0&&l>=o?M=0:a<0?M=Math.floor((o-l+1)/a+1):M=Math.floor((o-l-1)/a+1);let q=[];for(let K=0;K<M;++K)q[K]=_[l+K*a];return q}u.slice=B;function L(_,y,l){let o=_.length;if(o<=1||(y<0?y=Math.max(0,y+o):y=Math.min(y,o-1),l<0?l=Math.max(0,l+o):l=Math.min(l,o-1),y===l))return;let a=_[y],S=y<l?1:-1;for(let M=y;M!==l;M+=S)_[M]=_[M+S];_[l]=a}u.move=L;function W(_,y=0,l=-1){let o=_.length;if(!(o<=1))for(y<0?y=Math.max(0,y+o):y=Math.min(y,o-1),l<0?l=Math.max(0,l+o):l=Math.min(l,o-1);y<l;){let a=_[y],S=_[l];_[y++]=S,_[l--]=a}}u.reverse=W;function z(_,y,l=0,o=-1){let a=_.length;if(a<=1||(l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1),l>=o))return;let S=o-l+1;if(y>0?y=y%S:y<0&&(y=(y%S+S)%S),y===0)return;let M=l+y;W(_,l,M-1),W(_,M,o),W(_,l,o)}u.rotate=z;function G(_,y,l=0,o=-1){let a=_.length;if(a===0)return;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S;o<l?S=o+1+(a-l):S=o-l+1;for(let M=0;M<S;++M)_[(l+M)%a]=y}u.fill=G;function Ke(_,y,l){let o=_.length;y<0?y=Math.max(0,y+o):y=Math.min(y,o);for(let a=o;a>y;--a)_[a]=_[a-1];_[y]=l}u.insert=Ke;function Z(_,y){let l=_.length;if(y<0&&(y+=l),y<0||y>=l)return;let o=_[y];for(let a=y+1;a<l;++a)_[a-1]=_[a];return _.length=l-1,o}u.removeAt=Z;function ze(_,y,l=0,o=-1){let a=d(_,y,l,o);return a!==-1&&Z(_,a),a}u.removeFirstOf=ze;function He(_,y,l=-1,o=0){let a=m(_,y,l,o);return a!==-1&&Z(_,a),a}u.removeLastOf=He;function Ge(_,y,l=0,o=-1){let a=_.length;if(a===0)return 0;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S=0;for(let M=0;M<a;++M)l<=o&&M>=l&&M<=o&&_[M]===y||o<l&&(M<=o||M>=l)&&_[M]===y?S++:S>0&&(_[M-S]=_[M]);return S>0&&(_.length=a-S),S}u.removeAllOf=Ge;function Je(_,y,l=0,o=-1){let a,S=w(_,y,l,o);return S!==-1&&(a=Z(_,S)),{index:S,value:a}}u.removeFirstWhere=Je;function Ye(_,y,l=-1,o=0){let a,S=R(_,y,l,o);return S!==-1&&(a=Z(_,S)),{index:S,value:a}}u.removeLastWhere=Ye;function Xe(_,y,l=0,o=-1){let a=_.length;if(a===0)return 0;l<0?l=Math.max(0,l+a):l=Math.min(l,a-1),o<0?o=Math.max(0,o+a):o=Math.min(o,a-1);let S=0;for(let M=0;M<a;++M)l<=o&&M>=l&&M<=o&&y(_[M],M)||o<l&&(M<=o||M>=l)&&y(_[M],M)?S++:S>0&&(_[M-S]=_[M]);return S>0&&(_.length=a-S),S}u.removeAllWhere=Xe}(n.ArrayExt||(n.ArrayExt={}));function*e(...u){for(let d of u)yield*d}function*t(){}function*i(u,d=0){for(let m of u)yield[d++,m]}function*r(u,d){let m=0;for(let w of u)d(w,m++)&&(yield w)}function s(u,d){let m=0;for(let w of u)if(d(w,m++))return w}function c(u,d){let m=0;for(let w of u)if(d(w,m++))return m-1;return-1}function f(u,d){let m;for(let w of u){if(m===void 0){m=w;continue}d(w,m)<0&&(m=w)}return m}function v(u,d){let m;for(let w of u){if(m===void 0){m=w;continue}d(w,m)>0&&(m=w)}return m}function p(u,d){let m=!0,w,R;for(let U of u)m?(w=U,R=U,m=!1):d(U,w)<0?w=U:d(U,R)>0&&(R=U);return m?void 0:[w,R]}function h(u){return Array.from(u)}function g(u){let d={};for(let[m,w]of u)d[m]=w;return d}function b(u,d){let m=0;for(let w of u)if(d(w,m++)===!1)return}function C(u,d){let m=0;for(let w of u)if(d(w,m++)===!1)return!1;return!0}function P(u,d){let m=0;for(let w of u)if(d(w,m++))return!0;return!1}function*O(u,d){let m=0;for(let w of u)yield d(w,m++)}function*I(u,d,m){d===void 0?(d=u,u=0,m=1):m===void 0&&(m=1);let w=N.rangeLength(u,d,m);for(let R=0;R<w;R++)yield u+m*R}var N;(function(u){function d(m,w,R){return R===0?1/0:m>w&&R>0||m<w&&R<0?0:Math.ceil((w-m)/R)}u.rangeLength=d})(N||(N={}));function V(u,d,m){let w=u[Symbol.iterator](),R=0,U=w.next();if(U.done&&m===void 0)throw new TypeError("Reduce of empty iterable with no initial value.");if(U.done)return m;let D=w.next();if(D.done&&m===void 0)return U.value;if(D.done)return d(m,U.value,R++);let k;m===void 0?k=d(U.value,D.value,R++):k=d(d(m,U.value,R++),D.value,R++);let A;for(;!(A=w.next()).done;)k=d(k,A.value,R++);return k}function*$(u,d){for(;0<d--;)yield u}function*j(u){yield u}function*J(u){if(typeof u.retro=="function")yield*u.retro();else for(let d=u.length-1;d>-1;d--)yield u[d]}function X(u){let d=[],m=new Set,w=new Map;for(let D of u)R(D);for(let[D]of w)U(D);return d;function R(D){let[k,A]=D,T=w.get(A);T?T.push(k):w.set(A,[k])}function U(D){if(m.has(D))return;m.add(D);let k=w.get(D);if(k)for(let A of k)U(A);d.push(D)}}function*H(u,d){let m=0;for(let w of u)m++%d===0&&(yield w)}n.StringExt=void 0,function(u){function d(D,k,A=0){let T=new Array(k.length);for(let B=0,L=A,W=k.length;B<W;++B,++L){if(L=D.indexOf(k[B],L),L===-1)return null;T[B]=L}return T}u.findIndices=d;function m(D,k,A=0){let T=d(D,k,A);if(!T)return null;let B=0;for(let L=0,W=T.length;L<W;++L){let z=T[L]-A;B+=z*z}return{score:B,indices:T}}u.matchSumOfSquares=m;function w(D,k,A=0){let T=d(D,k,A);if(!T)return null;let B=0,L=A-1;for(let W=0,z=T.length;W<z;++W){let G=T[W];B+=G-L-1,L=G}return{score:B,indices:T}}u.matchSumOfDeltas=w;function R(D,k,A){let T=[],B=0,L=0,W=k.length;for(;B<W;){let z=k[B],G=k[B];for(;++B<W&&k[B]===G+1;)G++;L<z&&T.push(D.slice(L,z)),z<G+1&&T.push(A(D.slice(z,G+1))),L=G+1}return L<D.length&&T.push(D.slice(L)),T}u.highlight=R;function U(D,k){return D<k?-1:D>k?1:0}u.cmp=U}(n.StringExt||(n.StringExt={}));function*E(u,d){if(d<1)return;let m=u[Symbol.iterator](),w;for(;0<d--&&!(w=m.next()).done;)yield w.value}function*x(...u){let d=u.map(w=>w[Symbol.iterator]()),m=d.map(w=>w.next());for(;C(m,w=>!w.done);m=d.map(w=>w.next()))yield m.map(w=>w.value)}n.chain=e,n.each=b,n.empty=t,n.enumerate=i,n.every=C,n.filter=r,n.find=s,n.findIndex=c,n.map=O,n.max=v,n.min=f,n.minmax=p,n.once=j,n.range=I,n.reduce=V,n.repeat=$,n.retro=J,n.some=P,n.stride=H,n.take=E,n.toArray=h,n.toObject=g,n.topologicSort=X,n.zip=x})});var Fa=F(be=>{"use strict";var md=gs();be.JSONExt=void 0;(function(n){n.emptyObject=Object.freeze({}),n.emptyArray=Object.freeze([]);function e(h){return h===null||typeof h=="boolean"||typeof h=="number"||typeof h=="string"}n.isPrimitive=e;function t(h){return Array.isArray(h)}n.isArray=t;function i(h){return!e(h)&&!t(h)}n.isObject=i;function r(h,g){if(h===g)return!0;if(e(h)||e(g))return!1;let b=t(h),C=t(g);return b!==C?!1:b&&C?c(h,g):f(h,g)}n.deepEqual=r;function s(h){return e(h)?h:t(h)?v(h):p(h)}n.deepCopy=s;function c(h,g){if(h===g)return!0;if(h.length!==g.length)return!1;for(let b=0,C=h.length;b<C;++b)if(!r(h[b],g[b]))return!1;return!0}function f(h,g){if(h===g)return!0;for(let b in h)if(h[b]!==void 0&&!(b in g))return!1;for(let b in g)if(g[b]!==void 0&&!(b in h))return!1;for(let b in h){let C=h[b],P=g[b];if(!(C===void 0&&P===void 0)&&(C===void 0||P===void 0||!r(C,P)))return!1}return!0}function v(h){let g=new Array(h.length);for(let b=0,C=h.length;b<C;++b)g[b]=s(h[b]);return g}function p(h){let g={};for(let b in h){let C=h[b];C!==void 0&&(g[b]=s(C))}return g}})(be.JSONExt||(be.JSONExt={}));var ps=class{constructor(){this._types=[],this._values=[]}types(){return this._types.slice()}hasData(e){return this._types.indexOf(e)!==-1}getData(e){let t=this._types.indexOf(e);return t!==-1?this._values[t]:void 0}setData(e,t){this.clearData(e),this._types.push(e),this._values.push(t)}clearData(e){let t=this._types.indexOf(e);t!==-1&&(this._types.splice(t,1),this._values.splice(t,1))}clear(){this._types.length=0,this._values.length=0}},ms=class{constructor(e={}){this._application=null,this._validatePlugin=()=>!0,this._plugins=new Map,this._services=new Map,e.validatePlugin&&(console.info("Plugins may be rejected by the custom validation plugin method."),this._validatePlugin=e.validatePlugin)}get application(){return this._application}set application(e){if(this._application!==null)throw Error("PluginRegistry.application is already set. It cannot be overridden.");this._application=e}get deferredPlugins(){return Array.from(this._plugins).filter(([e,t])=>t.autoStart==="defer").map(([e,t])=>e)}getPluginDescription(e){var t,i;return(i=(t=this._plugins.get(e))===null||t===void 0?void 0:t.description)!==null&&i!==void 0?i:""}hasPlugin(e){return this._plugins.has(e)}isPluginActivated(e){var t,i;return(i=(t=this._plugins.get(e))===null||t===void 0?void 0:t.activated)!==null&&i!==void 0?i:!1}listPlugins(){return Array.from(this._plugins.keys())}registerPlugin(e){if(this._plugins.has(e.id))throw new TypeError(`Plugin '${e.id}' is already registered.`);if(!this._validatePlugin(e))throw new Error(`Plugin '${e.id}' is not valid.`);let t=It.createPluginData(e);It.ensureNoCycle(t,this._plugins,this._services),t.provides&&this._services.set(t.provides,t.id),this._plugins.set(t.id,t)}registerPlugins(e){for(let t of e)this.registerPlugin(t)}deregisterPlugin(e,t){let i=this._plugins.get(e);if(i){if(i.activated&&!t)throw new Error(`Plugin '${e}' is still active.`);this._plugins.delete(e)}}async activatePlugin(e){let t=this._plugins.get(e);if(!t)throw new ReferenceError(`Plugin '${e}' is not registered.`);if(t.activated)return;if(t.promise)return t.promise;let i=t.requires.map(s=>this.resolveRequiredService(s)),r=t.optional.map(s=>this.resolveOptionalService(s));return t.promise=Promise.all([...i,...r]).then(s=>t.activate.apply(void 0,[this.application,...s])).then(s=>{t.service=s,t.activated=!0,t.promise=null}).catch(s=>{throw t.promise=null,s}),t.promise}async activatePlugins(e,t={}){switch(e){case"defer":{let i=this.deferredPlugins.filter(r=>this._plugins.get(r).autoStart).map(r=>this.activatePlugin(r));await Promise.all(i);break}case"startUp":{let r=It.collectStartupPlugins(this._plugins,t).map(async s=>{try{return await this.activatePlugin(s)}catch(c){console.error(`Plugin '${s}' failed to activate.`,c)}});await Promise.all(r);break}}}async deactivatePlugin(e){let t=this._plugins.get(e);if(!t)throw new ReferenceError(`Plugin '${e}' is not registered.`);if(!t.activated)return[];if(!t.deactivate)throw new TypeError(`Plugin '${e}'#deactivate() method missing`);let i=It.findDependents(e,this._plugins,this._services),r=i.map(s=>this._plugins.get(s));for(let s of r)if(!s.deactivate)throw new TypeError(`Plugin ${s.id}#deactivate() method missing (depends on ${e})`);for(let s of r){let c=[...s.requires,...s.optional].map(f=>{let v=this._services.get(f);return v?this._plugins.get(v).service:null});await s.deactivate(this.application,...c),s.service=null,s.activated=!1}return i.pop(),i}async resolveRequiredService(e){let t=this._services.get(e);if(!t)throw new TypeError(`No provider for: ${e.name}.`);let i=this._plugins.get(t);return i.activated||await this.activatePlugin(t),i.service}async resolveOptionalService(e){let t=this._services.get(e);if(!t)return null;let i=this._plugins.get(t);if(!i.activated)try{await this.activatePlugin(t)}catch(r){return console.error(r),null}return i.service}},It;(function(n){class e{constructor(f){var v,p,h,g;this._activated=!1,this._promise=null,this._service=null,this.id=f.id,this.description=(v=f.description)!==null&&v!==void 0?v:"",this.activate=f.activate,this.deactivate=(p=f.deactivate)!==null&&p!==void 0?p:null,this.provides=(h=f.provides)!==null&&h!==void 0?h:null,this.autoStart=(g=f.autoStart)!==null&&g!==void 0?g:!1,this.requires=f.requires?f.requires.slice():[],this.optional=f.optional?f.optional.slice():[]}get activated(){return this._activated}set activated(f){this._activated=f}get service(){return this._service}set service(f){this._service=f}get promise(){return this._promise}set promise(f){this._promise=f}}function t(c){return new e(c)}n.createPluginData=t;function i(c,f,v){let p=[...c.requires,...c.optional],h=b=>{if(b===c.provides)return!0;let C=v.get(b);if(!C)return!1;let P=f.get(C),O=[...P.requires,...P.optional];return O.length===0?!1:(g.push(C),O.some(h)?!0:(g.pop(),!1))};if(!c.provides||p.length===0)return;let g=[c.id];if(p.some(h))throw new ReferenceError(`Cycle detected: ${g.join(" -> ")}.`)}n.ensureNoCycle=i;function r(c,f,v){let p=new Array,h=O=>{let I=f.get(O),N=[...I.requires,...I.optional];p.push(...N.reduce((V,$)=>{let j=v.get($);return j&&V.push([O,j]),V},[]))};for(let O of f.keys())h(O);let g=p.filter(O=>O[1]===c),b=0;for(;g.length>b;){let O=g.length,I=new Set(g.map(N=>N[0]));for(let N of I)p.filter(V=>V[1]===N).forEach(V=>{g.includes(V)||g.push(V)});b=O}let C=md.topologicSort(g),P=C.findIndex(O=>O===c);return P===-1?[c]:C.slice(0,P+1)}n.findDependents=r;function s(c,f){let v=new Set;for(let p of c.keys())c.get(p).autoStart===!0&&v.add(p);if(f.startPlugins)for(let p of f.startPlugins)v.add(p);if(f.ignorePlugins)for(let p of f.ignorePlugins)v.delete(p);return Array.from(v)}n.collectStartupPlugins=s})(It||(It={}));var vs=class{constructor(){this.promise=new Promise((e,t)=>{this._resolve=e,this._reject=t})}resolve(e){let t=this._resolve;t(e)}reject(e){let t=this._reject;t(e)}},ys=class{constructor(e,t){this.name=e,this.description=t??"",this._tokenStructuralPropertyT=null}};function vd(n){let e=0;for(let t=0,i=n.length;t<i;++t)t%4===0&&(e=Math.random()*4294967295>>>0),n[t]=e&255,e>>>=8}be.Random=void 0;(function(n){n.getRandomValues=(()=>{let e=typeof require<"u"&&require("crypto")||null;return e&&typeof e.randomFillSync=="function"?function(i){return e.randomFillSync(i)}:e&&typeof e.randomBytes=="function"?function(i){let r=e.randomBytes(i.length);for(let s=0,c=r.length;s<c;++s)i[s]=r[s]}:vd})()})(be.Random||(be.Random={}));function yd(n){let e=new Uint8Array(16),t=new Array(256);for(let i=0;i<16;++i)t[i]="0"+i.toString(16);for(let i=16;i<256;++i)t[i]=i.toString(16);return function(){return n(e),e[6]=64|e[6]&15,e[8]=128|e[8]&63,t[e[0]]+t[e[1]]+t[e[2]]+t[e[3]]+"-"+t[e[4]]+t[e[5]]+"-"+t[e[6]]+t[e[7]]+"-"+t[e[8]]+t[e[9]]+"-"+t[e[10]]+t[e[11]]+t[e[12]]+t[e[13]]+t[e[14]]+t[e[15]]}}be.UUID=void 0;(function(n){n.uuid4=yd(be.Random.getRandomValues)})(be.UUID||(be.UUID={}));be.MimeData=ps;be.PluginRegistry=ms;be.PromiseDelegate=vs;be.Token=ys});var Va=F((vi,Ba)=>{(function(n,e){typeof vi=="object"&&typeof Ba<"u"?e(vi,gs(),Fa()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm","@lumino/coreutils"],e):(n=typeof globalThis<"u"?globalThis:n||self,e(n.lumino_signaling={},n.lumino_algorithm,n.lumino_coreutils))})(vi,function(n,e,t){"use strict";class i{constructor(f){this.sender=f}connect(f,v){return s.connect(this,f,v)}disconnect(f,v){return s.disconnect(this,f,v)}emit(f){s.emit(this,f)}}(function(c){function f(P,O){s.disconnectBetween(P,O)}c.disconnectBetween=f;function v(P){s.disconnectSender(P)}c.disconnectSender=v;function p(P){s.disconnectReceiver(P)}c.disconnectReceiver=p;function h(P){s.disconnectAll(P)}c.disconnectAll=h;function g(P){s.disconnectAll(P)}c.clearData=g;function b(){return s.exceptionHandler}c.getExceptionHandler=b;function C(P){let O=s.exceptionHandler;return s.exceptionHandler=P,O}c.setExceptionHandler=C})(i||(i={}));class r extends i{constructor(){super(...arguments),this._pending=new t.PromiseDelegate}async*[Symbol.asyncIterator](){let f=this._pending;for(;;)try{let{args:v,next:p}=await f.promise;f=p,yield v}catch{return}}emit(f){let v=this._pending,p=this._pending=new t.PromiseDelegate;v.resolve({args:f,next:p}),super.emit(f)}stop(){this._pending.promise.catch(()=>{}),this._pending.reject("stop"),this._pending=new t.PromiseDelegate}}var s;(function(c){c.exceptionHandler=E=>{console.error(E)};function f(E,x,u){u=u||void 0;let d=P.get(E.sender);if(d||(d=[],P.set(E.sender,d)),V(d,E,x,u))return!1;let m=u||x,w=O.get(m);w||(w=[],O.set(m,w));let R={signal:E,slot:x,thisArg:u};return d.push(R),w.push(R),!0}c.connect=f;function v(E,x,u){u=u||void 0;let d=P.get(E.sender);if(!d||d.length===0)return!1;let m=V(d,E,x,u);if(!m)return!1;let w=u||x,R=O.get(w);return m.signal=null,j(d),j(R),!0}c.disconnect=v;function p(E,x){let u=P.get(E);if(!u||u.length===0)return;let d=O.get(x);if(!(!d||d.length===0)){for(let m of d)m.signal&&m.signal.sender===E&&(m.signal=null);j(u),j(d)}}c.disconnectBetween=p;function h(E){let x=P.get(E);if(!(!x||x.length===0)){for(let u of x){if(!u.signal)continue;let d=u.thisArg||u.slot;u.signal=null,j(O.get(d))}j(x)}}c.disconnectSender=h;function g(E){let x=O.get(E);if(!(!x||x.length===0)){for(let u of x){if(!u.signal)continue;let d=u.signal.sender;u.signal=null,j(P.get(d))}j(x)}}c.disconnectReceiver=g;function b(E){h(E),g(E)}c.disconnectAll=b;function C(E,x){let u=P.get(E.sender);if(!(!u||u.length===0))for(let d=0,m=u.length;d<m;++d){let w=u[d];w.signal===E&&$(w,x)}}c.emit=C;let P=new WeakMap,O=new WeakMap,I=new Set,N=(()=>typeof requestAnimationFrame=="function"?requestAnimationFrame:setImmediate)();function V(E,x,u,d){return e.find(E,m=>m.signal===x&&m.slot===u&&m.thisArg===d)}function $(E,x){let{signal:u,slot:d,thisArg:m}=E;try{d.call(m,u.sender,x)}catch(w){c.exceptionHandler(w)}}function j(E){I.size===0&&N(J),I.add(E)}function J(){I.forEach(X),I.clear()}function X(E){e.ArrayExt.removeAllWhere(E,H)}function H(E){return E.signal===null}})(s||(s={})),n.Signal=i,n.Stream=r})});var ws=F((yi,Wa)=>{(function(n,e){typeof yi=="object"&&typeof Wa<"u"?e(yi,Va()):typeof define=="function"&&define.amd?define(["exports","@lumino/signaling"],e):(n=typeof globalThis<"u"?globalThis:n||self,e(n.lumino_disposable={},n.lumino_signaling))})(yi,function(n,e){"use strict";class t{constructor(f){this._fn=f}get isDisposed(){return!this._fn}dispose(){if(!this._fn)return;let f=this._fn;this._fn=null,f()}}class i extends t{constructor(){super(...arguments),this._disposed=new e.Signal(this)}get disposed(){return this._disposed}dispose(){this.isDisposed||(super.dispose(),this._disposed.emit(void 0),e.Signal.clearData(this))}}class r{constructor(){this._isDisposed=!1,this._items=new Set}get isDisposed(){return this._isDisposed}dispose(){this._isDisposed||(this._isDisposed=!0,this._items.forEach(f=>{f.dispose()}),this._items.clear())}contains(f){return this._items.has(f)}add(f){this._items.add(f)}remove(f){this._items.delete(f)}clear(){this._items.clear()}}(function(c){function f(v){let p=new c;for(let h of v)p.add(h);return p}c.from=f})(r||(r={}));class s extends r{constructor(){super(...arguments),this._disposed=new e.Signal(this)}get disposed(){return this._disposed}dispose(){this.isDisposed||(super.dispose(),this._disposed.emit(void 0),e.Signal.clearData(this))}}(function(c){function f(v){let p=new c;for(let h of v)p.add(h);return p}c.from=f})(s||(s={})),n.DisposableDelegate=t,n.DisposableSet=r,n.ObservableDisposableDelegate=i,n.ObservableDisposableSet=s})});var $a=F(We=>{"use strict";var wd=We&&We.__createBinding||(Object.create?function(n,e,t,i){i===void 0&&(i=t);var r=Object.getOwnPropertyDescriptor(e,t);(!r||("get"in r?!e.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,i,r)}:function(n,e,t,i){i===void 0&&(i=t),n[i]=e[t]}),Sd=We&&We.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),bd=We&&We.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.prototype.hasOwnProperty.call(n,t)&&wd(e,n,t);return Sd(e,n),e};Object.defineProperty(We,"__esModule",{value:!0});We.CommHandler=void 0;var Md=ws(),wi=bd(Pt()),Ss=class extends Md.DisposableDelegate{constructor(e,t,i,r){super(r),this._target="",this._id="",this._id=t,this._target=e,this._kernel=i}get commId(){return this._id}get targetName(){return this._target}get onClose(){return this._onClose}set onClose(e){this._onClose=e}get onMsg(){return this._onMsg}set onMsg(e){this._onMsg=e}open(e,t,i=[]){if(this.isDisposed||this._kernel.isDisposed)throw new Error("Cannot open");let r=wi.createMessage({msgType:"comm_open",channel:"shell",username:this._kernel.username,session:this._kernel.clientId,content:{comm_id:this._id,target_name:this._target,data:e??{}},metadata:t,buffers:i});return this._kernel.sendShellMessage(r,!1,!0)}send(e,t,i=[],r=!0){if(this.isDisposed||this._kernel.isDisposed)throw new Error("Cannot send");let s=wi.createMessage({msgType:"comm_msg",channel:"shell",username:this._kernel.username,session:this._kernel.clientId,content:{comm_id:this._id,data:e},metadata:t,buffers:i});return this._kernel.sendShellMessage(s,!1,r)}close(e,t,i=[]){if(this.isDisposed||this._kernel.isDisposed)throw new Error("Cannot close");let r=wi.createMessage({msgType:"comm_close",channel:"shell",username:this._kernel.username,session:this._kernel.clientId,content:{comm_id:this._id,data:e??{}},metadata:t,buffers:i}),s=this._kernel.sendShellMessage(r,!1,!0),c=this._onClose;if(c){let f=wi.createMessage({msgType:"comm_close",channel:"iopub",username:this._kernel.username,session:this._kernel.clientId,content:{comm_id:this._id,data:e??{}},metadata:t,buffers:i});c(f)}return this.dispose(),s}};We.CommHandler=Ss});var za=F(Pe=>{"use strict";var Cd=Pe&&Pe.__createBinding||(Object.create?function(n,e,t,i){i===void 0&&(i=t);var r=Object.getOwnPropertyDescriptor(e,t);(!r||("get"in r?!e.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,i,r)}:function(n,e,t,i){i===void 0&&(i=t),n[i]=e[t]}),Pd=Pe&&Pe.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),Ed=Pe&&Pe.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.prototype.hasOwnProperty.call(n,t)&&Cd(e,n,t);return Pd(e,n),e};Object.defineProperty(Pe,"__esModule",{value:!0});Pe.KernelShellFutureHandler=Pe.KernelControlFutureHandler=Pe.KernelFutureHandler=void 0;var Ka=Ue(),Od=ws(),Rd=Ed(Pt()),fn=class extends Od.DisposableDelegate{constructor(e,t,i,r,s){super(e),this._status=0,this._stdin=ae.noOp,this._iopub=ae.noOp,this._reply=ae.noOp,this._done=new Ka.PromiseDelegate,this._hooks=new ae.HookList,this._disposeOnDone=!0,this._msg=t,i||this._setFlag(ae.KernelFutureFlag.GotReply),this._disposeOnDone=r,this._kernel=s}get msg(){return this._msg}get done(){return this._done.promise}get onReply(){return this._reply}set onReply(e){this._reply=e}get onIOPub(){return this._iopub}set onIOPub(e){this._iopub=e}get onStdin(){return this._stdin}set onStdin(e){this._stdin=e}registerMessageHook(e){if(this.isDisposed)throw new Error("Kernel future is disposed");this._hooks.add(e)}removeMessageHook(e){this.isDisposed||this._hooks.remove(e)}sendInputReply(e,t){this._kernel.sendInputReply(e,t)}dispose(){this._stdin=ae.noOp,this._iopub=ae.noOp,this._reply=ae.noOp,this._hooks=null,this._testFlag(ae.KernelFutureFlag.IsDone)||(this._done.promise.catch(()=>{}),this._done.reject(new Error(`Canceled future for ${this.msg.header.msg_type} message before replies were done`))),super.dispose()}async handleMsg(e){switch(e.channel){case"control":case"shell":e.channel===this.msg.channel&&e.parent_header.msg_id===this.msg.header.msg_id&&await this._handleReply(e);break;case"stdin":await this._handleStdin(e);break;case"iopub":await this._handleIOPub(e);break;default:break}}async _handleReply(e){let t=this._reply;t&&await t(e),this._replyMsg=e,this._setFlag(ae.KernelFutureFlag.GotReply),this._testFlag(ae.KernelFutureFlag.GotIdle)&&this._handleDone()}async _handleStdin(e){this._kernel.hasPendingInput=!0;let t=this._stdin;t&&await t(e)}async _handleIOPub(e){let t=await this._hooks.process(e),i=this._iopub;t&&i&&await i(e),Rd.isStatusMsg(e)&&e.content.execution_state==="idle"&&(this._setFlag(ae.KernelFutureFlag.GotIdle),this._testFlag(ae.KernelFutureFlag.GotReply)&&this._handleDone())}_handleDone(){this._testFlag(ae.KernelFutureFlag.IsDone)||(this._setFlag(ae.KernelFutureFlag.IsDone),this._done.resolve(this._replyMsg),this._disposeOnDone&&this.dispose())}_testFlag(e){return(this._status&e)!==0}_setFlag(e){this._status|=e}};Pe.KernelFutureHandler=fn;var bs=class extends fn{};Pe.KernelControlFutureHandler=bs;var Ms=class extends fn{};Pe.KernelShellFutureHandler=Ms;var ae;(function(n){n.noOp=()=>{};let e=(()=>typeof requestAnimationFrame=="function"?requestAnimationFrame:setImmediate)();class t{constructor(){this._hooks=[]}add(s){this.remove(s),this._hooks.push(s)}remove(s){let c=this._hooks.indexOf(s);c>=0&&(this._hooks[c]=null,this._scheduleCompact())}async process(s){await this._processing;let c=new Ka.PromiseDelegate;this._processing=c.promise;let f;for(let v=this._hooks.length-1;v>=0;v--){let p=this._hooks[v];if(p!==null){try{f=await p(s)}catch(h){f=!0,console.error(h)}if(f===!1)return c.resolve(void 0),!1}}return c.resolve(void 0),!0}_scheduleCompact(){this._compactScheduled||(this._compactScheduled=!0,e(()=>{this._processing=this._processing.then(()=>{this._compactScheduled=!1,this._compact()})}))}_compact(){let s=0;for(let c=0,f=this._hooks.length;c<f;c++){let v=this._hooks[c];this._hooks[c]===null?s++:this._hooks[c-s]=v}this._hooks.length-=s}}n.HookList=t;let i;(function(r){r[r.GotReply=1]="GotReply",r[r.GotIdle=2]="GotIdle",r[r.IsDone=4]="IsDone",r[r.DisposeOnDone=8]="DisposeOnDone"})(i=n.KernelFutureFlag||(n.KernelFutureFlag={}))})(ae||(ae={}))});var Tr=F($e=>{var Dd=$e&&$e.__createBinding||(Object.create?function(n,e,t,i){i===void 0&&(i=t);var r=Object.getOwnPropertyDescriptor(e,t);(!r||("get"in r?!e.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,i,r)}:function(n,e,t,i){i===void 0&&(i=t),n[i]=e[t]}),xd=$e&&$e.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),Ps=$e&&$e.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.prototype.hasOwnProperty.call(n,t)&&Dd(e,n,t);return xd(e,n),e};Object.defineProperty($e,"__esModule",{value:!0});$e.KernelConnection=void 0;var Ha=ue(),dt=Ue(),_t=Oe(),Ga=at(),Ja=$a(),Ee=Ps(Pt()),Ya=za(),kd=Ps(Wn()),qd=Gn(),hn=Ps(Kn()),jd=3e3,Ut="_RESTARTING_",Td="",Cs=class n{constructor(e){var t,i,r,s;this._createSocket=(c=!0)=>{this._errorIfDisposed(),this._clearSocket(),this._updateConnectionStatus("connecting");let f=this.serverSettings,v=Ha.URLExt.join(f.wsUrl,hn.KERNEL_SERVICE_URL,encodeURIComponent(this._id)),p=v.replace(/^((?:\w+:)?\/\/)(?:[^@\/]+@)/,"$1"),h=Ha.URLExt.join(v,"channels?session_id="+encodeURIComponent(this._clientId)),g=f.token;f.appendToken&&g!==""&&(h=h+`&token=${encodeURIComponent(g)}`);let b=c?this._supportedProtocols:[];this._ws=new f.WebSocket(h,b),this._ws.binaryType="arraybuffer";let C=!1,P=async I=>{var N,V;if(!this._isDisposed){this._reason="",this._model=void 0;try{let $=await hn.getKernelModel(this._id,f);this._model=$,$?.execution_state==="dead"?this._updateStatus("dead"):this._onWSClose(I)}catch($){if($ instanceof Ga.ServerConnection.NetworkError||((N=$.response)===null||N===void 0?void 0:N.status)===503||((V=$.response)===null||V===void 0?void 0:V.status)===424){let j=ke.getRandomIntInclusive(10,30)*1e3;setTimeout(P,j,I)}else this._reason="Kernel died unexpectedly",this._updateStatus("dead")}}},O=async I=>{C||(C=!0,await P(I))};this._ws.onmessage=this._onWSMessage,this._ws.onopen=this._onWSOpen,this._ws.onclose=O,this._ws.onerror=O},this._onWSOpen=c=>{if(this._ws.protocol!==""&&!this._supportedProtocols.includes(this._ws.protocol))throw console.log("Server selected unknown kernel wire protocol:",this._ws.protocol),this._updateStatus("dead"),new Error(`Unknown kernel wire protocol:  ${this._ws.protocol}`);this._selectedProtocol=this._ws.protocol,this._ws.onclose=this._onWSClose,this._ws.onerror=this._onWSClose,this._updateConnectionStatus("connected")},this._onWSMessage=c=>{let f;try{f=this.serverSettings.serializer.deserialize(c.data,this._ws.protocol),kd.validateMessage(f)}catch(v){throw v.message=`Kernel message validation error: ${v.message}`,v}this._kernelSession=f.header.session,this._msgChain=this._msgChain.then(()=>this._handleMessage(f)).catch(v=>{v.message.startsWith("Canceled future for ")&&console.error(v)}),this._anyMessage.emit({msg:f,direction:"recv"})},this._onWSClose=c=>{this.isDisposed||this._reconnect()},this._id="",this._name="",this._status="unknown",this._connectionStatus="connecting",this._kernelSession="",this._isDisposed=!1,this._ws=null,this._username="",this._reconnectLimit=7,this._reconnectAttempt=0,this._reconnectTimeout=null,this._supportedProtocols=Object.values(Ee.supportedKernelWebSocketProtocols),this._selectedProtocol="",this._futures=new Map,this._comms=new Map,this._targetRegistry=Object.create(null),this._info=new dt.PromiseDelegate,this._pendingMessages=[],this._statusChanged=new _t.Signal(this),this._connectionStatusChanged=new _t.Signal(this),this._disposed=new _t.Signal(this),this._iopubMessage=new _t.Signal(this),this._anyMessage=new _t.Signal(this),this._pendingInput=new _t.Signal(this),this._unhandledMessage=new _t.Signal(this),this._displayIdToParentIds=new Map,this._msgIdToDisplayIds=new Map,this._msgChain=Promise.resolve(),this._hasPendingInput=!1,this._reason="",this._noOp=()=>{},this._name=e.model.name,this._id=e.model.id,this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:Ga.ServerConnection.makeSettings(),this._clientId=(i=e.clientId)!==null&&i!==void 0?i:dt.UUID.uuid4(),this._username=(r=e.username)!==null&&r!==void 0?r:"",this.handleComms=(s=e.handleComms)!==null&&s!==void 0?s:!0,this._createSocket()}get disposed(){return this._disposed}get statusChanged(){return this._statusChanged}get connectionStatusChanged(){return this._connectionStatusChanged}get iopubMessage(){return this._iopubMessage}get unhandledMessage(){return this._unhandledMessage}get model(){return this._model||{id:this.id,name:this.name,reason:this._reason}}get anyMessage(){return this._anyMessage}get pendingInput(){return this._pendingInput}get id(){return this._id}get name(){return this._name}get username(){return this._username}get clientId(){return this._clientId}get status(){return this._status}get connectionStatus(){return this._connectionStatus}get isDisposed(){return this._isDisposed}get info(){return this._info.promise}get spec(){return this._specPromise?this._specPromise:(this._specPromise=qd.KernelSpecAPI.getSpecs(this.serverSettings).then(e=>e.kernelspecs[this._name]),this._specPromise)}clone(e={}){return new n({model:this.model,username:this.username,serverSettings:this.serverSettings,handleComms:!1,...e})}dispose(){this.isDisposed||(this._isDisposed=!0,this._disposed.emit(),this._updateConnectionStatus("disconnected"),this._clearKernelState(),this._pendingMessages=[],this._clearSocket(),_t.Signal.clearData(this))}sendShellMessage(e,t=!1,i=!0){return this._sendKernelShellControl(Ya.KernelShellFutureHandler,e,t,i)}sendControlMessage(e,t=!1,i=!0){return this._sendKernelShellControl(Ya.KernelControlFutureHandler,e,t,i)}_sendKernelShellControl(e,t,i=!1,r=!0){this._sendMessage(t),this._anyMessage.emit({msg:t,direction:"send"});let s=new e(()=>{let c=t.header.msg_id;this._futures.delete(c);let f=this._msgIdToDisplayIds.get(c);f&&(f.forEach(v=>{let p=this._displayIdToParentIds.get(v);if(p){let h=p.indexOf(c);if(h===-1)return;p.length===1?this._displayIdToParentIds.delete(v):(p.splice(h,1),this._displayIdToParentIds.set(v,p))}}),this._msgIdToDisplayIds.delete(c))},t,i,r,this);return this._futures.set(t.header.msg_id,s),s}_sendMessage(e,t=!0){if(this.status==="dead")throw new Error("Kernel is dead");if((this._kernelSession===Td||this._kernelSession===Ut)&&Ee.isInfoRequestMsg(e))if(this.connectionStatus==="connected"){this._ws.send(this.serverSettings.serializer.serialize(e,this._ws.protocol));return}else throw new Error("Could not send message: status is not connected");if(t&&this._pendingMessages.length>0){this._pendingMessages.push(e);return}if(this.connectionStatus==="connected"&&this._kernelSession!==Ut)this._ws.send(this.serverSettings.serializer.serialize(e,this._ws.protocol));else if(t)this._pendingMessages.push(e);else throw new Error("Could not send message")}async interrupt(){if(this.hasPendingInput=!1,this.status==="dead")throw new Error("Kernel is dead");return hn.interruptKernel(this.id,this.serverSettings)}async restart(){if(this.status==="dead")throw new Error("Kernel is dead");this._updateStatus("restarting"),this._clearKernelState(),this._kernelSession=Ut,await hn.restartKernel(this.id,this.serverSettings),await this.reconnect(),this.hasPendingInput=!1}reconnect(){this._errorIfDisposed();let e=new dt.PromiseDelegate,t=(i,r)=>{r==="connected"?(e.resolve(),this.connectionStatusChanged.disconnect(t,this)):r==="disconnected"&&(e.reject(new Error("Kernel connection disconnected")),this.connectionStatusChanged.disconnect(t,this))};return this.connectionStatusChanged.connect(t,this),this._reconnectAttempt=0,this._reconnect(),e.promise}async shutdown(){this.status!=="dead"&&await hn.shutdownKernel(this.id,this.serverSettings),this.handleShutdown()}handleShutdown(){this._updateStatus("dead"),this.dispose()}async requestKernelInfo(){let e=Ee.createMessage({msgType:"kernel_info_request",channel:"shell",username:this._username,session:this._clientId,content:{}}),t;try{t=await ke.handleShellMessage(this,e)}catch(i){if(this.isDisposed)return;throw i}if(this._errorIfDisposed(),!!t)return t.content.status===void 0&&(t.content.status="ok"),t.content.status!=="ok"?(this._info.reject("Kernel info reply errored"),t):(this._info.resolve(t.content),this._kernelSession=t.header.session,t)}requestComplete(e){let t=Ee.createMessage({msgType:"complete_request",channel:"shell",username:this._username,session:this._clientId,content:e});return ke.handleShellMessage(this,t)}requestInspect(e){let t=Ee.createMessage({msgType:"inspect_request",channel:"shell",username:this._username,session:this._clientId,content:e});return ke.handleShellMessage(this,t)}requestHistory(e){let t=Ee.createMessage({msgType:"history_request",channel:"shell",username:this._username,session:this._clientId,content:e});return ke.handleShellMessage(this,t)}requestExecute(e,t=!0,i){let r={silent:!1,store_history:!0,user_expressions:{},allow_stdin:!0,stop_on_error:!1},s=Ee.createMessage({msgType:"execute_request",channel:"shell",username:this._username,session:this._clientId,content:{...r,...e},metadata:i});return this.sendShellMessage(s,!0,t)}requestDebug(e,t=!0){let i=Ee.createMessage({msgType:"debug_request",channel:"control",username:this._username,session:this._clientId,content:e});return this.sendControlMessage(i,!0,t)}requestIsComplete(e){let t=Ee.createMessage({msgType:"is_complete_request",channel:"shell",username:this._username,session:this._clientId,content:e});return ke.handleShellMessage(this,t)}requestCommInfo(e){let t=Ee.createMessage({msgType:"comm_info_request",channel:"shell",username:this._username,session:this._clientId,content:e});return ke.handleShellMessage(this,t)}sendInputReply(e,t){let i=Ee.createMessage({msgType:"input_reply",channel:"stdin",username:this._username,session:this._clientId,content:e});i.parent_header=t,this._sendMessage(i),this._anyMessage.emit({msg:i,direction:"send"}),this.hasPendingInput=!1}createComm(e,t=dt.UUID.uuid4()){if(!this.handleComms)throw new Error("Comms are disabled on this kernel connection");if(this._comms.has(t))throw new Error("Comm is already created");let i=new Ja.CommHandler(e,t,this,()=>{this._unregisterComm(t)});return this._comms.set(t,i),i}hasComm(e){return this._comms.has(e)}registerCommTarget(e,t){this.handleComms&&(this._targetRegistry[e]=t)}removeCommTarget(e,t){this.handleComms&&!this.isDisposed&&this._targetRegistry[e]===t&&delete this._targetRegistry[e]}registerMessageHook(e,t){var i;let r=(i=this._futures)===null||i===void 0?void 0:i.get(e);r&&r.registerMessageHook(t)}removeMessageHook(e,t){var i;let r=(i=this._futures)===null||i===void 0?void 0:i.get(e);r&&r.removeMessageHook(t)}removeInputGuard(){this.hasPendingInput=!1}async _handleDisplayId(e,t){var i,r;let s=t.parent_header.msg_id,c=this._displayIdToParentIds.get(e);if(c){let v={header:dt.JSONExt.deepCopy(t.header),parent_header:dt.JSONExt.deepCopy(t.parent_header),metadata:dt.JSONExt.deepCopy(t.metadata),content:dt.JSONExt.deepCopy(t.content),channel:t.channel,buffers:t.buffers?t.buffers.slice():[]};v.header.msg_type="update_display_data",await Promise.all(c.map(async p=>{let h=this._futures&&this._futures.get(p);h&&await h.handleMsg(v)}))}if(t.header.msg_type==="update_display_data")return!0;c=(i=this._displayIdToParentIds.get(e))!==null&&i!==void 0?i:[],c.indexOf(s)===-1&&c.push(s),this._displayIdToParentIds.set(e,c);let f=(r=this._msgIdToDisplayIds.get(s))!==null&&r!==void 0?r:[];return f.indexOf(s)===-1&&f.push(s),this._msgIdToDisplayIds.set(s,f),!1}_clearSocket(){this._ws!==null&&(this._ws.onopen=this._noOp,this._ws.onclose=this._noOp,this._ws.onerror=this._noOp,this._ws.onmessage=this._noOp,this._ws.close(),this._ws=null)}_updateStatus(e){this._status===e||this._status==="dead"||(this._status=e,ke.logKernelStatus(this),this._statusChanged.emit(e),e==="dead"&&this.dispose())}_sendPending(){for(;this.connectionStatus==="connected"&&this._kernelSession!==Ut&&this._pendingMessages.length>0;)this._sendMessage(this._pendingMessages[0],!1),this._pendingMessages.shift()}_clearKernelState(){this._kernelSession="",this._pendingMessages=[],this._futures.forEach(e=>{e.dispose()}),this._comms.forEach(e=>{e.dispose()}),this._msgChain=Promise.resolve(),this._futures=new Map,this._comms=new Map,this._displayIdToParentIds.clear(),this._msgIdToDisplayIds.clear()}_assertCurrentMessage(e){if(this._errorIfDisposed(),e.header.session!==this._kernelSession)throw new Error(`Canceling handling of old message: ${e.header.msg_type}`)}async _handleCommOpen(e){this._assertCurrentMessage(e);let t=e.content,i=new Ja.CommHandler(t.target_name,t.comm_id,this,()=>{this._unregisterComm(t.comm_id)});this._comms.set(t.comm_id,i);try{await(await ke.loadObject(t.target_name,t.target_module,this._targetRegistry))(i,e)}catch(r){throw i.close(),console.error("Exception opening new comm"),r}}async _handleCommClose(e){this._assertCurrentMessage(e);let t=e.content,i=this._comms.get(t.comm_id);if(!i){console.error("Comm not found for comm id "+t.comm_id);return}this._unregisterComm(i.commId);let r=i.onClose;r&&await r(e),i.dispose()}async _handleCommMsg(e){this._assertCurrentMessage(e);let t=e.content,i=this._comms.get(t.comm_id);if(!i)return;let r=i.onMsg;r&&await r(e)}_unregisterComm(e){this._comms.delete(e)}_updateConnectionStatus(e){if(this._connectionStatus!==e){if(this._connectionStatus=e,e!=="connecting"&&(this._reconnectAttempt=0,clearTimeout(this._reconnectTimeout)),this.status!=="dead")if(e==="connected"){let t=this._kernelSession===Ut,i=this.requestKernelInfo(),r=!1,s=()=>{r||(r=!0,t&&this._kernelSession===Ut&&(this._kernelSession=""),clearTimeout(c),this._pendingMessages.length>0&&this._sendPending())};i.then(s);let c=setTimeout(s,jd)}else this._updateStatus("unknown");this._connectionStatusChanged.emit(e)}}async _handleMessage(e){var t,i;let r=!1;if(e.parent_header&&e.channel==="iopub"&&(Ee.isDisplayDataMsg(e)||Ee.isUpdateDisplayDataMsg(e)||Ee.isExecuteResultMsg(e))){let c=((t=e.content.transient)!==null&&t!==void 0?t:{}).display_id;c&&(r=await this._handleDisplayId(c,e),this._assertCurrentMessage(e))}if(!r&&e.parent_header){let s=e.parent_header,c=(i=this._futures)===null||i===void 0?void 0:i.get(s.msg_id);if(c)await c.handleMsg(e),this._assertCurrentMessage(e);else{let f=s.session===this.clientId;e.channel!=="iopub"&&f&&this._unhandledMessage.emit(e)}}if(e.channel==="iopub"){switch(e.header.msg_type){case"status":{let s=e.content.execution_state;s==="restarting"&&Promise.resolve().then(async()=>{this._updateStatus("autorestarting"),this._clearKernelState(),await this.reconnect()}),this._updateStatus(s);break}case"comm_open":this.handleComms&&await this._handleCommOpen(e);break;case"comm_msg":this.handleComms&&await this._handleCommMsg(e);break;case"comm_close":this.handleComms&&await this._handleCommClose(e);break;default:break}this.isDisposed||(this._assertCurrentMessage(e),this._iopubMessage.emit(e))}}_reconnect(){if(this._errorIfDisposed(),clearTimeout(this._reconnectTimeout),this._reconnectAttempt<this._reconnectLimit){this._updateConnectionStatus("connecting");let e=ke.getRandomIntInclusive(0,1e3*(Math.pow(2,this._reconnectAttempt)-1));console.warn(`Connection lost, reconnecting in ${Math.floor(e/1e3)} seconds.`);let t=this._selectedProtocol!=="";this._reconnectTimeout=setTimeout(this._createSocket,e,t),this._reconnectAttempt+=1}else this._updateConnectionStatus("disconnected");this._clearSocket()}_errorIfDisposed(){if(this.isDisposed)throw new Error("Kernel connection is disposed")}get hasPendingInput(){return this._hasPendingInput}set hasPendingInput(e){this._hasPendingInput=e,this._pendingInput.emit(e)}};$e.KernelConnection=Cs;var ke;(function(n){function e(s){switch(s.status){case"idle":case"busy":case"unknown":return;default:console.debug(`Kernel: ${s.status} (${s.id})`);break}}n.logKernelStatus=e;async function t(s,c){return s.sendShellMessage(c,!0).done}n.handleShellMessage=t;function i(s,c,f){return new Promise((v,p)=>{if(c){if(typeof requirejs>"u")throw new Error("requirejs not found");requirejs([c],h=>{if(h[s]===void 0){let g=`Object '${s}' not found in module '${c}'`;p(new Error(g))}else v(h[s])},p)}else f?.[s]?v(f[s]):p(new Error(`Object '${s}' not found in registry`))})}n.loadObject=i;function r(s,c){return s=Math.ceil(s),c=Math.floor(c),Math.floor(Math.random()*(c-s+1))+s}n.getRandomIntInclusive=r})(ke||(ke={}))});module.exports=Tr();

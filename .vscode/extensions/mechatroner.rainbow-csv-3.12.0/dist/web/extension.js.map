{"version":3,"file":"extension.js","mappings":"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","sources":["webpack://rainbow-csv/./contrib/wcwidth/combining.js","webpack://rainbow-csv/./contrib/wcwidth/index.js","webpack://rainbow-csv/./fast_load_utils.js","webpack://rainbow-csv/./node_modules/call-bind/callBound.js","webpack://rainbow-csv/./node_modules/call-bind/index.js","webpack://rainbow-csv/./node_modules/define-data-property/index.js","webpack://rainbow-csv/./node_modules/es-define-property/index.js","webpack://rainbow-csv/./node_modules/es-errors/eval.js","webpack://rainbow-csv/./node_modules/es-errors/index.js","webpack://rainbow-csv/./node_modules/es-errors/range.js","webpack://rainbow-csv/./node_modules/es-errors/ref.js","webpack://rainbow-csv/./node_modules/es-errors/syntax.js","webpack://rainbow-csv/./node_modules/es-errors/type.js","webpack://rainbow-csv/./node_modules/es-errors/uri.js","webpack://rainbow-csv/./node_modules/for-each/index.js","webpack://rainbow-csv/./node_modules/function-bind/implementation.js","webpack://rainbow-csv/./node_modules/function-bind/index.js","webpack://rainbow-csv/./node_modules/get-intrinsic/index.js","webpack://rainbow-csv/./node_modules/gopd/index.js","webpack://rainbow-csv/./node_modules/has-property-descriptors/index.js","webpack://rainbow-csv/./node_modules/has-proto/index.js","webpack://rainbow-csv/./node_modules/has-symbols/index.js","webpack://rainbow-csv/./node_modules/has-symbols/shams.js","webpack://rainbow-csv/./node_modules/has-tostringtag/shams.js","webpack://rainbow-csv/./node_modules/hasown/index.js","webpack://rainbow-csv/./node_modules/inherits/inherits_browser.js","webpack://rainbow-csv/./node_modules/is-arguments/index.js","webpack://rainbow-csv/./node_modules/is-callable/index.js","webpack://rainbow-csv/./node_modules/is-generator-function/index.js","webpack://rainbow-csv/./node_modules/is-typed-array/index.js","webpack://rainbow-csv/./node_modules/possible-typed-array-names/index.js","webpack://rainbow-csv/./node_modules/process/browser.js","webpack://rainbow-csv/./node_modules/set-function-length/index.js","webpack://rainbow-csv/./node_modules/util/support/isBufferBrowser.js","webpack://rainbow-csv/./node_modules/util/support/types.js","webpack://rainbow-csv/./node_modules/util/util.js","webpack://rainbow-csv/./node_modules/which-typed-array/index.js","webpack://rainbow-csv/./rainbow_utils.js","webpack://rainbow-csv/./rbql_core/rbql-js/csv_utils.js","webpack://rainbow-csv/./rbql_core/rbql-js/rbql.js","webpack://rainbow-csv/./rbql_core/rbql-js/rbql_csv.js","webpack://rainbow-csv/external commonjs \"vscode\"","webpack://rainbow-csv/./node_modules/available-typed-arrays/index.js","webpack://rainbow-csv/webpack/bootstrap","webpack://rainbow-csv/webpack/runtime/global","webpack://rainbow-csv/./extension.js"],"sourcesContent":["module.exports = [\n    [ 0x0300, 0x036F ], [ 0x0483, 0x0486 ], [ 0x0488, 0x0489 ],\n    [ 0x0591, 0x05BD ], [ 0x05BF, 0x05BF ], [ 0x05C1, 0x05C2 ],\n    [ 0x05C4, 0x05C5 ], [ 0x05C7, 0x05C7 ], [ 0x0600, 0x0603 ],\n    [ 0x0610, 0x0615 ], [ 0x064B, 0x065E ], [ 0x0670, 0x0670 ],\n    [ 0x06D6, 0x06E4 ], [ 0x06E7, 0x06E8 ], [ 0x06EA, 0x06ED ],\n    [ 0x070F, 0x070F ], [ 0x0711, 0x0711 ], [ 0x0730, 0x074A ],\n    [ 0x07A6, 0x07B0 ], [ 0x07EB, 0x07F3 ], [ 0x0901, 0x0902 ],\n    [ 0x093C, 0x093C ], [ 0x0941, 0x0948 ], [ 0x094D, 0x094D ],\n    [ 0x0951, 0x0954 ], [ 0x0962, 0x0963 ], [ 0x0981, 0x0981 ],\n    [ 0x09BC, 0x09BC ], [ 0x09C1, 0x09C4 ], [ 0x09CD, 0x09CD ],\n    [ 0x09E2, 0x09E3 ], [ 0x0A01, 0x0A02 ], [ 0x0A3C, 0x0A3C ],\n    [ 0x0A41, 0x0A42 ], [ 0x0A47, 0x0A48 ], [ 0x0A4B, 0x0A4D ],\n    [ 0x0A70, 0x0A71 ], [ 0x0A81, 0x0A82 ], [ 0x0ABC, 0x0ABC ],\n    [ 0x0AC1, 0x0AC5 ], [ 0x0AC7, 0x0AC8 ], [ 0x0ACD, 0x0ACD ],\n    [ 0x0AE2, 0x0AE3 ], [ 0x0B01, 0x0B01 ], [ 0x0B3C, 0x0B3C ],\n    [ 0x0B3F, 0x0B3F ], [ 0x0B41, 0x0B43 ], [ 0x0B4D, 0x0B4D ],\n    [ 0x0B56, 0x0B56 ], [ 0x0B82, 0x0B82 ], [ 0x0BC0, 0x0BC0 ],\n    [ 0x0BCD, 0x0BCD ], [ 0x0C3E, 0x0C40 ], [ 0x0C46, 0x0C48 ],\n    [ 0x0C4A, 0x0C4D ], [ 0x0C55, 0x0C56 ], [ 0x0CBC, 0x0CBC ],\n    [ 0x0CBF, 0x0CBF ], [ 0x0CC6, 0x0CC6 ], [ 0x0CCC, 0x0CCD ],\n    [ 0x0CE2, 0x0CE3 ], [ 0x0D41, 0x0D43 ], [ 0x0D4D, 0x0D4D ],\n    [ 0x0DCA, 0x0DCA ], [ 0x0DD2, 0x0DD4 ], [ 0x0DD6, 0x0DD6 ],\n    [ 0x0E31, 0x0E31 ], [ 0x0E34, 0x0E3A ], [ 0x0E47, 0x0E4E ],\n    [ 0x0EB1, 0x0EB1 ], [ 0x0EB4, 0x0EB9 ], [ 0x0EBB, 0x0EBC ],\n    [ 0x0EC8, 0x0ECD ], [ 0x0F18, 0x0F19 ], [ 0x0F35, 0x0F35 ],\n    [ 0x0F37, 0x0F37 ], [ 0x0F39, 0x0F39 ], [ 0x0F71, 0x0F7E ],\n    [ 0x0F80, 0x0F84 ], [ 0x0F86, 0x0F87 ], [ 0x0F90, 0x0F97 ],\n    [ 0x0F99, 0x0FBC ], [ 0x0FC6, 0x0FC6 ], [ 0x102D, 0x1030 ],\n    [ 0x1032, 0x1032 ], [ 0x1036, 0x1037 ], [ 0x1039, 0x1039 ],\n    [ 0x1058, 0x1059 ], [ 0x1160, 0x11FF ], [ 0x135F, 0x135F ],\n    [ 0x1712, 0x1714 ], [ 0x1732, 0x1734 ], [ 0x1752, 0x1753 ],\n    [ 0x1772, 0x1773 ], [ 0x17B4, 0x17B5 ], [ 0x17B7, 0x17BD ],\n    [ 0x17C6, 0x17C6 ], [ 0x17C9, 0x17D3 ], [ 0x17DD, 0x17DD ],\n    [ 0x180B, 0x180D ], [ 0x18A9, 0x18A9 ], [ 0x1920, 0x1922 ],\n    [ 0x1927, 0x1928 ], [ 0x1932, 0x1932 ], [ 0x1939, 0x193B ],\n    [ 0x1A17, 0x1A18 ], [ 0x1B00, 0x1B03 ], [ 0x1B34, 0x1B34 ],\n    [ 0x1B36, 0x1B3A ], [ 0x1B3C, 0x1B3C ], [ 0x1B42, 0x1B42 ],\n    [ 0x1B6B, 0x1B73 ], [ 0x1DC0, 0x1DCA ], [ 0x1DFE, 0x1DFF ],\n    [ 0x200B, 0x200F ], [ 0x202A, 0x202E ], [ 0x2060, 0x2063 ],\n    [ 0x206A, 0x206F ], [ 0x20D0, 0x20EF ], [ 0x302A, 0x302F ],\n    [ 0x3099, 0x309A ], [ 0xA806, 0xA806 ], [ 0xA80B, 0xA80B ],\n    [ 0xA825, 0xA826 ], [ 0xFB1E, 0xFB1E ], [ 0xFE00, 0xFE0F ],\n    [ 0xFE20, 0xFE23 ], [ 0xFEFF, 0xFEFF ], [ 0xFFF9, 0xFFFB ],\n    [ 0x10A01, 0x10A03 ], [ 0x10A05, 0x10A06 ], [ 0x10A0C, 0x10A0F ],\n    [ 0x10A38, 0x10A3A ], [ 0x10A3F, 0x10A3F ], [ 0x1D167, 0x1D169 ],\n    [ 0x1D173, 0x1D182 ], [ 0x1D185, 0x1D18B ], [ 0x1D1AA, 0x1D1AD ],\n    [ 0x1D242, 0x1D244 ], [ 0xE0001, 0xE0001 ], [ 0xE0020, 0xE007F ],\n    [ 0xE0100, 0xE01EF ]\n]\n","\"use strict\"\n\nvar combining = require('./combining')\n\nvar DEFAULTS = {\n  nul: 0,\n  control: 0\n}\n\nmodule.exports = function wcwidth(str) {\n  return wcswidth(str, DEFAULTS)\n}\n\n/*\n *  The following functions define the column width of an ISO 10646\n *  character as follows:\n *  - The null character (U+0000) has a column width of 0.\n *  - Other C0/C1 control characters and DEL will lead to a return value\n *    of -1.\n *  - Non-spacing and enclosing combining characters (general category\n *    code Mn or Me in the\n *    Unicode database) have a column width of 0.\n *  - SOFT HYPHEN (U+00AD) has a column width of 1.\n *  - Other format characters (general category code Cf in the Unicode\n *    database) and ZERO WIDTH\n *    SPACE (U+200B) have a column width of 0.\n *  - Hangul Jamo medial vowels and final consonants (U+1160-U+11FF)\n *    have a column width of 0.\n *  - Spacing characters in the East Asian Wide (W) or East Asian\n *    Full-width (F) category as\n *    defined in Unicode Technical Report #11 have a column width of 2.\n *  - All remaining characters (including all printable ISO 8859-1 and\n *    WGL4 characters, Unicode control characters, etc.) have a column\n *    width of 1.\n *  This implementation assumes that characters are encoded in ISO 10646.\n*/\n\nfunction wcswidth(str, opts) {\n  if (typeof str !== 'string') return wcwidth(str, opts)\n\n  var s = 0\n  for (var i = 0; i < str.length; i++) {\n    var n = wcwidth(str.charCodeAt(i), opts)\n    if (n < 0) return -1\n    s += n\n  }\n\n  return s\n}\n\nfunction wcwidth(ucs, opts) {\n  // test for 8-bit control characters\n  if (ucs === 0) return opts.nul\n  if (ucs < 32 || (ucs >= 0x7f && ucs < 0xa0)) return opts.control\n\n  // binary search in table of non-spacing characters\n  if (bisearch(ucs)) return 0\n\n  // if we arrive here, ucs is not a combining or C0/C1 control character\n  return 1 +\n      (ucs >= 0x1100 &&\n       (ucs <= 0x115f ||                       // Hangul Jamo init. consonants\n        ucs == 0x2329 || ucs == 0x232a ||\n        (ucs >= 0x2e80 && ucs <= 0xa4cf &&\n         ucs != 0x303f) ||                     // CJK ... Yi\n        (ucs >= 0xac00 && ucs <= 0xd7a3) ||    // Hangul Syllables\n        (ucs >= 0xf900 && ucs <= 0xfaff) ||    // CJK Compatibility Ideographs\n        (ucs >= 0xfe10 && ucs <= 0xfe19) ||    // Vertical forms\n        (ucs >= 0xfe30 && ucs <= 0xfe6f) ||    // CJK Compatibility Forms\n        (ucs >= 0xff00 && ucs <= 0xff60) ||    // Fullwidth Forms\n        (ucs >= 0xffe0 && ucs <= 0xffe6) ||\n        (ucs >= 0x20000 && ucs <= 0x2fffd) ||\n        (ucs >= 0x30000 && ucs <= 0x3fffd)));\n}\n\nfunction bisearch(ucs) {\n  var min = 0\n  var max = combining.length - 1\n  var mid\n\n  if (ucs < combining[0][0] || ucs > combining[max][1]) return false\n\n  while (max >= min) {\n    mid = Math.floor((min + max) / 2)\n    if (ucs > combining[mid][1]) min = mid + 1\n    else if (ucs < combining[mid][0]) max = mid - 1\n    else return true\n  }\n\n  return false\n}\n","// This file stores only functionality that is required for idle operation of Rainbow CSV i.e. autodetection only.\n// We want to avoid loading/parsing a lot of JS code in cases where we don't have any CSV files to work with.\n\nconst csv_utils = require('./rbql_core/rbql-js/csv_utils.js');\n\nclass AssertionError extends Error {}\n\nfunction assert(condition, message=null) {\n    if (!condition) {\n        if (!message) {\n            message = 'Assertion error';\n        }\n        throw new AssertionError(message);\n    }\n}\n\nclass RecordTextConsumer {\n    // The only purpose of this class is to avoid code duplication when dealing with leftover lines in line_aggregator (the second `consume` call).\n    constructor(delim, policy, stop_on_warning, collect_records, preserve_quotes_and_whitespaces, detect_trailing_spaces, min_num_fields_for_autodetection) {\n        this.delim = delim;\n        this.policy = policy;\n        this.stop_on_warning = stop_on_warning;\n        this.first_defective_line = null;\n        this.records = collect_records ? [] : null;\n        this.collect_records = collect_records;\n        this.num_records_parsed = 0;\n        this.fields_info = new Map();\n        this.first_trailing_space_line = null;\n        this.detect_trailing_spaces = detect_trailing_spaces;\n        this.preserve_quotes_and_whitespaces = preserve_quotes_and_whitespaces;\n        this.min_num_fields_for_autodetection = min_num_fields_for_autodetection;\n    }\n\n    consume(record_text, record_start_line) {\n        let [record, warning] = csv_utils.smart_split(record_text, this.delim, this.policy, this.preserve_quotes_and_whitespaces);\n        if (warning) {\n            if (this.first_defective_line === null) {\n                this.first_defective_line = record_start_line;\n            }\n            if (this.stop_on_warning)\n                return /*can_continue=*/false;\n        }\n        if (this.detect_trailing_spaces && this.first_trailing_space_line === null) {\n            for (let field of record) {\n                if (field.length && (field.charAt(0) == ' ' || field.charAt(field.length - 1) == ' ')) {\n                    this.first_trailing_space_line = record_start_line;\n                }\n            }\n        }\n        if (!this.fields_info.has(record.length)) {\n            this.fields_info.set(record.length, this.num_records_parsed);\n            if (this.min_num_fields_for_autodetection != -1) {\n                // Autodetection mode: stop on inconsistent records length and when there is not enough columns (typically less than 2 i.e. 1).\n                if (record.length < this.min_num_fields_for_autodetection)\n                    return /*can_continue=*/false;\n                if (this.fields_info.size > 1)\n                    return /*can_continue=*/false;\n            }\n        }\n        if (this.collect_records) {\n            this.records.push(record);\n        }\n        this.num_records_parsed += 1;\n        return /*can_continue=*/true;\n    }\n}\n\n\nfunction parse_document_records(document, delim, policy, comment_prefix=null, stop_on_warning=false, max_records_to_parse=-1, collect_records=true, preserve_quotes_and_whitespaces=false, detect_trailing_spaces=false, min_num_fields_for_autodetection=-1) {\n    let num_lines = document.lineCount;\n    let record_start_line = 0;\n    let line_aggregator = new csv_utils.MultilineRecordAggregator(comment_prefix);\n    let consumer = new RecordTextConsumer(delim, policy, stop_on_warning, collect_records, preserve_quotes_and_whitespaces, detect_trailing_spaces, min_num_fields_for_autodetection);\n    let comments = []; // An ordered list of {record_no, comment_text} tuples which can be merged with the records later.\n\n    for (let lnum = 0; lnum < num_lines; ++lnum) {\n        let line_text = document.lineAt(lnum).text;\n        if (lnum + 1 >= num_lines && line_text == \"\") {\n            if (collect_records) {\n                // Treat the last empty line as a comment - this is to prevent align/shrink functions from removing it.\n                comments.push({record_num: consumer.num_records_parsed, comment_text: line_text});\n            }\n            break; // Skip the last empty line.\n        }\n        let record_text = null;\n        if (policy == 'quoted_rfc') {\n            line_aggregator.add_line(line_text);\n            if (line_aggregator.has_comment_line) {\n                record_start_line = lnum + 1;\n                line_aggregator.reset();\n                if (collect_records) {\n                    comments.push({record_num: consumer.num_records_parsed, comment_text: line_text});\n                }\n                continue;\n            } else if (line_aggregator.has_full_record) {\n                record_text = line_aggregator.get_full_line('\\n');\n                line_aggregator.reset();\n            } else {\n                continue;\n            }\n        } else {\n            if (comment_prefix && line_text.startsWith(comment_prefix)) {\n                record_start_line = lnum + 1;\n                if (collect_records) {\n                    comments.push({record_num: consumer.num_records_parsed, comment_text: line_text});\n                }\n                continue;\n            } else {\n                record_text = line_text;\n            }\n        }\n        if (!consumer.consume(record_text, record_start_line)) {\n            return [consumer.records, consumer.num_records_parsed, consumer.fields_info, consumer.first_defective_line, consumer.first_trailing_space_line, comments];\n        }\n        record_start_line = lnum + 1;\n        if (max_records_to_parse !== -1 && consumer.num_records_parsed >= max_records_to_parse) {\n            return [consumer.records, consumer.num_records_parsed, consumer.fields_info, consumer.first_defective_line, consumer.first_trailing_space_line, comments];\n        }\n    }\n\n    if (line_aggregator.is_inside_multiline_record()) {\n        assert(policy == 'quoted_rfc');\n        consumer.consume(line_aggregator.get_full_line('\\n'), record_start_line);\n    }\n    return [consumer.records, consumer.num_records_parsed, consumer.fields_info, consumer.first_defective_line, consumer.first_trailing_space_line, comments];\n}\n\n\nmodule.exports.parse_document_records = parse_document_records;\nmodule.exports.assert = assert;\n","'use strict';\n\nvar GetIntrinsic = require('get-intrinsic');\n\nvar callBind = require('./');\n\nvar $indexOf = callBind(GetIntrinsic('String.prototype.indexOf'));\n\nmodule.exports = function callBoundIntrinsic(name, allowMissing) {\n\tvar intrinsic = GetIntrinsic(name, !!allowMissing);\n\tif (typeof intrinsic === 'function' && $indexOf(name, '.prototype.') > -1) {\n\t\treturn callBind(intrinsic);\n\t}\n\treturn intrinsic;\n};\n","'use strict';\n\nvar bind = require('function-bind');\nvar GetIntrinsic = require('get-intrinsic');\nvar setFunctionLength = require('set-function-length');\n\nvar $TypeError = require('es-errors/type');\nvar $apply = GetIntrinsic('%Function.prototype.apply%');\nvar $call = GetIntrinsic('%Function.prototype.call%');\nvar $reflectApply = GetIntrinsic('%Reflect.apply%', true) || bind.call($call, $apply);\n\nvar $defineProperty = require('es-define-property');\nvar $max = GetIntrinsic('%Math.max%');\n\nmodule.exports = function callBind(originalFunction) {\n\tif (typeof originalFunction !== 'function') {\n\t\tthrow new $TypeError('a function is required');\n\t}\n\tvar func = $reflectApply(bind, $call, arguments);\n\treturn setFunctionLength(\n\t\tfunc,\n\t\t1 + $max(0, originalFunction.length - (arguments.length - 1)),\n\t\ttrue\n\t);\n};\n\nvar applyBind = function applyBind() {\n\treturn $reflectApply(bind, $apply, arguments);\n};\n\nif ($defineProperty) {\n\t$defineProperty(module.exports, 'apply', { value: applyBind });\n} else {\n\tmodule.exports.apply = applyBind;\n}\n","'use strict';\n\nvar $defineProperty = require('es-define-property');\n\nvar $SyntaxError = require('es-errors/syntax');\nvar $TypeError = require('es-errors/type');\n\nvar gopd = require('gopd');\n\n/** @type {import('.')} */\nmodule.exports = function defineDataProperty(\n\tobj,\n\tproperty,\n\tvalue\n) {\n\tif (!obj || (typeof obj !== 'object' && typeof obj !== 'function')) {\n\t\tthrow new $TypeError('`obj` must be an object or a function`');\n\t}\n\tif (typeof property !== 'string' && typeof property !== 'symbol') {\n\t\tthrow new $TypeError('`property` must be a string or a symbol`');\n\t}\n\tif (arguments.length > 3 && typeof arguments[3] !== 'boolean' && arguments[3] !== null) {\n\t\tthrow new $TypeError('`nonEnumerable`, if provided, must be a boolean or null');\n\t}\n\tif (arguments.length > 4 && typeof arguments[4] !== 'boolean' && arguments[4] !== null) {\n\t\tthrow new $TypeError('`nonWritable`, if provided, must be a boolean or null');\n\t}\n\tif (arguments.length > 5 && typeof arguments[5] !== 'boolean' && arguments[5] !== null) {\n\t\tthrow new $TypeError('`nonConfigurable`, if provided, must be a boolean or null');\n\t}\n\tif (arguments.length > 6 && typeof arguments[6] !== 'boolean') {\n\t\tthrow new $TypeError('`loose`, if provided, must be a boolean');\n\t}\n\n\tvar nonEnumerable = arguments.length > 3 ? arguments[3] : null;\n\tvar nonWritable = arguments.length > 4 ? arguments[4] : null;\n\tvar nonConfigurable = arguments.length > 5 ? arguments[5] : null;\n\tvar loose = arguments.length > 6 ? arguments[6] : false;\n\n\t/* @type {false | TypedPropertyDescriptor<unknown>} */\n\tvar desc = !!gopd && gopd(obj, property);\n\n\tif ($defineProperty) {\n\t\t$defineProperty(obj, property, {\n\t\t\tconfigurable: nonConfigurable === null && desc ? desc.configurable : !nonConfigurable,\n\t\t\tenumerable: nonEnumerable === null && desc ? desc.enumerable : !nonEnumerable,\n\t\t\tvalue: value,\n\t\t\twritable: nonWritable === null && desc ? desc.writable : !nonWritable\n\t\t});\n\t} else if (loose || (!nonEnumerable && !nonWritable && !nonConfigurable)) {\n\t\t// must fall back to [[Set]], and was not explicitly asked to make non-enumerable, non-writable, or non-configurable\n\t\tobj[property] = value; // eslint-disable-line no-param-reassign\n\t} else {\n\t\tthrow new $SyntaxError('This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.');\n\t}\n};\n","'use strict';\n\nvar GetIntrinsic = require('get-intrinsic');\n\n/** @type {import('.')} */\nvar $defineProperty = GetIntrinsic('%Object.defineProperty%', true) || false;\nif ($defineProperty) {\n\ttry {\n\t\t$defineProperty({}, 'a', { value: 1 });\n\t} catch (e) {\n\t\t// IE 8 has a broken defineProperty\n\t\t$defineProperty = false;\n\t}\n}\n\nmodule.exports = $defineProperty;\n","'use strict';\n\n/** @type {import('./eval')} */\nmodule.exports = EvalError;\n","'use strict';\n\n/** @type {import('.')} */\nmodule.exports = Error;\n","'use strict';\n\n/** @type {import('./range')} */\nmodule.exports = RangeError;\n","'use strict';\n\n/** @type {import('./ref')} */\nmodule.exports = ReferenceError;\n","'use strict';\n\n/** @type {import('./syntax')} */\nmodule.exports = SyntaxError;\n","'use strict';\n\n/** @type {import('./type')} */\nmodule.exports = TypeError;\n","'use strict';\n\n/** @type {import('./uri')} */\nmodule.exports = URIError;\n","'use strict';\n\nvar isCallable = require('is-callable');\n\nvar toStr = Object.prototype.toString;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\nvar forEachArray = function forEachArray(array, iterator, receiver) {\n    for (var i = 0, len = array.length; i < len; i++) {\n        if (hasOwnProperty.call(array, i)) {\n            if (receiver == null) {\n                iterator(array[i], i, array);\n            } else {\n                iterator.call(receiver, array[i], i, array);\n            }\n        }\n    }\n};\n\nvar forEachString = function forEachString(string, iterator, receiver) {\n    for (var i = 0, len = string.length; i < len; i++) {\n        // no such thing as a sparse string.\n        if (receiver == null) {\n            iterator(string.charAt(i), i, string);\n        } else {\n            iterator.call(receiver, string.charAt(i), i, string);\n        }\n    }\n};\n\nvar forEachObject = function forEachObject(object, iterator, receiver) {\n    for (var k in object) {\n        if (hasOwnProperty.call(object, k)) {\n            if (receiver == null) {\n                iterator(object[k], k, object);\n            } else {\n                iterator.call(receiver, object[k], k, object);\n            }\n        }\n    }\n};\n\nvar forEach = function forEach(list, iterator, thisArg) {\n    if (!isCallable(iterator)) {\n        throw new TypeError('iterator must be a function');\n    }\n\n    var receiver;\n    if (arguments.length >= 3) {\n        receiver = thisArg;\n    }\n\n    if (toStr.call(list) === '[object Array]') {\n        forEachArray(list, iterator, receiver);\n    } else if (typeof list === 'string') {\n        forEachString(list, iterator, receiver);\n    } else {\n        forEachObject(list, iterator, receiver);\n    }\n};\n\nmodule.exports = forEach;\n","'use strict';\n\n/* eslint no-invalid-this: 1 */\n\nvar ERROR_MESSAGE = 'Function.prototype.bind called on incompatible ';\nvar toStr = Object.prototype.toString;\nvar max = Math.max;\nvar funcType = '[object Function]';\n\nvar concatty = function concatty(a, b) {\n    var arr = [];\n\n    for (var i = 0; i < a.length; i += 1) {\n        arr[i] = a[i];\n    }\n    for (var j = 0; j < b.length; j += 1) {\n        arr[j + a.length] = b[j];\n    }\n\n    return arr;\n};\n\nvar slicy = function slicy(arrLike, offset) {\n    var arr = [];\n    for (var i = offset || 0, j = 0; i < arrLike.length; i += 1, j += 1) {\n        arr[j] = arrLike[i];\n    }\n    return arr;\n};\n\nvar joiny = function (arr, joiner) {\n    var str = '';\n    for (var i = 0; i < arr.length; i += 1) {\n        str += arr[i];\n        if (i + 1 < arr.length) {\n            str += joiner;\n        }\n    }\n    return str;\n};\n\nmodule.exports = function bind(that) {\n    var target = this;\n    if (typeof target !== 'function' || toStr.apply(target) !== funcType) {\n        throw new TypeError(ERROR_MESSAGE + target);\n    }\n    var args = slicy(arguments, 1);\n\n    var bound;\n    var binder = function () {\n        if (this instanceof bound) {\n            var result = target.apply(\n                this,\n                concatty(args, arguments)\n            );\n            if (Object(result) === result) {\n                return result;\n            }\n            return this;\n        }\n        return target.apply(\n            that,\n            concatty(args, arguments)\n        );\n\n    };\n\n    var boundLength = max(0, target.length - args.length);\n    var boundArgs = [];\n    for (var i = 0; i < boundLength; i++) {\n        boundArgs[i] = '$' + i;\n    }\n\n    bound = Function('binder', 'return function (' + joiny(boundArgs, ',') + '){ return binder.apply(this,arguments); }')(binder);\n\n    if (target.prototype) {\n        var Empty = function Empty() {};\n        Empty.prototype = target.prototype;\n        bound.prototype = new Empty();\n        Empty.prototype = null;\n    }\n\n    return bound;\n};\n","'use strict';\n\nvar implementation = require('./implementation');\n\nmodule.exports = Function.prototype.bind || implementation;\n","'use strict';\n\nvar undefined;\n\nvar $Error = require('es-errors');\nvar $EvalError = require('es-errors/eval');\nvar $RangeError = require('es-errors/range');\nvar $ReferenceError = require('es-errors/ref');\nvar $SyntaxError = require('es-errors/syntax');\nvar $TypeError = require('es-errors/type');\nvar $URIError = require('es-errors/uri');\n\nvar $Function = Function;\n\n// eslint-disable-next-line consistent-return\nvar getEvalledConstructor = function (expressionSyntax) {\n\ttry {\n\t\treturn $Function('\"use strict\"; return (' + expressionSyntax + ').constructor;')();\n\t} catch (e) {}\n};\n\nvar $gOPD = Object.getOwnPropertyDescriptor;\nif ($gOPD) {\n\ttry {\n\t\t$gOPD({}, '');\n\t} catch (e) {\n\t\t$gOPD = null; // this is IE 8, which has a broken gOPD\n\t}\n}\n\nvar throwTypeError = function () {\n\tthrow new $TypeError();\n};\nvar ThrowTypeError = $gOPD\n\t? (function () {\n\t\ttry {\n\t\t\t// eslint-disable-next-line no-unused-expressions, no-caller, no-restricted-properties\n\t\t\targuments.callee; // IE 8 does not throw here\n\t\t\treturn throwTypeError;\n\t\t} catch (calleeThrows) {\n\t\t\ttry {\n\t\t\t\t// IE 8 throws on Object.getOwnPropertyDescriptor(arguments, '')\n\t\t\t\treturn $gOPD(arguments, 'callee').get;\n\t\t\t} catch (gOPDthrows) {\n\t\t\t\treturn throwTypeError;\n\t\t\t}\n\t\t}\n\t}())\n\t: throwTypeError;\n\nvar hasSymbols = require('has-symbols')();\nvar hasProto = require('has-proto')();\n\nvar getProto = Object.getPrototypeOf || (\n\thasProto\n\t\t? function (x) { return x.__proto__; } // eslint-disable-line no-proto\n\t\t: null\n);\n\nvar needsEval = {};\n\nvar TypedArray = typeof Uint8Array === 'undefined' || !getProto ? undefined : getProto(Uint8Array);\n\nvar INTRINSICS = {\n\t__proto__: null,\n\t'%AggregateError%': typeof AggregateError === 'undefined' ? undefined : AggregateError,\n\t'%Array%': Array,\n\t'%ArrayBuffer%': typeof ArrayBuffer === 'undefined' ? undefined : ArrayBuffer,\n\t'%ArrayIteratorPrototype%': hasSymbols && getProto ? getProto([][Symbol.iterator]()) : undefined,\n\t'%AsyncFromSyncIteratorPrototype%': undefined,\n\t'%AsyncFunction%': needsEval,\n\t'%AsyncGenerator%': needsEval,\n\t'%AsyncGeneratorFunction%': needsEval,\n\t'%AsyncIteratorPrototype%': needsEval,\n\t'%Atomics%': typeof Atomics === 'undefined' ? undefined : Atomics,\n\t'%BigInt%': typeof BigInt === 'undefined' ? undefined : BigInt,\n\t'%BigInt64Array%': typeof BigInt64Array === 'undefined' ? undefined : BigInt64Array,\n\t'%BigUint64Array%': typeof BigUint64Array === 'undefined' ? undefined : BigUint64Array,\n\t'%Boolean%': Boolean,\n\t'%DataView%': typeof DataView === 'undefined' ? undefined : DataView,\n\t'%Date%': Date,\n\t'%decodeURI%': decodeURI,\n\t'%decodeURIComponent%': decodeURIComponent,\n\t'%encodeURI%': encodeURI,\n\t'%encodeURIComponent%': encodeURIComponent,\n\t'%Error%': $Error,\n\t'%eval%': eval, // eslint-disable-line no-eval\n\t'%EvalError%': $EvalError,\n\t'%Float32Array%': typeof Float32Array === 'undefined' ? undefined : Float32Array,\n\t'%Float64Array%': typeof Float64Array === 'undefined' ? undefined : Float64Array,\n\t'%FinalizationRegistry%': typeof FinalizationRegistry === 'undefined' ? undefined : FinalizationRegistry,\n\t'%Function%': $Function,\n\t'%GeneratorFunction%': needsEval,\n\t'%Int8Array%': typeof Int8Array === 'undefined' ? undefined : Int8Array,\n\t'%Int16Array%': typeof Int16Array === 'undefined' ? undefined : Int16Array,\n\t'%Int32Array%': typeof Int32Array === 'undefined' ? undefined : Int32Array,\n\t'%isFinite%': isFinite,\n\t'%isNaN%': isNaN,\n\t'%IteratorPrototype%': hasSymbols && getProto ? getProto(getProto([][Symbol.iterator]())) : undefined,\n\t'%JSON%': typeof JSON === 'object' ? JSON : undefined,\n\t'%Map%': typeof Map === 'undefined' ? undefined : Map,\n\t'%MapIteratorPrototype%': typeof Map === 'undefined' || !hasSymbols || !getProto ? undefined : getProto(new Map()[Symbol.iterator]()),\n\t'%Math%': Math,\n\t'%Number%': Number,\n\t'%Object%': Object,\n\t'%parseFloat%': parseFloat,\n\t'%parseInt%': parseInt,\n\t'%Promise%': typeof Promise === 'undefined' ? undefined : Promise,\n\t'%Proxy%': typeof Proxy === 'undefined' ? undefined : Proxy,\n\t'%RangeError%': $RangeError,\n\t'%ReferenceError%': $ReferenceError,\n\t'%Reflect%': typeof Reflect === 'undefined' ? undefined : Reflect,\n\t'%RegExp%': RegExp,\n\t'%Set%': typeof Set === 'undefined' ? undefined : Set,\n\t'%SetIteratorPrototype%': typeof Set === 'undefined' || !hasSymbols || !getProto ? undefined : getProto(new Set()[Symbol.iterator]()),\n\t'%SharedArrayBuffer%': typeof SharedArrayBuffer === 'undefined' ? undefined : SharedArrayBuffer,\n\t'%String%': String,\n\t'%StringIteratorPrototype%': hasSymbols && getProto ? getProto(''[Symbol.iterator]()) : undefined,\n\t'%Symbol%': hasSymbols ? Symbol : undefined,\n\t'%SyntaxError%': $SyntaxError,\n\t'%ThrowTypeError%': ThrowTypeError,\n\t'%TypedArray%': TypedArray,\n\t'%TypeError%': $TypeError,\n\t'%Uint8Array%': typeof Uint8Array === 'undefined' ? undefined : Uint8Array,\n\t'%Uint8ClampedArray%': typeof Uint8ClampedArray === 'undefined' ? undefined : Uint8ClampedArray,\n\t'%Uint16Array%': typeof Uint16Array === 'undefined' ? undefined : Uint16Array,\n\t'%Uint32Array%': typeof Uint32Array === 'undefined' ? undefined : Uint32Array,\n\t'%URIError%': $URIError,\n\t'%WeakMap%': typeof WeakMap === 'undefined' ? undefined : WeakMap,\n\t'%WeakRef%': typeof WeakRef === 'undefined' ? undefined : WeakRef,\n\t'%WeakSet%': typeof WeakSet === 'undefined' ? undefined : WeakSet\n};\n\nif (getProto) {\n\ttry {\n\t\tnull.error; // eslint-disable-line no-unused-expressions\n\t} catch (e) {\n\t\t// https://github.com/tc39/proposal-shadowrealm/pull/384#issuecomment-1364264229\n\t\tvar errorProto = getProto(getProto(e));\n\t\tINTRINSICS['%Error.prototype%'] = errorProto;\n\t}\n}\n\nvar doEval = function doEval(name) {\n\tvar value;\n\tif (name === '%AsyncFunction%') {\n\t\tvalue = getEvalledConstructor('async function () {}');\n\t} else if (name === '%GeneratorFunction%') {\n\t\tvalue = getEvalledConstructor('function* () {}');\n\t} else if (name === '%AsyncGeneratorFunction%') {\n\t\tvalue = getEvalledConstructor('async function* () {}');\n\t} else if (name === '%AsyncGenerator%') {\n\t\tvar fn = doEval('%AsyncGeneratorFunction%');\n\t\tif (fn) {\n\t\t\tvalue = fn.prototype;\n\t\t}\n\t} else if (name === '%AsyncIteratorPrototype%') {\n\t\tvar gen = doEval('%AsyncGenerator%');\n\t\tif (gen && getProto) {\n\t\t\tvalue = getProto(gen.prototype);\n\t\t}\n\t}\n\n\tINTRINSICS[name] = value;\n\n\treturn value;\n};\n\nvar LEGACY_ALIASES = {\n\t__proto__: null,\n\t'%ArrayBufferPrototype%': ['ArrayBuffer', 'prototype'],\n\t'%ArrayPrototype%': ['Array', 'prototype'],\n\t'%ArrayProto_entries%': ['Array', 'prototype', 'entries'],\n\t'%ArrayProto_forEach%': ['Array', 'prototype', 'forEach'],\n\t'%ArrayProto_keys%': ['Array', 'prototype', 'keys'],\n\t'%ArrayProto_values%': ['Array', 'prototype', 'values'],\n\t'%AsyncFunctionPrototype%': ['AsyncFunction', 'prototype'],\n\t'%AsyncGenerator%': ['AsyncGeneratorFunction', 'prototype'],\n\t'%AsyncGeneratorPrototype%': ['AsyncGeneratorFunction', 'prototype', 'prototype'],\n\t'%BooleanPrototype%': ['Boolean', 'prototype'],\n\t'%DataViewPrototype%': ['DataView', 'prototype'],\n\t'%DatePrototype%': ['Date', 'prototype'],\n\t'%ErrorPrototype%': ['Error', 'prototype'],\n\t'%EvalErrorPrototype%': ['EvalError', 'prototype'],\n\t'%Float32ArrayPrototype%': ['Float32Array', 'prototype'],\n\t'%Float64ArrayPrototype%': ['Float64Array', 'prototype'],\n\t'%FunctionPrototype%': ['Function', 'prototype'],\n\t'%Generator%': ['GeneratorFunction', 'prototype'],\n\t'%GeneratorPrototype%': ['GeneratorFunction', 'prototype', 'prototype'],\n\t'%Int8ArrayPrototype%': ['Int8Array', 'prototype'],\n\t'%Int16ArrayPrototype%': ['Int16Array', 'prototype'],\n\t'%Int32ArrayPrototype%': ['Int32Array', 'prototype'],\n\t'%JSONParse%': ['JSON', 'parse'],\n\t'%JSONStringify%': ['JSON', 'stringify'],\n\t'%MapPrototype%': ['Map', 'prototype'],\n\t'%NumberPrototype%': ['Number', 'prototype'],\n\t'%ObjectPrototype%': ['Object', 'prototype'],\n\t'%ObjProto_toString%': ['Object', 'prototype', 'toString'],\n\t'%ObjProto_valueOf%': ['Object', 'prototype', 'valueOf'],\n\t'%PromisePrototype%': ['Promise', 'prototype'],\n\t'%PromiseProto_then%': ['Promise', 'prototype', 'then'],\n\t'%Promise_all%': ['Promise', 'all'],\n\t'%Promise_reject%': ['Promise', 'reject'],\n\t'%Promise_resolve%': ['Promise', 'resolve'],\n\t'%RangeErrorPrototype%': ['RangeError', 'prototype'],\n\t'%ReferenceErrorPrototype%': ['ReferenceError', 'prototype'],\n\t'%RegExpPrototype%': ['RegExp', 'prototype'],\n\t'%SetPrototype%': ['Set', 'prototype'],\n\t'%SharedArrayBufferPrototype%': ['SharedArrayBuffer', 'prototype'],\n\t'%StringPrototype%': ['String', 'prototype'],\n\t'%SymbolPrototype%': ['Symbol', 'prototype'],\n\t'%SyntaxErrorPrototype%': ['SyntaxError', 'prototype'],\n\t'%TypedArrayPrototype%': ['TypedArray', 'prototype'],\n\t'%TypeErrorPrototype%': ['TypeError', 'prototype'],\n\t'%Uint8ArrayPrototype%': ['Uint8Array', 'prototype'],\n\t'%Uint8ClampedArrayPrototype%': ['Uint8ClampedArray', 'prototype'],\n\t'%Uint16ArrayPrototype%': ['Uint16Array', 'prototype'],\n\t'%Uint32ArrayPrototype%': ['Uint32Array', 'prototype'],\n\t'%URIErrorPrototype%': ['URIError', 'prototype'],\n\t'%WeakMapPrototype%': ['WeakMap', 'prototype'],\n\t'%WeakSetPrototype%': ['WeakSet', 'prototype']\n};\n\nvar bind = require('function-bind');\nvar hasOwn = require('hasown');\nvar $concat = bind.call(Function.call, Array.prototype.concat);\nvar $spliceApply = bind.call(Function.apply, Array.prototype.splice);\nvar $replace = bind.call(Function.call, String.prototype.replace);\nvar $strSlice = bind.call(Function.call, String.prototype.slice);\nvar $exec = bind.call(Function.call, RegExp.prototype.exec);\n\n/* adapted from https://github.com/lodash/lodash/blob/4.17.15/dist/lodash.js#L6735-L6744 */\nvar rePropName = /[^%.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|%$))/g;\nvar reEscapeChar = /\\\\(\\\\)?/g; /** Used to match backslashes in property paths. */\nvar stringToPath = function stringToPath(string) {\n\tvar first = $strSlice(string, 0, 1);\n\tvar last = $strSlice(string, -1);\n\tif (first === '%' && last !== '%') {\n\t\tthrow new $SyntaxError('invalid intrinsic syntax, expected closing `%`');\n\t} else if (last === '%' && first !== '%') {\n\t\tthrow new $SyntaxError('invalid intrinsic syntax, expected opening `%`');\n\t}\n\tvar result = [];\n\t$replace(string, rePropName, function (match, number, quote, subString) {\n\t\tresult[result.length] = quote ? $replace(subString, reEscapeChar, '$1') : number || match;\n\t});\n\treturn result;\n};\n/* end adaptation */\n\nvar getBaseIntrinsic = function getBaseIntrinsic(name, allowMissing) {\n\tvar intrinsicName = name;\n\tvar alias;\n\tif (hasOwn(LEGACY_ALIASES, intrinsicName)) {\n\t\talias = LEGACY_ALIASES[intrinsicName];\n\t\tintrinsicName = '%' + alias[0] + '%';\n\t}\n\n\tif (hasOwn(INTRINSICS, intrinsicName)) {\n\t\tvar value = INTRINSICS[intrinsicName];\n\t\tif (value === needsEval) {\n\t\t\tvalue = doEval(intrinsicName);\n\t\t}\n\t\tif (typeof value === 'undefined' && !allowMissing) {\n\t\t\tthrow new $TypeError('intrinsic ' + name + ' exists, but is not available. Please file an issue!');\n\t\t}\n\n\t\treturn {\n\t\t\talias: alias,\n\t\t\tname: intrinsicName,\n\t\t\tvalue: value\n\t\t};\n\t}\n\n\tthrow new $SyntaxError('intrinsic ' + name + ' does not exist!');\n};\n\nmodule.exports = function GetIntrinsic(name, allowMissing) {\n\tif (typeof name !== 'string' || name.length === 0) {\n\t\tthrow new $TypeError('intrinsic name must be a non-empty string');\n\t}\n\tif (arguments.length > 1 && typeof allowMissing !== 'boolean') {\n\t\tthrow new $TypeError('\"allowMissing\" argument must be a boolean');\n\t}\n\n\tif ($exec(/^%?[^%]*%?$/, name) === null) {\n\t\tthrow new $SyntaxError('`%` may not be present anywhere but at the beginning and end of the intrinsic name');\n\t}\n\tvar parts = stringToPath(name);\n\tvar intrinsicBaseName = parts.length > 0 ? parts[0] : '';\n\n\tvar intrinsic = getBaseIntrinsic('%' + intrinsicBaseName + '%', allowMissing);\n\tvar intrinsicRealName = intrinsic.name;\n\tvar value = intrinsic.value;\n\tvar skipFurtherCaching = false;\n\n\tvar alias = intrinsic.alias;\n\tif (alias) {\n\t\tintrinsicBaseName = alias[0];\n\t\t$spliceApply(parts, $concat([0, 1], alias));\n\t}\n\n\tfor (var i = 1, isOwn = true; i < parts.length; i += 1) {\n\t\tvar part = parts[i];\n\t\tvar first = $strSlice(part, 0, 1);\n\t\tvar last = $strSlice(part, -1);\n\t\tif (\n\t\t\t(\n\t\t\t\t(first === '\"' || first === \"'\" || first === '`')\n\t\t\t\t|| (last === '\"' || last === \"'\" || last === '`')\n\t\t\t)\n\t\t\t&& first !== last\n\t\t) {\n\t\t\tthrow new $SyntaxError('property names with quotes must have matching quotes');\n\t\t}\n\t\tif (part === 'constructor' || !isOwn) {\n\t\t\tskipFurtherCaching = true;\n\t\t}\n\n\t\tintrinsicBaseName += '.' + part;\n\t\tintrinsicRealName = '%' + intrinsicBaseName + '%';\n\n\t\tif (hasOwn(INTRINSICS, intrinsicRealName)) {\n\t\t\tvalue = INTRINSICS[intrinsicRealName];\n\t\t} else if (value != null) {\n\t\t\tif (!(part in value)) {\n\t\t\t\tif (!allowMissing) {\n\t\t\t\t\tthrow new $TypeError('base intrinsic for ' + name + ' exists, but the property is not available.');\n\t\t\t\t}\n\t\t\t\treturn void undefined;\n\t\t\t}\n\t\t\tif ($gOPD && (i + 1) >= parts.length) {\n\t\t\t\tvar desc = $gOPD(value, part);\n\t\t\t\tisOwn = !!desc;\n\n\t\t\t\t// By convention, when a data property is converted to an accessor\n\t\t\t\t// property to emulate a data property that does not suffer from\n\t\t\t\t// the override mistake, that accessor's getter is marked with\n\t\t\t\t// an `originalValue` property. Here, when we detect this, we\n\t\t\t\t// uphold the illusion by pretending to see that original data\n\t\t\t\t// property, i.e., returning the value rather than the getter\n\t\t\t\t// itself.\n\t\t\t\tif (isOwn && 'get' in desc && !('originalValue' in desc.get)) {\n\t\t\t\t\tvalue = desc.get;\n\t\t\t\t} else {\n\t\t\t\t\tvalue = value[part];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tisOwn = hasOwn(value, part);\n\t\t\t\tvalue = value[part];\n\t\t\t}\n\n\t\t\tif (isOwn && !skipFurtherCaching) {\n\t\t\t\tINTRINSICS[intrinsicRealName] = value;\n\t\t\t}\n\t\t}\n\t}\n\treturn value;\n};\n","'use strict';\n\nvar GetIntrinsic = require('get-intrinsic');\n\nvar $gOPD = GetIntrinsic('%Object.getOwnPropertyDescriptor%', true);\n\nif ($gOPD) {\n\ttry {\n\t\t$gOPD([], 'length');\n\t} catch (e) {\n\t\t// IE 8 has a broken gOPD\n\t\t$gOPD = null;\n\t}\n}\n\nmodule.exports = $gOPD;\n","'use strict';\n\nvar $defineProperty = require('es-define-property');\n\nvar hasPropertyDescriptors = function hasPropertyDescriptors() {\n\treturn !!$defineProperty;\n};\n\nhasPropertyDescriptors.hasArrayLengthDefineBug = function hasArrayLengthDefineBug() {\n\t// node v0.6 has a bug where array lengths can be Set but not Defined\n\tif (!$defineProperty) {\n\t\treturn null;\n\t}\n\ttry {\n\t\treturn $defineProperty([], 'length', { value: 1 }).length !== 1;\n\t} catch (e) {\n\t\t// In Firefox 4-22, defining length on an array throws an exception.\n\t\treturn true;\n\t}\n};\n\nmodule.exports = hasPropertyDescriptors;\n","'use strict';\n\nvar test = {\n\t__proto__: null,\n\tfoo: {}\n};\n\nvar $Object = Object;\n\n/** @type {import('.')} */\nmodule.exports = function hasProto() {\n\t// @ts-expect-error: TS errors on an inherited property for some reason\n\treturn { __proto__: test }.foo === test.foo\n\t\t&& !(test instanceof $Object);\n};\n","'use strict';\n\nvar origSymbol = typeof Symbol !== 'undefined' && Symbol;\nvar hasSymbolSham = require('./shams');\n\nmodule.exports = function hasNativeSymbols() {\n\tif (typeof origSymbol !== 'function') { return false; }\n\tif (typeof Symbol !== 'function') { return false; }\n\tif (typeof origSymbol('foo') !== 'symbol') { return false; }\n\tif (typeof Symbol('bar') !== 'symbol') { return false; }\n\n\treturn hasSymbolSham();\n};\n","'use strict';\n\n/* eslint complexity: [2, 18], max-statements: [2, 33] */\nmodule.exports = function hasSymbols() {\n\tif (typeof Symbol !== 'function' || typeof Object.getOwnPropertySymbols !== 'function') { return false; }\n\tif (typeof Symbol.iterator === 'symbol') { return true; }\n\n\tvar obj = {};\n\tvar sym = Symbol('test');\n\tvar symObj = Object(sym);\n\tif (typeof sym === 'string') { return false; }\n\n\tif (Object.prototype.toString.call(sym) !== '[object Symbol]') { return false; }\n\tif (Object.prototype.toString.call(symObj) !== '[object Symbol]') { return false; }\n\n\t// temp disabled per https://github.com/ljharb/object.assign/issues/17\n\t// if (sym instanceof Symbol) { return false; }\n\t// temp disabled per https://github.com/WebReflection/get-own-property-symbols/issues/4\n\t// if (!(symObj instanceof Symbol)) { return false; }\n\n\t// if (typeof Symbol.prototype.toString !== 'function') { return false; }\n\t// if (String(sym) !== Symbol.prototype.toString.call(sym)) { return false; }\n\n\tvar symVal = 42;\n\tobj[sym] = symVal;\n\tfor (sym in obj) { return false; } // eslint-disable-line no-restricted-syntax, no-unreachable-loop\n\tif (typeof Object.keys === 'function' && Object.keys(obj).length !== 0) { return false; }\n\n\tif (typeof Object.getOwnPropertyNames === 'function' && Object.getOwnPropertyNames(obj).length !== 0) { return false; }\n\n\tvar syms = Object.getOwnPropertySymbols(obj);\n\tif (syms.length !== 1 || syms[0] !== sym) { return false; }\n\n\tif (!Object.prototype.propertyIsEnumerable.call(obj, sym)) { return false; }\n\n\tif (typeof Object.getOwnPropertyDescriptor === 'function') {\n\t\tvar descriptor = Object.getOwnPropertyDescriptor(obj, sym);\n\t\tif (descriptor.value !== symVal || descriptor.enumerable !== true) { return false; }\n\t}\n\n\treturn true;\n};\n","'use strict';\n\nvar hasSymbols = require('has-symbols/shams');\n\n/** @type {import('.')} */\nmodule.exports = function hasToStringTagShams() {\n\treturn hasSymbols() && !!Symbol.toStringTag;\n};\n","'use strict';\n\nvar call = Function.prototype.call;\nvar $hasOwn = Object.prototype.hasOwnProperty;\nvar bind = require('function-bind');\n\n/** @type {import('.')} */\nmodule.exports = bind.call(call, $hasOwn);\n","if (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    if (superCtor) {\n      ctor.super_ = superCtor\n      ctor.prototype = Object.create(superCtor.prototype, {\n        constructor: {\n          value: ctor,\n          enumerable: false,\n          writable: true,\n          configurable: true\n        }\n      })\n    }\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    if (superCtor) {\n      ctor.super_ = superCtor\n      var TempCtor = function () {}\n      TempCtor.prototype = superCtor.prototype\n      ctor.prototype = new TempCtor()\n      ctor.prototype.constructor = ctor\n    }\n  }\n}\n","'use strict';\n\nvar hasToStringTag = require('has-tostringtag/shams')();\nvar callBound = require('call-bind/callBound');\n\nvar $toString = callBound('Object.prototype.toString');\n\nvar isStandardArguments = function isArguments(value) {\n\tif (hasToStringTag && value && typeof value === 'object' && Symbol.toStringTag in value) {\n\t\treturn false;\n\t}\n\treturn $toString(value) === '[object Arguments]';\n};\n\nvar isLegacyArguments = function isArguments(value) {\n\tif (isStandardArguments(value)) {\n\t\treturn true;\n\t}\n\treturn value !== null &&\n\t\ttypeof value === 'object' &&\n\t\ttypeof value.length === 'number' &&\n\t\tvalue.length >= 0 &&\n\t\t$toString(value) !== '[object Array]' &&\n\t\t$toString(value.callee) === '[object Function]';\n};\n\nvar supportsStandardArguments = (function () {\n\treturn isStandardArguments(arguments);\n}());\n\nisStandardArguments.isLegacyArguments = isLegacyArguments; // for tests\n\nmodule.exports = supportsStandardArguments ? isStandardArguments : isLegacyArguments;\n","'use strict';\n\nvar fnToStr = Function.prototype.toString;\nvar reflectApply = typeof Reflect === 'object' && Reflect !== null && Reflect.apply;\nvar badArrayLike;\nvar isCallableMarker;\nif (typeof reflectApply === 'function' && typeof Object.defineProperty === 'function') {\n\ttry {\n\t\tbadArrayLike = Object.defineProperty({}, 'length', {\n\t\t\tget: function () {\n\t\t\t\tthrow isCallableMarker;\n\t\t\t}\n\t\t});\n\t\tisCallableMarker = {};\n\t\t// eslint-disable-next-line no-throw-literal\n\t\treflectApply(function () { throw 42; }, null, badArrayLike);\n\t} catch (_) {\n\t\tif (_ !== isCallableMarker) {\n\t\t\treflectApply = null;\n\t\t}\n\t}\n} else {\n\treflectApply = null;\n}\n\nvar constructorRegex = /^\\s*class\\b/;\nvar isES6ClassFn = function isES6ClassFunction(value) {\n\ttry {\n\t\tvar fnStr = fnToStr.call(value);\n\t\treturn constructorRegex.test(fnStr);\n\t} catch (e) {\n\t\treturn false; // not a function\n\t}\n};\n\nvar tryFunctionObject = function tryFunctionToStr(value) {\n\ttry {\n\t\tif (isES6ClassFn(value)) { return false; }\n\t\tfnToStr.call(value);\n\t\treturn true;\n\t} catch (e) {\n\t\treturn false;\n\t}\n};\nvar toStr = Object.prototype.toString;\nvar objectClass = '[object Object]';\nvar fnClass = '[object Function]';\nvar genClass = '[object GeneratorFunction]';\nvar ddaClass = '[object HTMLAllCollection]'; // IE 11\nvar ddaClass2 = '[object HTML document.all class]';\nvar ddaClass3 = '[object HTMLCollection]'; // IE 9-10\nvar hasToStringTag = typeof Symbol === 'function' && !!Symbol.toStringTag; // better: use `has-tostringtag`\n\nvar isIE68 = !(0 in [,]); // eslint-disable-line no-sparse-arrays, comma-spacing\n\nvar isDDA = function isDocumentDotAll() { return false; };\nif (typeof document === 'object') {\n\t// Firefox 3 canonicalizes DDA to undefined when it's not accessed directly\n\tvar all = document.all;\n\tif (toStr.call(all) === toStr.call(document.all)) {\n\t\tisDDA = function isDocumentDotAll(value) {\n\t\t\t/* globals document: false */\n\t\t\t// in IE 6-8, typeof document.all is \"object\" and it's truthy\n\t\t\tif ((isIE68 || !value) && (typeof value === 'undefined' || typeof value === 'object')) {\n\t\t\t\ttry {\n\t\t\t\t\tvar str = toStr.call(value);\n\t\t\t\t\treturn (\n\t\t\t\t\t\tstr === ddaClass\n\t\t\t\t\t\t|| str === ddaClass2\n\t\t\t\t\t\t|| str === ddaClass3 // opera 12.16\n\t\t\t\t\t\t|| str === objectClass // IE 6-8\n\t\t\t\t\t) && value('') == null; // eslint-disable-line eqeqeq\n\t\t\t\t} catch (e) { /**/ }\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t}\n}\n\nmodule.exports = reflectApply\n\t? function isCallable(value) {\n\t\tif (isDDA(value)) { return true; }\n\t\tif (!value) { return false; }\n\t\tif (typeof value !== 'function' && typeof value !== 'object') { return false; }\n\t\ttry {\n\t\t\treflectApply(value, null, badArrayLike);\n\t\t} catch (e) {\n\t\t\tif (e !== isCallableMarker) { return false; }\n\t\t}\n\t\treturn !isES6ClassFn(value) && tryFunctionObject(value);\n\t}\n\t: function isCallable(value) {\n\t\tif (isDDA(value)) { return true; }\n\t\tif (!value) { return false; }\n\t\tif (typeof value !== 'function' && typeof value !== 'object') { return false; }\n\t\tif (hasToStringTag) { return tryFunctionObject(value); }\n\t\tif (isES6ClassFn(value)) { return false; }\n\t\tvar strClass = toStr.call(value);\n\t\tif (strClass !== fnClass && strClass !== genClass && !(/^\\[object HTML/).test(strClass)) { return false; }\n\t\treturn tryFunctionObject(value);\n\t};\n","'use strict';\n\nvar toStr = Object.prototype.toString;\nvar fnToStr = Function.prototype.toString;\nvar isFnRegex = /^\\s*(?:function)?\\*/;\nvar hasToStringTag = require('has-tostringtag/shams')();\nvar getProto = Object.getPrototypeOf;\nvar getGeneratorFunc = function () { // eslint-disable-line consistent-return\n\tif (!hasToStringTag) {\n\t\treturn false;\n\t}\n\ttry {\n\t\treturn Function('return function*() {}')();\n\t} catch (e) {\n\t}\n};\nvar GeneratorFunction;\n\nmodule.exports = function isGeneratorFunction(fn) {\n\tif (typeof fn !== 'function') {\n\t\treturn false;\n\t}\n\tif (isFnRegex.test(fnToStr.call(fn))) {\n\t\treturn true;\n\t}\n\tif (!hasToStringTag) {\n\t\tvar str = toStr.call(fn);\n\t\treturn str === '[object GeneratorFunction]';\n\t}\n\tif (!getProto) {\n\t\treturn false;\n\t}\n\tif (typeof GeneratorFunction === 'undefined') {\n\t\tvar generatorFunc = getGeneratorFunc();\n\t\tGeneratorFunction = generatorFunc ? getProto(generatorFunc) : false;\n\t}\n\treturn getProto(fn) === GeneratorFunction;\n};\n","'use strict';\n\nvar whichTypedArray = require('which-typed-array');\n\n/** @type {import('.')} */\nmodule.exports = function isTypedArray(value) {\n\treturn !!whichTypedArray(value);\n};\n","'use strict';\n\n/** @type {import('.')} */\nmodule.exports = [\n\t'Float32Array',\n\t'Float64Array',\n\t'Int8Array',\n\t'Int16Array',\n\t'Int32Array',\n\t'Uint8Array',\n\t'Uint8ClampedArray',\n\t'Uint16Array',\n\t'Uint32Array',\n\t'BigInt64Array',\n\t'BigUint64Array'\n];\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","'use strict';\n\nvar GetIntrinsic = require('get-intrinsic');\nvar define = require('define-data-property');\nvar hasDescriptors = require('has-property-descriptors')();\nvar gOPD = require('gopd');\n\nvar $TypeError = require('es-errors/type');\nvar $floor = GetIntrinsic('%Math.floor%');\n\n/** @type {import('.')} */\nmodule.exports = function setFunctionLength(fn, length) {\n\tif (typeof fn !== 'function') {\n\t\tthrow new $TypeError('`fn` is not a function');\n\t}\n\tif (typeof length !== 'number' || length < 0 || length > 0xFFFFFFFF || $floor(length) !== length) {\n\t\tthrow new $TypeError('`length` must be a positive 32-bit integer');\n\t}\n\n\tvar loose = arguments.length > 2 && !!arguments[2];\n\n\tvar functionLengthIsConfigurable = true;\n\tvar functionLengthIsWritable = true;\n\tif ('length' in fn && gOPD) {\n\t\tvar desc = gOPD(fn, 'length');\n\t\tif (desc && !desc.configurable) {\n\t\t\tfunctionLengthIsConfigurable = false;\n\t\t}\n\t\tif (desc && !desc.writable) {\n\t\t\tfunctionLengthIsWritable = false;\n\t\t}\n\t}\n\n\tif (functionLengthIsConfigurable || functionLengthIsWritable || !loose) {\n\t\tif (hasDescriptors) {\n\t\t\tdefine(/** @type {Parameters<define>[0]} */ (fn), 'length', length, true, true);\n\t\t} else {\n\t\t\tdefine(/** @type {Parameters<define>[0]} */ (fn), 'length', length);\n\t\t}\n\t}\n\treturn fn;\n};\n","module.exports = function isBuffer(arg) {\n  return arg && typeof arg === 'object'\n    && typeof arg.copy === 'function'\n    && typeof arg.fill === 'function'\n    && typeof arg.readUInt8 === 'function';\n}","// Currently in sync with Node.js lib/internal/util/types.js\n// https://github.com/nodejs/node/commit/112cc7c27551254aa2b17098fb774867f05ed0d9\n\n'use strict';\n\nvar isArgumentsObject = require('is-arguments');\nvar isGeneratorFunction = require('is-generator-function');\nvar whichTypedArray = require('which-typed-array');\nvar isTypedArray = require('is-typed-array');\n\nfunction uncurryThis(f) {\n  return f.call.bind(f);\n}\n\nvar BigIntSupported = typeof BigInt !== 'undefined';\nvar SymbolSupported = typeof Symbol !== 'undefined';\n\nvar ObjectToString = uncurryThis(Object.prototype.toString);\n\nvar numberValue = uncurryThis(Number.prototype.valueOf);\nvar stringValue = uncurryThis(String.prototype.valueOf);\nvar booleanValue = uncurryThis(Boolean.prototype.valueOf);\n\nif (BigIntSupported) {\n  var bigIntValue = uncurryThis(BigInt.prototype.valueOf);\n}\n\nif (SymbolSupported) {\n  var symbolValue = uncurryThis(Symbol.prototype.valueOf);\n}\n\nfunction checkBoxedPrimitive(value, prototypeValueOf) {\n  if (typeof value !== 'object') {\n    return false;\n  }\n  try {\n    prototypeValueOf(value);\n    return true;\n  } catch(e) {\n    return false;\n  }\n}\n\nexports.isArgumentsObject = isArgumentsObject;\nexports.isGeneratorFunction = isGeneratorFunction;\nexports.isTypedArray = isTypedArray;\n\n// Taken from here and modified for better browser support\n// https://github.com/sindresorhus/p-is-promise/blob/cda35a513bda03f977ad5cde3a079d237e82d7ef/index.js\nfunction isPromise(input) {\n\treturn (\n\t\t(\n\t\t\ttypeof Promise !== 'undefined' &&\n\t\t\tinput instanceof Promise\n\t\t) ||\n\t\t(\n\t\t\tinput !== null &&\n\t\t\ttypeof input === 'object' &&\n\t\t\ttypeof input.then === 'function' &&\n\t\t\ttypeof input.catch === 'function'\n\t\t)\n\t);\n}\nexports.isPromise = isPromise;\n\nfunction isArrayBufferView(value) {\n  if (typeof ArrayBuffer !== 'undefined' && ArrayBuffer.isView) {\n    return ArrayBuffer.isView(value);\n  }\n\n  return (\n    isTypedArray(value) ||\n    isDataView(value)\n  );\n}\nexports.isArrayBufferView = isArrayBufferView;\n\n\nfunction isUint8Array(value) {\n  return whichTypedArray(value) === 'Uint8Array';\n}\nexports.isUint8Array = isUint8Array;\n\nfunction isUint8ClampedArray(value) {\n  return whichTypedArray(value) === 'Uint8ClampedArray';\n}\nexports.isUint8ClampedArray = isUint8ClampedArray;\n\nfunction isUint16Array(value) {\n  return whichTypedArray(value) === 'Uint16Array';\n}\nexports.isUint16Array = isUint16Array;\n\nfunction isUint32Array(value) {\n  return whichTypedArray(value) === 'Uint32Array';\n}\nexports.isUint32Array = isUint32Array;\n\nfunction isInt8Array(value) {\n  return whichTypedArray(value) === 'Int8Array';\n}\nexports.isInt8Array = isInt8Array;\n\nfunction isInt16Array(value) {\n  return whichTypedArray(value) === 'Int16Array';\n}\nexports.isInt16Array = isInt16Array;\n\nfunction isInt32Array(value) {\n  return whichTypedArray(value) === 'Int32Array';\n}\nexports.isInt32Array = isInt32Array;\n\nfunction isFloat32Array(value) {\n  return whichTypedArray(value) === 'Float32Array';\n}\nexports.isFloat32Array = isFloat32Array;\n\nfunction isFloat64Array(value) {\n  return whichTypedArray(value) === 'Float64Array';\n}\nexports.isFloat64Array = isFloat64Array;\n\nfunction isBigInt64Array(value) {\n  return whichTypedArray(value) === 'BigInt64Array';\n}\nexports.isBigInt64Array = isBigInt64Array;\n\nfunction isBigUint64Array(value) {\n  return whichTypedArray(value) === 'BigUint64Array';\n}\nexports.isBigUint64Array = isBigUint64Array;\n\nfunction isMapToString(value) {\n  return ObjectToString(value) === '[object Map]';\n}\nisMapToString.working = (\n  typeof Map !== 'undefined' &&\n  isMapToString(new Map())\n);\n\nfunction isMap(value) {\n  if (typeof Map === 'undefined') {\n    return false;\n  }\n\n  return isMapToString.working\n    ? isMapToString(value)\n    : value instanceof Map;\n}\nexports.isMap = isMap;\n\nfunction isSetToString(value) {\n  return ObjectToString(value) === '[object Set]';\n}\nisSetToString.working = (\n  typeof Set !== 'undefined' &&\n  isSetToString(new Set())\n);\nfunction isSet(value) {\n  if (typeof Set === 'undefined') {\n    return false;\n  }\n\n  return isSetToString.working\n    ? isSetToString(value)\n    : value instanceof Set;\n}\nexports.isSet = isSet;\n\nfunction isWeakMapToString(value) {\n  return ObjectToString(value) === '[object WeakMap]';\n}\nisWeakMapToString.working = (\n  typeof WeakMap !== 'undefined' &&\n  isWeakMapToString(new WeakMap())\n);\nfunction isWeakMap(value) {\n  if (typeof WeakMap === 'undefined') {\n    return false;\n  }\n\n  return isWeakMapToString.working\n    ? isWeakMapToString(value)\n    : value instanceof WeakMap;\n}\nexports.isWeakMap = isWeakMap;\n\nfunction isWeakSetToString(value) {\n  return ObjectToString(value) === '[object WeakSet]';\n}\nisWeakSetToString.working = (\n  typeof WeakSet !== 'undefined' &&\n  isWeakSetToString(new WeakSet())\n);\nfunction isWeakSet(value) {\n  return isWeakSetToString(value);\n}\nexports.isWeakSet = isWeakSet;\n\nfunction isArrayBufferToString(value) {\n  return ObjectToString(value) === '[object ArrayBuffer]';\n}\nisArrayBufferToString.working = (\n  typeof ArrayBuffer !== 'undefined' &&\n  isArrayBufferToString(new ArrayBuffer())\n);\nfunction isArrayBuffer(value) {\n  if (typeof ArrayBuffer === 'undefined') {\n    return false;\n  }\n\n  return isArrayBufferToString.working\n    ? isArrayBufferToString(value)\n    : value instanceof ArrayBuffer;\n}\nexports.isArrayBuffer = isArrayBuffer;\n\nfunction isDataViewToString(value) {\n  return ObjectToString(value) === '[object DataView]';\n}\nisDataViewToString.working = (\n  typeof ArrayBuffer !== 'undefined' &&\n  typeof DataView !== 'undefined' &&\n  isDataViewToString(new DataView(new ArrayBuffer(1), 0, 1))\n);\nfunction isDataView(value) {\n  if (typeof DataView === 'undefined') {\n    return false;\n  }\n\n  return isDataViewToString.working\n    ? isDataViewToString(value)\n    : value instanceof DataView;\n}\nexports.isDataView = isDataView;\n\n// Store a copy of SharedArrayBuffer in case it's deleted elsewhere\nvar SharedArrayBufferCopy = typeof SharedArrayBuffer !== 'undefined' ? SharedArrayBuffer : undefined;\nfunction isSharedArrayBufferToString(value) {\n  return ObjectToString(value) === '[object SharedArrayBuffer]';\n}\nfunction isSharedArrayBuffer(value) {\n  if (typeof SharedArrayBufferCopy === 'undefined') {\n    return false;\n  }\n\n  if (typeof isSharedArrayBufferToString.working === 'undefined') {\n    isSharedArrayBufferToString.working = isSharedArrayBufferToString(new SharedArrayBufferCopy());\n  }\n\n  return isSharedArrayBufferToString.working\n    ? isSharedArrayBufferToString(value)\n    : value instanceof SharedArrayBufferCopy;\n}\nexports.isSharedArrayBuffer = isSharedArrayBuffer;\n\nfunction isAsyncFunction(value) {\n  return ObjectToString(value) === '[object AsyncFunction]';\n}\nexports.isAsyncFunction = isAsyncFunction;\n\nfunction isMapIterator(value) {\n  return ObjectToString(value) === '[object Map Iterator]';\n}\nexports.isMapIterator = isMapIterator;\n\nfunction isSetIterator(value) {\n  return ObjectToString(value) === '[object Set Iterator]';\n}\nexports.isSetIterator = isSetIterator;\n\nfunction isGeneratorObject(value) {\n  return ObjectToString(value) === '[object Generator]';\n}\nexports.isGeneratorObject = isGeneratorObject;\n\nfunction isWebAssemblyCompiledModule(value) {\n  return ObjectToString(value) === '[object WebAssembly.Module]';\n}\nexports.isWebAssemblyCompiledModule = isWebAssemblyCompiledModule;\n\nfunction isNumberObject(value) {\n  return checkBoxedPrimitive(value, numberValue);\n}\nexports.isNumberObject = isNumberObject;\n\nfunction isStringObject(value) {\n  return checkBoxedPrimitive(value, stringValue);\n}\nexports.isStringObject = isStringObject;\n\nfunction isBooleanObject(value) {\n  return checkBoxedPrimitive(value, booleanValue);\n}\nexports.isBooleanObject = isBooleanObject;\n\nfunction isBigIntObject(value) {\n  return BigIntSupported && checkBoxedPrimitive(value, bigIntValue);\n}\nexports.isBigIntObject = isBigIntObject;\n\nfunction isSymbolObject(value) {\n  return SymbolSupported && checkBoxedPrimitive(value, symbolValue);\n}\nexports.isSymbolObject = isSymbolObject;\n\nfunction isBoxedPrimitive(value) {\n  return (\n    isNumberObject(value) ||\n    isStringObject(value) ||\n    isBooleanObject(value) ||\n    isBigIntObject(value) ||\n    isSymbolObject(value)\n  );\n}\nexports.isBoxedPrimitive = isBoxedPrimitive;\n\nfunction isAnyArrayBuffer(value) {\n  return typeof Uint8Array !== 'undefined' && (\n    isArrayBuffer(value) ||\n    isSharedArrayBuffer(value)\n  );\n}\nexports.isAnyArrayBuffer = isAnyArrayBuffer;\n\n['isProxy', 'isExternal', 'isModuleNamespaceObject'].forEach(function(method) {\n  Object.defineProperty(exports, method, {\n    enumerable: false,\n    value: function() {\n      throw new Error(method + ' is not supported in userland');\n    }\n  });\n});\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar getOwnPropertyDescriptors = Object.getOwnPropertyDescriptors ||\n  function getOwnPropertyDescriptors(obj) {\n    var keys = Object.keys(obj);\n    var descriptors = {};\n    for (var i = 0; i < keys.length; i++) {\n      descriptors[keys[i]] = Object.getOwnPropertyDescriptor(obj, keys[i]);\n    }\n    return descriptors;\n  };\n\nvar formatRegExp = /%[sdj%]/g;\nexports.format = function(f) {\n  if (!isString(f)) {\n    var objects = [];\n    for (var i = 0; i < arguments.length; i++) {\n      objects.push(inspect(arguments[i]));\n    }\n    return objects.join(' ');\n  }\n\n  var i = 1;\n  var args = arguments;\n  var len = args.length;\n  var str = String(f).replace(formatRegExp, function(x) {\n    if (x === '%%') return '%';\n    if (i >= len) return x;\n    switch (x) {\n      case '%s': return String(args[i++]);\n      case '%d': return Number(args[i++]);\n      case '%j':\n        try {\n          return JSON.stringify(args[i++]);\n        } catch (_) {\n          return '[Circular]';\n        }\n      default:\n        return x;\n    }\n  });\n  for (var x = args[i]; i < len; x = args[++i]) {\n    if (isNull(x) || !isObject(x)) {\n      str += ' ' + x;\n    } else {\n      str += ' ' + inspect(x);\n    }\n  }\n  return str;\n};\n\n\n// Mark that a method should not be used.\n// Returns a modified function which warns once by default.\n// If --no-deprecation is set, then it is a no-op.\nexports.deprecate = function(fn, msg) {\n  if (typeof process !== 'undefined' && process.noDeprecation === true) {\n    return fn;\n  }\n\n  // Allow for deprecating things in the process of starting up.\n  if (typeof process === 'undefined') {\n    return function() {\n      return exports.deprecate(fn, msg).apply(this, arguments);\n    };\n  }\n\n  var warned = false;\n  function deprecated() {\n    if (!warned) {\n      if (process.throwDeprecation) {\n        throw new Error(msg);\n      } else if (process.traceDeprecation) {\n        console.trace(msg);\n      } else {\n        console.error(msg);\n      }\n      warned = true;\n    }\n    return fn.apply(this, arguments);\n  }\n\n  return deprecated;\n};\n\n\nvar debugs = {};\nvar debugEnvRegex = /^$/;\n\nif (process.env.NODE_DEBUG) {\n  var debugEnv = process.env.NODE_DEBUG;\n  debugEnv = debugEnv.replace(/[|\\\\{}()[\\]^$+?.]/g, '\\\\$&')\n    .replace(/\\*/g, '.*')\n    .replace(/,/g, '$|^')\n    .toUpperCase();\n  debugEnvRegex = new RegExp('^' + debugEnv + '$', 'i');\n}\nexports.debuglog = function(set) {\n  set = set.toUpperCase();\n  if (!debugs[set]) {\n    if (debugEnvRegex.test(set)) {\n      var pid = process.pid;\n      debugs[set] = function() {\n        var msg = exports.format.apply(exports, arguments);\n        console.error('%s %d: %s', set, pid, msg);\n      };\n    } else {\n      debugs[set] = function() {};\n    }\n  }\n  return debugs[set];\n};\n\n\n/**\n * Echos the value of a value. Trys to print the value out\n * in the best way possible given the different types.\n *\n * @param {Object} obj The object to print out.\n * @param {Object} opts Optional options object that alters the output.\n */\n/* legacy: obj, showHidden, depth, colors*/\nfunction inspect(obj, opts) {\n  // default options\n  var ctx = {\n    seen: [],\n    stylize: stylizeNoColor\n  };\n  // legacy...\n  if (arguments.length >= 3) ctx.depth = arguments[2];\n  if (arguments.length >= 4) ctx.colors = arguments[3];\n  if (isBoolean(opts)) {\n    // legacy...\n    ctx.showHidden = opts;\n  } else if (opts) {\n    // got an \"options\" object\n    exports._extend(ctx, opts);\n  }\n  // set default options\n  if (isUndefined(ctx.showHidden)) ctx.showHidden = false;\n  if (isUndefined(ctx.depth)) ctx.depth = 2;\n  if (isUndefined(ctx.colors)) ctx.colors = false;\n  if (isUndefined(ctx.customInspect)) ctx.customInspect = true;\n  if (ctx.colors) ctx.stylize = stylizeWithColor;\n  return formatValue(ctx, obj, ctx.depth);\n}\nexports.inspect = inspect;\n\n\n// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics\ninspect.colors = {\n  'bold' : [1, 22],\n  'italic' : [3, 23],\n  'underline' : [4, 24],\n  'inverse' : [7, 27],\n  'white' : [37, 39],\n  'grey' : [90, 39],\n  'black' : [30, 39],\n  'blue' : [34, 39],\n  'cyan' : [36, 39],\n  'green' : [32, 39],\n  'magenta' : [35, 39],\n  'red' : [31, 39],\n  'yellow' : [33, 39]\n};\n\n// Don't use 'blue' not visible on cmd.exe\ninspect.styles = {\n  'special': 'cyan',\n  'number': 'yellow',\n  'boolean': 'yellow',\n  'undefined': 'grey',\n  'null': 'bold',\n  'string': 'green',\n  'date': 'magenta',\n  // \"name\": intentionally not styling\n  'regexp': 'red'\n};\n\n\nfunction stylizeWithColor(str, styleType) {\n  var style = inspect.styles[styleType];\n\n  if (style) {\n    return '\\u001b[' + inspect.colors[style][0] + 'm' + str +\n           '\\u001b[' + inspect.colors[style][1] + 'm';\n  } else {\n    return str;\n  }\n}\n\n\nfunction stylizeNoColor(str, styleType) {\n  return str;\n}\n\n\nfunction arrayToHash(array) {\n  var hash = {};\n\n  array.forEach(function(val, idx) {\n    hash[val] = true;\n  });\n\n  return hash;\n}\n\n\nfunction formatValue(ctx, value, recurseTimes) {\n  // Provide a hook for user-specified inspect functions.\n  // Check that value is an object with an inspect function on it\n  if (ctx.customInspect &&\n      value &&\n      isFunction(value.inspect) &&\n      // Filter out the util module, it's inspect function is special\n      value.inspect !== exports.inspect &&\n      // Also filter out any prototype objects using the circular check.\n      !(value.constructor && value.constructor.prototype === value)) {\n    var ret = value.inspect(recurseTimes, ctx);\n    if (!isString(ret)) {\n      ret = formatValue(ctx, ret, recurseTimes);\n    }\n    return ret;\n  }\n\n  // Primitive types cannot have properties\n  var primitive = formatPrimitive(ctx, value);\n  if (primitive) {\n    return primitive;\n  }\n\n  // Look up the keys of the object.\n  var keys = Object.keys(value);\n  var visibleKeys = arrayToHash(keys);\n\n  if (ctx.showHidden) {\n    keys = Object.getOwnPropertyNames(value);\n  }\n\n  // IE doesn't make error fields non-enumerable\n  // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx\n  if (isError(value)\n      && (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {\n    return formatError(value);\n  }\n\n  // Some type of object without properties can be shortcutted.\n  if (keys.length === 0) {\n    if (isFunction(value)) {\n      var name = value.name ? ': ' + value.name : '';\n      return ctx.stylize('[Function' + name + ']', 'special');\n    }\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    }\n    if (isDate(value)) {\n      return ctx.stylize(Date.prototype.toString.call(value), 'date');\n    }\n    if (isError(value)) {\n      return formatError(value);\n    }\n  }\n\n  var base = '', array = false, braces = ['{', '}'];\n\n  // Make Array say that they are Array\n  if (isArray(value)) {\n    array = true;\n    braces = ['[', ']'];\n  }\n\n  // Make functions say that they are functions\n  if (isFunction(value)) {\n    var n = value.name ? ': ' + value.name : '';\n    base = ' [Function' + n + ']';\n  }\n\n  // Make RegExps say that they are RegExps\n  if (isRegExp(value)) {\n    base = ' ' + RegExp.prototype.toString.call(value);\n  }\n\n  // Make dates with properties first say the date\n  if (isDate(value)) {\n    base = ' ' + Date.prototype.toUTCString.call(value);\n  }\n\n  // Make error with message first say the error\n  if (isError(value)) {\n    base = ' ' + formatError(value);\n  }\n\n  if (keys.length === 0 && (!array || value.length == 0)) {\n    return braces[0] + base + braces[1];\n  }\n\n  if (recurseTimes < 0) {\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    } else {\n      return ctx.stylize('[Object]', 'special');\n    }\n  }\n\n  ctx.seen.push(value);\n\n  var output;\n  if (array) {\n    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);\n  } else {\n    output = keys.map(function(key) {\n      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);\n    });\n  }\n\n  ctx.seen.pop();\n\n  return reduceToSingleString(output, base, braces);\n}\n\n\nfunction formatPrimitive(ctx, value) {\n  if (isUndefined(value))\n    return ctx.stylize('undefined', 'undefined');\n  if (isString(value)) {\n    var simple = '\\'' + JSON.stringify(value).replace(/^\"|\"$/g, '')\n                                             .replace(/'/g, \"\\\\'\")\n                                             .replace(/\\\\\"/g, '\"') + '\\'';\n    return ctx.stylize(simple, 'string');\n  }\n  if (isNumber(value))\n    return ctx.stylize('' + value, 'number');\n  if (isBoolean(value))\n    return ctx.stylize('' + value, 'boolean');\n  // For some reason typeof null is \"object\", so special case here.\n  if (isNull(value))\n    return ctx.stylize('null', 'null');\n}\n\n\nfunction formatError(value) {\n  return '[' + Error.prototype.toString.call(value) + ']';\n}\n\n\nfunction formatArray(ctx, value, recurseTimes, visibleKeys, keys) {\n  var output = [];\n  for (var i = 0, l = value.length; i < l; ++i) {\n    if (hasOwnProperty(value, String(i))) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          String(i), true));\n    } else {\n      output.push('');\n    }\n  }\n  keys.forEach(function(key) {\n    if (!key.match(/^\\d+$/)) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          key, true));\n    }\n  });\n  return output;\n}\n\n\nfunction formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {\n  var name, str, desc;\n  desc = Object.getOwnPropertyDescriptor(value, key) || { value: value[key] };\n  if (desc.get) {\n    if (desc.set) {\n      str = ctx.stylize('[Getter/Setter]', 'special');\n    } else {\n      str = ctx.stylize('[Getter]', 'special');\n    }\n  } else {\n    if (desc.set) {\n      str = ctx.stylize('[Setter]', 'special');\n    }\n  }\n  if (!hasOwnProperty(visibleKeys, key)) {\n    name = '[' + key + ']';\n  }\n  if (!str) {\n    if (ctx.seen.indexOf(desc.value) < 0) {\n      if (isNull(recurseTimes)) {\n        str = formatValue(ctx, desc.value, null);\n      } else {\n        str = formatValue(ctx, desc.value, recurseTimes - 1);\n      }\n      if (str.indexOf('\\n') > -1) {\n        if (array) {\n          str = str.split('\\n').map(function(line) {\n            return '  ' + line;\n          }).join('\\n').slice(2);\n        } else {\n          str = '\\n' + str.split('\\n').map(function(line) {\n            return '   ' + line;\n          }).join('\\n');\n        }\n      }\n    } else {\n      str = ctx.stylize('[Circular]', 'special');\n    }\n  }\n  if (isUndefined(name)) {\n    if (array && key.match(/^\\d+$/)) {\n      return str;\n    }\n    name = JSON.stringify('' + key);\n    if (name.match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)) {\n      name = name.slice(1, -1);\n      name = ctx.stylize(name, 'name');\n    } else {\n      name = name.replace(/'/g, \"\\\\'\")\n                 .replace(/\\\\\"/g, '\"')\n                 .replace(/(^\"|\"$)/g, \"'\");\n      name = ctx.stylize(name, 'string');\n    }\n  }\n\n  return name + ': ' + str;\n}\n\n\nfunction reduceToSingleString(output, base, braces) {\n  var numLinesEst = 0;\n  var length = output.reduce(function(prev, cur) {\n    numLinesEst++;\n    if (cur.indexOf('\\n') >= 0) numLinesEst++;\n    return prev + cur.replace(/\\u001b\\[\\d\\d?m/g, '').length + 1;\n  }, 0);\n\n  if (length > 60) {\n    return braces[0] +\n           (base === '' ? '' : base + '\\n ') +\n           ' ' +\n           output.join(',\\n  ') +\n           ' ' +\n           braces[1];\n  }\n\n  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];\n}\n\n\n// NOTE: These type checking functions intentionally don't use `instanceof`\n// because it is fragile and can be easily faked with `Object.create()`.\nexports.types = require('./support/types');\n\nfunction isArray(ar) {\n  return Array.isArray(ar);\n}\nexports.isArray = isArray;\n\nfunction isBoolean(arg) {\n  return typeof arg === 'boolean';\n}\nexports.isBoolean = isBoolean;\n\nfunction isNull(arg) {\n  return arg === null;\n}\nexports.isNull = isNull;\n\nfunction isNullOrUndefined(arg) {\n  return arg == null;\n}\nexports.isNullOrUndefined = isNullOrUndefined;\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\nexports.isNumber = isNumber;\n\nfunction isString(arg) {\n  return typeof arg === 'string';\n}\nexports.isString = isString;\n\nfunction isSymbol(arg) {\n  return typeof arg === 'symbol';\n}\nexports.isSymbol = isSymbol;\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\nexports.isUndefined = isUndefined;\n\nfunction isRegExp(re) {\n  return isObject(re) && objectToString(re) === '[object RegExp]';\n}\nexports.isRegExp = isRegExp;\nexports.types.isRegExp = isRegExp;\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\nexports.isObject = isObject;\n\nfunction isDate(d) {\n  return isObject(d) && objectToString(d) === '[object Date]';\n}\nexports.isDate = isDate;\nexports.types.isDate = isDate;\n\nfunction isError(e) {\n  return isObject(e) &&\n      (objectToString(e) === '[object Error]' || e instanceof Error);\n}\nexports.isError = isError;\nexports.types.isNativeError = isError;\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\nexports.isFunction = isFunction;\n\nfunction isPrimitive(arg) {\n  return arg === null ||\n         typeof arg === 'boolean' ||\n         typeof arg === 'number' ||\n         typeof arg === 'string' ||\n         typeof arg === 'symbol' ||  // ES6 symbol\n         typeof arg === 'undefined';\n}\nexports.isPrimitive = isPrimitive;\n\nexports.isBuffer = require('./support/isBuffer');\n\nfunction objectToString(o) {\n  return Object.prototype.toString.call(o);\n}\n\n\nfunction pad(n) {\n  return n < 10 ? '0' + n.toString(10) : n.toString(10);\n}\n\n\nvar months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',\n              'Oct', 'Nov', 'Dec'];\n\n// 26 Feb 16:19:34\nfunction timestamp() {\n  var d = new Date();\n  var time = [pad(d.getHours()),\n              pad(d.getMinutes()),\n              pad(d.getSeconds())].join(':');\n  return [d.getDate(), months[d.getMonth()], time].join(' ');\n}\n\n\n// log is just a thin wrapper to console.log that prepends a timestamp\nexports.log = function() {\n  console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));\n};\n\n\n/**\n * Inherit the prototype methods from one constructor into another.\n *\n * The Function.prototype.inherits from lang.js rewritten as a standalone\n * function (not on Function.prototype). NOTE: If this file is to be loaded\n * during bootstrapping this function needs to be rewritten using some native\n * functions as prototype setup using normal JavaScript does not work as\n * expected during bootstrapping (see mirror.js in r114903).\n *\n * @param {function} ctor Constructor function which needs to inherit the\n *     prototype.\n * @param {function} superCtor Constructor function to inherit prototype from.\n */\nexports.inherits = require('inherits');\n\nexports._extend = function(origin, add) {\n  // Don't do anything if add isn't an object\n  if (!add || !isObject(add)) return origin;\n\n  var keys = Object.keys(add);\n  var i = keys.length;\n  while (i--) {\n    origin[keys[i]] = add[keys[i]];\n  }\n  return origin;\n};\n\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nvar kCustomPromisifiedSymbol = typeof Symbol !== 'undefined' ? Symbol('util.promisify.custom') : undefined;\n\nexports.promisify = function promisify(original) {\n  if (typeof original !== 'function')\n    throw new TypeError('The \"original\" argument must be of type Function');\n\n  if (kCustomPromisifiedSymbol && original[kCustomPromisifiedSymbol]) {\n    var fn = original[kCustomPromisifiedSymbol];\n    if (typeof fn !== 'function') {\n      throw new TypeError('The \"util.promisify.custom\" argument must be of type Function');\n    }\n    Object.defineProperty(fn, kCustomPromisifiedSymbol, {\n      value: fn, enumerable: false, writable: false, configurable: true\n    });\n    return fn;\n  }\n\n  function fn() {\n    var promiseResolve, promiseReject;\n    var promise = new Promise(function (resolve, reject) {\n      promiseResolve = resolve;\n      promiseReject = reject;\n    });\n\n    var args = [];\n    for (var i = 0; i < arguments.length; i++) {\n      args.push(arguments[i]);\n    }\n    args.push(function (err, value) {\n      if (err) {\n        promiseReject(err);\n      } else {\n        promiseResolve(value);\n      }\n    });\n\n    try {\n      original.apply(this, args);\n    } catch (err) {\n      promiseReject(err);\n    }\n\n    return promise;\n  }\n\n  Object.setPrototypeOf(fn, Object.getPrototypeOf(original));\n\n  if (kCustomPromisifiedSymbol) Object.defineProperty(fn, kCustomPromisifiedSymbol, {\n    value: fn, enumerable: false, writable: false, configurable: true\n  });\n  return Object.defineProperties(\n    fn,\n    getOwnPropertyDescriptors(original)\n  );\n}\n\nexports.promisify.custom = kCustomPromisifiedSymbol\n\nfunction callbackifyOnRejected(reason, cb) {\n  // `!reason` guard inspired by bluebird (Ref: https://goo.gl/t5IS6M).\n  // Because `null` is a special error value in callbacks which means \"no error\n  // occurred\", we error-wrap so the callback consumer can distinguish between\n  // \"the promise rejected with null\" or \"the promise fulfilled with undefined\".\n  if (!reason) {\n    var newReason = new Error('Promise was rejected with a falsy value');\n    newReason.reason = reason;\n    reason = newReason;\n  }\n  return cb(reason);\n}\n\nfunction callbackify(original) {\n  if (typeof original !== 'function') {\n    throw new TypeError('The \"original\" argument must be of type Function');\n  }\n\n  // We DO NOT return the promise as it gives the user a false sense that\n  // the promise is actually somehow related to the callback's execution\n  // and that the callback throwing will reject the promise.\n  function callbackified() {\n    var args = [];\n    for (var i = 0; i < arguments.length; i++) {\n      args.push(arguments[i]);\n    }\n\n    var maybeCb = args.pop();\n    if (typeof maybeCb !== 'function') {\n      throw new TypeError('The last argument must be of type Function');\n    }\n    var self = this;\n    var cb = function() {\n      return maybeCb.apply(self, arguments);\n    };\n    // In true node style we process the callback on `nextTick` with all the\n    // implications (stack, `uncaughtException`, `async_hooks`)\n    original.apply(this, args)\n      .then(function(ret) { process.nextTick(cb.bind(null, null, ret)) },\n            function(rej) { process.nextTick(callbackifyOnRejected.bind(null, rej, cb)) });\n  }\n\n  Object.setPrototypeOf(callbackified, Object.getPrototypeOf(original));\n  Object.defineProperties(callbackified,\n                          getOwnPropertyDescriptors(original));\n  return callbackified;\n}\nexports.callbackify = callbackify;\n","'use strict';\n\nvar forEach = require('for-each');\nvar availableTypedArrays = require('available-typed-arrays');\nvar callBind = require('call-bind');\nvar callBound = require('call-bind/callBound');\nvar gOPD = require('gopd');\n\n/** @type {(O: object) => string} */\nvar $toString = callBound('Object.prototype.toString');\nvar hasToStringTag = require('has-tostringtag/shams')();\n\nvar g = typeof globalThis === 'undefined' ? global : globalThis;\nvar typedArrays = availableTypedArrays();\n\nvar $slice = callBound('String.prototype.slice');\nvar getPrototypeOf = Object.getPrototypeOf; // require('getprototypeof');\n\n/** @type {<T = unknown>(array: readonly T[], value: unknown) => number} */\nvar $indexOf = callBound('Array.prototype.indexOf', true) || function indexOf(array, value) {\n\tfor (var i = 0; i < array.length; i += 1) {\n\t\tif (array[i] === value) {\n\t\t\treturn i;\n\t\t}\n\t}\n\treturn -1;\n};\n\n/** @typedef {(receiver: import('.').TypedArray) => string | typeof Uint8Array.prototype.slice.call | typeof Uint8Array.prototype.set.call} Getter */\n/** @type {{ [k in `\\$${import('.').TypedArrayName}`]?: Getter } & { __proto__: null }} */\nvar cache = { __proto__: null };\nif (hasToStringTag && gOPD && getPrototypeOf) {\n\tforEach(typedArrays, function (typedArray) {\n\t\tvar arr = new g[typedArray]();\n\t\tif (Symbol.toStringTag in arr) {\n\t\t\tvar proto = getPrototypeOf(arr);\n\t\t\t// @ts-expect-error TS won't narrow inside a closure\n\t\t\tvar descriptor = gOPD(proto, Symbol.toStringTag);\n\t\t\tif (!descriptor) {\n\t\t\t\tvar superProto = getPrototypeOf(proto);\n\t\t\t\t// @ts-expect-error TS won't narrow inside a closure\n\t\t\t\tdescriptor = gOPD(superProto, Symbol.toStringTag);\n\t\t\t}\n\t\t\t// @ts-expect-error TODO: fix\n\t\t\tcache['$' + typedArray] = callBind(descriptor.get);\n\t\t}\n\t});\n} else {\n\tforEach(typedArrays, function (typedArray) {\n\t\tvar arr = new g[typedArray]();\n\t\tvar fn = arr.slice || arr.set;\n\t\tif (fn) {\n\t\t\t// @ts-expect-error TODO: fix\n\t\t\tcache['$' + typedArray] = callBind(fn);\n\t\t}\n\t});\n}\n\n/** @type {(value: object) => false | import('.').TypedArrayName} */\nvar tryTypedArrays = function tryAllTypedArrays(value) {\n\t/** @type {ReturnType<typeof tryAllTypedArrays>} */ var found = false;\n\tforEach(\n\t\t// eslint-disable-next-line no-extra-parens\n\t\t/** @type {Record<`\\$${TypedArrayName}`, Getter>} */ /** @type {any} */ (cache),\n\t\t/** @type {(getter: Getter, name: `\\$${import('.').TypedArrayName}`) => void} */\n\t\tfunction (getter, typedArray) {\n\t\t\tif (!found) {\n\t\t\t\ttry {\n\t\t\t\t// @ts-expect-error TODO: fix\n\t\t\t\t\tif ('$' + getter(value) === typedArray) {\n\t\t\t\t\t\tfound = $slice(typedArray, 1);\n\t\t\t\t\t}\n\t\t\t\t} catch (e) { /**/ }\n\t\t\t}\n\t\t}\n\t);\n\treturn found;\n};\n\n/** @type {(value: object) => false | import('.').TypedArrayName} */\nvar trySlices = function tryAllSlices(value) {\n\t/** @type {ReturnType<typeof tryAllSlices>} */ var found = false;\n\tforEach(\n\t\t// eslint-disable-next-line no-extra-parens\n\t\t/** @type {Record<`\\$${TypedArrayName}`, Getter>} */ /** @type {any} */ (cache),\n\t\t/** @type {(getter: typeof cache, name: `\\$${import('.').TypedArrayName}`) => void} */ function (getter, name) {\n\t\t\tif (!found) {\n\t\t\t\ttry {\n\t\t\t\t\t// @ts-expect-error TODO: fix\n\t\t\t\t\tgetter(value);\n\t\t\t\t\tfound = $slice(name, 1);\n\t\t\t\t} catch (e) { /**/ }\n\t\t\t}\n\t\t}\n\t);\n\treturn found;\n};\n\n/** @type {import('.')} */\nmodule.exports = function whichTypedArray(value) {\n\tif (!value || typeof value !== 'object') { return false; }\n\tif (!hasToStringTag) {\n\t\t/** @type {string} */\n\t\tvar tag = $slice($toString(value), 8, -1);\n\t\tif ($indexOf(typedArrays, tag) > -1) {\n\t\t\treturn tag;\n\t\t}\n\t\tif (tag !== 'Object') {\n\t\t\treturn false;\n\t\t}\n\t\t// node < 0.6 hits here on real Typed Arrays\n\t\treturn trySlices(value);\n\t}\n\tif (!gOPD) { return null; } // unknown engine\n\treturn tryTypedArrays(value);\n};\n","const os = require('os');\nconst fs = require('fs');\nconst path = require('path');\n\nconst rbql = require('./rbql_core/rbql-js/rbql.js');\nconst rbql_csv = require('./rbql_core/rbql-js/rbql_csv.js');\nconst csv_utils = require('./rbql_core/rbql-js/csv_utils.js');\n\nconst fast_load_utils = require('./fast_load_utils.js');\n\nconst wcwidth = require('./contrib/wcwidth/index.js');\n\nconst non_numeric_sentinel = -1;\nconst number_regex = /^([0-9]+)(\\.[0-9]+)?$/;\n\n// Copypasted from extension.js\nconst QUOTED_RFC_POLICY = 'quoted_rfc';\nconst QUOTED_POLICY = 'quoted';\nconst dynamic_csv_highlight_margin = 50; // TODO make configurable.\nconst max_preview_field_length = 250;\nconst alignment_extra_readability_whitespace_length = 1;\n\n\nclass AssertionError extends Error {}\n\nfunction assert(condition, message=null) {\n    if (!condition) {\n        if (!message) {\n            message = 'Assertion error';\n        }\n        throw new AssertionError(message);\n    }\n}\n\n\nfunction get_default_js_udf_content() {\n    let default_content = `// This file can be used to store RBQL UDFs. Example:\n    //\n    // function foo(value) {\n    //     return 'foo ' + String(value.length);\n    // }\n    // \n    // Functions defined in this file can be used in RBQL queries e.g.\n    // SELECT foo(a1), a2 WHERE foo(a3) != 'foo 5' LIMIT 10\n    //\n    // Don't forget to save this file after editing!\n    //\n    // Write your own functions below this line:\n    `.replace(new RegExp(/^  */, 'mg'), '');\n    return default_content;\n}\n\n\nfunction get_default_python_udf_content() {\n    let default_content = `# This file can be used to store RBQL UDFs. Example:\n    #\n    # def foo(value):\n    #     return 'foo ' + str(len(value))\n    # \n    # \n    # Functions defined in this file can be used in RBQL queries e.g.\n    # SELECT foo(a1), a2 WHERE foo(a3) != 'foo 5' LIMIT 10\n    #\n    # Don't forget to save this file after editing!\n    #\n    # Write your own functions below this line:\n    `.replace(new RegExp(/^  */, 'mg'), '');\n    return default_content;\n}\n\n\nfunction update_subcomponent_stats(field, is_first_record, max_field_components_lens, calc_visual_char_width) {\n    // Extract overall field length and length of integer and fractional parts of the field if it represents a number.\n    let visual_field_length = calc_visual_char_width ? wcwidth(field) : field.length;\n    max_field_components_lens.has_wide_chars = max_field_components_lens.has_wide_chars || visual_field_length != field.length;\n    max_field_components_lens.max_total_length = Math.max(max_field_components_lens.max_total_length, visual_field_length);\n    if (max_field_components_lens.max_int_length == non_numeric_sentinel) {\n        // Column is not a number, early return.\n        return;\n    }\n    let match_result = number_regex.exec(field);\n    if (match_result === null) {\n        if (!is_first_record && field.length) { // Checking field_length here allows numeric columns to have some of the fields empty.\n            // We only mark the column as non-header if we know that this is not a header line.\n            max_field_components_lens.max_int_length = non_numeric_sentinel;\n            max_field_components_lens.max_fractional_length = non_numeric_sentinel;\n        }\n        return;\n    }\n    let cur_integer_part_length = match_result[1].length;\n    max_field_components_lens.max_int_length = Math.max(max_field_components_lens.max_int_length, cur_integer_part_length);\n    let cur_fractional_part_length = match_result[2] === undefined ? 0 : match_result[2].length;\n    max_field_components_lens.max_fractional_length = Math.max(max_field_components_lens.max_fractional_length, cur_fractional_part_length);\n}\n\n\nfunction get_cursor_position_if_unambiguous(active_editor) {\n    let selections = active_editor.selections;\n    if (!selections || selections.length != 1) {\n        // Support only single-cursor, multicursor is ambiguous.\n        return null;\n    }\n    let selection = selections[0];\n    let position = selection.active;\n    if (!position.isEqual(selection.anchor)) {\n        // Selections are ambiguous.\n        return null;\n    }\n    return position;\n}\n\n\nfunction is_ascii(src_str) {\n    return /^[\\x00-\\x7F]*$/.test(src_str);\n}\n\n\nfunction calc_column_stats(active_doc, delim, policy, comment_prefix, enable_double_width_alignment) {\n    let [records, _num_records_parsed, _fields_info, first_defective_line, _first_trailing_space_line, comments] = fast_load_utils.parse_document_records(active_doc, delim, policy, comment_prefix, /*stop_on_warning=*/true, /*max_records_to_parse=*/-1, /*collect_records=*/true, /*preserve_quotes_and_whitespaces=*/true);\n    if (first_defective_line !== null) {\n        return [null, first_defective_line + 1, null, null];\n    }\n    let column_stats = [];\n    let is_first_record = true;\n    let calc_visual_char_width = false;\n    for (let record of records) {\n        for (let fnum = 0; fnum < record.length; fnum++) {\n            if (column_stats.length <= fnum) {\n                column_stats.push({max_total_length: 0, max_int_length: 0, max_fractional_length: 0, has_wide_chars: false});\n            }\n            let field = record[fnum];\n            if (!calc_visual_char_width && enable_double_width_alignment) {\n                calc_visual_char_width = !is_ascii(field);\n            }\n            let field_lines = field.split('\\n');\n            if (field_lines.length > 1) {\n                // We don't allow multiline fields to be numeric for simplicity.\n                column_stats[fnum].max_int_length = non_numeric_sentinel;\n                column_stats[fnum].max_fractional_length = non_numeric_sentinel;\n            }\n            for (let field_line of field_lines) {\n                update_subcomponent_stats(field_line.trim(), is_first_record, column_stats[fnum], calc_visual_char_width);\n            }\n        }\n        is_first_record = false;\n    }\n    return [column_stats, null, records, comments];\n}\n\n\nfunction adjust_column_stats(column_stats, delim_length) {\n    // Ensure that numeric components max widths are consistent with non-numeric (header) width.\n    let adjusted_stats = [];\n    for (let column_stat of column_stats) {\n        if (column_stat.max_int_length <= 0) {\n            column_stat.max_int_length = -1;\n            column_stat.max_fractional_length = -1;\n        }\n        if (column_stat.max_int_length > 0) {\n            // The sum of integer and float parts can be bigger than the max width, e.g. here:\n            // value\n            // 0.12\n            // 1234\n            if (column_stat.max_int_length + column_stat.max_fractional_length > column_stat.max_total_length) {\n                column_stat.max_total_length = column_stat.max_int_length + column_stat.max_fractional_length;\n            }\n            // This is needed when the header is wider than numeric components and/or their sum.\n            if (column_stat.max_total_length - column_stat.max_fractional_length > column_stat.max_int_length) {\n                column_stat.max_int_length = column_stat.max_total_length - column_stat.max_fractional_length;\n            }\n            // Sanity check.\n            if (column_stat.max_total_length != column_stat.max_int_length + column_stat.max_fractional_length) {\n                // Assertion Error, this can never happen.\n                return null;\n            }\n        }\n        let previous_stat = adjusted_stats.length ? adjusted_stats[adjusted_stats.length - 1] : null;\n        column_stat.start_offset = previous_stat === null ? 0 : previous_stat.start_offset + previous_stat.max_total_length + alignment_extra_readability_whitespace_length + delim_length;\n        adjusted_stats.push(column_stat);\n    }\n    return adjusted_stats;\n}\n\n\nfunction align_field(field, is_first_record, max_field_components_lens, is_last_in_line) {\n    // Align field, use Math.max() to avoid negative delta_length which can happen theorethically due to async doc edit.\n    field = field.trim();\n    let visual_field_length = max_field_components_lens.has_wide_chars ? wcwidth(field) : field.length;\n    if (max_field_components_lens.max_int_length == non_numeric_sentinel) {\n        let delta_length = Math.max(max_field_components_lens.max_total_length - visual_field_length, 0);\n        return is_last_in_line ? field : field + ' '.repeat(delta_length + alignment_extra_readability_whitespace_length);\n    }\n    if (is_first_record) {\n        if (number_regex.exec(field) === null) {\n            // The line must be a header - align it using max_width rule.\n            let delta_length = Math.max(max_field_components_lens.max_total_length - visual_field_length, 0);\n            return is_last_in_line ? field : field + ' '.repeat(delta_length + alignment_extra_readability_whitespace_length);\n        }\n    }\n    let dot_pos = field.indexOf('.');\n    let cur_integer_part_length = dot_pos == -1 ? field.length : dot_pos;\n    // Here cur_fractional_part_length includes the leading dot too.\n    let cur_fractional_part_length = dot_pos == -1 ? 0 : field.length - dot_pos;\n    let integer_delta_length = Math.max(max_field_components_lens.max_int_length - cur_integer_part_length, 0);\n    let fractional_delta_length = Math.max(max_field_components_lens.max_fractional_length - cur_fractional_part_length);\n    let trailing_spaces = is_last_in_line ? '' : ' '.repeat(fractional_delta_length + alignment_extra_readability_whitespace_length);\n    return ' '.repeat(integer_delta_length) + field + trailing_spaces;\n}\n\n\nfunction rfc_align_field(field, is_first_record, max_field_components_lens, is_field_segment, is_last_in_line) {\n    let aligned = align_field(field, is_first_record, max_field_components_lens, is_last_in_line);\n    if (is_field_segment) {\n        aligned = ' '.repeat(max_field_components_lens.start_offset) + aligned;\n    }\n    return aligned;\n}\n\n\nclass RecordCommentMerger {\n    constructor(records, comments) {\n        this.records = records;\n        this.comments = comments;\n        this.nr = 0;\n        this.next_comment = 0;\n    }\n\n    get_next() {\n        // Returns tuple (record, comment).\n        if (this.has_comments_left() && (!this.has_records_left() || this.comments[this.next_comment].record_num <= this.nr)) {\n            let result = [null, this.comments[this.next_comment].comment_text];\n            this.next_comment += 1;\n            return result;\n        }\n        if (this.has_records_left()) {\n            let result = [this.records[this.nr], null];\n            this.nr += 1;\n            return result;\n        }\n        return [null, null];\n    }\n\n    has_comments_left() {\n        return this.next_comment < this.comments.length;\n    }\n\n    has_records_left() {\n        return this.nr < this.records.length;\n    }\n\n    has_entries_left() {\n        return this.has_comments_left() || this.has_records_left();\n    }\n}\n\n\nfunction align_columns(records, comments, column_stats, delim) {\n    // Unlike shrink_columns, here we don't compute `has_edit` flag because it is\n    // 1: Algorithmically complicated (especially for multiline fields) and we also can't just compare fields lengths like in shrink.\n    // 2: The alignment procedure is opinionated and \"Already aligned\" report has little value.\n    // Because of this in case of executing \"Align\" command consecutively N times one would have to run undo N times too.\n    let result_lines = [];\n    let is_first_record = true;\n    let merger = new RecordCommentMerger(records, comments);\n    while (merger.has_entries_left()) {\n        let [record, comment] = merger.get_next();\n        assert((comment === null) != (record === null));\n        if (record === null) {\n            result_lines.push(comment);\n            continue;\n        }\n        let aligned_fields = [];\n        for (let fnum = 0; fnum < record.length; fnum++) {\n            if (fnum >= column_stats.length) // Safeguard against async doc edit, should never happen.\n                break;\n            let is_field_segment = false;\n            let field = record[fnum];\n            let field_lines = field.split('\\n');\n            for (let i = 0; i < field_lines.length; i++) {\n                if (i > 0) {\n                    result_lines.push(aligned_fields.join(delim));\n                    aligned_fields = [];\n                    is_field_segment = true;\n                }\n                let is_last_in_line = fnum + 1 == record.length || (field_lines.length > 1 && i + 1 < field_lines.length);\n                let aligned_field = rfc_align_field(field_lines[i], is_first_record, column_stats[fnum], is_field_segment, is_last_in_line);\n                is_field_segment = false;\n                aligned_fields.push(aligned_field);\n            }\n        }\n        is_first_record = false;\n        result_lines.push(aligned_fields.join(delim));\n    }\n    return result_lines.join('\\n');\n}\n\n\nfunction shrink_columns(active_doc, delim, policy, comment_prefix) {\n    let [records, _num_records_parsed, _fields_info, first_defective_line, _first_trailing_space_line, comments] = fast_load_utils.parse_document_records(active_doc, delim, policy, comment_prefix, /*stop_on_warning=*/true, /*max_records_to_parse=*/-1, /*collect_records=*/true, /*preserve_quotes_and_whitespaces=*/true);\n    if (first_defective_line !== null) {\n        return [null, first_defective_line + 1];\n    }\n    let result_lines = [];\n    let has_edit = false;\n    let merger = new RecordCommentMerger(records, comments);\n    while (merger.has_entries_left()) {\n        let [record, comment] = merger.get_next();\n        assert((comment === null) != (record === null));\n        if (record === null) {\n            result_lines.push(comment);\n            continue;\n        }\n        let aligned_fields = [];\n        for (let fnum = 0; fnum < record.length; fnum++) {\n            let field = record[fnum];\n            let field_lines = field.split('\\n');\n            for (let i = 0; i < field_lines.length; i++) {\n                if (i > 0) {\n                    result_lines.push(aligned_fields.join(delim));\n                    aligned_fields = [];\n                }\n                let aligned_field = field_lines[i].trim();\n                if (aligned_field.length != field_lines[i].length) {\n                    // Unlike in align function here we can just compare resulting length to decide if change has occured.\n                    has_edit = true;\n                }\n                aligned_fields.push(aligned_field);\n            }\n        }\n        result_lines.push(aligned_fields.join(delim));\n    }\n    if (!has_edit)\n        return [null, null];\n    return [result_lines.join('\\n'), null];\n}\n\n\nfunction make_table_name_key(file_path) {\n    return 'rbql_table_name:' + file_path;\n}\n\n\nfunction expanduser(filepath) {\n    if (filepath.charAt(0) === '~') {\n        return path.join(os.homedir(), filepath.slice(1));\n    }\n    return filepath;\n}\n\n\nfunction find_table_path(vscode_global_state, main_table_dir, table_id) {\n    // If table_id is a relative path it could be relative either to the current directory or to the main table dir.\n    var candidate_path = expanduser(table_id);\n    if (fs.existsSync(candidate_path)) {\n        return candidate_path;\n    }\n    if (main_table_dir && !path.isAbsolute(candidate_path)) {\n        candidate_path = path.join(main_table_dir, candidate_path);\n        if (fs.existsSync(candidate_path)) {\n            return candidate_path;\n        }\n    }\n    let table_path = vscode_global_state ? vscode_global_state.get(make_table_name_key(table_id)) : null;\n    if (table_path && fs.existsSync(table_path)) {\n        return table_path;\n    }\n    return null;\n}\n\n\nasync function read_header(table_path, encoding) {\n    if (encoding == 'latin-1')\n        encoding = 'binary';\n    let readline = require('readline');\n    let input_reader = readline.createInterface({ input: fs.createReadStream(table_path, {encoding: encoding}) });\n    let closed = false;\n    let promise_resolve = null;\n    let promise_reject = null;\n    let output_promise = new Promise(function(resolve, reject) {\n        promise_resolve = resolve;\n        promise_reject = reject;\n    });\n    input_reader.on('line', line => {\n        if (!closed) {\n            closed = true;\n            input_reader.close();\n            promise_resolve(line);\n        }\n    });\n    input_reader.on('error', error => {\n        promise_reject(error);\n    });\n    return output_promise;\n}\n\n\nfunction get_header_line(document, comment_prefix) {\n    const num_lines = document.lineCount;\n    for (let lnum = 0; lnum < num_lines; ++lnum) {\n        const line_text = document.lineAt(lnum).text;\n        if (!comment_prefix || !line_text.startsWith(comment_prefix)) {\n            return [lnum, line_text];\n        }\n    }\n    return [null, null];\n}\n\n\nfunction make_inconsistent_num_fields_warning(table_name, inconsistent_records_info) {\n    let [record_num_1, num_fields_1, record_num_2, num_fields_2] = rbql.sample_first_two_inconsistent_records(inconsistent_records_info);\n    let warn_msg = `Number of fields in \"${table_name}\" table is not consistent: `;\n    warn_msg += `e.g. record ${record_num_1 + 1} -> ${num_fields_1} fields, record ${record_num_2 + 1} -> ${num_fields_2} fields`;\n    return warn_msg;\n}\n\n\nclass RbqlIOHandlingError extends Error {}\n\nclass VSCodeRecordIterator extends rbql.RBQLInputIterator {\n    constructor(document, delim, policy, has_header=false, comment_prefix=null, table_name='input', variable_prefix='a') {\n        // We could have done a hack here actually: convert the document to stream/buffer and then use the standard reader.\n        super();\n        this.has_header = has_header;\n        this.table_name = table_name;\n        this.variable_prefix = variable_prefix;\n        this.NR = 0; // Record number.\n        this.NL = 0; // Line number (NL != NR when the CSV file has comments or multiline fields).\n        let fail_on_warning = policy == 'quoted_rfc';\n        let [_num_records_parsed, _comments] = [null, null];\n        [this.records, _num_records_parsed, this.fields_info, this.first_defective_line, this._first_trailing_space_line, _comments] = fast_load_utils.parse_document_records(document, delim, policy, comment_prefix, fail_on_warning);\n        if (fail_on_warning && this.first_defective_line !== null) {\n            throw new RbqlIOHandlingError(`Inconsistent double quote escaping in ${this.table_name} table at record ${this.records.length}, line ${this.first_defective_line}`);\n        }\n        this.first_record = this.records.length ? this.records[0] : [];\n        this.next_record_index = 0;\n    }\n\n    stop() {\n    }\n\n    async get_variables_map(query_text) {\n        let variable_map = new Object();\n        rbql.parse_basic_variables(query_text, this.variable_prefix, variable_map);\n        rbql.parse_array_variables(query_text, this.variable_prefix, variable_map);\n        if (this.has_header) {\n            rbql.parse_attribute_variables(query_text, this.variable_prefix, this.first_record, 'CSV header line', variable_map);\n            rbql.parse_dictionary_variables(query_text, this.variable_prefix, this.first_record, variable_map);\n        }\n        return variable_map;\n    }\n\n    async get_header() {\n        return this.has_header ? this.first_record : null;\n    }\n\n    do_get_record() {\n        if (this.next_record_index >= this.records.length) {\n            return null;\n        }\n        let record = this.records[this.next_record_index];\n        this.next_record_index += 1;\n        return record;\n    }\n\n    async get_record() {\n        if (this.NR == 0 && this.has_header) {\n            this.do_get_record(); // Skip the header record.\n        }\n        this.NR += 1;\n        let record = this.do_get_record();\n        return record;\n    }\n\n    get_warnings() {\n        let result = [];\n        if (this.first_defective_line !== null)\n            result.push(`Inconsistent double quote escaping in ${this.table_name} table. E.g. at line ${this.first_defective_line}`);\n        if (this.fields_info.size > 1)\n            result.push(make_inconsistent_num_fields_warning(this.table_name, this.fields_info));\n        return result;\n    }\n}\n\n\nclass VSCodeWriter extends rbql.RBQLOutputWriter {\n    constructor(delim, policy) {\n        super();\n        this.delim = delim;\n        this.policy = policy;\n        this.header_len = null;\n        this.null_in_output = false;\n        this.delim_in_simple_output = false;\n        this.output_lines = [];\n\n        if (policy == 'simple') {\n            this.polymorphic_join = this.simple_join;\n        } else if (policy == 'quoted') {\n            this.polymorphic_join = this.quoted_join;\n        } else if (policy == 'quoted_rfc') {\n            this.polymorphic_join = this.quoted_join_rfc;\n        } else if (policy == 'monocolumn') {\n            this.polymorphic_join = this.mono_join;\n        } else if (policy == 'whitespace') {\n            this.polymorphic_join = this.simple_join;\n        } else {\n            throw new RbqlIOHandlingError('Unknown output csv policy');\n        }\n    }\n\n    set_header(header) {\n        if (header !== null) {\n            this.header_len = header.length;\n            this.write(header);\n        }\n    }\n\n    quoted_join(fields) {\n        let delim = this.delim;\n        var quoted_fields = fields.map(function(v) { return csv_utils.quote_field(String(v), delim); });\n        return quoted_fields.join(this.delim);\n    };\n\n\n    quoted_join_rfc(fields) {\n        let delim = this.delim;\n        var quoted_fields = fields.map(function(v) { return csv_utils.rfc_quote_field(String(v), delim); });\n        return quoted_fields.join(this.delim);\n    };\n\n\n    mono_join(fields) {\n        if (fields.length > 1) {\n            throw new RbqlIOHandlingError('Unable to use \"Monocolumn\" output format: some records have more than one field');\n        }\n        return fields[0];\n    };\n\n\n    simple_join(fields) {\n        var res = fields.join(this.delim);\n        if (fields.join('').indexOf(this.delim) != -1) {\n            this.delim_in_simple_output = true;\n        }\n        return res;\n    };\n\n\n    normalize_fields(out_fields) {\n        for (var i = 0; i < out_fields.length; i++) {\n            if (out_fields[i] == null) {\n                this.null_in_output = true;\n                out_fields[i] = '';\n            } else if (Array.isArray(out_fields[i])) {\n                this.normalize_fields(out_fields[i]);\n                out_fields[i] = out_fields[i].join(this.sub_array_delim);\n            }\n        }\n    };\n\n\n    write(fields) {\n        if (this.header_len !== null && fields.length != this.header_len)\n            throw new RbqlIOHandlingError(`Inconsistent number of columns in output header and the current record: ${this.header_len} != ${fields.length}`);\n        this.normalize_fields(fields);\n        this.output_lines.push(this.polymorphic_join(fields));\n        return true;\n    };\n\n    async finish() {\n    }\n\n    get_warnings() {\n        let result = [];\n        if (this.null_in_output)\n            result.push('null values in output were replaced by empty strings');\n        if (this.delim_in_simple_output)\n            result.push('Some output fields contain separator');\n        return result;\n    };\n}\n\nclass VSCodeTableRegistry {\n    constructor(){}\n\n    get_iterator_by_table_id(_table_id) {\n        throw new RbqlIOHandlingError(\"JOIN queries are currently not supported in vscode.dev web version.\");\n    }\n\n    get_warnings() {\n        return [];\n    };\n}\n\nasync function rbql_query_web(query_text, input_document, input_delim, input_policy, output_delim, output_policy, output_warnings, with_headers, comment_prefix=null) {\n    let user_init_code = ''; // TODO find a way to have init code.\n    let join_tables_registry = new VSCodeTableRegistry(); // TODO find a way to have join registry.\n    let input_iterator = new VSCodeRecordIterator(input_document, input_delim, input_policy, with_headers, comment_prefix);\n    let output_writer = new VSCodeWriter(output_delim, output_policy);\n    await rbql.query(query_text, input_iterator, output_writer, output_warnings, join_tables_registry, user_init_code);\n    return output_writer.output_lines;\n}\n\n\nclass VSCodeFileSystemCSVRegistry extends rbql.RBQLTableRegistry {\n    constructor(vscode_global_state, input_file_dir, delim, policy, encoding, has_header=false, comment_prefix=null, options=null) {\n        super();\n        this.vscode_global_state = vscode_global_state;\n        this.input_file_dir = input_file_dir;\n        this.delim = delim;\n        this.policy = policy;\n        this.encoding = encoding;\n        this.has_header = has_header;\n        this.comment_prefix = comment_prefix;\n        this.stream = null;\n        this.record_iterator = null;\n\n        this.options = options;\n        this.bulk_input_path = null;\n        this.table_path = null;\n    }\n\n    get_iterator_by_table_id(table_id) {\n        this.table_path = find_table_path(this.vscode_global_state, this.input_file_dir, table_id);\n        if (this.table_path === null) {\n            throw new RbqlIOHandlingError(`Unable to find join table \"${table_id}\"`);\n        }\n        if (this.options && this.options['bulk_read']) {\n            this.bulk_input_path = this.table_path;\n        } else {\n            this.stream = fs.createReadStream(this.table_path);\n        }\n        this.record_iterator = new rbql_csv.CSVRecordIterator(this.stream, this.bulk_input_path, this.encoding, this.delim, this.policy, this.has_header, this.comment_prefix, table_id, 'b');\n        return this.record_iterator;\n    };\n\n    get_warnings(output_warnings) {\n        if (this.record_iterator && this.has_header) {\n            output_warnings.push(`The first record in JOIN file ${path.basename(this.table_path)} was also treated as header (and skipped)`);\n        }\n    }\n}\n\n\nasync function rbql_query_node(vscode_global_state, query_text, input_path, input_delim, input_policy, output_path, output_delim, output_policy, csv_encoding, output_warnings, with_headers=false, comment_prefix=null, user_init_code='', options=null) {\n    let input_stream = null;\n    let bulk_input_path = null;\n    if (options && options['bulk_read'] && input_path) {\n        bulk_input_path = input_path;\n    } else {\n        input_stream = input_path === null ? process.stdin : fs.createReadStream(input_path);\n    }\n    let [output_stream, close_output_on_finish] = output_path === null ? [process.stdout, false] : [fs.createWriteStream(output_path), true];\n    if (input_delim == '\"' && input_policy == 'quoted')\n        throw new RbqlIOHandlingError('Double quote delimiter is incompatible with \"quoted\" policy');\n    if (csv_encoding == 'latin-1')\n        csv_encoding = 'binary';\n    if (!rbql_csv.is_ascii(query_text) && csv_encoding == 'binary')\n        throw new RbqlIOHandlingError('To use non-ascii characters in query enable UTF-8 encoding instead of latin-1/binary');\n    if ((!rbql_csv.is_ascii(input_delim) || !rbql_csv.is_ascii(output_delim)) && csv_encoding == 'binary')\n        throw new RbqlIOHandlingError('To use non-ascii characters in query enable UTF-8 encoding instead of latin-1/binary');\n\n    let default_init_source_path = path.join(os.homedir(), '.rbql_init_source.js');\n    if (user_init_code == '' && fs.existsSync(default_init_source_path)) {\n        user_init_code = rbql_csv.read_user_init_code(default_init_source_path);\n    }\n    let input_file_dir = input_path ? path.dirname(input_path) : null;\n    let join_tables_registry = new VSCodeFileSystemCSVRegistry(vscode_global_state, input_file_dir, input_delim, input_policy, csv_encoding, with_headers, comment_prefix, options);\n    let input_iterator = new rbql_csv.CSVRecordIterator(input_stream, bulk_input_path, csv_encoding, input_delim, input_policy, with_headers, comment_prefix);\n    let output_writer = new rbql_csv.CSVWriter(output_stream, close_output_on_finish, csv_encoding, output_delim, output_policy);\n\n    await rbql.query(query_text, input_iterator, output_writer, output_warnings, join_tables_registry, user_init_code);\n    join_tables_registry.get_warnings(output_warnings);\n}\n\n\nfunction make_multiline_record_ranges(vscode, delim_length, newline_marker, fields, start_line, expected_end_line_for_control) {\n    // Semantic ranges in VSCode can't span multiple lines, so we use this workaround.\n    let record_ranges = [];\n    let lnum_current = start_line;\n    let pos_in_editor_line = 0;\n    let next_pos_in_editor_line = 0;\n    for (let i = 0; i < fields.length; i++) {\n        let pos_in_logical_field = 0;\n        // Group tokens belonging to the same logical field.\n        let logical_field_tokens = [];\n        while (true) {\n            let newline_marker_pos = fields[i].indexOf(newline_marker, pos_in_logical_field);\n            if (newline_marker_pos == -1)\n                break;\n            logical_field_tokens.push(new vscode.Range(lnum_current, pos_in_editor_line, lnum_current, pos_in_editor_line + newline_marker_pos - pos_in_logical_field));\n            lnum_current += 1;\n            pos_in_editor_line = 0;\n            next_pos_in_editor_line = 0;\n            pos_in_logical_field = newline_marker_pos + newline_marker.length;\n        }\n        next_pos_in_editor_line += fields[i].length - pos_in_logical_field;\n        if (i + 1 < fields.length) {\n            next_pos_in_editor_line += delim_length;\n        }\n        logical_field_tokens.push(new vscode.Range(lnum_current, pos_in_editor_line, lnum_current, next_pos_in_editor_line));\n        record_ranges.push(logical_field_tokens);\n        // From semantic tokenization perspective the end of token doesn't include the last character of vscode.Range i.e. it treats the range as [) interval, unlike the Range.contains() function which treats ranges as [] intervals.\n        pos_in_editor_line = next_pos_in_editor_line;\n    }\n    assert(lnum_current == expected_end_line_for_control);\n    return record_ranges;\n}\n\n\nfunction is_opening_rfc_line(line_text, delim) {\n    // The line is oppening if by adding a character (to avoid accidental double double quote) and single double quote at the end we can make it parsable without warning!\n    // Some lines can be simultaneously opening and closing, e.g. `\",a1,a2` or `a1,a2,\"`\n    let [_record, warning] = csv_utils.split_quoted_str(line_text + 'x\"', delim);\n    return !warning;\n}\n\n\nfunction parse_document_range_rfc(vscode, doc, delim, comment_prefix, range, custom_parsing_margin=null) {\n    if (custom_parsing_margin === null) {\n        custom_parsing_margin = dynamic_csv_highlight_margin;\n    }\n    let begin_line = Math.max(0, range.start.line - custom_parsing_margin);\n    let end_line = Math.min(doc.lineCount, range.end.line + custom_parsing_margin);\n    let table_ranges = [];\n    let line_aggregator = new csv_utils.MultilineRecordAggregator(comment_prefix);\n    // The first or the second line in range with an odd number of double quotes is a start line, after finding it we can use the standard parsing algorithm.\n    for (let lnum = begin_line; lnum < end_line; lnum++) {\n        let line_text = doc.lineAt(lnum).text;\n        if (lnum + 1 == doc.lineCount && !line_text)\n            break;\n        let inside_multiline_record_before = line_aggregator.is_inside_multiline_record();\n        let start_line = lnum - line_aggregator.get_num_lines_in_record();\n        line_aggregator.add_line(line_text);\n        let inside_multiline_record_after = line_aggregator.is_inside_multiline_record();\n        if (!inside_multiline_record_before && inside_multiline_record_after) {\n            // Must be an odd-num line, check if this is an openning line - otherwise reset ranges.\n            if (!is_opening_rfc_line(line_text, delim)) {\n                table_ranges = [];\n                line_aggregator.reset();\n            }\n        }\n        if (line_aggregator.has_comment_line) {\n            table_ranges.push({comment_range: new vscode.Range(lnum, 0, lnum, line_text.length)});\n            line_aggregator.reset();\n        } else if (line_aggregator.has_full_record) {\n            const newline_marker = '\\r\\n'; // Use '\\r\\n' here to guarantee that this sequence is not present anywhere in the lines themselves.\n            let combined_line = line_aggregator.get_full_line(newline_marker);\n            line_aggregator.reset();\n            let [fields, warning] = csv_utils.smart_split(combined_line, delim, QUOTED_POLICY, /*preserve_quotes_and_whitespaces=*/true);\n            if (!warning) {\n                table_ranges.push({record_ranges: make_multiline_record_ranges(vscode, delim.length, newline_marker, fields, start_line, lnum)});\n            }\n        }\n    }\n    return table_ranges;\n}\n\n\nfunction parse_document_range_single_line(vscode, doc, delim, policy, comment_prefix, range) {\n    let table_ranges = [];\n    let begin_line = Math.max(0, range.start.line - dynamic_csv_highlight_margin);\n    let end_line = Math.min(doc.lineCount, range.end.line + dynamic_csv_highlight_margin);\n    for (let lnum = begin_line; lnum < end_line; lnum++) {\n        let record_ranges = [];\n        let line_text = doc.lineAt(lnum).text;\n        if (lnum + 1 == doc.lineCount && !line_text)\n            break;\n        if (comment_prefix && line_text.startsWith(comment_prefix)) {\n            table_ranges.push({comment_range: new vscode.Range(lnum, 0, lnum, line_text.length)});\n            continue;\n        }\n        let split_result = csv_utils.smart_split(line_text, delim, policy, /*preserve_quotes_and_whitespaces=*/true);\n        // TODO consider handling comments and warnings\n        let fields = split_result[0];\n        let cpos = 0;\n        let next_cpos = 0;\n        for (let i = 0; i < fields.length; i++) {\n            next_cpos += fields[i].length;\n            if (i + 1 < fields.length) {\n                next_cpos += delim.length;\n            }\n            record_ranges.push([new vscode.Range(lnum, cpos, lnum, next_cpos)]);\n            // From semantic tokenization perspective the end of token doesn't include the last character of vscode.Range i.e. it treats the range as [) interval, unlike the Range.contains() function which treats ranges as [] intervals.\n            cpos = next_cpos;\n        }\n        table_ranges.push({record_ranges: record_ranges});\n    }\n    return table_ranges;\n}\n\n\nfunction parse_document_range(vscode, doc, delim, policy, comment_prefix, range) {\n    if (policy == QUOTED_RFC_POLICY) {\n        return parse_document_range_rfc(vscode, doc, delim, comment_prefix, range);\n    } else {\n        return parse_document_range_single_line(vscode, doc, delim, policy, comment_prefix, range);\n    }\n}\n\n\nfunction get_field_by_line_position(fields, delim_length, query_pos) {\n    if (!fields.length)\n        return null;\n    var col_num = 0;\n    var cpos = fields[col_num].length + delim_length;\n    while (query_pos > cpos && col_num + 1 < fields.length) {\n        col_num += 1;\n        cpos = cpos + fields[col_num].length + delim_length;\n    }\n    return col_num;\n}\n\n\nfunction get_cursor_position_info_rfc(vscode, document, delim, comment_prefix, position) {\n    const hover_parse_margin = 20;\n    let range = new vscode.Range(Math.max(position.line - hover_parse_margin, 0), 0, position.line + hover_parse_margin, 0);\n    let table_ranges = parse_document_range_rfc(vscode, document, delim, comment_prefix, range);\n    let last_found_position_info = null; // Use last found instead of first found because cursor position at the border can belong to two ranges simultaneously.\n    for (let row_info of table_ranges) {\n        if (row_info.hasOwnProperty('comment_range')) {\n            if (row_info.comment_range.contains(position)) {\n                last_found_position_info = {is_comment: true};\n            }\n        } else {\n            for (let col_num = 0; col_num < row_info.record_ranges.length; col_num++) {\n                // One logical field can map to multiple ranges if it spans multiple lines.\n                for (let record_range of row_info.record_ranges[col_num]) {\n                    if (record_range.contains(position)) {\n                        last_found_position_info = {column_number: col_num, total_columns: row_info.record_ranges.length, split_warning: false};\n                    }\n                }\n            }\n        }\n    }\n    return last_found_position_info;\n}\n\n\nfunction get_cursor_position_info_standard(document, delim, policy, comment_prefix, position) {\n    var lnum = position.line;\n    var cnum = position.character;\n    var line = document.lineAt(lnum).text;\n\n    if (comment_prefix && line.startsWith(comment_prefix))\n        return {is_comment: true};\n\n    let [entries, warning] = csv_utils.smart_split(line, delim, policy, true);\n    var col_num = get_field_by_line_position(entries, delim.length, cnum + 1);\n    if (col_num == null)\n        return null;\n    return {column_number: col_num, total_columns: entries.length, split_warning: warning};\n}\n\n\nfunction get_cursor_position_info(vscode, document, delim, policy, comment_prefix, position) {\n    if (policy === null)\n        return null;\n    if (policy == QUOTED_RFC_POLICY) {\n        return get_cursor_position_info_rfc(vscode, document, delim, comment_prefix, position);\n    } else {\n        return get_cursor_position_info_standard(document, delim, policy, comment_prefix, position);\n    }\n}\n\n\nfunction format_cursor_position_info(cursor_position_info, header, show_column_names, show_comments, max_label_length) {\n    if (cursor_position_info.is_comment) {\n        if (show_comments) {\n            return ['Comment', 'Comment'];\n        } else {\n            return [null, null];\n        }\n    }\n    let short_report = 'Col ' + (cursor_position_info.column_number + 1);\n    let full_report = '[Rainbow CSV] ' + short_report;\n    if (show_column_names && cursor_position_info.column_number < header.length) {\n        let column_label = header[cursor_position_info.column_number].trim();\n        let short_column_label = column_label.substr(0, max_label_length);\n        if (short_column_label != column_label)\n            short_column_label = short_column_label + '...';\n        short_report += ': ' + short_column_label;\n        full_report += ': ' + column_label;\n    }\n    if (cursor_position_info.split_warning) {\n        full_report += '; ERR: Inconsistent double quotes in line';\n    } else if (header.length != cursor_position_info.total_columns) {\n        full_report += `; WARN: Inconsistent num of fields, header: ${header.length}, this line: ${cursor_position_info.total_columns}`;\n    }\n    return [full_report, short_report];\n}\n\n\nfunction sample_records(document, delim, policy, comment_prefix, end_record, preview_window_size, stop_on_warning, cached_table_parse_result) {\n    let records = [];\n    let first_failed_line = null;\n    let vscode_doc_version = null;\n    let [_num_records_parsed, _fields_info, _first_trailing_space_line, _comments] = [null, null, null, null];\n    // Here `preview_window_size` is typically 100.\n    if (end_record < preview_window_size * 5) {\n        // Re-sample the records. Re-sampling top records is fast and it ensures that all manual changes are mirrored into RBQL console.\n        [records, _num_records_parsed, _fields_info, first_failed_line, _first_trailing_space_line, _comments] = fast_load_utils.parse_document_records(document, delim, policy, comment_prefix, stop_on_warning, /*max_records_to_parse=*/end_record, /*collect_records=*/true, /*preserve_quotes_and_whitespaces=*/false);\n    } else {\n        let need_full_doc_parse = true;\n        if (cached_table_parse_result.has(document.fileName)) {\n            [records, first_failed_line, vscode_doc_version] = cached_table_parse_result.get(document.fileName);\n            if (document.version === vscode_doc_version) {\n                need_full_doc_parse = false;\n            }\n        }\n        if (need_full_doc_parse) {\n            let [records, _num_records_parsed, _fields_info, first_failed_line, _first_trailing_space_line, _comments] = fast_load_utils.parse_document_records(document, delim, policy, comment_prefix, stop_on_warning, /*max_records_to_parse=*/-1, /*collect_records=*/true, /*preserve_quotes_and_whitespaces=*/false);\n            cached_table_parse_result.set(document.fileName, [records, first_failed_line, document.version]);\n        }\n        [records, first_failed_line, vscode_doc_version] = cached_table_parse_result.get(document.fileName);\n    }\n    return [records, first_failed_line];\n}\n\n\nfunction sample_preview_records_from_context(rbql_context, dst_message, preview_window_size, cached_table_parse_result) {\n    let [document, delim, policy, comment_prefix] = [rbql_context.input_document, rbql_context.delim, rbql_context.policy, rbql_context.comment_prefix];\n    rbql_context.requested_start_record = Math.max(rbql_context.requested_start_record, 0);\n    let stop_on_warning = policy == QUOTED_RFC_POLICY;\n    let [records, first_failed_line] = sample_records(document, delim, policy, comment_prefix, rbql_context.requested_start_record + preview_window_size, preview_window_size, stop_on_warning, cached_table_parse_result);;\n    if (first_failed_line !== null && policy == QUOTED_RFC_POLICY) {\n        dst_message.preview_sampling_error = `Double quotes are not consistent in record ${records.length + 1} which starts at line ${first_failed_line + 1}`;\n        return;\n    }\n    rbql_context.requested_start_record = Math.max(0, Math.min(rbql_context.requested_start_record, records.length - preview_window_size));\n    let preview_records = records.slice(rbql_context.requested_start_record, rbql_context.requested_start_record + preview_window_size);\n\n    // Here we trim excessively long fields. The only benefit of doing is here instead of UI layer is to minimize the ammount of traffic that we send to UI - the total message size is limited.\n    for (let r = 0; r < preview_records.length; r++) {\n        let cur_record = preview_records[r];\n        for (let c = 0; c < cur_record.length; c++) {\n            if (cur_record[c].length > max_preview_field_length) {\n                cur_record[c] = cur_record[c].substr(0, max_preview_field_length) + '###UI_STRING_TRIM_MARKER###';\n            }\n        }\n    }\n    dst_message.preview_records = preview_records;\n    dst_message.actual_start_record = rbql_context.requested_start_record;\n}\n\nfunction show_lint_status_bar_button(vscode, extension_context, file_path, language_id) {\n\n    const COLOR_PROCESSING = '#A0A0A0';\n    const COLOR_ERROR      = '#f44242';\n    const COLOR_WARNING    = '#ffff28';\n    const COLOR_OK         = '#62f442';\n\n    let lint_cache_key = `${file_path}.${language_id}`;\n\n    if (!extension_context.lint_results.has(lint_cache_key)){\n      return;\n    }\n\n    var lint_report = extension_context.lint_results.get(lint_cache_key);\n\n    if (!extension_context.lint_status_bar_button){\n      extension_context.lint_status_bar_button = vscode.window.createStatusBarItem(vscode.StatusBarAlignment.Left);\n    }\n\n    extension_context.lint_status_bar_button.text = 'CSVLint';\n    let lint_report_msg = '';\n    if (lint_report.is_processing) {\n\n        extension_context.lint_status_bar_button.color = COLOR_PROCESSING;\n        extension_context.lint_status_bar_button.text = '$(clock) CSVLint';\n        lint_report_msg = 'Processing';\n\n    } else if (Number.isInteger(lint_report.first_defective_line)) {\n\n        lint_report_msg = `Error. Line ${lint_report.first_defective_line} has formatting error: double quote chars are not consistent`;\n        extension_context.lint_status_bar_button.color = COLOR_ERROR;\n        extension_context.lint_status_bar_button.text = '$(error) CSVLint';\n\n    } else if (lint_report.fields_info && lint_report.fields_info.size > 1) {\n\n        let [record_num_1, num_fields_1, record_num_2, num_fields_2] = rbql.sample_first_two_inconsistent_records(lint_report.fields_info);\n        lint_report_msg = `Error. Number of fields is not consistent: e.g. record ${record_num_1 + 1} has ${num_fields_1} fields, and record ${record_num_2 + 1} has ${num_fields_2} fields`;\n        extension_context.lint_status_bar_button.color = COLOR_ERROR;\n        extension_context.lint_status_bar_button.text = '$(error) CSVLint';\n\n    } else if (Number.isInteger(lint_report.first_trailing_space_line)) {\n\n        lint_report_msg = `Leading/Trailing spaces detected: e.g. at line ${lint_report.first_trailing_space_line + 1}. Run \"Shrink\" command to remove them`;\n        extension_context.lint_status_bar_button.color = COLOR_WARNING;\n        extension_context.lint_status_bar_button.text = '$(alert) CSVLint';\n    } else {\n        assert(lint_report.is_ok);\n        extension_context.lint_status_bar_button.color = COLOR_OK;\n        extension_context.lint_status_bar_button.text = '$(pass) CSVLint';\n        lint_report_msg = 'OK';\n    }\n    extension_context.lint_status_bar_button.tooltip = lint_report_msg + '\\nClick to recheck';\n    extension_context.lint_status_bar_button.command = 'rainbow-csv.CSVLint';\n    extension_context.lint_status_bar_button.show();\n}\n\n\nfunction generate_column_edit_selections(vscode, active_doc, delim, policy, comment_prefix, edit_mode, col_num) {\n    let [records, _num_records_parsed, _fields_info, first_defective_line, _first_trailing_space_line, comments] = fast_load_utils.parse_document_records(active_doc, delim, policy, comment_prefix, /*stop_on_warning=*/true, /*max_records_to_parse=*/-1, /*collect_records=*/true, /*preserve_quotes_and_whitespaces=*/true);\n    if (first_defective_line !== null) {\n        return [null, `Unable to enter column edit mode: quoting error at line ${first_defective_line + 1}`, null];\n    }\n    if (records.length + comments.length != active_doc.lineCount) {\n        // It is possible to support editing of non-multiline columns in such files, but for simplicity we won't do this.\n        return [null, 'Column edit mode is not supported for files with multiline fields', null];\n    }\n    let lnum = 0;\n    let selections = [];\n    let warning_msg = null;\n    let merger = new RecordCommentMerger(records, comments);\n    while (merger.has_entries_left()) {\n        let [record, comment] = merger.get_next();\n        assert((comment === null) != (record === null));\n        if (record !== null) {\n            if (col_num >= record.length) {\n                return [null, `Line ${lnum + 1} doesn't have field number ${col_num + 1}`, null];\n            }\n            let char_pos_before = record.slice(0, col_num).join('').length + col_num * delim.length;\n            let char_pos_after = record.slice(0, col_num + 1).join('').length + col_num * delim.length;\n            let line_text = record.join(delim);\n            if (!warning_msg && edit_mode == 'ce_before' && (policy == QUOTED_POLICY || policy == QUOTED_RFC_POLICY) && line_text.substring(char_pos_before - 2, char_pos_before + 2).indexOf('\"') != -1) {\n                warning_msg = `Be careful, cursor at line ${lnum + 1} has a double quote is in proximity.`;\n            }\n            if (!warning_msg && edit_mode == 'ce_after' && (policy == QUOTED_POLICY || policy == QUOTED_RFC_POLICY) && line_text.substring(char_pos_after - 2, char_pos_after + 2).indexOf('\"') != -1) {\n                warning_msg = `Be careful, cursor at line ${lnum + 1} has a double quote is in proximity.`;\n            }\n            if (!warning_msg && edit_mode == 'ce_select' && char_pos_before == char_pos_after) {\n                warning_msg = `Be careful, Field ${col_num + 1} at line ${lnum + 1} is empty.`;\n            }\n            let position_before = new vscode.Position(lnum, char_pos_before);\n            let position_after = new vscode.Position(lnum, char_pos_after);\n            if (edit_mode == 'ce_before') {\n                selections.push(new vscode.Selection(position_before, position_before));\n            }\n            if (edit_mode == 'ce_after') {\n                selections.push(new vscode.Selection(position_after, position_after));\n            }\n            if (edit_mode == 'ce_select') {\n                selections.push(new vscode.Selection(position_before, position_after));\n            }\n        }\n        lnum += 1;\n    }\n    return [selections, null, warning_msg];\n}\n\n\nmodule.exports.make_table_name_key = make_table_name_key;\nmodule.exports.find_table_path = find_table_path;\nmodule.exports.read_header = read_header;\nmodule.exports.rbql_query_web = rbql_query_web;\nmodule.exports.rbql_query_node = rbql_query_node;\nmodule.exports.get_header_line = get_header_line;\nmodule.exports.get_default_js_udf_content = get_default_js_udf_content;\nmodule.exports.get_default_python_udf_content = get_default_python_udf_content;\nmodule.exports.align_columns = align_columns;\nmodule.exports.shrink_columns = shrink_columns;\nmodule.exports.calc_column_stats = calc_column_stats;\nmodule.exports.adjust_column_stats = adjust_column_stats;\nmodule.exports.update_subcomponent_stats = update_subcomponent_stats;\nmodule.exports.align_field = align_field;\nmodule.exports.rfc_align_field = rfc_align_field;\nmodule.exports.assert = assert;\nmodule.exports.get_field_by_line_position = get_field_by_line_position;\nmodule.exports.get_cursor_position_info = get_cursor_position_info;\nmodule.exports.format_cursor_position_info = format_cursor_position_info;\nmodule.exports.parse_document_range = parse_document_range;\nmodule.exports.sample_preview_records_from_context = sample_preview_records_from_context;\nmodule.exports.parse_document_range_rfc = parse_document_range_rfc; // Only for unit tests.\nmodule.exports.sample_first_two_inconsistent_records = rbql.sample_first_two_inconsistent_records;\nmodule.exports.is_opening_rfc_line = is_opening_rfc_line; // Only for unit tests.\nmodule.exports.show_lint_status_bar_button = show_lint_status_bar_button;\nmodule.exports.get_cursor_position_if_unambiguous = get_cursor_position_if_unambiguous;\nmodule.exports.RecordCommentMerger = RecordCommentMerger;\nmodule.exports.generate_column_edit_selections = generate_column_edit_selections;\n","let field_regular_expression = '\"((?:[^\"]*\"\")*[^\"]*)\"';\nlet field_rgx = new RegExp('^' + field_regular_expression);\nlet field_rgx_external_whitespaces = new RegExp('^ *' + field_regular_expression + ' *');\n\n\n// TODO consider making this file (and rbql.js) both node and browser compatible: https://caolan.org/posts/writing_for_node_and_the_browser.html\n\n\nfunction split_lines(text) {\n    return text.split(/\\r\\n|\\r|\\n/);\n}\n\n\nfunction extract_next_field(src, dlm, preserve_quotes_and_whitespaces, allow_external_whitespaces, cidx, result) {\n    var warning = false;\n    let src_cur = src.substring(cidx);\n    let rgx = allow_external_whitespaces ? field_rgx_external_whitespaces : field_rgx;\n    let match_obj = rgx.exec(src_cur);\n    if (match_obj !== null) {\n        let match_end = match_obj[0].length;\n        if (cidx + match_end == src.length || src[cidx + match_end] == dlm) {\n            if (preserve_quotes_and_whitespaces) {\n                result.push(match_obj[0]);\n            } else {\n                result.push(match_obj[1].replace(/\"\"/g, '\"'));\n            }\n            return [cidx + match_end + 1, false];\n        }\n        warning = true;\n    }\n    var uidx = src.indexOf(dlm, cidx);\n    if (uidx == -1)\n        uidx = src.length;\n    var field = src.substring(cidx, uidx);\n    warning = warning || field.indexOf('\"') != -1;\n    result.push(field);\n    return [uidx + 1, warning];\n}\n\n\nfunction split_quoted_str(src, dlm, preserve_quotes_and_whitespaces=false) {\n    // This function is newline-agnostic i.e. it can also split records with multiline fields.\n    if (src.indexOf('\"') == -1) // Optimization for most common case\n        return [src.split(dlm), false];\n    var result = [];\n    var cidx = 0;\n    var warning = false;\n    let allow_external_whitespaces = dlm != ' ';\n    while (cidx < src.length) {\n        var extraction_report = extract_next_field(src, dlm, preserve_quotes_and_whitespaces, allow_external_whitespaces, cidx, result);\n        cidx = extraction_report[0];\n        warning = warning || extraction_report[1];\n    }\n    if (src.charAt(src.length - 1) == dlm)\n        result.push('');\n    return [result, warning];\n}\n\n\nfunction quote_field(src, delim) {\n    if (src.indexOf(delim) != -1 || src.indexOf('\"') != -1) {\n        var escaped = src.replace(/\"/g, '\"\"');\n        return `\"${escaped}\"`;\n    }\n    return src;\n}\n\n\nfunction rfc_quote_field(src, delim) {\n    if (src.indexOf(delim) != -1 || src.indexOf('\"') != -1 || src.indexOf('\\n') != -1 || src.indexOf('\\r') != -1) {\n        var escaped = src.replace(/\"/g, '\"\"');\n        return `\"${escaped}\"`;\n    }\n    return src;\n}\n\n\nfunction unquote_field(field) {\n    let rgx = new RegExp('^' + ' *' + field_regular_expression + ' *$');\n    let match_obj = rgx.exec(field);\n    if (match_obj !== null) {\n        return match_obj[1].replace(/\"\"/g, '\"');\n    }\n    return field;\n}\n\n\nfunction unquote_fields(fields) {\n    return fields.map(unquote_field);\n}\n\n\nfunction split_whitespace_separated_str(src, preserve_whitespaces=false) {\n    var rgxp = preserve_whitespaces ? new RegExp(' *[^ ]+ *', 'g') : new RegExp('[^ ]+', 'g');\n    let result = [];\n    let match_obj = null;\n    while((match_obj = rgxp.exec(src)) !== null) {\n        result.push(match_obj[0]);\n    }\n    if (preserve_whitespaces) {\n        for (let i = 0; i < result.length - 1; i++) {\n            result[i] = result[i].slice(0, -1);\n        }\n    }\n    return result;\n}\n\n\nfunction smart_split(src, dlm, policy, preserve_quotes_and_whitespaces) {\n    if (policy === 'simple')\n        return [src.split(dlm), false];\n    if (policy === 'whitespace')\n        return [split_whitespace_separated_str(src, preserve_quotes_and_whitespaces), false];\n    if (policy === 'monocolumn')\n        return [[src], false];\n    return split_quoted_str(src, dlm, preserve_quotes_and_whitespaces);\n}\n\n\nclass MultilineRecordAggregator {\n    constructor(comment_prefix) {\n        this.comment_prefix = comment_prefix;\n        this.reset();\n    }\n    add_line(line_text) {\n        if (this.has_full_record || this.has_comment_line) {\n            throw new Error('Invalid usage - record aggregator must be reset before adding new lines');\n        }\n        if (this.comment_prefix && this.rfc_line_buffer.length == 0 && line_text.startsWith(this.comment_prefix)) {\n            this.has_comment_line = true;\n            return false;\n        }\n        let match_list = line_text.match(/\"/g);\n        let has_unbalanced_double_quote = match_list && match_list.length % 2 == 1;\n        this.rfc_line_buffer.push(line_text);\n        this.has_full_record = (!has_unbalanced_double_quote && this.rfc_line_buffer.length == 1) || (has_unbalanced_double_quote && this.rfc_line_buffer.length > 1);\n        return this.has_full_record;\n    }\n    is_inside_multiline_record() {\n        return this.rfc_line_buffer.length && !this.has_full_record;\n    }\n    get_full_line(line_separator) {\n        return this.rfc_line_buffer.join(line_separator);\n    }\n    get_num_lines_in_record() {\n        return this.rfc_line_buffer.length;\n    }\n    reset() {\n        this.rfc_line_buffer = [];\n        this.has_full_record = false;\n        this.has_comment_line = false;\n    }\n}\n\n\nmodule.exports.split_quoted_str = split_quoted_str;\nmodule.exports.split_whitespace_separated_str = split_whitespace_separated_str;\nmodule.exports.smart_split = smart_split;\nmodule.exports.quote_field = quote_field;\nmodule.exports.rfc_quote_field = rfc_quote_field;\nmodule.exports.unquote_field = unquote_field;\nmodule.exports.unquote_fields = unquote_fields;\nmodule.exports.split_lines = split_lines;\nmodule.exports.MultilineRecordAggregator = MultilineRecordAggregator;\n","(function(exports){\n// The magic line above is to make the module both browser and Node compatible, see https://stackoverflow.com/questions/3225251/how-can-i-share-code-between-node-js-and-the-browser\n\n// This module works with records only. It is CSV-agnostic.\n// Do not add CSV-related logic or variables/functions/objects like \"delim\", \"separator\" etc\n\n\nclass RbqlParsingError extends Error {}\nclass RbqlRuntimeError extends Error {}\nclass AssertionError extends Error {}\nclass RbqlIOHandlingError extends Error {}\n\n\nclass InternalBadFieldError extends Error {\n    constructor(bad_idx, ...params) {\n        super(...params);\n        this.bad_idx = bad_idx;\n    }\n}\n\n\nfunction assert(condition, message=null) {\n    if (!condition) {\n        if (!message) {\n            message = 'Assertion error';\n        }\n        throw new AssertionError(message);\n    }\n}\n\n\nfunction replace_all(src, search, replacement) {\n    return src.split(search).join(replacement);\n}\n\n\nclass RBQLContext {\n    constructor(query_text, input_iterator, output_writer, user_init_code) {\n        this.query_text = query_text;\n        this.input_iterator = input_iterator;\n        this.writer = output_writer;\n        this.user_init_code = user_init_code;\n\n        this.unnest_list = null;\n        this.top_count = null;\n\n        this.like_regex_cache = new Map();\n\n        this.sort_key_expression = null;\n\n        this.aggregation_stage = 0;\n        this.aggregation_key_expression = null;\n        this.functional_aggregators = [];\n\n        this.join_map_impl = null;\n        this.join_map = null;\n        this.lhs_join_var_expression = null;\n\n        this.where_expression = null;\n\n        this.select_expression = null;\n\n        this.update_expressions = null;\n\n        this.variables_init_code = null;\n    }\n}\n\nvar query_context = null; // Needs to be global for MIN(), MAX(), etc functions. TODO find a way to make it local.\n\n\nconst wrong_aggregation_usage_error = 'Usage of RBQL aggregation functions inside JavaScript expressions is not allowed, see the docs';\nconst RBQL_VERSION = '0.27.0';\n\n\nfunction check_if_brackets_match(opening_bracket, closing_bracket) {\n    return (opening_bracket == '[' && closing_bracket == ']') || (opening_bracket == '(' && closing_bracket == ')') || (opening_bracket == '{' && closing_bracket == '}');\n}\n\n\nfunction parse_root_bracket_level_text_spans(select_expression) {\n    let text_spans = []; // parts of text separated by commas at the root parenthesis level\n    let last_pos = 0;\n    let bracket_stack = [];\n    for (let i = 0; i < select_expression.length; i++) {\n        let cur_char = select_expression[i];\n        if (cur_char == ',' && bracket_stack.length == 0) {\n            text_spans.push(select_expression.substring(last_pos, i));\n            last_pos = i + 1;\n        } else if (['[', '{', '('].indexOf(cur_char) != -1) {\n            bracket_stack.push(cur_char);\n        } else if ([']', '}', ')'].indexOf(cur_char) != -1) {\n            if (bracket_stack.length && check_if_brackets_match(bracket_stack[bracket_stack.length - 1], cur_char)) {\n                bracket_stack.pop();\n            } else {\n                throw new RbqlParsingError(`Unable to parse column headers in SELECT expression: No matching opening bracket for closing \"${cur_char}\"`);\n            }\n        }\n    }\n    if (bracket_stack.length) {\n        throw new RbqlParsingError(`Unable to parse column headers in SELECT expression: No matching closing bracket for opening \"${bracket_stack[0]}\"`);\n    }\n    text_spans.push(select_expression.substring(last_pos, select_expression.length));\n    text_spans = text_spans.map(span => span.trim());\n    return text_spans;\n}\n\n\nfunction unquote_string(quoted_str) {\n    // It's possible to use eval here to unqoute the quoted_column_name, but it would be a little barbaric, let's do it manually instead\n    if (!quoted_str || quoted_str.length < 2)\n        return null;\n    if (quoted_str[0] == \"'\" && quoted_str[quoted_str.length - 1] == \"'\") {\n        return quoted_str.substring(1, quoted_str.length - 1).replace(/\\\\'/g, \"'\").replace(/\\\\\\\\/g, \"\\\\\");\n    } else if (quoted_str[0] == '\"' && quoted_str[quoted_str.length - 1] == '\"') {\n        return quoted_str.substring(1, quoted_str.length - 1).replace(/\\\\\"/g, '\"').replace(/\\\\\\\\/g, \"\\\\\");\n    } else {\n        return null;\n    }\n}\n\n\nfunction column_info_from_text_span(text_span, string_literals) {\n    // This function is a rough equivalent of \"column_info_from_node()\" function in python version of RBQL\n    text_span = text_span.trim();\n    let rbql_star_marker = '__RBQL_INTERNAL_STAR';\n    let simple_var_match = /^[_a-zA-Z][_a-zA-Z0-9]*$/.exec(text_span);\n    let attribute_match = /^([ab])\\.([_a-zA-Z][_a-zA-Z0-9]*)$/.exec(text_span);\n    let subscript_int_match = /^([ab])\\[([0-9]+)\\]$/.exec(text_span);\n    let subscript_str_match = /^([ab])\\[___RBQL_STRING_LITERAL([0-9]+)___\\]$/.exec(text_span);\n    let as_alias_match = /^(.*) (as|AS) +([a-zA-Z][a-zA-Z0-9_]*) *$/.exec(text_span);\n    if (as_alias_match !== null) {\n        return {table_name: null, column_index: null, column_name: null, is_star: false, alias_name: as_alias_match[3]};\n    }\n    if (simple_var_match !== null) {\n        if (text_span == rbql_star_marker)\n            return {table_name: null, column_index: null, column_name: null, is_star: true, alias_name: null};\n        if (text_span.startsWith('___RBQL_STRING_LITERAL'))\n            return null;\n        let match = /^([ab])([0-9]+)$/.exec(text_span);\n        if (match !== null) {\n            return {table_name: match[1], column_index: parseInt(match[2]) - 1, column_name: null, is_star: false, alias_name: null};\n        }\n        // Some examples for this branch: NR, NF\n        return {table_name: null, column_index: null, column_name: text_span, is_star: false, alias_name: null};\n    } else if (attribute_match !== null) {\n        let table_name = attribute_match[1];\n        let column_name = attribute_match[2];\n        if (column_name == rbql_star_marker) {\n            return {table_name: table_name, column_index: null, column_name: null, is_star: true, alias_name: null};\n        }\n        return {table_name: null, column_index: null, column_name: column_name, is_star: false, alias_name: null};\n    } else if (subscript_int_match != null) {\n        let table_name = subscript_int_match[1];\n        let column_index = parseInt(subscript_int_match[2]) - 1;\n        return {table_name: table_name, column_index: column_index, column_name: null, is_star: false, alias_name: null};\n    } else if (subscript_str_match != null) {\n        let table_name = subscript_str_match[1];\n        let replaced_string_literal_id = subscript_str_match[2];\n        if (replaced_string_literal_id < string_literals.length) {\n            let quoted_column_name = string_literals[replaced_string_literal_id];\n            let unquoted_column_name = unquote_string(quoted_column_name);\n            if (unquoted_column_name !== null && unquoted_column_name !== undefined) {\n                return {table_name: null, column_index: null, column_name: unquoted_column_name, is_star: false, alias_name: null};\n            }\n        }\n    }\n    return null;\n}\n\n\nfunction adhoc_parse_select_expression_to_column_infos(select_expression, string_literals) {\n    // It is acceptable for the algorithm to provide null column name when it could be theorethically possible to deduce the name.\n    // I.e. this algorithm guarantees precision but doesn't guarantee completeness in all theorethically possible queries.\n    // Although the algorithm should be complete in all practical scenarios, i.e. it should be hard to come up with the query that doesn't produce complete set of column names.\n    // The null column name just means that the output column will be named as col{i}, so the failure to detect the proper column name can be tolerated.\n    // Specifically this function guarantees the following:\n    // 1. The number of column_infos is correct and will match the number of fields in each record in the output - otherwise the exception should be thrown\n    // 2. If column_info at pos j is not null, it is guaranteed to correctly represent that column name in the output\n    let text_spans = parse_root_bracket_level_text_spans(select_expression);\n    let column_infos = text_spans.map(ts => column_info_from_text_span(ts, string_literals));\n    return column_infos;\n}\n\n\nfunction stable_compare(a, b) {\n    for (var i = 0; i < a.length; i++) {\n        if (a[i] !== b[i])\n            return a[i] < b[i] ? -1 : 1;\n    }\n}\n\n\nfunction safe_get(record, idx) {\n    return idx < record.length ? record[idx] : null;\n}\n\n\nfunction safe_join_get(record, idx) {\n    if (idx < record.length) {\n        return record[idx];\n    }\n    throw new InternalBadFieldError(idx);\n}\n\n\nfunction safe_set(record, idx, value) {\n    if (idx < record.length) {\n        record[idx] = value;\n    } else {\n        throw new InternalBadFieldError(idx);\n    }\n}\n\n\nfunction regexp_escape(text) {\n    // From here: https://stackoverflow.com/a/6969486/2898283\n    return text.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');  // $& means the whole matched text\n}\n\n\nfunction like_to_regex(pattern) {\n    let p = 0;\n    let i = 0;\n    let converted = '';\n    while (i < pattern.length) {\n        if (pattern.charAt(i) == '_' || pattern.charAt(i) == '%') {\n            converted += regexp_escape(pattern.substring(p, i));\n            p = i + 1;\n            if (pattern.charAt(i) == '_') {\n                converted += '.';\n            } else {\n                converted += '.*';\n            }\n        }\n        i += 1;\n    }\n    converted += regexp_escape(pattern.substring(p, i));\n    return '^' + converted + '$';\n}\n\n\nfunction like(text, pattern) {\n    let matcher = query_context.like_regex_cache.get(pattern);\n    if (matcher === undefined) {\n        matcher = new RegExp(like_to_regex(pattern));\n        query_context.like_regex_cache.set(pattern, matcher);\n    }\n    return matcher.test(text);\n}\nconst LIKE = like;\n\n\nclass RBQLAggregationToken {\n    constructor(marker_id, value) {\n        this.marker_id = marker_id;\n        this.value = value;\n    }\n\n    toString() {\n        throw new RbqlParsingError(wrong_aggregation_usage_error);\n    }\n}\n\n\nclass UnnestMarker {}\n\n\nfunction UNNEST(vals) {\n    if (query_context.unnest_list !== null) {\n        // Technically we can support multiple UNNEST's but the implementation/algorithm is more complex and just doesn't worth it\n        throw new RbqlParsingError('Only one UNNEST is allowed per query');\n    }\n    query_context.unnest_list = vals;\n    return new UnnestMarker();\n}\nconst unnest = UNNEST;\nconst Unnest = UNNEST;\nconst UNFOLD = UNNEST; // \"UNFOLD\" is deprecated, just for backward compatibility\n\n\nfunction parse_number(val) {\n    // We can do a more pedantic number test like `/^ *-{0,1}[0-9]+\\.{0,1}[0-9]* *$/.test(val)`, but  user will probably use just Number(val) or parseInt/parseFloat\n    let result = Number(val);\n    if (isNaN(result)) {\n        throw new RbqlRuntimeError(`Unable to convert value \"${val}\" to a number. MIN, MAX, SUM, AVG, MEDIAN and VARIANCE aggregate functions convert their string arguments to numeric values`);\n    }\n    return result;\n}\n\n\nclass AnyValueAggregator {\n    constructor() {\n        this.stats = new Map();\n    }\n\n    increment(key, val) {\n        var cur_aggr = this.stats.get(key);\n        if (cur_aggr === undefined) {\n            this.stats.set(key, val);\n        }\n    }\n\n    get_final(key) {\n        return this.stats.get(key);\n    }\n}\n\n\nclass MinAggregator {\n    constructor() {\n        this.stats = new Map();\n    }\n\n    increment(key, val) {\n        val = parse_number(val);\n        var cur_aggr = this.stats.get(key);\n        if (cur_aggr === undefined) {\n            this.stats.set(key, val);\n        } else {\n            this.stats.set(key, Math.min(cur_aggr, val));\n        }\n    }\n\n    get_final(key) {\n        return this.stats.get(key);\n    }\n}\n\n\nclass MaxAggregator {\n    constructor() {\n        this.stats = new Map();\n    }\n\n    increment(key, val) {\n        val = parse_number(val);\n        var cur_aggr = this.stats.get(key);\n        if (cur_aggr === undefined) {\n            this.stats.set(key, val);\n        } else {\n            this.stats.set(key, Math.max(cur_aggr, val));\n        }\n    }\n\n    get_final(key) {\n        return this.stats.get(key);\n    }\n}\n\n\nclass SumAggregator {\n    constructor() {\n        this.stats = new Map();\n    }\n\n    increment(key, val) {\n        val = parse_number(val);\n        var cur_aggr = this.stats.get(key);\n        if (cur_aggr === undefined) {\n            this.stats.set(key, val);\n        } else {\n            this.stats.set(key, cur_aggr + val);\n        }\n    }\n\n    get_final(key) {\n        return this.stats.get(key);\n    }\n}\n\n\nclass AvgAggregator {\n    constructor() {\n        this.stats = new Map();\n    }\n\n    increment(key, val) {\n        val = parse_number(val);\n        var cur_aggr = this.stats.get(key);\n        if (cur_aggr === undefined) {\n            this.stats.set(key, [val, 1]);\n        } else {\n            var cur_sum = cur_aggr[0];\n            var cur_cnt = cur_aggr[1];\n            this.stats.set(key, [cur_sum + val, cur_cnt + 1]);\n        }\n    }\n\n    get_final(key) {\n        var cur_aggr = this.stats.get(key);\n        var cur_sum = cur_aggr[0];\n        var cur_cnt = cur_aggr[1];\n        var avg = cur_sum / cur_cnt;\n        return avg;\n    }\n}\n\n\nclass VarianceAggregator {\n    constructor() {\n        this.stats = new Map();\n    }\n\n    increment(key, val) {\n        val = parse_number(val);\n        var cur_aggr = this.stats.get(key);\n        if (cur_aggr === undefined) {\n            this.stats.set(key, [val, val * val, 1]);\n        } else {\n            var cur_sum = cur_aggr[0];\n            var cur_sum_sq = cur_aggr[1];\n            var cur_cnt = cur_aggr[2];\n            this.stats.set(key, [cur_sum + val, cur_sum_sq + val * val, cur_cnt + 1]);\n        }\n    }\n\n    get_final(key) {\n        var cur_aggr = this.stats.get(key);\n        var cur_sum = cur_aggr[0];\n        var cur_sum_sq = cur_aggr[1];\n        var cur_cnt = cur_aggr[2];\n        var avg_val = cur_sum / cur_cnt;\n        var variance = cur_sum_sq / cur_cnt - avg_val * avg_val;\n        return variance;\n    }\n}\n\n\nclass MedianAggregator {\n    constructor() {\n        this.stats = new Map();\n    }\n\n    increment(key, val) {\n        val = parse_number(val);\n        var cur_aggr = this.stats.get(key);\n        if (cur_aggr === undefined) {\n            this.stats.set(key, [val]);\n        } else {\n            cur_aggr.push(val);\n        }\n    }\n\n    get_final(key) {\n        var cur_aggr = this.stats.get(key);\n        cur_aggr.sort(function(a, b) { return a - b; });\n        var m = Math.floor(cur_aggr.length / 2);\n        if (cur_aggr.length % 2) {\n            return cur_aggr[m];\n        } else {\n            return (cur_aggr[m - 1] + cur_aggr[m]) / 2.0;\n        }\n    }\n}\n\n\nclass CountAggregator {\n    constructor() {\n        this.stats = new Map();\n    }\n\n    increment(key, val) {\n        var cur_aggr = this.stats.get(key);\n        if (cur_aggr === undefined) {\n            this.stats.set(key, 1);\n        } else {\n            this.stats.set(key, cur_aggr + 1);\n        }\n    }\n\n    get_final(key) {\n        return this.stats.get(key);\n    }\n}\n\n\nclass ArrayAggAggregator {\n    constructor(post_proc=null) {\n        this.post_proc = post_proc;\n        this.stats = new Map();\n    }\n\n    increment(key, val) {\n        let cur_aggr = this.stats.get(key);\n        if (cur_aggr === undefined) {\n            this.stats.set(key, [val]);\n        } else {\n            cur_aggr.push(val);\n        }\n    }\n\n    get_final(key) {\n        let cur_aggr = this.stats.get(key);\n        if (this.post_proc === null)\n            return cur_aggr;\n        return this.post_proc(cur_aggr);\n    }\n}\n\n\nclass ConstGroupVerifier {\n    constructor(output_index) {\n        this.output_index = output_index;\n        this.const_values = new Map();\n    }\n\n    increment(key, value) {\n        var old_value = this.const_values.get(key);\n        if (old_value === undefined) {\n            this.const_values.set(key, value);\n        } else if (old_value != value) {\n            throw new RbqlRuntimeError(`Invalid aggregate expression: non-constant values in output column ${this.output_index + 1}. E.g. \"${old_value}\" and \"${value}\"`);\n        }\n    }\n\n    get_final(key) {\n        return this.const_values.get(key);\n    }\n}\n\n\nfunction init_aggregator(generator_name, val, post_proc=null) {\n    query_context.aggregation_stage = 1;\n    var res = new RBQLAggregationToken(query_context.functional_aggregators.length, val);\n    if (post_proc === null) {\n        query_context.functional_aggregators.push(new generator_name());\n    } else {\n        query_context.functional_aggregators.push(new generator_name(post_proc));\n    }\n    return res;\n}\n\nfunction ANY_VALUE(val) {\n    return query_context.aggregation_stage < 2 ? init_aggregator(AnyValueAggregator, val) : val;\n}\nconst any_value = ANY_VALUE;\nconst Any_value = ANY_VALUE;\n\nfunction MIN(val) {\n    return query_context.aggregation_stage < 2 ? init_aggregator(MinAggregator, val) : val;\n}\nconst min = MIN;\nconst Min = MIN;\n\nfunction MAX(val) {\n    return query_context.aggregation_stage < 2 ? init_aggregator(MaxAggregator, val) : val;\n}\nconst max = MAX;\nconst Max = MAX;\n\nfunction COUNT(val) {\n    return query_context.aggregation_stage < 2 ? init_aggregator(CountAggregator, 1) : 1;\n}\nconst count = COUNT;\nconst Count = COUNT;\n\nfunction SUM(val) {\n    return query_context.aggregation_stage < 2 ? init_aggregator(SumAggregator, val) : val;\n}\nconst sum = SUM;\nconst Sum = SUM;\n\nfunction AVG(val) {\n    return query_context.aggregation_stage < 2 ? init_aggregator(AvgAggregator, val) : val;\n}\nconst avg = AVG;\nconst Avg = AVG;\n\nfunction VARIANCE(val) {\n    return query_context.aggregation_stage < 2 ? init_aggregator(VarianceAggregator, val) : val;\n}\nconst variance = VARIANCE;\nconst Variance = VARIANCE;\n\nfunction MEDIAN(val) {\n    return query_context.aggregation_stage < 2 ? init_aggregator(MedianAggregator, val) : val;\n}\nconst median = MEDIAN;\nconst Median = MEDIAN;\n\nfunction ARRAY_AGG(val, post_proc=null) {\n    return query_context.aggregation_stage < 2 ? init_aggregator(ArrayAggAggregator, val, post_proc) : val;\n}\nconst array_agg = ARRAY_AGG;\nconst FOLD = ARRAY_AGG; // \"FOLD\" is deprecated, just for backward compatibility\n\n\nfunction add_to_set(dst_set, value) {\n    var len_before = dst_set.size;\n    dst_set.add(value);\n    return len_before != dst_set.size;\n}\n\n\nclass TopWriter {\n    constructor(subwriter, top_count) {\n        this.subwriter = subwriter;\n        this.NW = 0;\n        this.top_count = top_count;\n    }\n\n    async write(record) {\n        if (this.top_count !== null && this.NW >= this.top_count)\n            return false;\n        await this.subwriter.write(record);\n        this.NW += 1;\n        return true;\n    }\n\n    async finish() {\n        await this.subwriter.finish();\n    }\n}\n\n\nclass UniqWriter {\n    constructor(subwriter) {\n        this.subwriter = subwriter;\n        this.seen = new Set();\n    }\n\n    async write(record) {\n        if (!add_to_set(this.seen, JSON.stringify(record)))\n            return true;\n        if (!await this.subwriter.write(record))\n            return false;\n        return true;\n    }\n\n    async finish() {\n        await this.subwriter.finish();\n    }\n}\n\n\nclass UniqCountWriter {\n    constructor(subwriter) {\n        this.subwriter = subwriter;\n        this.records = new Map();\n    }\n\n    async write(record) {\n        var key = JSON.stringify(record);\n        var old_val = this.records.get(key);\n        if (old_val) {\n            old_val[0] += 1;\n        } else {\n            this.records.set(key, [1, record]);\n        }\n        return true;\n    }\n\n    async finish() {\n        for (var [key, value] of this.records) {\n            let [count, record] = value;\n            record.unshift(count);\n            if (!await this.subwriter.write(record))\n                break;\n        }\n        await this.subwriter.finish();\n    }\n}\n\n\nclass SortedWriter {\n    constructor(subwriter, reverse_sort) {\n        this.subwriter = subwriter;\n        this.reverse_sort = reverse_sort;\n        this.unsorted_entries = [];\n    }\n\n    async write(stable_entry) {\n        this.unsorted_entries.push(stable_entry);\n        return true;\n    }\n\n    async finish() {\n        var unsorted_entries = this.unsorted_entries;\n        unsorted_entries.sort(stable_compare);\n        if (this.reverse_sort)\n            unsorted_entries.reverse();\n        for (var i = 0; i < unsorted_entries.length; i++) {\n            var entry = unsorted_entries[i];\n            if (!await this.subwriter.write(entry[entry.length - 1]))\n                break;\n        }\n        await this.subwriter.finish();\n    }\n}\n\n\nclass AggregateWriter {\n    constructor(subwriter) {\n        this.subwriter = subwriter;\n        this.aggregators = [];\n        this.aggregation_keys = new Set();\n    }\n\n    async finish() {\n        var all_keys = Array.from(this.aggregation_keys);\n        all_keys.sort();\n        for (var i = 0; i < all_keys.length; i++) {\n            var key = all_keys[i];\n            var out_fields = [];\n            for (var ag of this.aggregators) {\n                out_fields.push(ag.get_final(key));\n            }\n            if (!await this.subwriter.write(out_fields))\n                break;\n        }\n        await this.subwriter.finish();\n    }\n}\n\n\nclass InnerJoiner {\n    constructor(join_map) {\n        this.join_map = join_map;\n    }\n\n    get_rhs(lhs_key) {\n        return this.join_map.get_join_records(lhs_key);\n    }\n}\n\n\nclass LeftJoiner {\n    constructor(join_map) {\n        this.join_map = join_map;\n        this.null_record = [[null, join_map.max_record_len, Array(join_map.max_record_len).fill(null)]];\n    }\n\n    get_rhs(lhs_key) {\n        let result = this.join_map.get_join_records(lhs_key);\n        if (result.length == 0) {\n            return this.null_record;\n        }\n        return result;\n    }\n}\n\n\nclass StrictLeftJoiner {\n    constructor(join_map) {\n        this.join_map = join_map;\n    }\n\n    get_rhs(lhs_key) {\n        let result = this.join_map.get_join_records(lhs_key);\n        if (result.length != 1) {\n            throw new RbqlRuntimeError('In \"STRICT LEFT JOIN\" each key in A must have exactly one match in B. Bad A key: \"' + lhs_key + '\"');\n        }\n        return result;\n    }\n}\n\n\nfunction select_except(src, except_fields) {\n    let result = [];\n    for (let i = 0; i < src.length; i++) {\n        if (except_fields.indexOf(i) == -1)\n            result.push(src[i]);\n    }\n    return result;\n}\n\n\nasync function select_simple(sort_key, NR, out_fields) {\n    if (query_context.sort_key_expression !== null) {\n        var sort_entry = sort_key.concat([NR, out_fields]);\n        if (!await query_context.writer.write(sort_entry))\n            return false;\n    } else {\n        if (!await query_context.writer.write(out_fields))\n            return false;\n    }\n    return true;\n}\n\n\nfunction select_aggregated(key, transparent_values) {\n    if (key !== null) {\n        key = JSON.stringify(key);\n    }\n    if (query_context.aggregation_stage === 1) {\n        if (!(query_context.writer instanceof TopWriter)) {\n            throw new RbqlParsingError('\"ORDER BY\", \"UPDATE\" and \"DISTINCT\" keywords are not allowed in aggregate queries');\n        }\n        query_context.writer = new AggregateWriter(query_context.writer);\n        let num_aggregators_found = 0;\n        for (var i = 0; i < transparent_values.length; i++) {\n            var trans_value = transparent_values[i];\n            if (trans_value instanceof RBQLAggregationToken) {\n                query_context.writer.aggregators.push(query_context.functional_aggregators[trans_value.marker_id]);\n                query_context.writer.aggregators[query_context.writer.aggregators.length - 1].increment(key, trans_value.value);\n                num_aggregators_found += 1;\n            } else {\n                query_context.writer.aggregators.push(new ConstGroupVerifier(query_context.writer.aggregators.length));\n                query_context.writer.aggregators[query_context.writer.aggregators.length - 1].increment(key, trans_value);\n            }\n        }\n        if (num_aggregators_found != query_context.functional_aggregators.length) {\n            throw new RbqlParsingError(wrong_aggregation_usage_error);\n        }\n        query_context.aggregation_stage = 2;\n    } else {\n        for (var i = 0; i < transparent_values.length; i++) {\n            var trans_value = transparent_values[i];\n            query_context.writer.aggregators[i].increment(key, trans_value);\n        }\n    }\n    query_context.writer.aggregation_keys.add(key);\n}\n\n\nasync function select_unnested(sort_key, NR, folded_fields) {\n    let out_fields = folded_fields.slice();\n    let unnest_pos = folded_fields.findIndex(val => val instanceof UnnestMarker);\n    for (var i = 0; i < query_context.unnest_list.length; i++) {\n        out_fields[unnest_pos] = query_context.unnest_list[i];\n        if (!await select_simple(sort_key, NR, out_fields.slice()))\n            return false;\n    }\n    return true;\n}\n\n\nconst PROCESS_SELECT_COMMON = `\n__RBQLMP__variables_init_code\nif (__RBQLMP__where_expression) {\n    let out_fields = __RBQLMP__select_expression;\n    if (query_context.aggregation_stage > 0) {\n        let key = __RBQLMP__aggregation_key_expression;\n        select_aggregated(key, out_fields);\n    } else {\n        let sort_key = [__RBQLMP__sort_key_expression];\n        if (query_context.unnest_list !== null) {\n            if (!await select_unnested(sort_key, NR, out_fields))\n                stop_flag = true;\n        } else {\n            if (!await select_simple(sort_key, NR, out_fields))\n                stop_flag = true;\n        }\n    }\n}\n`;\n\n\nconst PROCESS_SELECT_SIMPLE = `\nlet star_fields = record_a;\n__CODE__\n`;\n\n\nconst PROCESS_SELECT_JOIN = `\nlet join_matches = query_context.join_map.get_rhs(__RBQLMP__lhs_join_var_expression);\nfor (let join_match of join_matches) {\n    let [bNR, bNF, record_b] = join_match;\n    let star_fields = record_a.concat(record_b);\n    __CODE__\n    if (stop_flag)\n        break;\n}\n`;\n\n\nconst PROCESS_UPDATE_JOIN = `\nlet join_matches = query_context.join_map.get_rhs(__RBQLMP__lhs_join_var_expression);\nif (join_matches.length > 1)\n    throw new RbqlRuntimeError('More than one record in UPDATE query matched a key from the input table in the join table');\nlet record_b = null;\nlet bNR = null;\nlet bNF = null;\nif (join_matches.length == 1)\n    [bNR, bNF, record_b] = join_matches[0];\nlet up_fields = record_a;\n__RBQLMP__variables_init_code\nif (join_matches.length == 1 && (__RBQLMP__where_expression)) {\n    NU += 1;\n    __RBQLMP__update_expressions\n}\nif (!await query_context.writer.write(up_fields))\n    stop_flag = true;\n`;\n\n\nconst PROCESS_UPDATE_SIMPLE = `\nlet up_fields = record_a;\n__RBQLMP__variables_init_code\nif (__RBQLMP__where_expression) {\n    NU += 1;\n    __RBQLMP__update_expressions\n}\nif (!await query_context.writer.write(up_fields))\n    stop_flag = true;\n`;\n\n\nconst MAIN_LOOP_BODY = `\n__USER_INIT_CODE__\n\nlet NU = 0;\nlet NR = 0;\n\nlet stop_flag = false;\nwhile (!stop_flag) {\n    let record_a = await query_context.input_iterator.get_record();\n    if (record_a === null)\n        break;\n    NR += 1;\n    let NF = record_a.length;\n    query_context.unnest_list = null; // TODO optimize, don't need to set this every iteration\n    try {\n        __CODE__\n    } catch (e) {\n        if (e.constructor.name === 'InternalBadFieldError') {\n            throw new RbqlRuntimeError(\\`No \"a\\${e.bad_idx + 1}\" field at record \\${NR}\\`);\n        } else if (e.constructor.name === 'RbqlParsingError') {\n            throw(e);\n        } else {\n            throw new RbqlRuntimeError(\\`At record \\${NR}, Details: \\${e.message}\\`);\n        }\n    }\n}\n`;\n\n\nfunction embed_expression(parent_code, child_placeholder, child_expression) {\n    return replace_all(parent_code, child_placeholder, child_expression);\n}\n\n\nfunction embed_code(parent_code, child_placeholder, child_code) {\n    let parent_lines = parent_code.split('\\n');\n    let child_lines = child_code.split('\\n');\n    for (let i = 0; i < parent_lines.length; i++) {\n        let pos = parent_lines[i].indexOf(child_placeholder);\n        if (pos == -1)\n            continue;\n        assert(pos % 4 == 0);\n        let placeholder_indentation = parent_lines[i].substring(0, pos);\n        child_lines = child_lines.map(l => placeholder_indentation + l);\n        let result_lines = parent_lines.slice(0, i).concat(child_lines).concat(parent_lines.slice(i + 1));\n        return result_lines.join('\\n') + '\\n';\n    }\n    assert(false);\n}\n\n\nfunction generate_main_loop_code(query_context) {\n    let is_select_query = query_context.select_expression !== null;\n    let is_join_query = query_context.join_map !== null;\n    let where_expression = query_context.where_expression === null ? 'true' : query_context.where_expression;\n    let aggregation_key_expression = query_context.aggregation_key_expression === null ? 'null' : query_context.aggregation_key_expression;\n    let sort_key_expression = query_context.sort_key_expression === null ? 'null' : query_context.sort_key_expression;\n    let js_code = embed_code(MAIN_LOOP_BODY, '__USER_INIT_CODE__', query_context.user_init_code);\n    if (is_select_query) {\n        if (is_join_query) {\n            js_code = embed_code(embed_code(js_code, '__CODE__', PROCESS_SELECT_JOIN), '__CODE__', PROCESS_SELECT_COMMON);\n            js_code = embed_expression(js_code, '__RBQLMP__lhs_join_var_expression', query_context.lhs_join_var_expression);\n        } else {\n            js_code = embed_code(embed_code(js_code, '__CODE__', PROCESS_SELECT_SIMPLE), '__CODE__', PROCESS_SELECT_COMMON);\n        }\n        js_code = embed_code(js_code, '__RBQLMP__variables_init_code', query_context.variables_init_code);\n        js_code = embed_expression(js_code, '__RBQLMP__select_expression', query_context.select_expression);\n        js_code = embed_expression(js_code, '__RBQLMP__where_expression', where_expression);\n        js_code = embed_expression(js_code, '__RBQLMP__aggregation_key_expression', aggregation_key_expression);\n        js_code = embed_expression(js_code, '__RBQLMP__sort_key_expression', sort_key_expression);\n    } else {\n        if (is_join_query) {\n            js_code = embed_code(js_code, '__CODE__', PROCESS_UPDATE_JOIN);\n            js_code = embed_expression(js_code, '__RBQLMP__lhs_join_var_expression', query_context.lhs_join_var_expression);\n        } else {\n            js_code = embed_code(js_code, '__CODE__', PROCESS_UPDATE_SIMPLE);\n        }\n        js_code = embed_code(js_code, '__RBQLMP__variables_init_code', query_context.variables_init_code);\n        js_code = embed_code(js_code, '__RBQLMP__update_expressions', query_context.update_expressions);\n        js_code = embed_expression(js_code, '__RBQLMP__where_expression', where_expression);\n    }\n    return \"(async () => {\" + js_code + \"})()\";\n}\n\n\nasync function compile_and_run(query_context) {\n    let main_loop_body = generate_main_loop_code(query_context);\n    try {\n        let main_loop_promise = eval(main_loop_body);\n        await main_loop_promise;\n    } catch (e) {\n        if (e instanceof SyntaxError) {\n            // SyntaxError's from eval() function do not contain detailed explanation of what has caused the syntax error, so to guess what was wrong we can only use the original query\n            // v8 issue to fix eval: https://bugs.chromium.org/p/v8/issues/detail?id=2589\n            let lower_case_query = query_context.query_text.toLowerCase();\n            if (lower_case_query.indexOf(' having ') != -1)\n                throw new SyntaxError(e.message + \"\\nRBQL doesn't support \\\"HAVING\\\" keyword\");\n            if (lower_case_query.indexOf(' like ') != -1)\n                throw new SyntaxError(e.message + \"\\nRBQL doesn't support \\\"LIKE\\\" operator, use like() function instead e.g. ... WHERE like(a1, 'foo%bar') ... \"); // UT JSON\n            if (lower_case_query.indexOf(' from ') != -1)\n                throw new SyntaxError(e.message + \"\\nTip: If input table is defined by the environment, RBQL query should not have \\\"FROM\\\" keyword\"); // UT JSON\n            if (e && e.message && String(e.message).toLowerCase().indexOf('unexpected identifier') != -1) {\n                if (lower_case_query.indexOf(' and ') != -1)\n                    throw new SyntaxError(e.message + \"\\nDid you use 'and' keyword in your query?\\nJavaScript backend doesn't support 'and' keyword, use '&&' operator instead!\");\n                if (lower_case_query.indexOf(' or ') != -1)\n                    throw new SyntaxError(e.message + \"\\nDid you use 'or' keyword in your query?\\nJavaScript backend doesn't support 'or' keyword, use '||' operator instead!\");\n            }\n        }\n        if (e && e.message && e.message.indexOf('Received an instance of RBQLAggregationToken') != -1)\n            throw new RbqlParsingError(wrong_aggregation_usage_error);\n        throw e;\n    }\n}\n\n\nconst GROUP_BY = 'GROUP BY';\nconst UPDATE = 'UPDATE';\nconst SELECT = 'SELECT';\nconst JOIN = 'JOIN';\nconst INNER_JOIN = 'INNER JOIN';\nconst LEFT_JOIN = 'LEFT JOIN';\nconst LEFT_OUTER_JOIN = 'LEFT OUTER JOIN';\nconst STRICT_LEFT_JOIN = 'STRICT LEFT JOIN';\nconst ORDER_BY = 'ORDER BY';\nconst WHERE = 'WHERE';\nconst LIMIT = 'LIMIT';\nconst EXCEPT = 'EXCEPT';\nconst WITH = 'WITH';\n\n\nfunction get_ambiguous_error_msg(variable_name) {\n    return `Ambiguous variable name: \"${variable_name}\" is present both in input and in join tables`;\n}\n\n\nfunction get_all_matches(regexp, text) {\n    var result = [];\n    let match_obj = null;\n    while((match_obj = regexp.exec(text)) !== null) {\n        result.push(match_obj);\n    }\n    return result;\n}\n\n\nfunction str_strip(src) {\n    return src.replace(/^ +| +$/g, '');\n}\n\n\nfunction strip_comments(cline) {\n    cline = cline.trim();\n    if (cline.startsWith('//'))\n        return '';\n    return cline;\n}\n\n\nfunction combine_string_literals(backend_expression, string_literals) {\n    for (var i = 0; i < string_literals.length; i++) {\n        backend_expression = replace_all(backend_expression, `___RBQL_STRING_LITERAL${i}___`, string_literals[i]);\n    }\n    return backend_expression;\n}\n\n\nfunction parse_basic_variables(query_text, prefix, dst_variables_map) {\n    assert(prefix == 'a' || prefix == 'b');\n    let rgx = new RegExp(`(?:^|[^_a-zA-Z0-9])${prefix}([1-9][0-9]*)(?:$|(?=[^_a-zA-Z0-9]))`, 'g');\n    let matches = get_all_matches(rgx, query_text);\n    for (let i = 0; i < matches.length; i++) {\n        let field_num = parseInt(matches[i][1]);\n        dst_variables_map[prefix + String(field_num)] = {initialize: true, index: field_num - 1};\n    }\n}\n\n\nfunction parse_array_variables(query_text, prefix, dst_variables_map) {\n    assert(prefix == 'a' || prefix == 'b');\n    let rgx = new RegExp(`(?:^|[^_a-zA-Z0-9])${prefix}\\\\[([1-9][0-9]*)\\\\]`, 'g');\n    let matches = get_all_matches(rgx, query_text);\n    for (let i = 0; i < matches.length; i++) {\n        let field_num = parseInt(matches[i][1]);\n        dst_variables_map[`${prefix}[${field_num}]`] = {initialize: true, index: field_num - 1};\n    }\n}\n\n\nfunction js_string_escape_column_name(column_name, quote_char) {\n    column_name = column_name.replace(/\\\\/g, '\\\\\\\\');\n    column_name = column_name.replace(/\\n/g, '\\\\n');\n    column_name = column_name.replace(/\\r/g, '\\\\r');\n    column_name = column_name.replace(/\\t/g, '\\\\t');\n    if (quote_char === \"'\")\n        return column_name.replace(/'/g, \"\\\\'\");\n    if (quote_char === '\"')\n        return column_name.replace(/\"/g, '\\\\\"');\n    assert(quote_char === \"`\");\n    return column_name.replace(/`/g, \"\\\\`\");\n}\n\n\nfunction query_probably_has_dictionary_variable(query_text, column_name) {\n    let rgx = new RegExp('[-a-zA-Z0-9_:;+=!.,()%^#@&* ]+', 'g');\n    let continuous_name_segments = get_all_matches(rgx, column_name);\n    for (let continuous_segment of continuous_name_segments) {\n        if (query_text.indexOf(continuous_segment) == -1)\n            return false;\n    }\n    return true;\n}\n\n\nfunction parse_dictionary_variables(query_text, prefix, column_names, dst_variables_map) {\n    // The purpose of this algorithm is to minimize number of variables in varibale_map to improve performance, ideally it should be only variables from the query\n\n    // FIXME to prevent typos in attribute names either use query-based variable parsing which can properly handle back-tick strings or wrap \"a\" and \"b\" variables with ES6 Proxies https://stackoverflow.com/a/25658975/2898283\n    assert(prefix === 'a' || prefix === 'b');\n    let dict_test_rgx = new RegExp(`(?:^|[^_a-zA-Z0-9])${prefix}\\\\[`);\n    if (query_text.search(dict_test_rgx) == -1)\n        return;\n    for (let i = 0; i < column_names.length; i++) {\n        let column_name = column_names[i];\n        if (query_probably_has_dictionary_variable(query_text, column_name)) {\n            let escaped_column_name = js_string_escape_column_name(column_name, '\"');\n            dst_variables_map[`${prefix}[\"${escaped_column_name}\"]`] = {initialize: true, index: i};\n            escaped_column_name = js_string_escape_column_name(column_name, \"'\");\n            dst_variables_map[`${prefix}['${escaped_column_name}']`] = {initialize: false, index: i};\n            escaped_column_name = js_string_escape_column_name(column_name, \"`\");\n            dst_variables_map[`${prefix}[\\`${escaped_column_name}\\`]`] = {initialize: false, index: i};\n        }\n    }\n}\n\n\nfunction parse_attribute_variables(query_text, prefix, column_names, column_names_source, dst_variables_map) {\n    // The purpose of this algorithm is to minimize number of variables in varibale_map to improve performance, ideally it should be only variables from the query\n\n    assert(prefix === 'a' || prefix === 'b');\n    let rgx = new RegExp(`(?:^|[^_a-zA-Z0-9])${prefix}\\\\.([_a-zA-Z][_a-zA-Z0-9]*)`, 'g');\n    let matches = get_all_matches(rgx, query_text);\n    let column_names_from_query = matches.map(v => v[1]);\n    for (let column_name of column_names_from_query) {\n        let zero_based_idx = column_names.indexOf(column_name);\n        if (zero_based_idx != -1) {\n            dst_variables_map[`${prefix}.${column_name}`] = {initialize: true, index: zero_based_idx};\n        } else {\n            throw new RbqlParsingError(`Unable to find column \"${column_name}\" in ${prefix == 'a' ? 'input' : 'join'} ${column_names_source}`);\n        }\n    }\n}\n\n\nfunction map_variables_directly(query_text, column_names, dst_variables_map) {\n    for (let i = 0; i < column_names.length; i++) {\n        let column_name = column_names[i];\n        if ( /^[_a-zA-Z][_a-zA-Z0-9]*$/.exec(column_name) === null)\n            throw new RbqlIOHandlingError(`Unable to use column name \"${column_name}\" as RBQL/JS variable`);\n        if (query_text.indexOf(column_name) != -1)\n            dst_variables_map[column_name] = {initialize: true, index: i};\n    }\n}\n\n\nfunction ensure_no_ambiguous_variables(query_text, input_column_names, join_column_names) {\n    let join_column_names_set = new Set(join_column_names);\n    for (let column_name of input_column_names) {\n        if (join_column_names_set.has(column_name) && query_text.indexOf(column_name) != -1) // False positive is tolerable here\n            throw new RbqlParsingError(get_ambiguous_error_msg(column_name));\n    }\n}\n\n\nfunction parse_join_expression(src) {\n    src = str_strip(src);\n    const invalid_join_syntax_error = 'Invalid join syntax. Valid syntax: <JOIN> /path/to/B/table on a... == b... [and a... == b... [and ... ]]';\n    let rgx = /^ *([^ ]+) +on +/i;\n    let match = rgx.exec(src);\n    if (match === null)\n        throw new RbqlParsingError(invalid_join_syntax_error);\n    let table_id = match[1];\n    src = src.substr(match[0].length);\n\n    let variable_pairs = [];\n    var pair_rgx = /^([^ =]+) *==? *([^ =]+)/;\n    var and_rgx = /^ +(and|&&) +/i;\n    while (true) {\n        match = pair_rgx.exec(src);\n        if (match === null)\n            throw new RbqlParsingError(invalid_join_syntax_error);\n        variable_pairs.push([match[1], match[2]]);\n        src = src.substr(match[0].length);\n        if (!src.length)\n            break;\n        match = and_rgx.exec(src);\n        if (match === null)\n            throw new RbqlParsingError(invalid_join_syntax_error);\n        src = src.substr(match[0].length);\n    }\n    return [table_id, variable_pairs];\n}\n\n\nfunction resolve_join_variables(input_variables_map, join_variables_map, variable_pairs, string_literals) {\n    let lhs_variables = [];\n    let rhs_indices = [];\n    const valid_join_syntax_msg = 'Valid JOIN syntax: <JOIN> /path/to/B/table on a... == b... [and a... == b... [and ... ]]';\n    for (let variable_pair of variable_pairs) {\n        let [join_var_1, join_var_2] = variable_pair;\n        join_var_1 = combine_string_literals(join_var_1, string_literals);\n        join_var_2 = combine_string_literals(join_var_2, string_literals);\n        if (input_variables_map.hasOwnProperty(join_var_1) && join_variables_map.hasOwnProperty(join_var_1))\n            throw new RbqlParsingError(get_ambiguous_error_msg(join_var_1));\n        if (input_variables_map.hasOwnProperty(join_var_2) && join_variables_map.hasOwnProperty(join_var_2))\n            throw new RbqlParsingError(get_ambiguous_error_msg(join_var_2));\n        if (input_variables_map.hasOwnProperty(join_var_2))\n            [join_var_1, join_var_2] = [join_var_2, join_var_1];\n\n        let [lhs_key_index, rhs_key_index] = [null, null];\n        if (['NR', 'a.NR', 'aNR'].indexOf(join_var_1) != -1) {\n            lhs_key_index = -1;\n        } else if (input_variables_map.hasOwnProperty(join_var_1)) {\n            lhs_key_index = input_variables_map[join_var_1].index;\n        } else {\n            throw new RbqlParsingError(`Unable to parse JOIN expression: Input table does not have field \"${join_var_1}\"\\n${valid_join_syntax_msg}`);\n        }\n\n        if (['b.NR', 'bNR'].indexOf(join_var_2) != -1) {\n            rhs_key_index = -1;\n        } else if (join_variables_map.hasOwnProperty(join_var_2)) {\n            rhs_key_index = join_variables_map[join_var_2].index;\n        } else {\n            throw new RbqlParsingError(`Unable to parse JOIN expression: Join table does not have field \"${join_var_2}\"\\n${valid_join_syntax_msg}`);\n        }\n\n        let lhs_join_var_expression = lhs_key_index == -1 ? 'NR' : `safe_join_get(record_a, ${lhs_key_index})`;\n        rhs_indices.push(rhs_key_index);\n        lhs_variables.push(lhs_join_var_expression);\n    }\n    return [lhs_variables, rhs_indices];\n}\n\n\nfunction generate_common_init_code(query_text, variable_prefix) {\n    assert(variable_prefix == 'a' || variable_prefix == 'b');\n    let result = [];\n    result.push(`${variable_prefix} = new Object();`);\n    let base_var = variable_prefix == 'a' ? 'NR' : 'bNR';\n    let attr_var = `${variable_prefix}.NR`;\n    if (query_text.indexOf(attr_var) != -1)\n        result.push(`${attr_var} = ${base_var};`);\n    if (variable_prefix == 'a' && query_text.indexOf('aNR') != -1)\n        result.push('aNR = NR;');\n    return result;\n}\n\n\nfunction generate_init_statements(query_text, variables_map, join_variables_map, indent) {\n    let code_lines = generate_common_init_code(query_text, 'a');\n    let simple_var_name_rgx = /^[_0-9a-zA-Z]+$/;\n    for (const [variable_name, var_info] of Object.entries(variables_map)) {\n        if (var_info.initialize) {\n            let variable_declaration_keyword = simple_var_name_rgx.exec(variable_name) ? 'var ' : '';\n            code_lines.push(`${variable_declaration_keyword}${variable_name} = safe_get(record_a, ${var_info.index});`);\n        }\n    }\n    if (join_variables_map) {\n        code_lines = code_lines.concat(generate_common_init_code(query_text, 'b'));\n        for (const [variable_name, var_info] of Object.entries(join_variables_map)) {\n            if (var_info.initialize) {\n                let variable_declaration_keyword = simple_var_name_rgx.exec(variable_name) ? 'var ' : '';\n                code_lines.push(`${variable_declaration_keyword}${variable_name} = record_b === null ? null : safe_get(record_b, ${var_info.index});`);\n            }\n        }\n    }\n    for (let i = 1; i < code_lines.length; i++) {\n        code_lines[i] = indent + code_lines[i];\n    }\n    return code_lines.join('\\n');\n}\n\n\nfunction replace_star_count(aggregate_expression) {\n    var rgx = /(?:(?<=^)|(?<=,)) *COUNT\\( *\\* *\\)/ig;\n    var result = aggregate_expression.replace(rgx, ' COUNT(1)');\n    return str_strip(result);\n}\n\n\nfunction replace_star_vars(rbql_expression) {\n    let star_rgx = /(?:^|,) *(\\*|a\\.\\*|b\\.\\*) *(?=$|,)/g;\n    let matches = get_all_matches(star_rgx, rbql_expression);\n    let last_pos = 0;\n    let result = '';\n    for (let match of matches) {\n        let star_expression = match[1];\n        let replacement_expression = ']).concat(' + {'*': 'star_fields', 'a.*': 'record_a', 'b.*': 'record_b'}[star_expression] + ').concat([';\n        if (last_pos < match.index)\n            result += rbql_expression.substring(last_pos, match.index);\n        result += replacement_expression;\n        last_pos = match.index + match[0].length + 1; // Adding one to skip the lookahead comma\n    }\n    result += rbql_expression.substring(last_pos);\n    return result;\n}\n\n\nfunction replace_star_vars_for_header_parsing(rbql_expression) {\n    let star_rgx = /(?:(?<=^)|(?<=,)) *(\\*|a\\.\\*|b\\.\\*) *(?=$|,)/g;\n    let matches = get_all_matches(star_rgx, rbql_expression);\n    let last_pos = 0;\n    let result = '';\n    for (let match of matches) {\n        let star_expression = match[1];\n        let replacement_expression = {'*': '__RBQL_INTERNAL_STAR', 'a.*': 'a.__RBQL_INTERNAL_STAR', 'b.*': 'b.__RBQL_INTERNAL_STAR'}[star_expression];\n        if (last_pos < match.index)\n            result += rbql_expression.substring(last_pos, match.index);\n        result += replacement_expression;\n        last_pos = match.index + match[0].length;\n    }\n    result += rbql_expression.substring(last_pos);\n    return result;\n}\n\n\nfunction translate_update_expression(update_expression, input_variables_map, string_literals, indent) {\n    let first_assignment = str_strip(update_expression.split('=')[0]);\n    let first_assignment_error = `Unable to parse \"UPDATE\" expression: the expression must start with assignment, but \"${first_assignment}\" does not look like an assignable field name`;\n\n    let assignment_looking_rgx = /(?:^|,) *(a[.#a-zA-Z0-9\\[\\]_]*) *=(?=[^=])/g;\n    let update_expressions = [];\n    let pos = 0;\n    while (true) {\n        let match = assignment_looking_rgx.exec(update_expression);\n        if (update_expressions.length == 0 && (match === null || match.index != 0)) {\n            throw new RbqlParsingError(first_assignment_error);\n        }\n        if (match === null) {\n            update_expressions[update_expressions.length - 1] += str_strip(update_expression.substr(pos)) + ');';\n            break;\n        }\n        if (update_expressions.length)\n            update_expressions[update_expressions.length - 1] += str_strip(update_expression.substring(pos, match.index)) + ');';\n        let dst_var_name = combine_string_literals(str_strip(match[1]), string_literals);\n        if (!input_variables_map.hasOwnProperty(dst_var_name))\n            throw new RbqlParsingError(`Unable to parse \"UPDATE\" expression: Unknown field name: \"${dst_var_name}\"`);\n        let var_index = input_variables_map[dst_var_name].index;\n        let current_indent = update_expressions.length ? indent : '';\n        update_expressions.push(`${current_indent}safe_set(up_fields, ${var_index}, `);\n        pos = match.index + match[0].length;\n    }\n    return combine_string_literals(update_expressions.join('\\n'), string_literals);\n}\n\n\nfunction translate_select_expression(select_expression) {\n    let as_alias_replacement_regexp = / +(AS|as) +([a-zA-Z][a-zA-Z0-9_]*) *(?=$|,)/g;\n    let expression_without_counting_stars = replace_star_count(select_expression);\n    let expression_without_as_column_alias = expression_without_counting_stars.replace(as_alias_replacement_regexp, '');\n    let translated = str_strip(replace_star_vars(expression_without_as_column_alias));\n    let translated_for_header = str_strip(replace_star_vars_for_header_parsing(expression_without_counting_stars));\n    if (!translated.length)\n        throw new RbqlParsingError('\"SELECT\" expression is empty');\n    return [`[].concat([${translated}])`, translated_for_header];\n}\n\n\nfunction separate_string_literals(rbql_expression) {\n    // The regex consists of 3 almost identicall parts, the only difference is quote type\n    var rgx = /('(\\\\(\\\\\\\\)*'|[^'])*')|(\"(\\\\(\\\\\\\\)*\"|[^\"])*\")|(`(\\\\(\\\\\\\\)*`|[^`])*`)/g;\n    var match_obj = null;\n    var format_parts = [];\n    var string_literals = [];\n    var idx_before = 0;\n    while((match_obj = rgx.exec(rbql_expression)) !== null) {\n        var literal_id = string_literals.length;\n        var string_literal = match_obj[0];\n        string_literals.push(string_literal);\n        var start_index = match_obj.index;\n        format_parts.push(rbql_expression.substring(idx_before, start_index));\n        format_parts.push(`___RBQL_STRING_LITERAL${literal_id}___`);\n        idx_before = rgx.lastIndex;\n    }\n    format_parts.push(rbql_expression.substring(idx_before));\n    var format_expression = format_parts.join('');\n    format_expression = format_expression.replace(/\\t/g, ' ');\n    return [format_expression, string_literals];\n}\n\n\nfunction locate_statements(rbql_expression) {\n    let statement_groups = [];\n    statement_groups.push([STRICT_LEFT_JOIN, LEFT_OUTER_JOIN, LEFT_JOIN, INNER_JOIN, JOIN]);\n    statement_groups.push([SELECT]);\n    statement_groups.push([ORDER_BY]);\n    statement_groups.push([WHERE]);\n    statement_groups.push([UPDATE]);\n    statement_groups.push([GROUP_BY]);\n    statement_groups.push([LIMIT]);\n    statement_groups.push([EXCEPT]);\n    var result = [];\n    for (var ig = 0; ig < statement_groups.length; ig++) {\n        for (var is = 0; is < statement_groups[ig].length; is++) {\n            var statement = statement_groups[ig][is];\n            var rgxp = new RegExp('(?:^| )' + replace_all(statement, ' ', ' *') + '(?= )', 'ig');\n            var matches = get_all_matches(rgxp, rbql_expression);\n            if (!matches.length)\n                continue;\n            if (matches.length > 1)\n                throw new RbqlParsingError(`More than one \"${statement}\" statements found`);\n            assert(matches.length == 1);\n            var match = matches[0];\n            var match_str = match[0];\n            result.push([match.index, match.index + match_str.length, statement]);\n            break; // Break to avoid matching a sub-statement from the same group e.g. \"INNER JOIN\" -> \"JOIN\"\n        }\n    }\n    result.sort(function(a, b) { return a[0] - b[0]; });\n    return result;\n}\n\n\nfunction separate_actions(rbql_expression) {\n    rbql_expression = str_strip(rbql_expression);\n    var result = {};\n    let with_match = /^(.*)  *[Ww][Ii][Tt][Hh] *\\(([a-z]{4,20})\\) *$/.exec(rbql_expression);\n    if (with_match !== null) {\n        rbql_expression = with_match[1];\n        result[WITH] = with_match[2];\n    }\n    var ordered_statements = locate_statements(rbql_expression);\n    for (var i = 0; i < ordered_statements.length; i++) {\n        var statement_start = ordered_statements[i][0];\n        var span_start = ordered_statements[i][1];\n        var statement = ordered_statements[i][2];\n        var span_end = i + 1 < ordered_statements.length ? ordered_statements[i + 1][0] : rbql_expression.length;\n        assert(statement_start < span_start);\n        assert(span_start <= span_end);\n        var span = rbql_expression.substring(span_start, span_end);\n        var statement_params = {};\n        if ([STRICT_LEFT_JOIN, LEFT_OUTER_JOIN, LEFT_JOIN, INNER_JOIN, JOIN].indexOf(statement) != -1) {\n            statement_params['join_subtype'] = statement;\n            statement = JOIN;\n        }\n\n        if (statement == UPDATE) {\n            if (statement_start != 0)\n                throw new RbqlParsingError('UPDATE keyword must be at the beginning of the query');\n            span = span.replace(/^ *SET/i, '');\n        }\n\n        if (statement == ORDER_BY) {\n            span = span.replace(/ ASC *$/i, '');\n            var new_span = span.replace(/ DESC *$/i, '');\n            if (new_span != span) {\n                span = new_span;\n                statement_params['reverse'] = true;\n            } else {\n                statement_params['reverse'] = false;\n            }\n        }\n\n        if (statement == SELECT) {\n            if (statement_start != 0)\n                throw new RbqlParsingError('SELECT keyword must be at the beginning of the query');\n            let match = /^ *TOP *([0-9]+) /i.exec(span);\n            if (match !== null) {\n                statement_params['top'] = parseInt(match[1]);\n                span = span.substr(match.index + match[0].length);\n            }\n            match = /^ *DISTINCT *(COUNT)? /i.exec(span);\n            if (match !== null) {\n                statement_params['distinct'] = true;\n                if (match[1]) {\n                    statement_params['distinct_count'] = true;\n                }\n                span = span.substr(match.index + match[0].length);\n            }\n        }\n        statement_params['text'] = str_strip(span);\n        result[statement] = statement_params;\n    }\n    if (!result.hasOwnProperty(SELECT) && !result.hasOwnProperty(UPDATE)) {\n        throw new RbqlParsingError('Query must contain either SELECT or UPDATE statement');\n    }\n    assert(result.hasOwnProperty(SELECT) != result.hasOwnProperty(UPDATE));\n    return result;\n}\n\n\nfunction find_top(rb_actions) {\n    if (rb_actions.hasOwnProperty(LIMIT)) {\n        var rgx = /^[0-9]+$/;\n        if (rgx.exec(rb_actions[LIMIT]['text']) === null) {\n            throw new RbqlParsingError('LIMIT keyword must be followed by an integer');\n        }\n        var result = parseInt(rb_actions[LIMIT]['text']);\n        return result;\n    }\n    var select_action = rb_actions[SELECT];\n    if (select_action && select_action.hasOwnProperty('top')) {\n        return select_action['top'];\n    }\n    return null;\n}\n\n\nfunction translate_except_expression(except_expression, input_variables_map, string_literals, input_header) {\n    let skip_vars = except_expression.split(',');\n    skip_vars = skip_vars.map(str_strip);\n    let skip_indices = [];\n    for (let var_name of skip_vars) {\n        var_name = combine_string_literals(var_name, string_literals);\n        if (!input_variables_map.hasOwnProperty(var_name))\n            throw new RbqlParsingError(`Unknown field in EXCEPT expression: \"${var_name}\"`);\n        skip_indices.push(input_variables_map[var_name].index);\n    }\n    skip_indices = skip_indices.sort((a, b) => a - b);\n    let output_header = input_header === null ? null : select_except(input_header, skip_indices);\n    let indices_str = skip_indices.join(',');\n    return [output_header, `select_except(record_a, [${indices_str}])`];\n}\n\n\nclass HashJoinMap {\n    constructor(record_iterator, key_indices) {\n        this.max_record_len = 0;\n        this.hash_map = new Map();\n        this.record_iterator = record_iterator;\n        this.nr = 0;\n        if (key_indices.length == 1) {\n            this.key_index = key_indices[0];\n            this.key_indices = null;\n            this.polymorphic_get_key = this.get_single_key;\n        } else {\n            this.key_index = null;\n            this.key_indices = key_indices;\n            this.polymorphic_get_key = this.get_multi_key;\n        }\n    }\n\n    get_single_key(nr, fields) {\n        if (this.key_index >= fields.length)\n            throw new RbqlRuntimeError(`No field with index ${this.key_index + 1} at record ${this.nr} in \"B\" table`);\n        return this.key_index === -1 ? this.nr : fields[this.key_index];\n    };\n\n    get_multi_key(nr, fields) {\n        let result = [];\n        for (let ki of this.key_indices) {\n            if (ki >= fields.length)\n                throw new RbqlRuntimeError(`No field with index ${ki + 1} at record ${this.nr} in \"B\" table`);\n            result.push(ki === -1 ? this.nr : fields[ki]);\n        }\n        return JSON.stringify(result);\n    };\n\n    async build() {\n        while (true) {\n            let fields = await this.record_iterator.get_record();\n            if (fields === null)\n                break;\n            this.nr += 1;\n            let nf = fields.length;\n            this.max_record_len = Math.max(this.max_record_len, nf);\n            let key = this.polymorphic_get_key(this.nr, fields);\n            let key_records = this.hash_map.get(key);\n            if (key_records === undefined) {\n                this.hash_map.set(key, [[this.nr, nf, fields]]);\n            } else {\n                key_records.push([this.nr, nf, fields]);\n            }\n        }\n    };\n\n    get_join_records(key) {\n        let result = this.hash_map.get(key);\n        if (result === undefined)\n            return [];\n        return result;\n    };\n\n    get_warnings() {\n        return this.record_iterator.get_warnings();\n    };\n}\n\n\nfunction cleanup_query(query_text) {\n    return query_text.split('\\n').map(strip_comments).filter(line => line.length).join(' ').replace(/;+$/g, '');\n}\n\n\nfunction remove_redundant_table_name(query_text) {\n    query_text = str_strip(query_text.replace(/ +from +a(?: +|$)/gi, ' '));\n    query_text = str_strip(query_text.replace(/^ *update +a +set /gi, 'update '));\n    return query_text;\n}\n\n\nfunction select_output_header(input_header, join_header, query_column_infos) {\n    if (input_header === null) {\n        assert(join_header === null);\n    }\n    let query_has_star = false;\n    let query_has_column_alias = false;\n    for (let qci of query_column_infos) {\n        query_has_star = query_has_star || (qci !== null && qci.is_star);\n        query_has_column_alias = query_has_column_alias || (qci !== null && qci.alias_name !== null);\n    }\n    if (input_header === null) {\n        if (query_has_star && query_has_column_alias) {\n            throw new RbqlParsingError('Using both * (star) and AS alias in the same query is not allowed for input tables without header');\n        }\n        if (!query_has_column_alias) {\n            // Input table has no header and query has no aliases therefore the output table will be without header.\n            return null;\n        }\n        input_header = [];\n        join_header = [];\n    }\n    if (join_header === null) {\n        // This means there is no JOIN table.\n        join_header = [];\n    }\n    let output_header = [];\n    for (let qci of query_column_infos) {\n        // TODO refactor this and python version: extract this code into a function instead to always return something\n        if (qci === null) {\n            output_header.push('col' + (output_header.length + 1));\n        } else if (qci.is_star) {\n            if (qci.table_name === null) {\n                output_header = output_header.concat(input_header).concat(join_header);\n            } else if (qci.table_name === 'a') {\n                output_header = output_header.concat(input_header);\n            } else if (qci.table_name === 'b') {\n                output_header = output_header.concat(join_header);\n            }\n        } else if (qci.column_name !== null) {\n            output_header.push(qci.column_name);\n        } else if (qci.alias_name !== null) {\n            output_header.push(qci.alias_name);\n        } else if (qci.column_index !== null) {\n            if (qci.table_name == 'a' && qci.column_index < input_header.length) {\n                output_header.push(input_header[qci.column_index]);\n            } else if (qci.table_name == 'b' && qci.column_index < join_header.length) {\n                output_header.push(join_header[qci.column_index]);\n            } else {\n                output_header.push('col' + (output_header.length + 1));\n            }\n        } else { // Should never happen\n            output_header.push('col' + (output_header.length + 1));\n        }\n    }\n    return output_header;\n}\n\n\nfunction sample_first_two_inconsistent_records(inconsistent_records_info) {\n    let entries = Array.from(inconsistent_records_info.entries());\n    entries.sort(function(a, b) { return a[1] - b[1]; });\n    assert(entries.length > 1);\n    let [num_fields_1, record_num_1] = entries[0];\n    let [num_fields_2, record_num_2] = entries[1];\n    return [record_num_1, num_fields_1, record_num_2, num_fields_2];\n}\n\n\nfunction make_inconsistent_num_fields_warning(table_name, inconsistent_records_info) {\n    let [record_num_1, num_fields_1, record_num_2, num_fields_2] = sample_first_two_inconsistent_records(inconsistent_records_info);\n    let warn_msg = `Number of fields in \"${table_name}\" table is not consistent: `;\n    warn_msg += `e.g. record ${record_num_1} -> ${num_fields_1} fields, record ${record_num_2} -> ${num_fields_2} fields`;\n    return warn_msg;\n}\n\n\nclass RBQLInputIterator {\n    constructor(){}\n    stop() {\n        throw new Error(\"Unable to call the interface method\");\n    }\n    async get_variables_map(query_text) {\n        throw new Error(\"Unable to call the interface method\");\n    }\n    async get_record() {\n        throw new Error(\"Unable to call the interface method\");\n    }\n    handle_query_modifier() {\n        return; // Reimplement if you need to handle a boolean query modifier that can be used like this: `SELECT * WITH (modifiername)`\n    }\n    get_warnings() {\n        return []; // Reimplement if your class can produce warnings\n    }\n    async get_header() {\n        return null; // Reimplement if your class can provide input header\n    }\n}\n\n\nclass RBQLOutputWriter {\n    constructor(){}\n\n    async write(fields) {\n        throw new Error(\"Unable to call the interface method\");\n    }\n\n    async finish() {\n        // Reimplement if your class needs to do something on finish e.g. cleanup\n    };\n\n    get_warnings() {\n        return []; // Reimplement if your class can produce warnings\n    };\n\n    set_header() {\n        return; // Reimplement if your class can handle output headers in a meaningful way\n    }\n}\n\n\nclass RBQLTableRegistry {\n    constructor(){}\n\n    get_iterator_by_table_id(table_id) {\n        throw new Error(\"Unable to call the interface method\");\n    }\n\n    get_warnings() {\n        return []; // Reimplement if your class can produce warnings\n    };\n}\n\n\nclass TableIterator extends RBQLInputIterator {\n    constructor(table, column_names=null, normalize_column_names=true, variable_prefix='a') {\n        super();\n        this.table = table;\n        this.column_names = column_names;\n        this.normalize_column_names = normalize_column_names;\n        this.variable_prefix = variable_prefix;\n        this.nr = 0;\n        this.fields_info = new Map();\n        this.stopped = false;\n    }\n\n\n    stop() {\n        this.stopped = true;\n    };\n\n\n    async get_variables_map(query_text) {\n        let variable_map = new Object();\n        parse_basic_variables(query_text, this.variable_prefix, variable_map);\n        parse_array_variables(query_text, this.variable_prefix, variable_map);\n        if (this.column_names !== null) {\n            if (this.table.length && this.column_names.length != this.table[0].length)\n                throw new RbqlIOHandlingError('List of column names and table records have different lengths');\n            if (this.normalize_column_names) {\n                parse_dictionary_variables(query_text, this.variable_prefix, this.column_names, variable_map);\n                parse_attribute_variables(query_text, this.variable_prefix, this.column_names, 'column names list', variable_map);\n            } else {\n                map_variables_directly(query_text, this.column_names, variable_map);\n            }\n        }\n        return variable_map;\n    };\n\n\n    async get_record() {\n        if (this.stopped)\n            return null;\n        if (this.nr >= this.table.length)\n            return null;\n        let record = this.table[this.nr];\n        this.nr += 1;\n        let num_fields = record.length;\n        if (!this.fields_info.has(num_fields))\n            this.fields_info.set(num_fields, this.nr);\n        return record;\n    };\n\n    get_warnings() {\n        if (this.fields_info.size > 1)\n            return [make_inconsistent_num_fields_warning('input', this.fields_info)];\n        return [];\n    };\n\n    async get_header() {\n        return this.column_names;\n    }\n}\n\n\nclass TableWriter extends RBQLOutputWriter {\n    constructor(external_table) {\n        super();\n        this.table = external_table;\n        this.header = null;\n    }\n\n    async write(fields) {\n        this.table.push(fields);\n        return true;\n    };\n\n    set_header(header) {\n        this.header = header;\n    }\n}\n\n\nclass SingleTableRegistry extends RBQLTableRegistry {\n    constructor(table, column_names=null, normalize_column_names=true, table_id='b') {\n        super();\n        this.table = table;\n        this.table_id = table_id;\n        this.column_names = column_names;\n        this.normalize_column_names = normalize_column_names;\n    }\n\n    get_iterator_by_table_id(table_id) {\n        if (table_id.toLowerCase() !== this.table_id)\n            throw new RbqlIOHandlingError(`Unable to find join table: \"${table_id}\"`);\n        return new TableIterator(this.table, this.column_names, this.normalize_column_names, 'b');\n    };\n}\n\n\nasync function shallow_parse_input_query(query_text, input_iterator, join_tables_registry, query_context) {\n    query_text = cleanup_query(query_text);\n    var [format_expression, string_literals] = separate_string_literals(query_text);\n    format_expression = remove_redundant_table_name(format_expression);\n\n    var rb_actions = separate_actions(format_expression);\n    if (rb_actions.hasOwnProperty(WITH)) {\n        input_iterator.handle_query_modifier(rb_actions[WITH]);\n    }\n    var input_variables_map = await input_iterator.get_variables_map(query_text);\n\n    if (rb_actions.hasOwnProperty(ORDER_BY) && rb_actions.hasOwnProperty(UPDATE))\n        throw new RbqlParsingError('\"ORDER BY\" is not allowed in \"UPDATE\" queries');\n\n    if (rb_actions.hasOwnProperty(GROUP_BY)) {\n        if (rb_actions.hasOwnProperty(ORDER_BY) || rb_actions.hasOwnProperty(UPDATE))\n            throw new RbqlParsingError('\"ORDER BY\", \"UPDATE\" and \"DISTINCT\" keywords are not allowed in aggregate queries');\n        query_context.aggregation_key_expression = '[' + combine_string_literals(rb_actions[GROUP_BY]['text'], string_literals) + ']';\n        query_context.aggregation_stage = 1;\n    }\n\n\n    let input_header = await input_iterator.get_header();\n    let join_variables_map = null;\n    let join_header = null;\n    if (rb_actions.hasOwnProperty(JOIN)) {\n        var [rhs_table_id, variable_pairs] = parse_join_expression(rb_actions[JOIN]['text']);\n        if (join_tables_registry === null)\n            throw new RbqlParsingError('JOIN operations are not supported by the application');\n        let join_record_iterator = join_tables_registry.get_iterator_by_table_id(rhs_table_id);\n        if (!join_record_iterator)\n            throw new RbqlParsingError(`Unable to find join table: \"${rhs_table_id}\"`);\n        if (rb_actions.hasOwnProperty(WITH)) {\n            join_record_iterator.handle_query_modifier(rb_actions[WITH]);\n        }\n        join_variables_map = await join_record_iterator.get_variables_map(query_text);\n        join_header = await join_record_iterator.get_header();\n        if (input_header === null && join_header !== null) {\n            throw new RbqlIOHandlingError('Inconsistent modes: Input table doesn\\'t have a header while the Join table has a header');\n        }\n        if (input_header !== null && join_header === null) {\n            throw new RbqlIOHandlingError('Inconsistent modes: Input table has a header while the Join table doesn\\'t have a header');\n        }\n        let [lhs_variables, rhs_indices] = resolve_join_variables(input_variables_map, join_variables_map, variable_pairs, string_literals);\n        let sql_join_type = {'JOIN': InnerJoiner, 'INNER JOIN': InnerJoiner, 'LEFT JOIN': LeftJoiner, 'LEFT OUTER JOIN': LeftJoiner, 'STRICT LEFT JOIN': StrictLeftJoiner}[rb_actions[JOIN]['join_subtype']];\n        query_context.lhs_join_var_expression = lhs_variables.length == 1 ? lhs_variables[0] : 'JSON.stringify([' + lhs_variables.join(',') + '])';\n        query_context.join_map_impl = new HashJoinMap(join_record_iterator, rhs_indices);\n        await query_context.join_map_impl.build();\n        query_context.join_map = new sql_join_type(query_context.join_map_impl);\n    }\n\n    query_context.variables_init_code = combine_string_literals(generate_init_statements(format_expression, input_variables_map, join_variables_map, ' '.repeat(4)), string_literals);\n\n    if (rb_actions.hasOwnProperty(WHERE)) {\n        var where_expression = rb_actions[WHERE]['text'];\n        if (/[^><!=]=[^=]/.exec(where_expression))\n            throw new RbqlParsingError('Assignments \"=\" are not allowed in \"WHERE\" expressions. For equality test use \"==\" or \"===\"');\n        query_context.where_expression = combine_string_literals(where_expression, string_literals);\n    }\n\n    if (rb_actions.hasOwnProperty(UPDATE)) {\n        var update_expression = translate_update_expression(rb_actions[UPDATE]['text'], input_variables_map, string_literals, ' '.repeat(8));\n        query_context.update_expressions = combine_string_literals(update_expression, string_literals);\n        query_context.writer.set_header(input_header);\n    }\n\n    if (rb_actions.hasOwnProperty(SELECT)) {\n        query_context.top_count = find_top(rb_actions);\n        if (rb_actions.hasOwnProperty(EXCEPT)) {\n            if (rb_actions.hasOwnProperty(JOIN)) {\n                throw new RbqlParsingError('EXCEPT and JOIN are not allowed in the same query');\n            }\n            let [output_header, select_expression] = translate_except_expression(rb_actions[EXCEPT]['text'], input_variables_map, string_literals, input_header);\n            query_context.select_expression = select_expression;\n            query_context.writer.set_header(output_header);\n        } else {\n            let [select_expression, select_expression_for_header] = translate_select_expression(rb_actions[SELECT]['text']);\n            query_context.select_expression = combine_string_literals(select_expression, string_literals);\n            let column_infos = adhoc_parse_select_expression_to_column_infos(select_expression_for_header, string_literals);\n            let output_header = select_output_header(input_header, join_header, column_infos);\n            query_context.writer.set_header(output_header);\n        }\n\n        query_context.writer = new TopWriter(query_context.writer, query_context.top_count);\n        if (rb_actions[SELECT].hasOwnProperty('distinct_count')) {\n            query_context.writer = new UniqCountWriter(query_context.writer);\n        } else if (rb_actions[SELECT].hasOwnProperty('distinct')) {\n            query_context.writer = new UniqWriter(query_context.writer);\n        }\n    }\n\n    if (rb_actions.hasOwnProperty(ORDER_BY)) {\n        query_context.sort_key_expression = combine_string_literals(rb_actions[ORDER_BY]['text'], string_literals);\n        let reverse_sort = rb_actions[ORDER_BY]['reverse'];\n        query_context.writer = new SortedWriter(query_context.writer, reverse_sort);\n    }\n}\n\n\nasync function query(query_text, input_iterator, output_writer, output_warnings, join_tables_registry=null, user_init_code='') {\n    query_context = new RBQLContext(query_text, input_iterator, output_writer, user_init_code);\n    await shallow_parse_input_query(query_text, input_iterator, join_tables_registry, query_context);\n    await compile_and_run(query_context);\n    await query_context.writer.finish();\n    output_warnings.push(...input_iterator.get_warnings());\n    if (query_context.join_map_impl)\n        output_warnings.push(...query_context.join_map_impl.get_warnings());\n    output_warnings.push(...output_writer.get_warnings());\n}\n\n\nasync function query_table(query_text, input_table, output_table, output_warnings, join_table=null, input_column_names=null, join_column_names=null, output_column_names=null, normalize_column_names=true, user_init_code='') {\n    if (!normalize_column_names && input_column_names !== null && join_column_names !== null)\n        ensure_no_ambiguous_variables(query_text, input_column_names, join_column_names);\n    let input_iterator = new TableIterator(input_table, input_column_names, normalize_column_names);\n    let output_writer = new TableWriter(output_table);\n    let join_tables_registry = join_table === null ? null : new SingleTableRegistry(join_table, join_column_names, normalize_column_names);\n    await query(query_text, input_iterator, output_writer, output_warnings, join_tables_registry, user_init_code);\n    if (output_column_names !== null) {\n        assert(output_column_names.length == 0, '`output_column_names` param must be an empty list or null');\n        if (output_writer.header !== null) {\n            for (let column_name of output_writer.header) {\n                output_column_names.push(column_name);\n            }\n        }\n    }\n}\n\n\nfunction exception_to_error_info(e) {\n    let exceptions_type_map = {\n        'RbqlRuntimeError': 'query execution',\n        'RbqlParsingError': 'query parsing',\n        'SyntaxError': 'JS syntax error',\n        'RbqlIOHandlingError': 'IO handling'\n    };\n    let error_type = 'unexpected';\n    if (e.constructor && e.constructor.name && exceptions_type_map.hasOwnProperty(e.constructor.name)) {\n        error_type = exceptions_type_map[e.constructor.name];\n    }\n    let error_msg = e.hasOwnProperty('message') ? e.message : String(e);\n    return [error_type, error_msg];\n}\n\n\nexports.query = query;\nexports.query_table = query_table;\nexports.RBQLInputIterator = RBQLInputIterator;\nexports.RBQLOutputWriter = RBQLOutputWriter;\nexports.RBQLTableRegistry = RBQLTableRegistry;\n\nexports.version = RBQL_VERSION;\nexports.TableIterator = TableIterator;\nexports.TableWriter = TableWriter;\nexports.SingleTableRegistry = SingleTableRegistry;\nexports.exception_to_error_info = exception_to_error_info;\n\n\n// The functions below are exported just for unit tests, they are not part of the rbql API\n// TODO exports through the special unit_test proxy e.g. exports.unit_test.parse_basic_variables = parse_basic_variables;\nexports.parse_basic_variables = parse_basic_variables;\nexports.parse_array_variables = parse_array_variables;\nexports.parse_dictionary_variables = parse_dictionary_variables;\nexports.parse_attribute_variables = parse_attribute_variables;\nexports.get_all_matches = get_all_matches;\nexports.strip_comments = strip_comments;\nexports.separate_actions = separate_actions;\nexports.separate_string_literals = separate_string_literals;\nexports.combine_string_literals = combine_string_literals;\nexports.parse_join_expression = parse_join_expression;\nexports.resolve_join_variables = resolve_join_variables;\nexports.translate_update_expression = translate_update_expression;\nexports.translate_select_expression = translate_select_expression;\nexports.translate_except_expression = translate_except_expression;\nexports.like_to_regex = like_to_regex;\nexports.adhoc_parse_select_expression_to_column_infos = adhoc_parse_select_expression_to_column_infos;\nexports.replace_star_count = replace_star_count;\nexports.replace_star_vars_for_header_parsing = replace_star_vars_for_header_parsing;\nexports.select_output_header = select_output_header;\nexports.sample_first_two_inconsistent_records = sample_first_two_inconsistent_records;\n\n}(typeof exports === 'undefined' ? this.rbql = {} : exports));\n","const fs = require('fs');\nconst os = require('os');\nconst path = require('path');\nconst util = require('util');\n\nconst rbql = require('./rbql.js');\nconst csv_utils = require('./csv_utils.js');\n\n\nconst utf_decoding_error = 'Unable to decode input table as UTF-8. Use binary (latin-1) encoding instead';\n\n\nclass RbqlIOHandlingError extends Error {}\nclass AssertionError extends Error {}\n\n\n// TODO performance improvement: replace smart_split() with polymorphic_split()\n\n\nfunction assert(condition, message=null) {\n    if (!condition) {\n        if (!message) {\n            message = 'Assertion error';\n        }\n        throw new AssertionError(message);\n    }\n}\n\n\nfunction interpret_named_csv_format(format_name) {\n    format_name = format_name.toLowerCase();\n    if (format_name == 'monocolumn')\n        return ['', 'monocolumn'];\n    if (format_name == 'csv')\n        return [',', 'quoted'];\n    if (format_name == 'tsv')\n        return ['\\t', 'simple'];\n    throw new RbqlIOHandlingError(`Unknown format name: \"${format_name}\"`);\n}\n\n\n\nfunction is_ascii(str) {\n    return /^[\\x00-\\x7F]*$/.test(str);\n}\n\n\nfunction read_user_init_code(rbql_init_source_path) {\n    return fs.readFileSync(rbql_init_source_path, 'utf-8');\n}\n\n\nfunction remove_utf8_bom(line, assumed_source_encoding) {\n    if (assumed_source_encoding == 'binary' && line.length >= 3 && line.charCodeAt(0) === 0xEF && line.charCodeAt(1) === 0xBB && line.charCodeAt(2) === 0xBF) {\n        return line.substring(3);\n    }\n    if (assumed_source_encoding == 'utf-8' && line.length >= 1 && line.charCodeAt(0) === 0xFEFF) {\n        return line.substring(1);\n    }\n    return line;\n}\n\n\nfunction make_inconsistent_num_fields_warning(table_name, inconsistent_records_info) {\n    let [record_num_1, num_fields_1, record_num_2, num_fields_2] = rbql.sample_first_two_inconsistent_records(inconsistent_records_info);\n    let warn_msg = `Number of fields in \"${table_name}\" table is not consistent: `;\n    warn_msg += `e.g. record ${record_num_1} -> ${num_fields_1} fields, record ${record_num_2} -> ${num_fields_2} fields`;\n    return warn_msg;\n}\n\n\nfunction expanduser(filepath) {\n    if (filepath.charAt(0) === '~') {\n        return path.join(os.homedir(), filepath.slice(1));\n    }\n    return filepath;\n}\n\n\nfunction try_read_index(index_path) {\n    var content = null;\n    try {\n        content = fs.readFileSync(index_path, 'utf-8');\n    } catch (e) {\n        return [];\n    }\n    var lines = content.split('\\n');\n    var records = [];\n    for (var i = 0; i < lines.length; i++) {\n        if (!lines[i])\n            continue;\n        var record = lines[i].split('\\t');\n        records.push(record);\n    }\n    return records;\n}\n\n\nfunction get_index_record(index_path, key) {\n    var records = try_read_index(index_path);\n    for (var i = 0; i < records.length; i++) {\n        if (records[i].length && records[i][0] == key) {\n            return records[i];\n        }\n    }\n    return null;\n}\n\n\nfunction find_table_path(main_table_dir, table_id) {\n    // If table_id is a relative path it could be relative either to the current directory or to the main table dir.\n    var candidate_path = expanduser(table_id);\n    if (fs.existsSync(candidate_path)) {\n        return candidate_path;\n    }\n    if (main_table_dir && !path.isAbsolute(candidate_path)) {\n        candidate_path = path.join(main_table_dir, candidate_path);\n        if (fs.existsSync(candidate_path)) {\n            return candidate_path;\n        }\n    }\n    let table_names_settings_path = path.join(os.homedir(), '.rbql_table_names');\n    var name_record = get_index_record(table_names_settings_path, table_id);\n    if (name_record && name_record.length > 1 && fs.existsSync(name_record[1])) {\n        return name_record[1];\n    }\n    return null;\n}\n\n\nclass RecordQueue {\n    // TODO compare performance with a linked list\n    constructor() {\n        this.push_stack = [];\n        this.pull_stack = [];\n    }\n\n    enqueue(record) {\n        this.push_stack.push(record);\n    }\n\n    dequeue() {\n        if (!this.pull_stack.length) {\n            if (!this.push_stack.length)\n                return null;\n            this.pull_stack = this.push_stack;\n            this.pull_stack.reverse();\n            this.push_stack = [];\n        }\n        return this.pull_stack.pop();\n    }\n}\n\n\nclass CSVRecordIterator extends rbql.RBQLInputIterator {\n    // CSVRecordIterator implements a typical async producer-consumer model with an internal buffer:\n    // get_record() - consumer\n    // stream.on('data') - producer\n    constructor(stream, csv_path, encoding, delim, policy, has_header=false, comment_prefix=null, table_name='input', variable_prefix='a') {\n        super();\n        this.stream = stream;\n        this.csv_path = csv_path;\n        assert((this.stream === null) != (this.csv_path === null));\n        this.encoding = encoding;\n        this.delim = delim;\n        this.policy = policy;\n\n        this.has_header = has_header;\n        this.first_record = null;\n        this.first_record_should_be_emitted = !has_header;\n        this.header_preread_complete = false;\n\n        this.table_name = table_name;\n        this.variable_prefix = variable_prefix;\n        this.comment_prefix = comment_prefix;\n\n        this.decoder = null;\n        if (encoding == 'utf-8' && this.csv_path === null) {\n            // Unfortunately util.TextDecoder has serious flaws:\n            // 1. It doesn't work in Node without ICU: https://nodejs.org/api/util.html#util_new_textdecoder_encoding_options\n            // 2. It is broken in Electron: https://github.com/electron/electron/issues/18733\n\n            // Technically we can implement our own custom streaming text decoder, using the 3 following technologies:\n            // 1. decode-encode validation method from https://stackoverflow.com/a/32279283/2898283\n            // 2. Scanning buffer chunks for non-continuation utf-8 bytes from the end of the buffer:\n            //    src_buffer -> (buffer_before, buffer_after) where buffer_after is very small(a couple of bytes) and buffer_before is large and ends with a non-continuation bytes\n            // 3. Internal buffer to store small tail part from the previous buffer\n            this.decoder = new util.TextDecoder(encoding, {fatal: true, stream: true});\n        }\n\n        this.input_exhausted = false;\n        this.started = false;\n\n        this.utf8_bom_removed = false; // BOM doesn't get automatically removed by the decoder when utf-8 file is treated as latin-1\n        this.first_defective_line = null;\n\n        this.fields_info = new Map();\n        this.NR = 0; // Record number\n        this.NL = 0; // Line number (NL != NR when the CSV file has comments or multiline fields)\n\n        this.line_aggregator = new csv_utils.MultilineRecordAggregator(comment_prefix);\n\n        this.partially_decoded_line = '';\n        this.partially_decoded_line_ends_with_cr = false;\n\n        // Holds an external \"resolve\" function which is called when everything is fine.\n        this.resolve_current_record = null;\n        // Holds an external \"reject\" function which is called when error has occured.\n        this.reject_current_record = null;\n        // Holds last exception if we don't have any reject callbacks from clients yet.\n        this.current_exception = null;\n\n        this.produced_records_queue = new RecordQueue();\n\n        this.process_line_polymorphic = policy == 'quoted_rfc' ? this.process_partial_rfc_record_line : this.process_record_line_simple;\n    }\n\n\n    handle_query_modifier(modifier) {\n        // For `... WITH (header) ...` syntax\n        if (['header', 'headers'].indexOf(modifier) != -1) {\n            this.has_header = true;\n            this.first_record_should_be_emitted = false;\n        }\n        if (['noheader', 'noheaders'].indexOf(modifier) != -1) {\n            this.has_header = false;\n            this.first_record_should_be_emitted = true;\n        }\n    }\n\n\n    reset_external_callbacks() {\n        // Drop external callbacks simultaneously since promises can only resolve once, see: https://stackoverflow.com/a/18218542/2898283\n        this.reject_current_record = null;\n        this.resolve_current_record = null;\n    }\n\n    try_propagate_exception() {\n        if (this.current_exception && this.reject_current_record) {\n            let reject = this.reject_current_record;\n            let exception = this.current_exception;\n            this.reset_external_callbacks();\n            this.current_exception = null;\n            reject(exception);\n        }\n    }\n\n\n    store_or_propagate_exception(exception) {\n        if (this.current_exception === null)\n            // Ignore subsequent exceptions if we already have an unreported error. This way we prioritize earlier errors over the more recent ones.\n            this.current_exception = exception;\n        this.try_propagate_exception();\n    }\n\n\n    async preread_first_record() {\n        if (this.header_preread_complete)\n            return;\n        this.first_record = await this.get_record();\n        this.header_preread_complete = true; // We must set header_preread_complete to true after calling get_record(), because get_record() uses it internally.\n        if (this.first_record === null) {\n            return;\n        }\n        if (this.stream)\n            this.stream.pause();\n        this.first_record = this.first_record.slice();\n    };\n\n\n    async get_variables_map(query_text) {\n        let variable_map = new Object();\n        rbql.parse_basic_variables(query_text, this.variable_prefix, variable_map);\n        rbql.parse_array_variables(query_text, this.variable_prefix, variable_map);\n\n        await this.preread_first_record();\n        if (this.has_header && this.first_record) {\n            rbql.parse_attribute_variables(query_text, this.variable_prefix, this.first_record, 'CSV header line', variable_map);\n            rbql.parse_dictionary_variables(query_text, this.variable_prefix, this.first_record, variable_map);\n        }\n        return variable_map;\n    };\n\n    async get_header() {\n        await this.preread_first_record();\n        return this.has_header ? this.first_record : null;\n    }\n\n\n    try_resolve_next_record() {\n        this.try_propagate_exception();\n        if (this.resolve_current_record === null)\n            return;\n\n        let record = null;\n        if (this.first_record_should_be_emitted && this.header_preread_complete) {\n            this.first_record_should_be_emitted = false;\n            record = this.first_record;\n        } else {\n            record = this.produced_records_queue.dequeue();\n        }\n\n        if (record === null && !this.input_exhausted)\n            return;\n        let resolve = this.resolve_current_record;\n        this.reset_external_callbacks();\n        resolve(record);\n    };\n\n\n    async get_record() {\n        if (!this.started)\n            await this.start();\n        if (this.stream && this.stream.isPaused())\n            this.stream.resume();\n\n        let parent_iterator = this;\n        let current_record_promise = new Promise(function(resolve, reject) {\n            parent_iterator.resolve_current_record = resolve;\n            parent_iterator.reject_current_record = reject;\n        });\n        this.try_resolve_next_record();\n        return current_record_promise;\n    };\n\n\n    async get_all_records(num_records=null) {\n        let records = [];\n        while (true) {\n            let record = await this.get_record();\n            if (record === null)\n                break;\n            records.push(record);\n            if (num_records && records.length >= num_records) {\n                this.stop();\n                break;\n            }\n        }\n        return records;\n    };\n\n\n    process_record_line_simple(line) {\n        if (this.comment_prefix && line.startsWith(this.comment_prefix))\n            return; // Just skip the line\n        this.process_record_line(line);\n    }\n\n\n    process_record_line(line) {\n        this.NR += 1;\n        var [record, warning] = csv_utils.smart_split(line, this.delim, this.policy, false);\n        if (warning) {\n            if (this.first_defective_line === null) {\n                this.first_defective_line = this.NL;\n                if (this.policy == 'quoted_rfc')\n                    this.store_or_propagate_exception(new RbqlIOHandlingError(`Inconsistent double quote escaping in ${this.table_name} table at record ${this.NR}, line ${this.NL}`));\n            }\n        }\n        let num_fields = record.length;\n        if (!this.fields_info.has(num_fields))\n            this.fields_info.set(num_fields, this.NR);\n        this.produced_records_queue.enqueue(record);\n        this.try_resolve_next_record();\n    };\n\n\n    process_partial_rfc_record_line(line) {\n        this.line_aggregator.add_line(line);\n        if (this.line_aggregator.has_comment_line) {\n            this.line_aggregator.reset();\n        } else if (this.line_aggregator.has_full_record) {\n            this.process_record_line(this.line_aggregator.get_full_line('\\n'));\n            this.line_aggregator.reset();\n        }\n    };\n\n\n    process_line(line) {\n        this.NL += 1;\n        if (this.NL === 1) {\n            var clean_line = remove_utf8_bom(line, this.encoding);\n            if (clean_line != line) {\n                line = clean_line;\n                this.utf8_bom_removed = true;\n            }\n        }\n        this.process_line_polymorphic(line);\n    };\n\n\n    process_data_stream_chunk(data_chunk) {\n        let decoded_string = null;\n        if (this.decoder) {\n            try {\n                decoded_string = this.decoder.decode(data_chunk);\n            } catch (e) {\n                if (e instanceof TypeError) {\n                    this.store_or_propagate_exception(new RbqlIOHandlingError(utf_decoding_error));\n                } else {\n                    this.store_or_propagate_exception(e);\n                }\n                return;\n            }\n        } else {\n            decoded_string = data_chunk.toString(this.encoding);\n        }\n        let line_starts_with_lf = decoded_string.length && decoded_string[0] == '\\n';\n        let first_line_index = line_starts_with_lf && this.partially_decoded_line_ends_with_cr ? 1 : 0;\n        this.partially_decoded_line_ends_with_cr = decoded_string.length && decoded_string[decoded_string.length - 1] == '\\r';\n        let lines = csv_utils.split_lines(decoded_string);\n        lines[0] = this.partially_decoded_line + lines[0];\n        assert(first_line_index == 0 || lines[0].length == 0);\n        this.partially_decoded_line = lines.pop();\n        for (let i = first_line_index; i < lines.length; i++) {\n            this.process_line(lines[i]);\n        }\n    };\n\n\n    process_data_bulk(data_blob) {\n        let decoded_string = data_blob.toString(this.encoding);\n        if (this.encoding == 'utf-8') {\n            // Using hacky comparison method from here: https://stackoverflow.com/a/32279283/2898283\n            // TODO get rid of this once TextDecoder is really fixed or when alternative method of reliable decoding appears\n            let control_buffer = Buffer.from(decoded_string, 'utf-8');\n            if (Buffer.compare(data_blob, control_buffer) != 0) {\n                this.store_or_propagate_exception(new RbqlIOHandlingError(utf_decoding_error));\n                return;\n            }\n        }\n        let lines = csv_utils.split_lines(decoded_string);\n        if (lines.length && lines[lines.length - 1].length == 0)\n            lines.pop();\n        for (let i = 0; i < lines.length; i++) {\n            this.process_line(lines[i]);\n        }\n        if (this.line_aggregator.is_inside_multiline_record()) {\n            this.process_record_line(this.line_aggregator.get_full_line('\\n'));\n        }\n        this.input_exhausted = true;\n        this.try_resolve_next_record(); // Should be a NOOP here?\n    }\n\n\n    process_data_stream_end() {\n        this.input_exhausted = true;\n        if (this.partially_decoded_line.length) {\n            let last_line = this.partially_decoded_line;\n            this.partially_decoded_line = '';\n            this.process_line(last_line);\n        }\n        if (this.line_aggregator.is_inside_multiline_record()) {\n            this.process_record_line(this.line_aggregator.get_full_line('\\n'));\n        }\n        this.try_resolve_next_record();\n    };\n\n\n    stop() {\n        if (this.stream)\n            this.stream.destroy(); // TODO consider using pause() instead\n    };\n\n\n    async start() {\n        if (this.started)\n            return;\n        this.started = true;\n        if (this.stream) {\n            this.stream.on('data', (data_chunk) => { this.process_data_stream_chunk(data_chunk); });\n            this.stream.on('end', () => { this.process_data_stream_end(); });\n        } else {\n            let parent_iterator = this;\n            return new Promise(function(resolve, reject) {\n                fs.readFile(parent_iterator.csv_path, (err, data_blob) => {\n                    if (err) {\n                        reject(err);\n                    } else {\n                        parent_iterator.process_data_bulk(data_blob);\n                        resolve();\n                    }\n                });\n            });\n        }\n    };\n\n\n    get_warnings() {\n        let result = [];\n        if (this.first_defective_line !== null)\n            result.push(`Inconsistent double quote escaping in ${this.table_name} table. E.g. at line ${this.first_defective_line}`);\n        if (this.utf8_bom_removed)\n            result.push(`UTF-8 Byte Order Mark (BOM) was found and skipped in ${this.table_name} table`);\n        if (this.fields_info.size > 1)\n            result.push(make_inconsistent_num_fields_warning(this.table_name, this.fields_info));\n        return result;\n    };\n}\n\n\nclass CSVWriter extends rbql.RBQLOutputWriter {\n    constructor(stream, close_stream_on_finish, encoding, delim, policy, line_separator='\\n') {\n        super();\n        this.stream = stream;\n        this.encoding = encoding;\n        if (encoding)\n            this.stream.setDefaultEncoding(encoding);\n        this.stream.on('error', (error_obj) => { this.store_first_error(error_obj); })\n        this.delim = delim;\n        this.policy = policy;\n        this.line_separator = line_separator;\n        this.sub_array_delim = delim == '|' ? ';' : '|';\n\n        this.close_stream_on_finish = close_stream_on_finish;\n\n        this.null_in_output = false;\n        this.delim_in_simple_output = false;\n        this.header_len = null;\n        this.first_error = null;\n\n        if (policy == 'simple') {\n            this.polymorphic_join = this.simple_join;\n        } else if (policy == 'quoted') {\n            this.polymorphic_join = this.quoted_join;\n        } else if (policy == 'quoted_rfc') {\n            this.polymorphic_join = this.quoted_join_rfc;\n        } else if (policy == 'monocolumn') {\n            this.polymorphic_join = this.mono_join;\n        } else if (policy == 'whitespace') {\n            this.polymorphic_join = this.simple_join;\n        } else {\n            throw new RbqlIOHandlingError('Unknown output csv policy');\n        }\n    }\n\n\n    store_first_error(error_obj) {\n        // Store only first error because it is typically more important than the subsequent ones.\n        if (this.first_error === null)\n            this.first_error = error_obj;\n    }\n\n    set_header(header) {\n        if (header !== null) {\n            this.header_len = header.length;\n            this.write(header);\n        }\n    }\n\n\n    quoted_join(fields) {\n        let delim = this.delim;\n        var quoted_fields = fields.map(function(v) { return csv_utils.quote_field(String(v), delim); });\n        return quoted_fields.join(this.delim);\n    };\n\n\n    quoted_join_rfc(fields) {\n        let delim = this.delim;\n        var quoted_fields = fields.map(function(v) { return csv_utils.rfc_quote_field(String(v), delim); });\n        return quoted_fields.join(this.delim);\n    };\n\n\n    mono_join(fields) {\n        if (fields.length > 1) {\n            throw new RbqlIOHandlingError('Unable to use \"Monocolumn\" output format: some records have more than one field');\n        }\n        return fields[0];\n    };\n\n\n    simple_join(fields) {\n        var res = fields.join(this.delim);\n        if (fields.join('').indexOf(this.delim) != -1) {\n            this.delim_in_simple_output = true;\n        }\n        return res;\n    };\n\n\n    normalize_fields(out_fields) {\n        for (var i = 0; i < out_fields.length; i++) {\n            if (out_fields[i] == null) {\n                this.null_in_output = true;\n                out_fields[i] = '';\n            } else if (Array.isArray(out_fields[i])) {\n                this.normalize_fields(out_fields[i]);\n                out_fields[i] = out_fields[i].join(this.sub_array_delim);\n            }\n        }\n    };\n\n\n    async write(fields) {\n        if (this.header_len !== null && fields.length != this.header_len)\n            throw new RbqlIOHandlingError(`Inconsistent number of columns in output header and the current record: ${this.header_len} != ${fields.length}`);\n        this.normalize_fields(fields);\n        this.stream.write(this.polymorphic_join(fields));\n        this.stream.write(this.line_separator);\n        let writer_error = this.first_error;\n        return new Promise(function(resolve, reject) {\n            if (writer_error !== null) {\n                reject(writer_error);\n            } else {\n                resolve(true);\n            }\n        });\n    };\n\n\n    _write_all(table) {\n        for (let i = 0; i < table.length; i++) {\n            this.write(table[i]);\n        }\n    };\n\n\n    async finish() {\n        let close_stream_on_finish = this.close_stream_on_finish;\n        let output_stream = this.stream;\n        let output_encoding = this.encoding;\n        let writer_error = this.first_error;\n        let finish_promise = new Promise(function(resolve, reject) {\n            if (writer_error !== null) {\n                reject(writer_error);\n            }\n            if (close_stream_on_finish) {\n                output_stream.end('', output_encoding, () => { resolve(); });\n            } else {\n                setTimeout(() => { resolve(); }, 0);\n            }\n        });\n        return finish_promise;\n    };\n\n\n    get_warnings() {\n        let result = [];\n        if (this.null_in_output)\n            result.push('null values in output were replaced by empty strings');\n        if (this.delim_in_simple_output)\n            result.push('Some output fields contain separator');\n        return result;\n    };\n\n}\n\n\nclass FileSystemCSVRegistry extends rbql.RBQLTableRegistry {\n    constructor(input_file_dir, delim, policy, encoding, has_header=false, comment_prefix=null, options=null) {\n        super();\n        this.input_file_dir = input_file_dir;\n        this.delim = delim;\n        this.policy = policy;\n        this.encoding = encoding;\n        this.has_header = has_header;\n        this.comment_prefix = comment_prefix;\n        this.stream = null;\n        this.record_iterator = null;\n\n        this.options = options;\n        this.bulk_input_path = null;\n        this.table_path = null;\n    }\n\n    get_iterator_by_table_id(table_id) {\n        this.table_path = find_table_path(this.input_file_dir, table_id);\n        if (this.table_path === null) {\n            throw new RbqlIOHandlingError(`Unable to find join table \"${table_id}\"`);\n        }\n        if (this.options && this.options['bulk_read']) {\n            this.bulk_input_path = this.table_path;\n        } else {\n            this.stream = fs.createReadStream(this.table_path);\n        }\n        this.record_iterator = new CSVRecordIterator(this.stream, this.bulk_input_path, this.encoding, this.delim, this.policy, this.has_header, this.comment_prefix, table_id, 'b');\n        return this.record_iterator;\n    };\n\n    get_warnings(output_warnings) {\n        if (this.record_iterator && this.has_header) {\n            output_warnings.push(`The first record in JOIN file ${path.basename(this.table_path)} was also treated as header (and skipped)`);\n        }\n    }\n}\n\n\nasync function query_csv(query_text, input_path, input_delim, input_policy, output_path, output_delim, output_policy, csv_encoding, output_warnings, with_headers=false, comment_prefix=null, user_init_code='', options=null) {\n    let input_stream = null;\n    let bulk_input_path = null;\n    if (options && options['bulk_read'] && input_path) {\n        bulk_input_path = input_path;\n    } else {\n        input_stream = input_path === null ? process.stdin : fs.createReadStream(input_path);\n    }\n    let [output_stream, close_output_on_finish] = output_path === null ? [process.stdout, false] : [fs.createWriteStream(output_path), true];\n    if (input_delim == '\"' && input_policy == 'quoted')\n        throw new RbqlIOHandlingError('Double quote delimiter is incompatible with \"quoted\" policy');\n    if (csv_encoding == 'latin-1')\n        csv_encoding = 'binary';\n    if (!is_ascii(query_text) && csv_encoding == 'binary')\n        throw new RbqlIOHandlingError('To use non-ascii characters in query enable UTF-8 encoding instead of latin-1/binary');\n    if ((!is_ascii(input_delim) || !is_ascii(output_delim)) && csv_encoding == 'binary')\n        throw new RbqlIOHandlingError('To use non-ascii characters in query enable UTF-8 encoding instead of latin-1/binary');\n\n    let default_init_source_path = path.join(os.homedir(), '.rbql_init_source.js');\n    if (user_init_code == '' && fs.existsSync(default_init_source_path)) {\n        user_init_code = read_user_init_code(default_init_source_path);\n    }\n    let input_file_dir = input_path ? path.dirname(input_path) : null;\n    let join_tables_registry = new FileSystemCSVRegistry(input_file_dir, input_delim, input_policy, csv_encoding, with_headers, comment_prefix, options);\n    let input_iterator = new CSVRecordIterator(input_stream, bulk_input_path, csv_encoding, input_delim, input_policy, with_headers, comment_prefix);\n    let output_writer = new CSVWriter(output_stream, close_output_on_finish, csv_encoding, output_delim, output_policy);\n\n    await rbql.query(query_text, input_iterator, output_writer, output_warnings, join_tables_registry, user_init_code);\n    join_tables_registry.get_warnings(output_warnings);\n}\n\n\nmodule.exports.is_ascii = is_ascii;\nmodule.exports.CSVRecordIterator = CSVRecordIterator;\nmodule.exports.CSVWriter = CSVWriter;\nmodule.exports.FileSystemCSVRegistry = FileSystemCSVRegistry;\nmodule.exports.interpret_named_csv_format = interpret_named_csv_format;\nmodule.exports.read_user_init_code = read_user_init_code;\nmodule.exports.query_csv = query_csv;\nmodule.exports.RecordQueue = RecordQueue;\nmodule.exports.exception_to_error_info = rbql.exception_to_error_info;\n","module.exports = require(\"vscode\");","'use strict';\n\nvar possibleNames = require('possible-typed-array-names');\n\nvar g = typeof globalThis === 'undefined' ? global : globalThis;\n\n/** @type {import('.')} */\nmodule.exports = function availableTypedArrays() {\n\tvar /** @type {ReturnType<typeof availableTypedArrays>} */ out = [];\n\tfor (var i = 0; i < possibleNames.length; i++) {\n\t\tif (typeof g[possibleNames[i]] === 'function') {\n\t\t\t// @ts-expect-error\n\t\t\tout[out.length] = possibleNames[i];\n\t\t}\n\t}\n\treturn out;\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","const vscode = require('vscode');\n\nconst path = require('path');\nconst fs = require('fs');\nconst os = require('os');\nconst child_process = require('child_process');\n\nconst fast_load_utils = require('./fast_load_utils.js');\n\n// See DEV_README.md file for additional info.\n\n\nconst csv_utils = require('./rbql_core/rbql-js/csv_utils.js');\n\nvar rbql_csv = null; // Using lazy load to improve startup performance.\nfunction ll_rbql_csv() {\n    if (rbql_csv === null)\n        rbql_csv = require('./rbql_core/rbql-js/rbql_csv.js');\n    return rbql_csv;\n}\n\n\nvar rainbow_utils = null; // Using lazy load to improve startup performance.\nfunction ll_rainbow_utils() {\n    if (rainbow_utils === null) {\n        rainbow_utils = require('./rainbow_utils.js');\n    }\n    return rainbow_utils;\n}\n\nconst is_web_ext = (os.homedir === undefined); // Runs as web extension in browser.\nvar web_extension_uri = null;\nconst preview_window_size = 100;\nconst scratch_buf_marker = 'vscode_rbql_scratch';\nconst dynamic_csv_highlight_margin = 50; // TODO make configurable\n\nvar aligned_files = new Set();\nvar result_set_parent_map = new Map();\nvar cached_table_parse_result = new Map(); // TODO store doc timestamp / size to invalidate the entry when the doc changes.\nvar manual_comment_prefix_stoplist = new Set();\n\nvar rbql_status_bar_button = null;\nvar align_shrink_button = null;\nvar rainbow_off_status_bar_button = null;\nvar rainbow_on_status_bar_button = null;\nvar copy_back_button = null;\nvar column_info_button = null;\nvar dynamic_dialect_select_button = null;\n\nvar rbql_context = null;\n\nvar debug_log_output_channel = null;\n\nvar last_rbql_queries = new Map(); // Query history does not replace this structure, it is also used to store partially entered queries for preview window switch.\n\nvar client_html_template = null;\nvar dialect_selection_html_template = null;\n\n// This `global_state` is persistent across VSCode restarts.\nvar global_state = null;\n\nvar rbql_preview_panel = null;\nvar dialect_panel = null;\n\nvar doc_first_edit_subscription = null;\nvar keyboard_cursor_subscription = null;\n\nvar last_closed_rainbow_doc_info = null;\n\nvar _unit_test_last_rbql_report = null; // For unit tests only.\nvar _unit_test_last_warnings = null; // For unit tests only.\n\nlet cursor_timeout_handle = null;\n\nlet rainbow_token_event = null;\nlet comment_token_event = null;\nlet sticky_header_disposable = null;\n\nconst PLAINTEXT = 'plaintext';\nconst DYNAMIC_CSV = 'dynamic csv';\n\nconst QUOTED_POLICY = 'quoted';\nconst WHITESPACE_POLICY = 'whitespace';\nconst QUOTED_RFC_POLICY = 'quoted_rfc';\nconst SIMPLE_POLICY = 'simple';\n\n\nlet extension_context = {\n    lint_results: new Map(),\n    lint_status_bar_button: null,\n    dynamic_document_dialects: new Map(),\n    custom_comment_prefixes: new Map(), // TODO consider making custom comment prefixes records persistent.\n    original_language_ids: new Map(),\n    reenable_rainbow_language_infos: new Map(), // This only needed for \"Rainbow On\" functionality that reverts \"Rainbow Off\" effect.\n    autodetection_stoplist: new Set(),\n    autodetection_temporarily_disabled_for_rbql: false,\n    dynamic_dialect_for_next_request: null,\n    logging_enabled: false,\n    logging_next_context_id: 1,\n};\n\nconst dialect_map = {\n    'csv': [',', QUOTED_POLICY],\n    'tsv': ['\\t', SIMPLE_POLICY],\n    'csv (semicolon)': [';', QUOTED_POLICY],\n    'csv (pipe)': ['|', SIMPLE_POLICY],\n    'csv (whitespace)': [' ', WHITESPACE_POLICY],\n    [DYNAMIC_CSV]: [null, null]\n};\n\n\nconst COMMENT_TOKEN = 'comment';\nconst rainbow_token_types = ['rainbow1', 'rainbow2', 'rainbow3', 'rainbow4', 'rainbow5', 'rainbow6', 'rainbow7', 'rainbow8', 'rainbow9', 'rainbow10'];\nconst all_token_types = rainbow_token_types.concat([COMMENT_TOKEN]);\nconst tokens_legend = new vscode.SemanticTokensLegend(all_token_types);\n\n\nfunction is_eligible_scheme(vscode_doc)  {\n    // Make sure that the the doc has a valid scheme.\n    // We don't want to handle virtual docs and docs created by other extensions, see https://code.visualstudio.com/api/extension-guides/virtual-documents#events-and-visibility and https://github.com/mechatroner/vscode_rainbow_csv/issues/123\n    // VScode also opens pairing virtual `.git` documents for git-controlled files that we also want to skip, see https://github.com/microsoft/vscode/issues/22561.\n    // \"vscode-test-web\" scheme is used for browser unit tests.\n    return vscode_doc && vscode_doc.uri && ['file', 'untitled', 'vscode-test-web'].indexOf(vscode_doc.uri.scheme) != -1;\n}\n\n\nfunction is_eligible_doc(vscode_doc) {\n    // For new untitled scratch documents `fileName` would be \"Untitled-1\", \"Untitled-2\", etc, so we won't enter this branch.\n    return vscode_doc && vscode_doc.uri && vscode_doc.fileName && is_eligible_scheme(vscode_doc);\n}\n\n\nfunction is_rainbow_dialect_doc(vscode_doc) {\n    return is_eligible_doc(vscode_doc) && dialect_map.hasOwnProperty(vscode_doc.languageId);\n}\n\n\nfunction make_dialect_info(delim, policy) {\n    return {'delim': delim, 'policy': policy};\n}\n\n\nfunction make_dynamic_dialect_key(file_path) {\n    return 'dynamic_dialect:' + file_path;\n}\n\n\nasync function save_dynamic_info(extension_context, file_path, dialect_info) {\n    await save_to_global_state(make_dynamic_dialect_key(file_path), dialect_info);\n    extension_context.dynamic_document_dialects.set(file_path, dialect_info);\n}\n\n\nasync function remove_dynamic_info(file_path) {\n    await save_to_global_state(make_dynamic_dialect_key(file_path), undefined);\n    extension_context.dynamic_document_dialects.delete(file_path);\n}\n\n\nfunction get_dynamic_info(file_path) {\n    // Filetypes (lang modes) are not preserved across doc reopen but surprisingly preserved across VSCode restarts so we are also storing them in persistent global state.\n    // Persistent dialect info has some minor drawbacks (e.g. performance also restart not completely resetting the state is an issue by itself in some scenarios) and could be reconsidered if more serious issues are found.\n    if (extension_context.dynamic_document_dialects.has(file_path)) {\n        return extension_context.dynamic_document_dialects.get(file_path);\n    }\n    // Failed to get from the session-local dynamic_document_dialects - check if we have it persistently stored from a previous session.\n    let dialect_info = get_from_global_state(make_dynamic_dialect_key(file_path), null);\n    if (dialect_info && dialect_info.hasOwnProperty('delim') && dialect_info.hasOwnProperty('policy')) {\n        extension_context.dynamic_document_dialects.set(file_path, dialect_info);\n        return dialect_info;\n    }\n    return null;\n}\n\n\nfunction safe_lower(src_str) {\n    if (!src_str)\n        return src_str;\n    return src_str.toLowerCase();\n}\n\n\nfunction get_default_policy(separator) {\n    // This function is most likely a temporal workaround, get rid of it when possible.\n    for (let language_id in dialect_map) {\n        if (!dialect_map.hasOwnProperty(language_id))\n            continue;\n        if (dialect_map[language_id][0] == separator)\n            return dialect_map[language_id][1];\n    }\n    return SIMPLE_POLICY;\n}\n\n\nfunction map_dialect_to_language_id(separator, policy) {\n    for (let language_id in dialect_map) {\n        if (!dialect_map.hasOwnProperty(language_id))\n            continue;\n        if (dialect_map[language_id][0] == separator && dialect_map[language_id][1] == policy)\n            return language_id;\n    }\n    return DYNAMIC_CSV;\n}\n\n\n// This structure will get properly initialized during the startup.\nlet absolute_path_map = {\n    'rbql_client.js': null,\n    'contrib/textarea-caret-position/index.js': null,\n    'rbql_suggest.js': null,\n    'rbql_logo.svg': null,\n    'rbql_client.html': null,\n    'dialect_select.html': null,\n    'dialect_select.js': null,\n    'rbql mock/rbql_mock.py': null,\n    'rbql_core/vscode_rbql.py': null\n};\n\n\nfunction show_single_line_error(error_msg) {\n    var active_window = vscode.window;\n    if (!active_window)\n        return;\n    // Do not \"await\" error messages because the promise gets resolved only on error dismissal.\n    active_window.showErrorMessage(error_msg);\n}\n\n\nfunction sleep(ms) {\n    return new Promise(resolve => setTimeout(resolve, ms));\n}\n\n\nasync function report_progress(progress, status_message) {\n    progress.report({message: status_message});\n    // Push the current stack to the JS callback queue to allow UI update.\n    await sleep(0);\n}\n\n\nfunction get_from_global_state(key, default_value) {\n    // Load KV pair from the \"global state\" which is persistent across VSCode restarts.\n    if (global_state) {\n        var value = global_state.get(key);\n        if (value !== null && value !== undefined)\n            return value;\n    }\n    return default_value;\n}\n\n\nasync function save_to_global_state(key, value) {\n    // Save KV pair to the \"global state\" which is persistent across VSCode restarts.\n    if (global_state && key) {\n        await global_state.update(key, value);\n        return true;\n    }\n    return false;\n}\n\n\nasync function replace_doc_content(active_editor, active_doc, new_content) {\n    let invalid_range = new vscode.Range(0, 0, active_doc.lineCount /* Intentionally missing the '-1' */, 0);\n    let full_range = active_doc.validateRange(invalid_range);\n    await active_editor.edit(edit => edit.replace(full_range, new_content));\n}\n\n\nfunction make_header_key(file_path) {\n    return 'rbql_header_info:' + file_path;\n}\n\n\nfunction make_with_headers_key(file_path) {\n    return 'rbql_with_headers:' + file_path;\n}\n\n\nfunction get_from_config(param_name, default_value, config=null) {\n    if (!config) {\n        config = vscode.workspace.getConfiguration('rainbow_csv');\n    }\n    return config ? config.get(param_name) : default_value;\n}\n\n\nclass StackContextLogWrapper {\n    // Use class instead of pure function to avoid passing context name and checking if logging is enabled in the config in each call.\n    constructor(context_name, caller_context_id=null) {\n        this.context_name = context_name;\n        this.logging_enabled = extension_context.logging_enabled;\n        this.context_id = caller_context_id === null ? extension_context.logging_next_context_id : caller_context_id;\n        extension_context.logging_next_context_id += 1;\n    }\n\n    log_doc_event(event_name, vscode_doc=null) {\n        if (!this.logging_enabled)\n            return;\n        try {\n            let full_event = `CID:${this.context_id}, ${this.context_name}:${event_name}`;\n            if (vscode_doc) {\n                full_event = `${full_event}, doc_lang:${vscode_doc.languageId}`;\n                if (vscode_doc.uri) {\n                    let str_uri = vscode_doc.uri.toString(/*skipEncoding=*/true);\n                    full_event = `${full_event}, doc_uri:${str_uri}`;\n                }\n            } else {\n                full_event = `${full_event}, no_doc:1`;\n            }\n            // Use \"info\" level because logging is flag-guarded by the extension-level setting.\n            debug_log_output_channel.info(full_event);\n        } catch (error) {\n            console.error(`Rainbow CSV: Unexpected log failure. ${this.context_name}:${this.event_name}`);\n            return;\n        }\n    }\n\n    log_simple_event(event_name) {\n        if (!this.logging_enabled)\n            return;\n        try {\n            let full_event = `CID:${this.context_id}, ${this.context_name}:${event_name}`;\n            debug_log_output_channel.info(full_event);\n        } catch (error) {\n            console.error(`Rainbow CSV: Unexpected log failure. ${this.context_name}:${this.event_name}`);\n            return;\n        }\n    }\n}\n\n\nfunction get_header_from_document(document, delim, policy, comment_prefix) {\n    let [_header_lnum, header_line] = ll_rainbow_utils().get_header_line(document, comment_prefix);\n    if (!header_line) {\n        return null;\n    }\n    return csv_utils.smart_split(header_line, delim, policy, /*preserve_quotes_and_whitespaces=*/false)[0];\n}\n\n\nfunction get_header(document, delim, policy, comment_prefix) {\n    var file_path = document.fileName;\n    if (file_path) {\n        let header_info = get_from_global_state(make_header_key(file_path), null);\n        if (header_info !== null && header_info.header !== null) {\n            return header_info.header;\n        }\n    }\n    return get_header_from_document(document, delim, policy, comment_prefix);\n}\n\n\nfunction get_dialect(document) {\n    let language_id = document.languageId;\n    let delim = null;\n    let policy = null;\n\n    let comment_prefix = '';\n    if (extension_context.custom_comment_prefixes.has(document.fileName)) {\n        comment_prefix = extension_context.custom_comment_prefixes.get(document.fileName);\n    } else {\n        comment_prefix = get_from_config('comment_prefix', '');\n    }\n    if (language_id != DYNAMIC_CSV && dialect_map.hasOwnProperty(language_id)) {\n        [delim, policy] = dialect_map[language_id];\n        return [delim, policy, comment_prefix];\n    }\n    let dialect_info = null;\n    if (language_id == DYNAMIC_CSV) {\n        dialect_info = get_dynamic_info(document.fileName);\n    }\n    if (dialect_info) {\n        return [dialect_info.delim, dialect_info.policy, comment_prefix];\n    }\n    // The language id can be `dynamic csv` here e.g. if user just now manually selected the \"Dynamic CSV\" filetype.\n    return [null, null, null];\n}\n\n\nfunction enable_rainbow_ui(active_doc) {\n    if (dynamic_dialect_select_button) {\n        dynamic_dialect_select_button.hide();\n    }\n    ll_rainbow_utils().show_lint_status_bar_button(vscode, extension_context, active_doc.fileName, active_doc.languageId);\n    show_rbql_status_bar_button();\n    show_align_shrink_button(active_doc.fileName);\n    show_rainbow_off_status_bar_button();\n    show_rbql_copy_to_source_button(active_doc.fileName);\n    show_column_info_button(); // This function finds active_doc internally, but the possible inconsistency is harmless.\n\n    if (get_from_config('enable_cursor_position_info', false)) {\n        keyboard_cursor_subscription = vscode.window.onDidChangeTextEditorSelection(handle_cursor_movement);\n    }\n}\n\n\nclass StickyHeaderProvider {\n    // We don't utilize typescript `implement` interface keyword, because TS doesn't seem to be exporting interfaces to JS (unlike classes).\n    constructor() {\n    }\n    async provideDocumentSymbols(document) {\n        // This can trigger multiple times for the same doc because otherwise this won't work in case of e.g. header edit.\n        let [_delim, policy, comment_prefix] = get_dialect(document);\n        if (!policy) {\n            return null;\n        }\n        let header_lnum = null;\n        var file_path = document.fileName;\n        if (file_path) {\n            let header_info = get_from_global_state(make_header_key(file_path), null);\n            if (header_info !== null && header_info.header_line_num !== null) {\n                header_lnum = header_info.header_line_num;\n            }\n        }\n\n        if (header_lnum === null) {\n            header_lnum = ll_rainbow_utils().get_header_line(document, comment_prefix)[0];\n        }\n        if (header_lnum === null || header_lnum >= document.lineCount - 1) {\n            return null;\n        }\n        let full_range = new vscode.Range(header_lnum, 0, document.lineCount - 1, 65535);\n        full_range = document.validateRange(full_range); // Just in case, should be always NOOP.\n        let header_range = new vscode.Range(header_lnum, 0, header_lnum, 65535);\n        if (!full_range.contains(header_range)) {\n            return; // Should never happen.\n        }\n        let symbol_kind = vscode.SymbolKind.File; // It is vscode.SymbolKind.File because it shows a nice \"File\" icon in the upper navigational panel. Another nice option is \"Class\".\n        let header_symbol = new vscode.DocumentSymbol('data', '', symbol_kind, full_range, header_range);\n        return [header_symbol];\n    }\n}\n\n\nfunction reconfigure_sticky_header_provider(force=false) {\n    let enable_sticky_header = get_from_config('enable_sticky_header', false);\n    if (!enable_sticky_header) {\n        if (sticky_header_disposable !== null) {\n            sticky_header_disposable.dispose();\n            sticky_header_disposable = null;\n        }\n        return;\n    }\n    if (sticky_header_disposable !== null && force) {\n        sticky_header_disposable.dispose();\n        sticky_header_disposable = null;\n    }\n    if (sticky_header_disposable !== null) {\n        // Sticky header provider already exists, nothing to do.\n        return;\n    }\n    let header_symbol_provider = new StickyHeaderProvider();\n    let document_selector = [];\n    for (let language_id in dialect_map) {\n        if (dialect_map.hasOwnProperty(language_id)) {\n            document_selector.push({language: language_id});\n        }\n    }\n    sticky_header_disposable = vscode.languages.registerDocumentSymbolProvider(document_selector, header_symbol_provider);\n}\n\n\nfunction enable_dynamic_semantic_tokenization() {\n    // Some themes can disable semantic highlighting e.g. \"Tokyo Night\" https://marketplace.visualstudio.com/items?itemName=enkia.tokyo-night, so we explicitly override the default setting in \"configurationDefaults\" section of package.json.\n    // We also add all other csv dialects to \"configurationDefaults\":\"editor.semanticHighlighting.enabled\" override in order to enable comment line highlighting.\n    // Conflict with some other extensions might also cause semantic highlighting to completely fail (although this could be caused by the theme issue described above), see https://github.com/mechatroner/vscode_rainbow_csv/issues/149.\n    let token_provider = new RainbowTokenProvider();\n    if (rainbow_token_event !== null) {\n        rainbow_token_event.dispose();\n    }\n    let document_selector = { language: DYNAMIC_CSV }; // Use '*' to select all languages if needed.\n    rainbow_token_event = vscode.languages.registerDocumentRangeSemanticTokensProvider(document_selector, token_provider, tokens_legend);\n}\n\n\nfunction register_comment_tokenization_handler() {\n    let token_provider = new CommentTokenProvider();\n    if (comment_token_event !== null) {\n        comment_token_event.dispose();\n    }\n    let document_selector = [];\n    for (let language_id in dialect_map) {\n        if (dialect_map.hasOwnProperty(language_id) && language_id != DYNAMIC_CSV) {\n            // We skip DYNAMIC_CSV here because its provider already handles comment lines.\n            document_selector.push({language: language_id});\n        }\n    }\n    comment_token_event = vscode.languages.registerDocumentRangeSemanticTokensProvider(document_selector, token_provider, tokens_legend);\n}\n\n\nfunction get_selected_separator(active_editor, active_doc) {\n    if (!active_editor || !active_doc)\n        return '';\n    let selection = active_editor.selection;\n    if (!selection) {\n        return '';\n    }\n    if (selection.start.line != selection.end.line) {\n        return '';\n    }\n    let separator = active_doc.lineAt(selection.start.line).text.substring(selection.start.character, selection.end.character);\n    return separator;\n}\n\n\nasync function choose_dynamic_separator(integration_test_options=null) {\n    let log_wrapper = new StackContextLogWrapper('choose_dynamic_separator');\n    log_wrapper.log_doc_event('starting', active_doc);\n    let active_editor = get_active_editor();\n    if (!active_editor) {\n        return;\n    }\n    var active_doc = get_active_doc(active_editor);\n    if (!is_eligible_doc(active_doc)) {\n        return;\n    }\n    let selected_separator = get_selected_separator(active_editor, active_doc);\n    if (!dialect_selection_html_template) {\n        dialect_selection_html_template = await load_resource_file_universal('dialect_select.html');\n    }\n    dialect_panel = vscode.window.createWebviewPanel('rainbow-dialect-select', 'Choose CSV Dialect', vscode.ViewColumn.Beside, {enableScripts: true});\n    dialect_panel.webview.html = adjust_webview_paths(dialect_panel, dialect_selection_html_template, ['dialect_select.js']);\n    dialect_panel.webview.onDidReceiveMessage(function(message) { handle_dialect_selection_message(active_doc, dialect_panel, message, selected_separator, log_wrapper, integration_test_options); });\n}\n\n\nfunction show_choose_dynamic_separator_button() {\n    if (!dynamic_dialect_select_button)\n        dynamic_dialect_select_button = vscode.window.createStatusBarItem(vscode.StatusBarAlignment.Left);\n    dynamic_dialect_select_button.text = 'Choose Separator...';\n    dynamic_dialect_select_button.tooltip = 'Click to choose Dynamic CSV separator';\n    dynamic_dialect_select_button.command = 'rainbow-csv.RainbowSeparator';\n    dynamic_dialect_select_button.show();\n}\n\n\nasync function enable_rainbow_features_if_csv(active_doc, log_wrapper) {\n    log_wrapper.log_doc_event('start enable-rainbow-features-if-csv', active_doc);\n    if (!is_rainbow_dialect_doc(active_doc)) {\n        log_wrapper.log_simple_event('abort enable-rainbow-features-if-csv: non-rainbow dialect');\n        return;\n    }\n    if (rainbow_on_status_bar_button) {\n        rainbow_on_status_bar_button.hide();\n    }\n    var language_id = active_doc.languageId;\n    if (language_id == DYNAMIC_CSV && extension_context.dynamic_dialect_for_next_request != null) {\n        await save_dynamic_info(extension_context, active_doc.fileName, extension_context.dynamic_dialect_for_next_request);\n        extension_context.dynamic_dialect_for_next_request = null;\n    }\n    let [delim, policy, comment_prefix] = get_dialect(active_doc);\n    if (!delim || !policy) {\n        log_wrapper.log_simple_event('abort enable-rainbow-features-if-csv: missing delim or policy');\n        // Make sure UI elements are disabled except dynamic separator selection button.\n        disable_ui_elements();\n        show_choose_dynamic_separator_button();\n        return;\n    }\n    if (comment_prefix) {\n        // It is currently impoossible to set comment_prefix on document level, so we have to set it on language level instead.\n        // This could potentially cause minor problems in very rare situations.\n        // Applying 'setLanguageConfiguration' doesn't disable static configuration in language-configuration.json.\n        vscode.languages.setLanguageConfiguration(language_id, { comments: { lineComment: comment_prefix } });\n    }\n    if (language_id == DYNAMIC_CSV) {\n        // Re-enable tokenization to explicitly trigger the highligthing. Sometimes this doesn't happen automatically.\n        enable_dynamic_semantic_tokenization();\n    }\n    enable_rainbow_ui(active_doc);\n    await csv_lint(active_doc, false);\n    log_wrapper.log_simple_event('finish enable-rainbow-features-if-csv');\n}\n\n\nfunction disable_ui_elements() {\n    let all_buttons = [extension_context.lint_status_bar_button, rbql_status_bar_button, rainbow_off_status_bar_button, copy_back_button, align_shrink_button, column_info_button, dynamic_dialect_select_button, rainbow_on_status_bar_button];\n    for (let i = 0; i < all_buttons.length; i++) {\n        if (all_buttons[i])\n            all_buttons[i].hide();\n    }\n    if (keyboard_cursor_subscription) {\n        keyboard_cursor_subscription.dispose();\n        keyboard_cursor_subscription = null;\n    }\n}\n\n\nfunction disable_rainbow_features_if_non_csv(active_doc, log_wrapper) {\n    log_wrapper.log_doc_event('start disable-rainbow-features-if-non-csv', active_doc);\n    if (is_rainbow_dialect_doc(active_doc)) {\n        if (rainbow_on_status_bar_button) {\n            rainbow_on_status_bar_button.hide();\n        }\n        log_wrapper.log_simple_event('abort disable-rainbow-features-if-non-csv: is rainbow dialect');\n        return;\n    }\n    log_wrapper.log_simple_event('perform disable-rainbow-features-if-non-csv');\n    disable_ui_elements();\n    if (is_eligible_doc(active_doc) && extension_context.reenable_rainbow_language_infos.has(active_doc.fileName)) {\n        // Show \"Rainbow On\" button. The button will be hidden again if user clicks away by `disable_rainbow_features_if_non_csv`.\n        // Only show for non-rainbow docs since this mechanism can interfere with manual filetype selection UI.\n        log_wrapper.log_simple_event('show rainbow-on status button');\n        show_rainbow_on_status_bar_button();\n    }\n}\n\n\nfunction get_active_editor() {\n    var active_window = vscode.window;\n    if (!active_window)\n        return null;\n    var active_editor = active_window.activeTextEditor;\n    if (!active_editor)\n        return null;\n    return active_editor;\n}\n\n\nfunction get_active_doc(active_editor=null) {\n    if (!active_editor)\n        active_editor = get_active_editor();\n    if (!active_editor)\n        return null;\n    var active_doc = active_editor.document;\n    if (!active_doc)\n        return null;\n    return active_doc;\n}\n\n\nfunction is_active_doc(vscode_doc) {\n    let active_doc = get_active_doc();\n    return (active_doc && active_doc.uri && vscode_doc && vscode_doc.uri && active_doc.uri.toString() == vscode_doc.uri.toString());\n}\n\n\nfunction show_align_shrink_button(file_path) {\n    if (!align_shrink_button)\n        align_shrink_button = vscode.window.createStatusBarItem(vscode.StatusBarAlignment.Left);\n    if (aligned_files.has(file_path)) {\n        align_shrink_button.text = 'Shrink';\n        align_shrink_button.tooltip = 'Click to shrink table (Then you can click again to align)';\n        align_shrink_button.command = 'rainbow-csv.Shrink';\n    } else {\n        align_shrink_button.text = 'Align';\n        align_shrink_button.tooltip = 'Click to align table (Then you can click again to shrink)';\n        align_shrink_button.command = 'rainbow-csv.Align';\n    }\n    align_shrink_button.show();\n}\n\n\nfunction do_show_column_info_button(full_report, short_report) {\n    if (!column_info_button)\n        column_info_button = vscode.window.createStatusBarItem(vscode.StatusBarAlignment.Right, 1000);\n    column_info_button.text = short_report;\n    column_info_button.tooltip = full_report;\n    column_info_button.show();\n}\n\n\nfunction make_hover(document, language_id, position, cancellation_token) {\n    if (!get_from_config('enable_tooltip', false)) {\n        return;\n    }\n    let [delim, policy, comment_prefix] = get_dialect(document);\n    let cursor_position_info = ll_rainbow_utils().get_cursor_position_info(vscode, document, delim, policy, comment_prefix, position);\n    if (!cursor_position_info || cancellation_token.isCancellationRequested)\n        return null;\n    let enable_tooltip_column_names = get_from_config('enable_tooltip_column_names', false);\n    let header = get_header(document, delim, policy, comment_prefix);\n    if (!header) {\n        return null;\n    }\n    let [_full_text, short_report] = ll_rainbow_utils().format_cursor_position_info(cursor_position_info, header, enable_tooltip_column_names, /*show_comments=*/true, /*max_label_length=*/25);\n    let mds = new vscode.MarkdownString();\n    // Using a special pseudo-language grammar trick for highlighting the hover text using the same color as the column doesn't work anymore due to https://github.com/microsoft/vscode/issues/53723.\n    mds.appendText(short_report);\n    return new vscode.Hover(mds);\n}\n\n\nfunction show_column_info_button() {\n    let active_editor = get_active_editor();\n    if (!active_editor) {\n        return false;\n    }\n    let position = ll_rainbow_utils().get_cursor_position_if_unambiguous(active_editor);\n    if (!position) {\n        return false;\n    }\n    let active_doc = get_active_doc(active_editor);\n    let [delim, policy, comment_prefix] = get_dialect(active_doc);\n    let cursor_position_info = ll_rainbow_utils().get_cursor_position_info(vscode, active_doc, delim, policy, comment_prefix, position);\n    if (!cursor_position_info)\n        return false;\n    let enable_tooltip_column_names = get_from_config('enable_tooltip_column_names', false);\n    let header = get_header(active_doc, delim, policy, comment_prefix);\n    if (!header)\n        return false;\n    let [full_report, short_report] = ll_rainbow_utils().format_cursor_position_info(cursor_position_info, header, enable_tooltip_column_names, /*show_comments=*/false, /*max_label_length=*/25);\n    do_show_column_info_button(full_report, short_report);\n    return true;\n}\n\n\nfunction show_rainbow_off_status_bar_button() {\n    if (!rainbow_off_status_bar_button)\n        rainbow_off_status_bar_button = vscode.window.createStatusBarItem(vscode.StatusBarAlignment.Left);\n    rainbow_off_status_bar_button.text = 'Rainbow OFF';\n    rainbow_off_status_bar_button.tooltip = 'Click to restore original file type and syntax';\n    rainbow_off_status_bar_button.command = 'rainbow-csv.RainbowSeparatorOff';\n    rainbow_off_status_bar_button.show();\n}\n\n\nfunction show_rainbow_on_status_bar_button() {\n    // TODO consider showing the separator selection dialog on \"RainbowOn\" button click instead of restoring the previous dialect.\n    if (!rainbow_on_status_bar_button)\n        rainbow_on_status_bar_button = vscode.window.createStatusBarItem(vscode.StatusBarAlignment.Left);\n    rainbow_on_status_bar_button.text = 'Rainbow ON';\n    rainbow_on_status_bar_button.tooltip = 'Click to reenable Rainbow CSV for this file';\n    rainbow_on_status_bar_button.command = 'rainbow-csv.RainbowSeparatorOn';\n    rainbow_on_status_bar_button.show();\n}\n\n\nfunction show_rbql_status_bar_button() {\n    if (!rbql_status_bar_button)\n        rbql_status_bar_button = vscode.window.createStatusBarItem(vscode.StatusBarAlignment.Left);\n    rbql_status_bar_button.text = 'Query';\n    rbql_status_bar_button.tooltip = 'Click to run SQL-like RBQL query';\n    rbql_status_bar_button.command = 'rainbow-csv.RBQL';\n    rbql_status_bar_button.show();\n}\n\n\nfunction show_rbql_copy_to_source_button(file_path) {\n    let parent_table_path = result_set_parent_map.get(safe_lower(file_path));\n    if (!parent_table_path || parent_table_path.indexOf(scratch_buf_marker) != -1)\n        return;\n    let parent_basename = path.basename(parent_table_path);\n    if (!copy_back_button)\n        copy_back_button = vscode.window.createStatusBarItem(vscode.StatusBarAlignment.Left);\n    copy_back_button.text = 'Copy Back';\n    copy_back_button.tooltip = `Copy to parent table: ${parent_basename}`;\n    copy_back_button.command = 'rainbow-csv.CopyBack';\n    copy_back_button.show();\n}\n\n\nasync function csv_lint(active_doc, is_manual_op) {\n    if (!active_doc)\n        active_doc = get_active_doc();\n    if (!is_rainbow_dialect_doc(active_doc)) {\n        return null;\n    }\n    var file_path = active_doc.fileName; // For new untitled scratch documents this would be \"Untitled-1\", \"Untitled-2\", etc...\n    var language_id = active_doc.languageId;\n    let lint_cache_key = `${file_path}.${language_id}`;\n    if (!is_manual_op) {\n        if (extension_context.lint_results.has(lint_cache_key))\n            return null;\n        if (!get_from_config('enable_auto_csv_lint', false))\n            return null;\n    }\n    let [delim, policy, comment_prefix] = get_dialect(active_doc);\n    if (policy === null)\n        return null;\n    extension_context.lint_results.set(lint_cache_key, {is_processing: true});\n    ll_rainbow_utils().show_lint_status_bar_button(vscode, extension_context, file_path, language_id); // Visual feedback.\n    let detect_trailing_spaces = get_from_config('csv_lint_detect_trailing_spaces', false);\n    let [_records, _num_records_parsed, fields_info, first_defective_line, first_trailing_space_line, _comments] = fast_load_utils.parse_document_records(active_doc, delim, policy, comment_prefix, /*stop_on_warning=*/true, /*max_records_to_parse=*/-1, /*collect_records=*/false, /*preserve_quotes_and_whitespaces=*/true, detect_trailing_spaces);\n    let is_ok = (first_defective_line === null && fields_info.size <= 1);\n    let lint_result = {'is_ok': is_ok, 'first_defective_line': first_defective_line, 'fields_info': fields_info, 'first_trailing_space_line': first_trailing_space_line};\n    extension_context.lint_results.set(lint_cache_key, lint_result);\n    if (is_manual_op) {\n        // Need timeout here to give user enough time to notice green -> yellow -> green switch, this is a sort of visual feedback.\n        await sleep(500);\n    }\n    ll_rainbow_utils().show_lint_status_bar_button(vscode, extension_context, file_path, language_id); // Visual feedback.\n    return lint_result;\n}\n\n\nasync function csv_lint_cmd() {\n    // TODO re-run on each file save with content change.\n    let lint_report_for_unit_tests = await csv_lint(null, true);\n    return lint_report_for_unit_tests;\n}\n\n\nasync function run_internal_test_cmd(integration_test_options) {\n    if (integration_test_options && integration_test_options.check_initialization_state) {\n        // This mode is to ensure that the most basic operations do not cause rainbow csv to load extra (potentially heavy) code.\n        // Vim uses the same approach with its plugin/autoload folder layout design.\n        return {initialized: global_state !== null, lazy_loaded: rainbow_utils !== null};\n    }\n    if (integration_test_options && integration_test_options.check_last_rbql_report) {\n        return _unit_test_last_rbql_report;\n    }\n    if (integration_test_options && integration_test_options.check_last_rbql_warnings) {\n        return {'warnings': _unit_test_last_warnings};\n    }\n    return null;\n}\n\n\nasync function show_warnings(warnings) {\n    _unit_test_last_warnings = [];\n    if (!warnings || !warnings.length)\n        return;\n    var active_window = vscode.window;\n    if (!active_window)\n        return null;\n    for (var i = 0; i < warnings.length; i++) {\n        // Do not \"await\" warning messages because the promise gets resolved only on warning dismissal.\n        active_window.showWarningMessage('RBQL warning: ' + warnings[i]);\n    }\n    _unit_test_last_warnings = warnings;\n}\n\n\nasync function handle_rbql_result_file_node(text_doc, delim, policy, warnings) {\n    try {\n        await vscode.window.showTextDocument(text_doc);\n    } catch (error) {\n        show_single_line_error('Unable to open RBQL result document');\n        return;\n    }\n    let language_id = map_dialect_to_language_id(delim, policy);\n    if (language_id && text_doc.languageId != language_id) {\n        // In non-web version we open a new doc without preset filetype, so we need to manually set it.\n        await vscode.languages.setTextDocumentLanguage(text_doc, language_id);\n    }\n    await show_warnings(warnings);\n}\n\n\nasync function handle_rbql_result_file_web(text_doc, warnings) {\n    try {\n        await vscode.window.showTextDocument(text_doc);\n    } catch (error) {\n        show_single_line_error('Unable to open RBQL result document');\n        return;\n    }\n    await show_warnings(warnings);\n}\n\n\n\nfunction command_async_wrapper(cmd, args) {\n    return new Promise(function (resolve, reject) {\n        let stdout_data = '';\n        let stderr_data = '';\n        let process = child_process.spawn(cmd, args, {'windowsHide': true});\n        process.stdout.on('data', function(data) {\n            stdout_data += data.toString();\n        });\n        process.stderr.on('data', function(data) {\n            stderr_data += data.toString();\n        });\n        process.on('close', function (code) { // Consider replacing 'close' with 'exit'.\n            resolve({'exit_code': code, 'stdout': stdout_data, 'stderr': stderr_data});\n        });\n        process.on('error', function (err) {\n            reject(err);\n        });\n    });\n}\n\n\nfunction get_dst_table_name(input_path, output_delim) {\n    var table_name = path.basename(input_path);\n    var orig_extension = path.extname(table_name);\n    var delim_ext_map = {'\\t': '.tsv', ',': '.csv'};\n    var dst_extension = '.txt';\n    if (delim_ext_map.hasOwnProperty(output_delim)) {\n        dst_extension = delim_ext_map[output_delim];\n    } else if (orig_extension.length > 1) {\n        dst_extension = orig_extension;\n    }\n    let result_table_name = table_name + dst_extension;\n    if (result_table_name == table_name) { // Just being paranoid to avoid overwriting input table accidentally when output dir configured to be the same as input.\n        result_table_name += '.txt';\n    }\n    return result_table_name;\n}\n\n\nfunction file_path_to_query_key(file_path) {\n    return (file_path && file_path.indexOf(scratch_buf_marker) != -1) ? scratch_buf_marker : file_path;\n}\n\nfunction get_dst_table_dir(input_table_path) {\n    let rbql_output_dir = get_from_config('rbql_output_dir', 'TMP');\n    if (rbql_output_dir == 'TMP') {\n        return os.tmpdir();\n    } else if (rbql_output_dir == 'INPUT') {\n        return path.dirname(input_table_path);\n    } else {\n        // Return custom directory. If the directory does not exist or isn't writable RBQL itself will report more or less clear error.\n        return rbql_output_dir;\n    }\n}\n\n\nasync function run_command_and_parse_output(cmd, args) {\n    let execution_result = null;\n    try {\n        execution_result = await command_async_wrapper(cmd, args);\n    } catch (error) {\n        let error_details = error ? error.name + ': ' + error.message : '';\n        let error_msg = 'Something went wrong. Make sure you have python installed and added to PATH variable in your OS. Or you can use it with JavaScript instead - it should work out of the box\\nDetails:\\n' + error_details;\n        return {error_type: 'Integration', error_msg: error_msg, invocation_error: 1};\n    }\n    let json_report = execution_result.stdout;\n    if (!json_report || execution_result.stderr) {\n        let error_msg = execution_result.stderr || 'empty error';\n        return {error_type: 'Integration', error_msg: error_msg};\n    }\n    try {\n        return JSON.parse(json_report);\n    } catch (e) {\n        return {error_type: 'Integration', error_msg: 'Unable to parse JSON report'};\n    }\n}\n\n\nasync function run_first_working_interpreter_command_and_parse_output(interpreters_list, args, log_wrapper) {\n    // The main use case of this function is to try 'python3' first and then fall back to 'python' if 'python3' is unavailable for some reason.\n    let execution_result = null;\n    for (let interpreter_cmd of interpreters_list) {\n        log_wrapper.log_simple_event(`Attempting interpreter '${interpreter_cmd}' ...`);\n        execution_result = await run_command_and_parse_output(interpreter_cmd, args);\n        if (!execution_result || !execution_result.hasOwnProperty('invocation_error') || !execution_result.invocation_error) {\n            return execution_result;\n        }\n        log_wrapper.log_simple_event(`Interpreter '${interpreter_cmd}' invocation failed.`);\n    }\n    return execution_result;\n}\n\n\nasync function send_report_to_webview(webview, error_type, error_msg) {\n    let report_msg = {'msg_type': 'rbql_report'};\n    if (error_type)\n        report_msg[\"error_type\"] = error_type;\n    if (error_msg)\n        report_msg[\"error_msg\"] = error_msg;\n    _unit_test_last_rbql_report = report_msg;\n    await webview.postMessage(report_msg);\n}\n\n\nasync function run_rbql_query(webview, input_path, csv_encoding, backend_language, rbql_query, output_dialect, with_headers) {\n    // TODO refactor this function.\n    let log_wrapper = new StackContextLogWrapper('run-rbql-query');\n    log_wrapper.log_simple_event('start');\n    last_rbql_queries.set(file_path_to_query_key(input_path), rbql_query);\n    let interpreters_preference_list = ['python3', 'python'];\n    const test_marker = 'test ';\n    let close_and_error_guard = {'process_reported': false};\n\n    let [input_delim, input_policy, comment_prefix] = [rbql_context.delim, rbql_context.policy, rbql_context.comment_prefix];\n    let [output_delim, output_policy] = [input_delim, input_policy];\n    if (output_dialect == 'csv')\n        [output_delim, output_policy] = [',', QUOTED_POLICY];\n    if (output_dialect == 'tsv')\n        [output_delim, output_policy] = ['\\t', SIMPLE_POLICY];\n    rbql_context.output_delim = output_delim;\n    rbql_context.output_policy = output_policy;\n\n    let output_path = is_web_ext ? null : path.join(get_dst_table_dir(input_path), get_dst_table_name(input_path, output_delim));\n\n    if (rbql_query.startsWith(test_marker)) {\n        log_wrapper.log_simple_event('test mode');\n        // interpreters_preference_list = ['nopython', 'python3', 'python']; // interpreters_preference_list can be adjusted for testing\n        let args = [absolute_path_map['rbql mock/rbql_mock.py'], rbql_query];\n        let execution_result = await run_first_working_interpreter_command_and_parse_output(interpreters_preference_list, args, log_wrapper);\n        console.log(JSON.stringify(execution_result));\n        if (execution_result.hasOwnProperty('error_type') || execution_result.hasOwnProperty('error_msg')) {\n            await send_report_to_webview(webview, execution_result.error_type, execution_result.error_msg);\n            return;\n        }\n        await send_report_to_webview(webview, null, null);\n        return;\n    }\n    if (backend_language == 'js') {\n        log_wrapper.log_simple_event('using js backend');\n        let warnings = [];\n        let result_doc = null;\n        let target_language_id = map_dialect_to_language_id(output_delim, output_policy);\n        try {\n            if (is_web_ext) {\n                log_wrapper.log_simple_event('using web mode');\n                let result_lines = await ll_rainbow_utils().rbql_query_web(rbql_query, rbql_context.input_document, input_delim, input_policy, output_delim, output_policy, warnings, with_headers, comment_prefix);\n                let output_doc_cfg = {content: result_lines.join('\\n'), language: target_language_id};\n                if (target_language_id == DYNAMIC_CSV) {\n                    extension_context.dynamic_dialect_for_next_request = make_dialect_info(output_delim, output_policy);\n                }\n                extension_context.autodetection_temporarily_disabled_for_rbql = true;\n                result_doc = await vscode.workspace.openTextDocument(output_doc_cfg);\n                await send_report_to_webview(webview, null, null);\n                await handle_rbql_result_file_web(result_doc, warnings);\n                extension_context.dynamic_dialect_for_next_request = null;\n                extension_context.autodetection_temporarily_disabled_for_rbql = false;\n                log_wrapper.log_simple_event('finished OK');\n            } else {\n                log_wrapper.log_simple_event('using electron mode');\n                let csv_options = {'bulk_read': true};\n                await ll_rainbow_utils().rbql_query_node(global_state, rbql_query, input_path, input_delim, input_policy, output_path, output_delim, output_policy, csv_encoding, warnings, with_headers, comment_prefix, /*user_init_code=*/'', csv_options);\n                result_set_parent_map.set(safe_lower(output_path), input_path);\n                if (target_language_id == DYNAMIC_CSV) {\n                    extension_context.dynamic_dialect_for_next_request = make_dialect_info(output_delim, output_policy);\n                }\n                extension_context.autodetection_temporarily_disabled_for_rbql = true;\n                result_doc = await vscode.workspace.openTextDocument(output_path);\n                await send_report_to_webview(webview, null, null);\n                await handle_rbql_result_file_node(result_doc, output_delim, output_policy, warnings);\n                extension_context.dynamic_dialect_for_next_request = null;\n                extension_context.autodetection_temporarily_disabled_for_rbql = false;\n                log_wrapper.log_simple_event('finished OK');\n            }\n        } catch (e) {\n            let [error_type, error_msg] = ll_rbql_csv().exception_to_error_info(e);\n            log_wrapper.log_simple_event('finished with error');\n            await send_report_to_webview(webview, error_type, error_msg);\n            return;\n        }\n    } else {\n        log_wrapper.log_simple_event('using python backend');\n        if (is_web_ext) {\n            await send_report_to_webview(webview, 'Input error', 'Python backend for RBQL is not supported in web version, please use JavaScript backend.');\n            return;\n        }\n        let cmd_safe_query = Buffer.from(rbql_query, \"utf-8\").toString(\"base64\");\n        if (!comment_prefix) {\n            comment_prefix = '';\n        }\n        let args = [absolute_path_map['rbql_core/vscode_rbql.py'], cmd_safe_query, input_path, input_delim, input_policy, output_path, output_delim, output_policy, comment_prefix, csv_encoding];\n        if (with_headers)\n            args.push('--with_headers');\n        let execution_result = await run_first_working_interpreter_command_and_parse_output(interpreters_preference_list, args, log_wrapper);\n        if (execution_result.hasOwnProperty('error_type') || execution_result.hasOwnProperty('error_msg')) {\n            log_wrapper.log_simple_event('finished with error');\n            await send_report_to_webview(webview, execution_result.error_type, execution_result.error_msg);\n            return;\n        }\n        log_wrapper.log_simple_event('finished OK');\n        await send_report_to_webview(webview, null, null);\n        extension_context.autodetection_stoplist.add(output_path);\n        result_set_parent_map.set(safe_lower(output_path), input_path);\n        extension_context.autodetection_temporarily_disabled_for_rbql = true;\n        let target_language_id = map_dialect_to_language_id(output_delim, output_policy);\n        let output_doc = await vscode.workspace.openTextDocument(output_path);\n        extension_context.autodetection_temporarily_disabled_for_rbql = false;\n        // We need dynamic_dialect_for_next_request here because we can't open the output_doc with DYNAMIC_CSV, it will be switched on doc-ropen.\n        if (target_language_id == DYNAMIC_CSV) {\n            extension_context.dynamic_dialect_for_next_request = make_dialect_info(output_delim, output_policy);\n        }\n        await handle_rbql_result_file_node(output_doc, output_delim, output_policy, execution_result.warnings);\n        extension_context.dynamic_dialect_for_next_request = null;\n    }\n}\n\n\nasync function set_header_line() {\n    let active_editor = get_active_editor();\n    if (!active_editor)\n        return;\n    var active_doc = get_active_doc(active_editor);\n    if (!active_doc)\n        return;\n\n    let [delim, policy, _comment_prefix] = get_dialect(active_doc);\n    if (policy === null) {\n        show_single_line_error('Unable to set header line: no separator specified');\n        return;\n    }\n    let file_path = active_doc.fileName;\n    if (!file_path) {\n        show_single_line_error('Unable to set header line for non-file documents');\n        return;\n    }\n    let selection = active_editor.selection;\n    let header_line = selection.start.line;\n    let raw_header = active_doc.lineAt(header_line).text;\n    let header = csv_utils.smart_split(raw_header, delim, policy, false)[0];\n\n    // The advantage of saving the parsed list of column names is that it would stay consistent even if some lines are added/deleted before the header line (line migration).\n    // The advantage of saving the line number is that it is resilient to modifications of header line itself.\n    // It is also possible to verify consistency of header line and header column names and return null if they are inconsistent and return null.\n    // But discarding the inconsistent header line is probably not very obvious and user-friendly way of handling this.\n    // Showing the inconsistent header is probably better since these column names are only used for UI/readability and a wrong sticky line obviously hints on what happened and how to fix it, while a suddenly disappeared sticky line could be seen as a bug.\n    await save_to_global_state(make_header_key(file_path), {header_line_num: header_line, header: header});\n    // Re-register sticky header provider because otherwise it won't re-generate the symbols unless there were no edits to the file.\n    reconfigure_sticky_header_provider(/*force=*/true);\n}\n\n\nfunction preserve_original_language_id_if_needed(file_path, original_language_id, original_language_ids) {\n    if (!file_path) {\n        return;\n    }\n    if (dialect_map.hasOwnProperty(original_language_id)) {\n        // This is to prevent invalid noop \"dynamic csv\" -> \"dynamic csv\" switch without carying dialect info.\n        // And to simplify state management in general by not storing any rainbow dialects.\n        return;\n    }\n    original_language_ids.set(file_path, original_language_id);\n}\n\n\nasync function set_comment_prefix() {\n    let active_editor = get_active_editor();\n    if (!active_editor)\n        return;\n    var active_doc = get_active_doc(active_editor);\n    if (!active_doc)\n        return;\n    let selection = active_editor.selection;\n    if (!selection) {\n        show_single_line_error(\"Selection is empty\");\n        return;\n    }\n    let comment_prefix = active_doc.lineAt(selection.start.line).text.substring(selection.start.character, selection.end.character);\n    extension_context.custom_comment_prefixes.set(active_doc.fileName, comment_prefix);\n    if (!comment_prefix) {\n        manual_comment_prefix_stoplist.add(active_doc.fileName);\n    } else {\n        manual_comment_prefix_stoplist.delete(active_doc.fileName);\n    }\n    if (comment_prefix) {\n        vscode.languages.setLanguageConfiguration(active_doc.languageId, { comments: { lineComment: comment_prefix } });\n    }\n    if (active_doc.languageId == DYNAMIC_CSV) {\n        // Re-enable tokenization to explicitly trigger the highligthing. Sometimes this doesn't happen automatically.\n        enable_dynamic_semantic_tokenization();\n    } else {\n        // Re-enable comment tokenization to explicitly adjust the comment highligthing (sometimes to disable it if comment prefix is set to an empty string).\n        register_comment_tokenization_handler();\n    }\n}\n\n\nasync function restore_original_language() {\n    let log_wrapper = new StackContextLogWrapper('restore_original_language');\n    let active_doc = get_active_doc();\n    log_wrapper.log_doc_event('starting', active_doc);\n    if (!active_doc)\n        return;\n    let file_path = active_doc.fileName;\n    let original_language_id = PLAINTEXT;\n    if (extension_context.original_language_ids.has(file_path)) {\n        original_language_id = extension_context.original_language_ids.get(file_path);\n    }\n    if (dialect_map.hasOwnProperty(original_language_id) || !dialect_map.hasOwnProperty(active_doc.languageId)) {\n        show_single_line_error(\"Unable to restore original language\");\n        return;\n    }\n\n    if (file_path) {\n        // Preserve rainbow language info, so that the user can later re-enable it for this file.\n        let current_language_info = {language_id: active_doc.languageId};\n        let dynamic_dialect_info = get_dynamic_info(file_path);\n        if (dynamic_dialect_info) {\n            current_language_info.dynamic_dialect_info = dynamic_dialect_info;\n        }\n        extension_context.reenable_rainbow_language_infos.set(file_path, current_language_info);\n        extension_context.autodetection_stoplist.add(file_path);\n    }\n\n    active_doc = await vscode.languages.setTextDocumentLanguage(active_doc, original_language_id);\n    // There is no onDidChangeActiveTextEditor even for language change so we need to explicitly disable rainbow features.\n    disable_rainbow_features_if_non_csv(active_doc, log_wrapper);\n    // The only reason why we might want to clean up dynamic dialect info here is to facilitate triggering dynamic_document_dialect selection UI after manual filetype swith at the later point so that the user could choose a different dynamic dialect without manual selection by cursor / commands.\n    remove_dynamic_info(file_path);\n}\n\n\nasync function reenable_rainbow_language() {\n    var active_doc = get_active_doc();\n    if (!active_doc)\n        return;\n    let file_path = active_doc.fileName;\n    if (!extension_context.reenable_rainbow_language_infos.has(file_path)) {\n        // Make sure we have previous rainbow dialect saved.\n        show_single_line_error(\"Unable to re-enable rainbow highlighting automatically, select filetype manually or select a new separator with cursor.\");\n        return;\n    }\n    let rainbow_language_info = extension_context.reenable_rainbow_language_infos.get(file_path);\n    // Delete from the stoplist to revert \"Rainbow Off\" side-effects.\n    extension_context.autodetection_stoplist.delete(file_path);\n    if (rainbow_language_info.hasOwnProperty('dynamic_dialect_info')) {\n        await save_dynamic_info(extension_context, file_path, rainbow_language_info.dynamic_dialect_info);\n    }\n    // Preserve current (non-rainbow) language id to allow switching between \"Rainbow Off\"/\"Rainbow On\".\n    preserve_original_language_id_if_needed(file_path, active_doc.languageId, extension_context.original_language_ids);\n    // Delete from the \"reenable\" map to hide the \"Rainbow ON\" button on next refresh.\n    extension_context.reenable_rainbow_language_infos.delete(file_path);\n    if (rainbow_on_status_bar_button) {\n        // Hide the button explicitly.\n        rainbow_on_status_bar_button.hide();\n    }\n    let doc = await vscode.languages.setTextDocumentLanguage(active_doc, rainbow_language_info.language_id);\n}\n\n\nasync function set_join_table_name() {\n    if (is_web_ext) {\n        show_single_line_error('This command is currently unavailable in web mode.');\n        return;\n    }\n    var active_doc = get_active_doc();\n    if (!active_doc)\n        return;\n    let file_path = active_doc.fileName;\n    if (!file_path) {\n        show_single_line_error('Unable to use this document as join table');\n        return;\n    }\n    var title = \"Input table name to use in RBQL JOIN expressions instead of table path\";\n    var input_box_props = {\"prompt\": title, \"value\": 'b'};\n    let table_name = await vscode.window.showInputBox(input_box_props);\n    if (!table_name)\n        return; // User pressed Esc and closed the input box.\n    await save_to_global_state(ll_rainbow_utils().make_table_name_key(table_name), file_path);\n}\n\n\nasync function set_virtual_header() {\n    var active_doc = get_active_doc();\n    let [delim, policy, comment_prefix] = get_dialect(active_doc);\n    if (policy === null) {\n        show_single_line_error('Unable to set virtual header: no separator specified');\n        return;\n    }\n    var file_path = active_doc.fileName;\n    if (!file_path) {\n        show_single_line_error('Unable to edit column names for non-file documents');\n        return;\n    }\n    var old_header = get_header(active_doc, delim, policy, comment_prefix);\n    var title = \"Adjust column names displayed in hover tooltips. Actual header line and file content won't be affected.\";\n    var old_header_str = old_header ? quoted_join(old_header, delim) : '';\n    var input_box_props = {\"prompt\": title, \"value\": old_header_str};\n    let raw_new_header = await vscode.window.showInputBox(input_box_props);\n    if (!raw_new_header)\n        return; // User pressed Esc and closed the input box.\n    let new_header = csv_utils.smart_split(raw_new_header, delim, policy, false)[0];\n    await save_to_global_state(make_header_key(file_path), {header_line_num: null, header: new_header});\n}\n\n\nasync function column_edit(edit_mode) {\n    let active_editor = get_active_editor();\n    if (!active_editor)\n        return;\n    let active_doc = active_editor.document;\n    if (!active_doc)\n        return;\n    let [delim, policy, comment_prefix] = get_dialect(active_doc);\n    if (policy === null) {\n        return;\n    }\n    let position = ll_rainbow_utils().get_cursor_position_if_unambiguous(active_editor);\n    if (!position) {\n        show_single_line_error('Unable to enter column edit mode: make sure that no text is selected and only one cursor is active');\n        return;\n    }\n    if (active_doc.lineCount >= 10000) {\n        show_single_line_error('Multicursor column edit works only for files smaller than 10000 lines.');\n        return;\n    }\n    let col_num = (ll_rainbow_utils().get_cursor_position_info(vscode, active_doc, delim, policy, comment_prefix, position)).column_number;\n    let [selections, error_msg, warning_msg] = ll_rainbow_utils().generate_column_edit_selections(vscode, active_doc, delim, policy, comment_prefix, edit_mode, col_num);\n    if (error_msg !== null) {\n        show_single_line_error(error_msg);\n        return;\n    }\n    if (warning_msg) {\n        vscode.window.showWarningMessage(warning_msg);\n    }\n    active_editor.selections = selections;\n    // Call showTextDocument so that the editor will gain focus and the cursors will become active and blinking. This is a critical step here!\n    await vscode.window.showTextDocument(active_doc);\n}\n\n\nasync function shrink_table() {\n    let active_editor = get_active_editor();\n    let active_doc = get_active_doc(active_editor);\n    if (!is_rainbow_dialect_doc(active_doc)) {\n        return;\n    }\n    let [delim, policy, comment_prefix] = get_dialect(active_doc);\n    if (policy === null) {\n        return;\n    }\n    let progress_options = {location: vscode.ProgressLocation.Window, title: 'Rainbow CSV'};\n    await vscode.window.withProgress(progress_options, async (progress) => {\n        await report_progress(progress, 'Preparing');\n        let [shrinked_doc_text, first_failed_line] = ll_rainbow_utils().shrink_columns(active_doc, delim, policy, comment_prefix);\n        if (first_failed_line) {\n            show_single_line_error(`Unable to shrink: Inconsistent double quotes at line ${first_failed_line}`);\n            return;\n        }\n        aligned_files.delete(active_doc.fileName);\n        show_align_shrink_button(active_doc.fileName);\n        if (shrinked_doc_text === null) {\n            vscode.window.showWarningMessage('No trailing whitespaces found, skipping');\n            return;\n        }\n        await report_progress(progress, 'Shrinking columns');\n        await replace_doc_content(active_editor, active_doc, shrinked_doc_text);\n    });\n}\n\n\nasync function align_table() {\n    let active_editor = get_active_editor();\n    let active_doc = get_active_doc(active_editor);\n    if (!is_rainbow_dialect_doc(active_doc))\n        return;\n    let [delim, policy, comment_prefix] = get_dialect(active_doc);\n    if (policy === null) {\n        return;\n    }\n    let progress_options = {location: vscode.ProgressLocation.Window, title: 'Rainbow CSV'};\n    await vscode.window.withProgress(progress_options, async (progress) => {\n        await report_progress(progress, 'Calculating column statistics');\n        let double_width_alignment = get_from_config('double_width_alignment', true);\n        let [column_stats, first_failed_line, records, comments] = ll_rainbow_utils().calc_column_stats(active_doc, delim, policy, comment_prefix, double_width_alignment);\n        if (first_failed_line) {\n            show_single_line_error(`Unable to align: Inconsistent double quotes at line ${first_failed_line}`);\n            return;\n        }\n        column_stats = ll_rainbow_utils().adjust_column_stats(column_stats, delim.length);\n        if (column_stats === null) {\n            show_single_line_error('Unable to allign: Internal Rainbow CSV Error');\n            return;\n        }\n        await report_progress(progress, 'Preparing final alignment');\n        let aligned_doc_text = ll_rainbow_utils().align_columns(records, comments, column_stats, delim);\n\n        await report_progress(progress, 'Aligning columns');\n        let align_in_scratch_file = get_from_config('align_in_scratch_file', false);\n        let is_scratch_file = active_doc.uri && active_doc.uri.scheme == 'untitled';\n        if (align_in_scratch_file && !is_scratch_file) {\n            let aligned_doc_cfg = {content: aligned_doc_text, language: active_doc.languageId};\n            let scratch_doc = await vscode.workspace.openTextDocument(aligned_doc_cfg);\n            aligned_files.add(scratch_doc.fileName);\n            await vscode.window.showTextDocument(scratch_doc);\n            show_align_shrink_button(scratch_doc.fileName); // This is likely redundant but won't hurt.\n        } else {\n            await replace_doc_content(active_editor, active_doc, aligned_doc_text);\n            aligned_files.add(active_doc.fileName);\n            show_align_shrink_button(active_doc.fileName);\n        }\n    });\n}\n\n\nasync function do_copy_back(query_result_doc, active_editor) {\n    let data = query_result_doc.getText();\n    let active_doc = get_active_doc(active_editor);\n    if (!active_doc)\n        return;\n    await replace_doc_content(active_editor, active_doc, data);\n}\n\n\nasync function copy_back() {\n    if (is_web_ext) {\n        show_single_line_error('This command is currently unavailable in web mode.');\n        return;\n    }\n    let result_doc = get_active_doc();\n    if (!result_doc)\n        return;\n    let file_path = result_doc.fileName;\n    let parent_table_path = result_set_parent_map.get(safe_lower(file_path));\n    if (!parent_table_path)\n        return;\n    let parent_doc = await vscode.workspace.openTextDocument(parent_table_path);\n    let parent_editor = await vscode.window.showTextDocument(parent_doc);\n    await do_copy_back(result_doc, parent_editor);\n}\n\n\nasync function update_query_history(query) {\n    let history_list = get_from_global_state('rbql_query_history', []);\n    let old_index = history_list.indexOf(query);\n    if (old_index != -1) {\n        history_list.splice(old_index, 1);\n    } else if (history_list.length >= 20) {\n        history_list.splice(0, 1);\n    }\n    history_list.push(query);\n    await save_to_global_state('rbql_query_history', history_list);\n}\n\n\nasync function handle_dialect_selection_message(origin_doc, dialect_webview_panel, message, selected_separator, log_wrapper, integration_test_options) {\n    if (!message) {\n        return;\n    }\n    if (message.msg_type == 'dialect_handshake') {\n        let init_msg = {'msg_type': 'dialect_handshake', 'selected_separator': selected_separator};\n        if (integration_test_options && integration_test_options.integration_test) {\n            init_msg['integration_test'] = true;\n        }\n        await dialect_webview_panel.webview.postMessage(init_msg);\n    }\n\n    if (message.msg_type == 'apply_dialect') {\n        let delim = message.delim;\n        let policy = message.policy;\n        let comment_prefix = message.comment_prefix;\n        if (policy == 'whitespace' && delim != ' ') {\n            show_single_line_error(\"Selected policy can only be used with whitespace separator\");\n            return;\n        }\n        if (policy == 'double_escape' && delim == '\"') {\n            show_single_line_error(\"Double quote separator in incompatible with double quote escape policy\");\n            return;\n        }\n        if (!delim) {\n            show_single_line_error(\"Separator is empty\");\n            return;\n        }\n        if ([SIMPLE_POLICY, QUOTED_RFC_POLICY, QUOTED_POLICY, WHITESPACE_POLICY].indexOf(policy) == -1) {\n            show_single_line_error(\"Selected policy is empty or not supported\");\n            return;\n        }\n        // Dispose/close the webview so that the origin_doc becomes active and rainbow features can be applied immediately.\n        dialect_webview_panel.dispose();\n\n        await save_dynamic_info(extension_context, origin_doc.fileName, make_dialect_info(delim, policy));\n        extension_context.custom_comment_prefixes.set(origin_doc.fileName, comment_prefix);\n        if (origin_doc.languageId == DYNAMIC_CSV && is_active_doc(origin_doc)) {\n            // Filetype was already \"dynamic csv\", just re-highlight the file properly.\n            await enable_rainbow_features_if_csv(origin_doc, log_wrapper);\n        } else {\n            await vscode.languages.setTextDocumentLanguage(origin_doc, DYNAMIC_CSV);\n        }\n    }\n}\n\n\nasync function handle_rbql_client_message(webview, message, integration_test_options=null) {\n    let message_type = message['msg_type'];\n\n    if (message_type == 'handshake') {\n        var backend_language = get_from_global_state('rbql_backend_language', 'js');\n        var encoding = get_from_global_state('rbql_encoding', 'utf-8');\n        var init_msg = {'msg_type': 'handshake', 'backend_language': backend_language, 'encoding': encoding};\n        ll_rainbow_utils().sample_preview_records_from_context(rbql_context, init_msg, preview_window_size, cached_table_parse_result);\n        let path_key = file_path_to_query_key(rbql_context.input_document_path);\n        if (last_rbql_queries.has(path_key))\n            init_msg['last_query'] = last_rbql_queries.get(path_key);\n        let history_list = get_from_global_state('rbql_query_history', []);\n        init_msg['query_history'] = history_list;\n        init_msg['policy'] = rbql_context.policy;\n        init_msg['with_headers'] = rbql_context.with_headers;\n        init_msg['header_for_ui'] = rbql_context.header_for_ui;\n        init_msg['is_web_ext'] = is_web_ext;\n        if (integration_test_options) {\n            init_msg['integration_test_language'] = integration_test_options.rbql_backend;\n            init_msg['integration_test_query'] = integration_test_options.rbql_query;\n            init_msg['integration_test_with_headers'] = integration_test_options.with_headers || false;\n            init_msg['integration_test_delay'] = integration_test_options.integration_test_delay || 2000;\n        }\n        await webview.postMessage(init_msg);\n    }\n\n    if (message_type == 'fetch_table_header') {\n        try {\n            let table_id = message['table_id'];\n            let encoding = message['encoding'];\n\n            let input_table_dir = rbql_context.input_document_path ? path.dirname(rbql_context.input_document_path) : null;\n            let table_path = ll_rainbow_utils().find_table_path(global_state, input_table_dir, table_id);\n            if (!table_path)\n                return;\n            let header_line = await ll_rainbow_utils().read_header(table_path, encoding);\n            if (!header_line) {\n                return;\n            }\n            let [fields, warning] = csv_utils.smart_split(header_line, rbql_context.delim, rbql_context.policy, false);\n            if (!warning) {\n                webview.postMessage({'msg_type': 'fetch_table_header_response', 'header_for_ui': fields});\n            }\n        } catch (e) {\n            console.error('Unable to get join table header: ' + String(e));\n        }\n    }\n\n    if (message_type == 'update_query') {\n        let rbql_query = message['query'];\n        if (!rbql_query)\n            return;\n        if (rbql_context.input_document_path)\n            last_rbql_queries.set(file_path_to_query_key(rbql_context.input_document_path), rbql_query);\n    }\n\n    if (message_type == 'with_headers_change') {\n        rbql_context.with_headers = message['with_headers'];\n        if (rbql_context.input_document_path)\n            await save_to_global_state(make_with_headers_key(rbql_context.input_document_path), rbql_context.with_headers);\n    }\n\n    if (message_type == 'navigate') {\n        var navig_direction = message['direction'];\n        if (navig_direction == 'backward') {\n            rbql_context.requested_start_record -= preview_window_size;\n        } else if (navig_direction == 'forward') {\n            rbql_context.requested_start_record += preview_window_size;\n        } else if (navig_direction == 'begin') {\n            rbql_context.requested_start_record = 0;\n        } else if (navig_direction == 'end') {\n            rbql_context.requested_start_record = rbql_context.input_document.lineCount; // This is just max possible value which is incorrect and will be adjusted later.\n        }\n        let protocol_message = {'msg_type': 'navigate'};\n        ll_rainbow_utils().sample_preview_records_from_context(rbql_context, protocol_message, preview_window_size, cached_table_parse_result);\n        await webview.postMessage(protocol_message);\n    }\n\n    if (message_type == 'run') {\n        let rbql_query = message['query'];\n        let backend_language = message['backend_language'];\n        let encoding = message['encoding'];\n        let output_dialect = message['output_dialect'];\n        let with_headers = message['with_headers'];\n        await update_query_history(rbql_query);\n        await run_rbql_query(webview, rbql_context.input_document_path, encoding, backend_language, rbql_query, output_dialect, with_headers);\n    }\n\n    if (message_type == 'edit_udf') {\n        if (is_web_ext) {\n            await send_report_to_webview(webview, 'Input error', 'UDFs are currently not supported in web version');\n            return;\n        }\n        let backend_language = message['backend_language'];\n        let udf_file_path = null;\n        let default_content = '';\n        if (backend_language == 'js') {\n            udf_file_path = path.join(os.homedir(), '.rbql_init_source.js');\n            default_content = ll_rainbow_utils().get_default_js_udf_content();\n        } else {\n            udf_file_path = path.join(os.homedir(), '.rbql_init_source.py');\n            default_content = ll_rainbow_utils().get_default_python_udf_content();\n        }\n        if (!fs.existsSync(udf_file_path)) {\n            fs.writeFileSync(udf_file_path, default_content);\n        }\n        let udf_doc = await vscode.workspace.openTextDocument(udf_file_path);\n        await vscode.window.showTextDocument(udf_doc);\n    }\n\n    if (message_type == 'global_param_change') {\n        await save_to_global_state(message['key'], message['value']);\n    }\n}\n\n\nfunction adjust_webview_paths(preview_panel, client_html, paths_list) {\n    for (const local_path of paths_list) {\n        let adjusted_webview_url = null;\n        if (is_web_ext) {\n            adjusted_webview_url = absolute_path_map[local_path];\n        } else {\n            adjusted_webview_url = preview_panel.webview.asWebviewUri(vscode.Uri.file(absolute_path_map[local_path]));\n        }\n        client_html = client_html.replace(`src=\"${local_path}\"`, `src=\"${adjusted_webview_url}\"`);\n    }\n    return client_html;\n}\n\n\nasync function edit_rbql(integration_test_options=null) {\n    let active_window = vscode.window;\n    if (!active_window)\n        return;\n    let active_editor = active_window.activeTextEditor;\n    if (!active_editor)\n        return;\n    let active_doc = active_editor.document;\n    if (!active_doc)\n        return;\n    let orig_uri = active_doc.uri;\n    if (!orig_uri)\n        return;\n    // For web orig_uri.scheme can have other valid values e.g. `vscode-test-web` when testing the browser integration.\n    if (orig_uri.scheme != 'file' && orig_uri.scheme != 'untitled' && !is_web_ext)\n        return;\n    if (orig_uri.scheme == 'file' && active_doc.isDirty && !is_web_ext) {\n        show_single_line_error(\"Unable to run RBQL: file has unsaved changes\");\n        return;\n    }\n    let input_path = null;\n    if (orig_uri.scheme == 'untitled' && !is_web_ext) {\n        // Scheme 'untitled' means that the document is a scratch buffer that hasn't been saved yet, see https://code.visualstudio.com/api/references/document-selector\n        let data = active_doc.getText();\n        let rnd_suffix = String(Math.floor(Math.random() * 1000000));\n        input_path = path.join(os.tmpdir(), `${scratch_buf_marker}_${rnd_suffix}.txt`);\n        // TODO consider adding username to the input_path and using chmod 600 on it.\n        fs.writeFileSync(input_path, data);\n    } else {\n        input_path = active_doc.fileName;\n    }\n\n    if (!input_path) {\n        show_single_line_error(\"Unable to run RBQL for this file\");\n        return;\n    }\n\n    let [delim, policy, comment_prefix] = get_dialect(active_doc);\n    if (policy === null) {\n        policy = 'monocolumn';\n        delim = 'monocolumn';\n    }\n    let with_headers_by_default = get_from_config('rbql_with_headers_by_default', false);\n    let with_headers = get_from_global_state(make_with_headers_key(input_path), with_headers_by_default);\n    let header_for_ui = get_header_from_document(active_doc, delim, policy, comment_prefix);\n    rbql_context = {\n        \"input_document\": active_doc,\n        \"input_document_path\": input_path,\n        \"requested_start_record\": 0,\n        \"delim\": delim,\n        \"policy\": policy,\n        \"comment_prefix\": comment_prefix,\n        \"with_headers\": with_headers,\n        \"header_for_ui\": header_for_ui\n    };\n\n    rbql_preview_panel = vscode.window.createWebviewPanel('rbql-console', 'RBQL Console', vscode.ViewColumn.Active, {enableScripts: true});\n    if (!client_html_template) {\n        client_html_template = await load_resource_file_universal('rbql_client.html');\n    }\n    rbql_preview_panel.webview.html = adjust_webview_paths(rbql_preview_panel, client_html_template, ['contrib/textarea-caret-position/index.js', 'rbql_suggest.js', 'rbql_client.js', 'rbql_logo.svg']);\n    rbql_preview_panel.webview.onDidReceiveMessage(function(message) { handle_rbql_client_message(rbql_preview_panel.webview, message, integration_test_options); });\n}\n\n\nfunction autodetect_dialect(config, active_doc, candidate_separators, comment_prefix) {\n    let candidate_dialects = [];\n    for (let separator of candidate_separators) {\n        let policy = get_default_policy(separator);\n        let dialect_id = map_dialect_to_language_id(separator, policy);\n        if (!dialect_id || !policy)\n            continue;\n        candidate_dialects.push([dialect_id, separator, policy]);\n        if (separator == ',' || separator == ';') {\n            candidate_dialects.push([DYNAMIC_CSV, separator, QUOTED_RFC_POLICY]);\n        }\n    }\n    let detect_trailing_spaces = get_from_config('csv_lint_detect_trailing_spaces', false, config);\n    let min_num_lines = get_from_config('autodetection_min_line_count', 10, config);\n    if (active_doc.lineCount < min_num_lines)\n        return [null, null, null];\n    let [best_dialect, best_separator, best_policy, best_dialect_first_trailing_space_line] = [null, null, null, null];\n    let best_dialect_num_columns = 1;\n    for (let candidate_dialect of candidate_dialects) {\n        let [dialect_id, separator, policy] = candidate_dialect;\n        let [_records, num_records_parsed, fields_info, first_defective_line, first_trailing_space_line, _comments] = fast_load_utils.parse_document_records(active_doc, separator, policy, comment_prefix, /*stop_on_warning=*/true, /*max_records_to_parse=*/-1, /*collect_records=*/false, /*preserve_quotes_and_whitespaces=*/true, detect_trailing_spaces, /*min_num_fields_for_autodetection=*/best_dialect_num_columns + 1);\n        if (first_defective_line !== null || fields_info.size != 1)\n            continue;\n        if (num_records_parsed < min_num_lines) {\n            // Ensure that min_num_lines also applies to number of parsed records. There could be a discrepancy between number of lines and records due to comment lines and/or multiline rfc records.\n            continue;\n        }\n        let num_columns = Array.from(fields_info.keys())[0];\n        if (num_columns >= best_dialect_num_columns + 1) {\n            best_dialect_num_columns = num_columns;\n            [best_dialect, best_separator, best_policy] = [dialect_id, separator, policy];\n            best_dialect_first_trailing_space_line = first_trailing_space_line;\n        }\n    }\n    return [best_dialect, best_separator, best_policy, best_dialect_first_trailing_space_line];\n}\n\n\nfunction autodetect_dialect_frequency_based(active_doc, candidate_separators, max_num_chars_to_test) {\n    let [best_dialect, best_separator, best_policy] = ['csv', ',', QUOTED_POLICY];\n    let best_dialect_frequency = 0;\n    let data = active_doc.getText();\n    if (!data)\n        return [best_dialect, best_separator, best_policy];\n    for (let separator of candidate_separators) {\n        if (separator == ' ' || separator == '.')\n            continue; // Whitespace and dot have advantage over other separators in this algorithm, so we just skip them.\n        let frequency = 0;\n        for (let j = 0; j < max_num_chars_to_test && j < data.length; j++) {\n            if (data[j] == separator)\n                frequency += 1;\n        }\n        if (frequency > best_dialect_frequency) {\n            let policy = get_default_policy(separator);\n            let dialect_id = map_dialect_to_language_id(separator, policy);\n            [best_dialect, best_separator, best_policy] = [dialect_id, separator, policy];\n            best_dialect_frequency = frequency;\n        }\n    }\n    return [best_dialect, best_separator, best_policy];\n}\n\n\nasync function try_autodetect_and_set_rainbow_filetype(vscode, config, extension_context, active_doc, logging_context_id=null) {\n    // VSCode to some extent is capable of \"remembering\" doc id in the previous invocation, at least when used in debug mode.\n\n    // VSCode may (and will?) forget documentId of a document \"A\" if document \"B\" is opened in the tab where \"A\" was (double VS single click in file browser panel).\n    // see https://code.visualstudio.com/docs/getstarted/userinterface#_preview-mode\n    let log_wrapper = new StackContextLogWrapper('autodetection', logging_context_id);\n    log_wrapper.log_doc_event('starting...', active_doc);\n    if (extension_context.autodetection_temporarily_disabled_for_rbql) {\n        log_wrapper.log_simple_event('abort: disabled for rbql');\n        return [active_doc, false];\n    }\n    if (!is_eligible_doc(active_doc)) {\n        log_wrapper.log_simple_event('abort: ineligible doc');\n        return [active_doc, false];\n    }\n    if (!get_from_config('enable_separator_autodetection', false, config)) {\n        log_wrapper.log_simple_event('abort: disabled in config');\n        return [active_doc, false];\n    }\n    var file_path = active_doc.fileName;\n    var original_language_id = active_doc.languageId;\n    if (extension_context.autodetection_stoplist.has(file_path)) {\n        log_wrapper.log_simple_event('abort: doc path in stoplist');\n        return [active_doc, false];\n    }\n    // The check below also prevents double autodetection from handle_doc_open fork in the new_doc with adjusted language id.\n    let is_default_csv = (file_path.endsWith('.csv') || file_path.endsWith('.CSV')) && original_language_id == 'csv';\n    if (original_language_id != PLAINTEXT && !is_default_csv) {\n        log_wrapper.log_simple_event('abort: ineligible original language id');\n        return [active_doc, false];\n    }\n\n    let candidate_separators = get_from_config('autodetect_separators', [], config).map((s) => s === 'TAB' ? '\\t' : s);\n    if (!dialect_map.hasOwnProperty(original_language_id) &&\n        last_closed_rainbow_doc_info &&\n        last_closed_rainbow_doc_info.file_path === file_path &&\n        Math.abs(Date.now() - last_closed_rainbow_doc_info.timestamp) < 1000) {\n        // The same file was recently closed with rainbow dialect and re-opened as another filetype, most likely manual language switch, do not autodetect.\n        // Do not add to autodetection_stoplist because it goes against VSCode approach to discard all language mode state on reopen.\n        // Also adding to autodetection_stoplist would make \"curious doc reopening\" problem worse.\n        // Do not initialize \"Rainbow ON\" because either it was already enabled or user goes through the native UI and therefore showing Rainbow ON is not idiomatic/consistent/relevant.\n        log_wrapper.log_simple_event('abort: recent doc language switch prevention');\n        return [active_doc, false];\n    }\n\n    let comment_prefix_for_autodetection = get_from_config('comment_prefix', '', config) || '#'; // Assume '#' as a comment prefix for autodetection purposes only.\n    log_wrapper.log_simple_event('starting standard dialect autodetection...');\n    let [rainbow_csv_language_id, delim, policy, first_trailing_space_line] = autodetect_dialect(config, active_doc, candidate_separators, comment_prefix_for_autodetection);\n    if (rainbow_csv_language_id) {\n        // Add the file to lint results to avoid re-parsing it with CSV Lint later.\n        extension_context.lint_results.set(`${file_path}.${rainbow_csv_language_id}`, {'is_ok': true, 'first_trailing_space_line': first_trailing_space_line});\n    } else if (!rainbow_csv_language_id && is_default_csv) {\n        // Smart autodetection method has failed, but we need to choose a separator because this is a csv file. Let's just find the most popular one within the first N characters.\n        log_wrapper.log_simple_event('starting frequency-based dialect autodetection...');\n        [rainbow_csv_language_id, delim, policy] = autodetect_dialect_frequency_based(active_doc, candidate_separators, /*max_num_chars_to_test=*/10000);\n    }\n    if (!rainbow_csv_language_id) {\n        log_wrapper.log_simple_event('abort: content-based autodetection did not detect anything');\n        return [active_doc, false];\n    }\n    // Comment prefix used here is global/default so we don't store it in custom comment prefix list.\n    if (rainbow_csv_language_id == DYNAMIC_CSV) {\n        await save_dynamic_info(extension_context, file_path, make_dialect_info(delim, policy));\n    }\n    if (rainbow_csv_language_id == original_language_id) {\n        log_wrapper.log_simple_event('abort: autodetected dialect matches the original one');\n        return [active_doc, false];\n    }\n\n    // We can't add the doc path to autodetection_stoplist here (for autodetect-once semantic)\n    // because the doc could be in preview mode and VSCode won't remember language_id so we might need to autodetect it again later.\n\n    preserve_original_language_id_if_needed(file_path, original_language_id, extension_context.original_language_ids);\n    log_wrapper.log_simple_event(`autodetection successful - switching from ${original_language_id} to ${rainbow_csv_language_id}`);\n    let new_doc = await vscode.languages.setTextDocumentLanguage(active_doc, rainbow_csv_language_id);\n    log_wrapper.log_doc_event('after language switch', new_doc);\n    return [new_doc, true];\n}\n\n\nasync function handle_first_edit_for_an_empty_doc(change_event) {\n    if (!change_event)\n        return;\n    if (doc_first_edit_subscription) {\n        doc_first_edit_subscription.dispose();\n        doc_first_edit_subscription = null;\n    }\n    let log_wrapper = new StackContextLogWrapper('handle_first_edit_for_an_empty_doc');\n    log_wrapper.log_doc_event('starting', change_event.document);\n    await try_autodetect_and_set_rainbow_filetype(vscode, vscode.workspace.getConfiguration('rainbow_csv'), extension_context, change_event.document, log_wrapper.context_id);\n}\n\n\nasync function handle_editor_switch(editor) {\n    let log_wrapper = new StackContextLogWrapper('handle_editor_switch');\n    // This event is not triggered when language mode is changed.\n    // We need this handler to hide and show UI elements when user switches between the doc tabs.\n    // When the file is larger than 50MB, editor and active_doc are null/undefined.\n    let active_doc = get_active_doc(editor);\n    log_wrapper.log_doc_event('editor switch', active_doc);\n    // When switching between the open non-preview doc tabs the doc open/close events are (typically) not triggered for the actual files (exception is \"curious doc reopening\" problem, see DEV_README.md)\n    // but open and close events could (and will) be triggered for some virtual files e.g. paired files with .git scheme.\n    disable_rainbow_features_if_non_csv(active_doc, log_wrapper);\n    await enable_rainbow_features_if_csv(active_doc, log_wrapper); // No-op if non-csv.\n}\n\n\nfunction do_handle_cursor_movement() {\n    if (!show_column_info_button() && column_info_button) {\n        column_info_button.hide();\n    }\n}\n\n\nfunction handle_cursor_movement(_unused_cursor_event) {\n    if (cursor_timeout_handle !== null) {\n        clearTimeout(cursor_timeout_handle);\n    }\n    // We need timeout delay here to deduplicate/debounce events from multiple consecutive movements, see https://stackoverflow.com/a/49050990/2898283.\n    cursor_timeout_handle = setTimeout(() => do_handle_cursor_movement(), 10);\n}\n\n\nasync function handle_doc_open(new_doc) {\n    // The onDidOpenTextDocument handler will trigger for already \"opened\" docs too if they are re-opened in the same tab. Example\n    // Document \"A\" opens in tab1 -> triggers onDidOpenTextDocument\n    // Document \"B\" opens in tab1 -> triggers onDidOpenTextDocument  (this could happen if user clicks on document \"B\" in the left file browser panel)\n    // Document \"A\" opens in tab1 -> triggers onDidOpenTextDocument again! The previous languageId is reset.\n    // In other words if user opens a different document in the same tab (single click VS double click in the file browser panel) it may trigger the curent document closing and opening of a new doc.\n    // This behavior is called Preview Mode, see https://vscode.one/new-tab-vscode/ and https://code.visualstudio.com/docs/getstarted/userinterface#_preview-mode\n\n    let log_wrapper = new StackContextLogWrapper('handle_doc_open');\n    log_wrapper.log_doc_event('opening doc', new_doc);\n\n    if (!is_eligible_doc(new_doc)) {\n        log_wrapper.log_simple_event('abort: ineligible doc');\n        return;\n    }\n\n    // Register a handler for copy-pasting CSV-formated data into an empty doc. Empty docs have lineCount equal 1.\n    if (get_from_config('enable_separator_autodetection', false) && doc_first_edit_subscription === null && new_doc.isUntitled && new_doc.lineCount <= 1) {\n        doc_first_edit_subscription = vscode.workspace.onDidChangeTextDocument(handle_first_edit_for_an_empty_doc);\n        log_wrapper.log_simple_event('creating empty doc subscription');\n        return;\n    }\n    let filetype_changed = false;\n    [new_doc, filetype_changed] = await try_autodetect_and_set_rainbow_filetype(vscode, vscode.workspace.getConfiguration('rainbow_csv'), extension_context, new_doc, log_wrapper.context_id);\n\n    // If autodetection was successful we are essentially forking this handler for the new doc and the code below will be executed twice: here and in the handle_doc_open for the `new_doc`.\n    // There is still some benefit for not having and additional check to prevent this double execution: disable/enable ui calls are idempotent and the code is more robust/reliable this way.\n    log_wrapper.log_doc_event(`after autodetection. filetype changed: ${filetype_changed}`, new_doc);\n    // There might be some redundancy between this code and onDidChangeActiveTextEditor handler, but this actually desired as long as methods are idempotent.\n    // It is much better to do the same thing twice (if it is idempotent) to ensure the required behavior than rely on assumptions about external VSCode mechanisms (aka Defensive Programming).\n    if (is_active_doc(new_doc)) {\n        log_wrapper.log_simple_event('active doc - enabling features');\n        disable_rainbow_features_if_non_csv(new_doc, log_wrapper); // We need this to handle manual switch from csv to txt, this would immediately remove UI elements, that would stay otherwise.\n        await enable_rainbow_features_if_csv(new_doc, log_wrapper); // No-op if non-csv.\n    }\n    log_wrapper.log_simple_event('finishing');\n}\n\n\nasync function handle_doc_close(doc_to_close) {\n    // NOTE: Closing of doc A (csv) followed by opening of the same doc A (non-csv) can also be caused by the \"curious doc reopening\" problem, see DEV_README.md.\n\n    // This is a workaround hack to prevent repeated autodetection on csv -> txt language switch.\n    // In that case a csv file will be closed and shortly after a txt file with the same path will be opened, so we don't want to apply autodetection to it.\n    // This will also trigger when virtual docs (e.g. `.git` pairs) are closed, but it is probably fine to reset last_closed_rainbow_doc_info in that case.\n    let log_wrapper = new StackContextLogWrapper('handle_doc_close');\n    log_wrapper.log_doc_event('closing doc', doc_to_close);\n    if (!is_rainbow_dialect_doc(doc_to_close)) {\n        log_wrapper.log_simple_event('abort: non rainbow doc');\n        last_closed_rainbow_doc_info = null;\n        return;\n    }\n\n    last_closed_rainbow_doc_info = {file_path: doc_to_close.fileName, timestamp: Date.now()};\n\n    if (is_active_doc(doc_to_close)) {\n        log_wrapper.log_simple_event('disabling ui elements');\n        // In order to disable elements we need to check that the closed rainbow doc is in fact active doc to avoid removing UI when a non-focused CSV or non-csv file is being closed.\n        // Inactive CSV closing can happen in the background if user closes with \"x\" top-right corner button another inactive tab with another CSV file.\n        disable_ui_elements();\n    }\n    log_wrapper.log_simple_event('finalizing');\n}\n\nasync function handle_config_change(config_change_event) {\n    // Here `config_change_event` allows to check if a specific configuration was affected but another way to do this is just to compare before and after values.\n    let logging_enabled_before = extension_context.logging_enabled;\n    extension_context.logging_enabled = get_from_config('enable_debug_logging', false);\n    if (extension_context.logging_enabled && !logging_enabled_before) {\n        let log_wrapper = new StackContextLogWrapper('config change');\n        log_wrapper.log_simple_event('logging enabled');\n    }\n    reconfigure_sticky_header_provider();\n}\n\n\n\nfunction quote_field(field, delim) {\n    if (field.indexOf('\"') != -1 || field.indexOf(delim) != -1) {\n        return '\"' + field.replace(/\"/g, '\"\"') + '\"';\n    }\n    return field;\n}\n\n\nfunction quoted_join(fields, delim) {\n    var quoted_fields = fields.map(function(val) { return quote_field(val, delim); });\n    return quoted_fields.join(delim);\n}\n\n\nasync function make_preview(uri, preview_mode) {\n    if (is_web_ext) {\n        show_single_line_error('This command is currently unavailable in web mode.');\n        return;\n    }\n    var file_path = uri.fsPath;\n    if (!file_path || !fs.existsSync(file_path)) {\n        vscode.window.showErrorMessage('Invalid file');\n        return;\n    }\n\n    var size_limit = 1024000; // ~1MB\n    var file_size_in_bytes = fs.statSync(file_path)['size'];\n    if (file_size_in_bytes <= size_limit) {\n        vscode.window.showWarningMessage('Rainbow CSV: The file is not big enough, showing the full file instead. Use this preview for files larger than 1MB');\n        let full_orig_doc = await vscode.workspace.openTextDocument(file_path);\n        await vscode.window.showTextDocument(full_orig_doc);\n        return;\n    }\n\n    let file_basename = path.basename(file_path);\n    const out_path = path.join(os.tmpdir(), `.rb_csv_preview.${preview_mode}.${file_basename}`);\n\n    fs.open(file_path, 'r', (err, fd) => {\n        if (err) {\n            console.log(err.message);\n            vscode.window.showErrorMessage('Unable to preview file');\n            return;\n        }\n\n        var buffer = Buffer.alloc(size_limit);\n        let read_begin_pos = preview_mode == 'head' ? 0 : Math.max(file_size_in_bytes - size_limit, 0);\n        fs.read(fd, buffer, 0, size_limit, read_begin_pos, function(err, _num) {\n            if (err) {\n                console.log(err.message);\n                vscode.window.showErrorMessage('Unable to preview file');\n                return;\n            }\n\n            const buffer_str = buffer.toString();\n            // TODO handle old mac '\\r' line endings - still used by Mac version of Excel.\n            let content = null;\n            if (preview_mode == 'head') {\n                content = buffer_str.substr(0, buffer_str.lastIndexOf(buffer_str.includes('\\r\\n') ? '\\r\\n' : '\\n'));\n            } else {\n                content = buffer_str.substr(buffer_str.indexOf('\\n') + 1);\n            }\n            fs.writeFileSync(out_path, content);\n            vscode.workspace.openTextDocument(out_path).then(doc => vscode.window.showTextDocument(doc));\n        });\n    });\n}\n\n\nfunction register_csv_hover_info_provider(language_id, context) {\n    let hover_provider = vscode.languages.registerHoverProvider(language_id, {\n        provideHover(document, position, token) {\n            return make_hover(document, language_id, position, token);\n        }\n    });\n    context.subscriptions.push(hover_provider);\n}\n\n\nclass RainbowTokenProvider {\n    // We don't utilize typescript `implement` interface keyword, because TS doesn't seem to be exporting interfaces to JS (unlike classes).\n    constructor() {\n    }\n    async provideDocumentRangeSemanticTokens(document, range, _token) {\n        let [delim, policy, comment_prefix] = get_dialect(document);\n        if (!policy || document.languageId != DYNAMIC_CSV) {\n            return null;\n        }\n        let table_ranges = ll_rainbow_utils().parse_document_range(vscode, document, delim, policy, comment_prefix, range);\n        // Create a new builder to clear the previous tokens.\n        const builder = new vscode.SemanticTokensBuilder(tokens_legend);\n        for (let row_info of table_ranges) {\n            if (row_info.hasOwnProperty('comment_range')) {\n                builder.push(row_info.comment_range, COMMENT_TOKEN);\n            } else {\n                for (let col_num = 0; col_num < row_info.record_ranges.length; col_num++) {\n                    let token_id = col_num % rainbow_token_types.length;\n                    if (token_id == 0) {\n                        // Do not highlight the first `rainbow1` group altogether, since it has the default color anyway.\n                        // Dynamic highlighting with undefined syntax like `rainbow1` is a little glitchy e.g. in case when re-tokenization occurs these undefined groups may fail to override the previous defined groups.\n                        // Another benefit is that by reducing the number of groups we are speeding things up a little.\n                        continue;\n                    }\n                    for (let record_range of row_info.record_ranges[col_num]) {\n                        // One logical field can map to multiple tokens if it spans multiple lines because VSCode doesn't support multiline tokens.\n                        builder.push(record_range, rainbow_token_types[token_id]);\n                    }\n                }\n            }\n        }\n        return builder.build();\n    }\n}\n\n\nclass CommentTokenProvider {\n    constructor() {\n    }\n    async provideDocumentRangeSemanticTokens(doc, range, _token) {\n        let [_delim, policy, comment_prefix] = get_dialect(doc);\n        if (manual_comment_prefix_stoplist.has(doc.fileName) && !comment_prefix) {\n            // We can't use empty comment prefix (and early return) - in that case the previous highlighting would not go away due to a VSCode quirk, need to make an empty build instead to make sure that all previously highlighted lines were cleared. We also can't create an empty builder and early return it because in that case we won't highlight dynamic csv columns (highlighting would disappear)\n            comment_prefix = '#####COMMENT_PREFIX_THAT_CAN_NOT_OCCURE_IN_A_NORMAL_FILE_AND_EVEN_IF_IT_OCCURES_NOT_A_BIG_DEAL####';\n        }\n        if (!comment_prefix || policy === null || policy == QUOTED_RFC_POLICY) {\n            return null; // Sanity check: with QUOTED_RFC_POLICY we should be using a different tokenizer which also handles comments.\n        }\n        // Create a new builder to clear the previous tokens.\n        const builder = new vscode.SemanticTokensBuilder(tokens_legend);\n        let begin_line = Math.max(0, range.start.line - dynamic_csv_highlight_margin);\n        let end_line = Math.min(doc.lineCount, range.end.line + dynamic_csv_highlight_margin);\n        for (let lnum = begin_line; lnum < end_line; lnum++) {\n            let line_text = doc.lineAt(lnum).text;\n            if (line_text.startsWith(comment_prefix)) {\n                builder.push(new vscode.Range(lnum, 0, lnum, line_text.length), COMMENT_TOKEN);\n            }\n        }\n        return builder.build();\n    }\n}\n\n\nasync function load_resource_file_for_web(extension_uri, resource_path) {\n    let resource_uri = vscode.Uri.joinPath(extension_uri, resource_path);\n    let bytes = await vscode.workspace.fs.readFile(resource_uri);\n    // Using TextDecoder because it should work fine in web extension.\n    return new TextDecoder().decode(bytes);\n}\n\n\nasync function load_resource_file_universal(resource_path) {\n    if (is_web_ext) {\n        let resource_data = await load_resource_file_for_web(web_extension_uri, resource_path);\n        return resource_data;\n    }\n    return fs.readFileSync(absolute_path_map[resource_path], \"utf8\");\n}\n\n\nasync function activate(context) {\n    // TODO consider storing `context` itself in a global variable.\n    global_state = context.globalState;\n\n    if (is_web_ext) {\n        web_extension_uri = context.extensionUri;\n    }\n\n    for (let local_path in absolute_path_map) {\n        if (absolute_path_map.hasOwnProperty(local_path)) {\n            if (is_web_ext) {\n                absolute_path_map[local_path] = vscode.Uri.joinPath(context.extensionUri, local_path);\n            } else {\n                absolute_path_map[local_path] = context.asAbsolutePath(local_path);\n            }\n        }\n    }\n\n    if (get_from_config('enable_tooltip', false)) {\n        for (let language_id in dialect_map) {\n            if (dialect_map.hasOwnProperty(language_id)) {\n                register_csv_hover_info_provider(language_id, context);\n            }\n        }\n    }\n    extension_context.logging_enabled = get_from_config('enable_debug_logging', false);\n\n    var lint_cmd = vscode.commands.registerCommand('rainbow-csv.CSVLint', csv_lint_cmd);\n    var rbql_cmd = vscode.commands.registerCommand('rainbow-csv.RBQL', edit_rbql);\n    var set_header_line_cmd = vscode.commands.registerCommand('rainbow-csv.SetHeaderLine', set_header_line);\n    var set_comment_prefix_cmd = vscode.commands.registerCommand('rainbow-csv.SetCommentPrefix', set_comment_prefix);\n    var edit_column_names_cmd = vscode.commands.registerCommand('rainbow-csv.SetVirtualHeader', set_virtual_header);\n    var set_join_table_name_cmd = vscode.commands.registerCommand('rainbow-csv.SetJoinTableName', set_join_table_name); // WEB_DISABLED\n    var column_edit_before_cmd = vscode.commands.registerCommand('rainbow-csv.ColumnEditBefore', async function() { await column_edit('ce_before'); });\n    var column_edit_after_cmd = vscode.commands.registerCommand('rainbow-csv.ColumnEditAfter', async function() { await column_edit('ce_after'); });\n    var column_edit_select_cmd = vscode.commands.registerCommand('rainbow-csv.ColumnEditSelect', async function() { await column_edit('ce_select'); });\n    var set_separator_cmd = vscode.commands.registerCommand('rainbow-csv.RainbowSeparator', choose_dynamic_separator);\n    var rainbow_off_cmd = vscode.commands.registerCommand('rainbow-csv.RainbowSeparatorOff', restore_original_language);\n    var rainbow_on_cmd = vscode.commands.registerCommand('rainbow-csv.RainbowSeparatorOn', reenable_rainbow_language);\n    var sample_head_cmd = vscode.commands.registerCommand('rainbow-csv.SampleHead', async function(uri) { await make_preview(uri, 'head'); }); // WEB_DISABLED\n    var sample_tail_cmd = vscode.commands.registerCommand('rainbow-csv.SampleTail', async function(uri) { await make_preview(uri, 'tail'); }); // WEB_DISABLED\n    var align_cmd = vscode.commands.registerCommand('rainbow-csv.Align', align_table);\n    var shrink_cmd = vscode.commands.registerCommand('rainbow-csv.Shrink', shrink_table);\n    var copy_back_cmd = vscode.commands.registerCommand('rainbow-csv.CopyBack', copy_back); // WEB_DISABLED\n    var internal_test_cmd = vscode.commands.registerCommand('rainbow-csv.InternalTest', run_internal_test_cmd);\n\n    // INFO: vscode.workspace and vscode.window lifetime are likely guaranteed to cover the extension lifetime (period between activate() and deactivate()) but I haven't found a confirmation yet.\n    var doc_open_event = vscode.workspace.onDidOpenTextDocument(handle_doc_open);\n    var doc_close_event = vscode.workspace.onDidCloseTextDocument(handle_doc_close);\n    var config_change_event = vscode.workspace.onDidChangeConfiguration(handle_config_change);\n\n    var switch_event = vscode.window.onDidChangeActiveTextEditor(handle_editor_switch);\n    try {\n        debug_log_output_channel = vscode.window.createOutputChannel('rainbow_csv_debug_channel', {log: true});\n    } catch (error) {\n        console.error('Rainbow CSV: Failed to create output log channel');\n    }\n\n    enable_dynamic_semantic_tokenization();\n    reconfigure_sticky_header_provider();\n\n    if (get_from_config('comment_prefix', null)) {\n        register_comment_tokenization_handler();\n    }\n\n    // The only purpose to add the entries to context.subscriptions is to guarantee their disposal during extension deactivation\n    context.subscriptions.push(lint_cmd);\n    context.subscriptions.push(rbql_cmd);\n    context.subscriptions.push(edit_column_names_cmd);\n    context.subscriptions.push(column_edit_before_cmd);\n    context.subscriptions.push(column_edit_after_cmd);\n    context.subscriptions.push(column_edit_select_cmd);\n    context.subscriptions.push(set_separator_cmd);\n    context.subscriptions.push(rainbow_off_cmd);\n    context.subscriptions.push(rainbow_on_cmd);\n    context.subscriptions.push(sample_head_cmd);\n    context.subscriptions.push(sample_tail_cmd);\n    context.subscriptions.push(set_join_table_name_cmd);\n    context.subscriptions.push(align_cmd);\n    context.subscriptions.push(shrink_cmd);\n    context.subscriptions.push(copy_back_cmd);\n    context.subscriptions.push(set_header_line_cmd);\n    context.subscriptions.push(set_comment_prefix_cmd);\n    context.subscriptions.push(internal_test_cmd);\n\n    context.subscriptions.push(doc_open_event);\n    context.subscriptions.push(doc_close_event);\n    context.subscriptions.push(switch_event);\n    context.subscriptions.push(config_change_event);\n\n\n    // Need this because \"onDidOpenTextDocument()\" doesn't get called for the first open document.\n    // Another issue is when dev debug logging mode is enabled, the first document would be \"Log\" because it is printing something and gets VSCode focus.\n    await sleep(1000);\n    let active_doc = get_active_doc();\n    handle_doc_open(active_doc);\n}\n\n\nfunction deactivate() {\n    // This method is called when extension is deactivated.\n}\n\n\nexports.activate = activate;\nexports.deactivate = deactivate;\n\n// Exports just for unit tests:\nexports.autodetect_dialect_frequency_based = autodetect_dialect_frequency_based;\nexports.try_autodetect_and_set_rainbow_filetype = try_autodetect_and_set_rainbow_filetype;\n"],"names":["module","exports","combining","DEFAULTS","nul","control","wcwidth","ucs","opts","mid","min","max","length","Math","floor","bisearch","str","s","i","n","charCodeAt","wcswidth","csv_utils","AssertionError","Error","assert","condition","message","RecordTextConsumer","constructor","delim","policy","stop_on_warning","collect_records","preserve_quotes_and_whitespaces","detect_trailing_spaces","min_num_fields_for_autodetection","this","first_defective_line","records","num_records_parsed","fields_info","Map","first_trailing_space_line","consume","record_text","record_start_line","record","warning","smart_split","field","charAt","has","set","size","push","parse_document_records","document","comment_prefix","max_records_to_parse","num_lines","lineCount","line_aggregator","MultilineRecordAggregator","consumer","comments","lnum","line_text","lineAt","text","record_num","comment_text","add_line","has_comment_line","reset","has_full_record","get_full_line","startsWith","is_inside_multiline_record","GetIntrinsic","callBind","$indexOf","name","allowMissing","intrinsic","bind","setFunctionLength","$TypeError","$apply","$call","$reflectApply","call","$defineProperty","$max","originalFunction","func","arguments","applyBind","value","apply","$SyntaxError","gopd","obj","property","nonEnumerable","nonWritable","nonConfigurable","loose","desc","configurable","enumerable","writable","e","EvalError","RangeError","ReferenceError","SyntaxError","TypeError","URIError","isCallable","toStr","Object","prototype","toString","hasOwnProperty","list","iterator","thisArg","receiver","array","len","forEachArray","string","forEachString","object","k","forEachObject","concatty","a","b","arr","j","that","target","bound","args","arrLike","offset","slicy","boundLength","boundArgs","Function","joiner","joiny","result","Empty","implementation","undefined","$Error","$EvalError","$RangeError","$ReferenceError","$URIError","$Function","getEvalledConstructor","expressionSyntax","$gOPD","getOwnPropertyDescriptor","throwTypeError","ThrowTypeError","calleeThrows","get","gOPDthrows","hasSymbols","hasProto","getProto","getPrototypeOf","x","__proto__","needsEval","TypedArray","Uint8Array","INTRINSICS","AggregateError","Array","ArrayBuffer","Symbol","Atomics","BigInt","BigInt64Array","BigUint64Array","Boolean","DataView","Date","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","eval","Float32Array","Float64Array","FinalizationRegistry","Int8Array","Int16Array","Int32Array","isFinite","isNaN","JSON","Number","parseFloat","parseInt","Promise","Proxy","Reflect","RegExp","Set","SharedArrayBuffer","String","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","WeakRef","WeakSet","error","errorProto","doEval","fn","gen","LEGACY_ALIASES","hasOwn","$concat","concat","$spliceApply","splice","$replace","replace","$strSlice","slice","$exec","exec","rePropName","reEscapeChar","getBaseIntrinsic","alias","intrinsicName","parts","first","last","match","number","quote","subString","stringToPath","intrinsicBaseName","intrinsicRealName","skipFurtherCaching","isOwn","part","hasPropertyDescriptors","hasArrayLengthDefineBug","test","foo","$Object","origSymbol","hasSymbolSham","getOwnPropertySymbols","sym","symObj","keys","getOwnPropertyNames","syms","propertyIsEnumerable","descriptor","toStringTag","$hasOwn","create","ctor","superCtor","super_","TempCtor","hasToStringTag","$toString","callBound","isStandardArguments","isLegacyArguments","callee","supportsStandardArguments","badArrayLike","isCallableMarker","fnToStr","reflectApply","defineProperty","_","constructorRegex","isES6ClassFn","fnStr","tryFunctionObject","isIE68","isDDA","all","strClass","GeneratorFunction","isFnRegex","generatorFunc","getGeneratorFunc","whichTypedArray","cachedSetTimeout","cachedClearTimeout","process","defaultSetTimout","defaultClearTimeout","runTimeout","fun","setTimeout","clearTimeout","currentQueue","queue","draining","queueIndex","cleanUpNextTick","drainQueue","timeout","run","marker","runClearTimeout","Item","noop","nextTick","title","browser","env","argv","version","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask","define","hasDescriptors","gOPD","$floor","functionLengthIsConfigurable","functionLengthIsWritable","arg","copy","fill","readUInt8","isArgumentsObject","isGeneratorFunction","isTypedArray","uncurryThis","f","BigIntSupported","SymbolSupported","ObjectToString","numberValue","valueOf","stringValue","booleanValue","bigIntValue","symbolValue","checkBoxedPrimitive","prototypeValueOf","isMapToString","isSetToString","isWeakMapToString","isWeakSetToString","isArrayBufferToString","isArrayBuffer","working","isDataViewToString","isDataView","isPromise","input","then","catch","isArrayBufferView","isView","isUint8Array","isUint8ClampedArray","isUint16Array","isUint32Array","isInt8Array","isInt16Array","isInt32Array","isFloat32Array","isFloat64Array","isBigInt64Array","isBigUint64Array","isMap","isSet","isWeakMap","isWeakSet","SharedArrayBufferCopy","isSharedArrayBufferToString","isSharedArrayBuffer","isNumberObject","isStringObject","isBooleanObject","isBigIntObject","isSymbolObject","isAsyncFunction","isMapIterator","isSetIterator","isGeneratorObject","isWebAssemblyCompiledModule","isBoxedPrimitive","isAnyArrayBuffer","forEach","method","getOwnPropertyDescriptors","descriptors","formatRegExp","format","isString","objects","inspect","join","stringify","isNull","isObject","deprecate","msg","noDeprecation","warned","throwDeprecation","traceDeprecation","console","trace","debugs","debugEnvRegex","NODE_DEBUG","debugEnv","toUpperCase","ctx","seen","stylize","stylizeNoColor","depth","colors","isBoolean","showHidden","_extend","isUndefined","customInspect","stylizeWithColor","formatValue","styleType","style","styles","recurseTimes","isFunction","ret","primitive","simple","isNumber","formatPrimitive","visibleKeys","hash","val","idx","arrayToHash","isError","indexOf","formatError","isRegExp","isDate","output","base","braces","isArray","toUTCString","l","formatProperty","key","formatArray","map","pop","reduce","prev","cur","reduceToSingleString","split","line","ar","re","objectToString","d","o","pad","debuglog","pid","types","isNullOrUndefined","isSymbol","isNativeError","isPrimitive","isBuffer","months","prop","log","time","getHours","getMinutes","getSeconds","getDate","getMonth","inherits","origin","add","kCustomPromisifiedSymbol","callbackifyOnRejected","reason","cb","newReason","promisify","original","promiseResolve","promiseReject","promise","resolve","reject","err","setPrototypeOf","defineProperties","custom","callbackify","callbackified","maybeCb","self","rej","availableTypedArrays","g","globalThis","typedArrays","$slice","cache","typedArray","proto","superProto","tag","found","getter","trySlices","tryTypedArrays","os","fs","path","rbql","rbql_csv","fast_load_utils","non_numeric_sentinel","number_regex","QUOTED_RFC_POLICY","QUOTED_POLICY","alignment_extra_readability_whitespace_length","update_subcomponent_stats","is_first_record","max_field_components_lens","calc_visual_char_width","visual_field_length","has_wide_chars","max_total_length","max_int_length","match_result","max_fractional_length","cur_integer_part_length","cur_fractional_part_length","align_field","is_last_in_line","trim","delta_length","repeat","dot_pos","integer_delta_length","fractional_delta_length","trailing_spaces","rfc_align_field","is_field_segment","aligned","start_offset","RecordCommentMerger","nr","next_comment","get_next","has_comments_left","has_records_left","has_entries_left","make_table_name_key","file_path","find_table_path","vscode_global_state","main_table_dir","table_id","filepath","candidate_path","homedir","existsSync","isAbsolute","table_path","RbqlIOHandlingError","VSCodeRecordIterator","RBQLInputIterator","has_header","table_name","variable_prefix","super","NR","NL","fail_on_warning","_num_records_parsed","_comments","_first_trailing_space_line","first_record","next_record_index","stop","get_variables_map","query_text","variable_map","parse_basic_variables","parse_array_variables","parse_attribute_variables","parse_dictionary_variables","get_header","do_get_record","get_record","get_warnings","inconsistent_records_info","record_num_1","num_fields_1","record_num_2","num_fields_2","sample_first_two_inconsistent_records","warn_msg","make_inconsistent_num_fields_warning","VSCodeWriter","RBQLOutputWriter","header_len","null_in_output","delim_in_simple_output","output_lines","polymorphic_join","simple_join","quoted_join","quoted_join_rfc","mono_join","set_header","header","write","fields","v","quote_field","rfc_quote_field","res","normalize_fields","out_fields","sub_array_delim","finish","VSCodeTableRegistry","get_iterator_by_table_id","_table_id","VSCodeFileSystemCSVRegistry","RBQLTableRegistry","input_file_dir","encoding","options","stream","record_iterator","bulk_input_path","createReadStream","CSVRecordIterator","output_warnings","basename","make_multiline_record_ranges","vscode","delim_length","newline_marker","start_line","expected_end_line_for_control","record_ranges","lnum_current","pos_in_editor_line","next_pos_in_editor_line","pos_in_logical_field","logical_field_tokens","newline_marker_pos","Range","is_opening_rfc_line","_record","split_quoted_str","parse_document_range_rfc","doc","range","custom_parsing_margin","begin_line","start","end_line","end","table_ranges","inside_multiline_record_before","get_num_lines_in_record","inside_multiline_record_after","comment_range","combined_line","get_field_by_line_position","query_pos","col_num","cpos","read_header","async","input_reader","createInterface","closed","promise_resolve","promise_reject","output_promise","close","rbql_query_web","input_document","input_delim","input_policy","output_delim","output_policy","with_headers","join_tables_registry","input_iterator","output_writer","query","rbql_query_node","input_path","output_path","csv_encoding","user_init_code","input_stream","stdin","output_stream","close_output_on_finish","stdout","createWriteStream","is_ascii","default_init_source_path","read_user_init_code","dirname","CSVWriter","get_header_line","get_default_js_udf_content","get_default_python_udf_content","align_columns","column_stats","result_lines","merger","comment","aligned_fields","fnum","field_lines","aligned_field","shrink_columns","active_doc","_fields_info","has_edit","calc_column_stats","enable_double_width_alignment","field_line","adjust_column_stats","adjusted_stats","column_stat","previous_stat","get_cursor_position_info","position","last_found_position_info","row_info","contains","is_comment","record_range","column_number","total_columns","split_warning","get_cursor_position_info_rfc","cnum","character","entries","get_cursor_position_info_standard","format_cursor_position_info","cursor_position_info","show_column_names","show_comments","max_label_length","short_report","full_report","column_label","short_column_label","substr","parse_document_range","next_cpos","parse_document_range_single_line","sample_preview_records_from_context","rbql_context","dst_message","preview_window_size","cached_table_parse_result","requested_start_record","first_failed_line","end_record","vscode_doc_version","need_full_doc_parse","fileName","sample_records","preview_sampling_error","preview_records","r","cur_record","c","actual_start_record","show_lint_status_bar_button","extension_context","language_id","COLOR_ERROR","lint_cache_key","lint_results","lint_report","lint_status_bar_button","window","createStatusBarItem","StatusBarAlignment","Left","lint_report_msg","is_processing","color","isInteger","is_ok","tooltip","command","show","get_cursor_position_if_unambiguous","active_editor","selections","selection","active","isEqual","anchor","generate_column_edit_selections","edit_mode","warning_msg","char_pos_before","char_pos_after","substring","position_before","Position","position_after","Selection","field_regular_expression","field_rgx","field_rgx_external_whitespaces","extract_next_field","src","dlm","allow_external_whitespaces","cidx","src_cur","match_obj","match_end","uidx","extraction_report","unquote_field","split_whitespace_separated_str","preserve_whitespaces","rgxp","unquote_fields","split_lines","rfc_line_buffer","match_list","has_unbalanced_double_quote","line_separator","RbqlParsingError","RbqlRuntimeError","InternalBadFieldError","bad_idx","params","replace_all","search","replacement","RBQLContext","writer","unnest_list","top_count","like_regex_cache","sort_key_expression","aggregation_stage","aggregation_key_expression","functional_aggregators","join_map_impl","join_map","lhs_join_var_expression","where_expression","select_expression","update_expressions","variables_init_code","query_context","wrong_aggregation_usage_error","RBQL_VERSION","check_if_brackets_match","opening_bracket","closing_bracket","parse_root_bracket_level_text_spans","text_spans","last_pos","bracket_stack","cur_char","span","unquote_string","quoted_str","column_info_from_text_span","text_span","string_literals","rbql_star_marker","simple_var_match","attribute_match","subscript_int_match","subscript_str_match","as_alias_match","column_index","column_name","is_star","alias_name","replaced_string_literal_id","unquoted_column_name","adhoc_parse_select_expression_to_column_infos","ts","stable_compare","safe_get","safe_join_get","safe_set","regexp_escape","like_to_regex","pattern","p","converted","like","matcher","LIKE","RBQLAggregationToken","marker_id","UnnestMarker","UNNEST","vals","unnest","Unnest","UNFOLD","parse_number","AnyValueAggregator","stats","increment","get_final","MinAggregator","cur_aggr","MaxAggregator","SumAggregator","AvgAggregator","cur_sum","cur_cnt","VarianceAggregator","cur_sum_sq","avg_val","MedianAggregator","sort","m","CountAggregator","ArrayAggAggregator","post_proc","ConstGroupVerifier","output_index","const_values","old_value","init_aggregator","generator_name","ANY_VALUE","any_value","Any_value","MIN","Min","MAX","Max","COUNT","count","Count","SUM","sum","Sum","AVG","avg","Avg","VARIANCE","variance","Variance","MEDIAN","median","Median","ARRAY_AGG","array_agg","FOLD","add_to_set","dst_set","len_before","TopWriter","subwriter","NW","UniqWriter","UniqCountWriter","old_val","unshift","SortedWriter","reverse_sort","unsorted_entries","stable_entry","reverse","entry","AggregateWriter","aggregators","aggregation_keys","all_keys","from","ag","InnerJoiner","get_rhs","lhs_key","get_join_records","LeftJoiner","null_record","max_record_len","StrictLeftJoiner","select_except","except_fields","select_simple","sort_key","sort_entry","select_aggregated","transparent_values","num_aggregators_found","trans_value","select_unnested","folded_fields","unnest_pos","findIndex","PROCESS_SELECT_COMMON","PROCESS_SELECT_SIMPLE","PROCESS_SELECT_JOIN","PROCESS_UPDATE_JOIN","PROCESS_UPDATE_SIMPLE","MAIN_LOOP_BODY","embed_expression","parent_code","child_placeholder","child_expression","embed_code","child_code","parent_lines","child_lines","pos","placeholder_indentation","generate_main_loop_code","is_select_query","is_join_query","js_code","compile_and_run","main_loop_body","main_loop_promise","lower_case_query","toLowerCase","GROUP_BY","UPDATE","SELECT","JOIN","INNER_JOIN","LEFT_JOIN","LEFT_OUTER_JOIN","STRICT_LEFT_JOIN","ORDER_BY","WHERE","LIMIT","EXCEPT","WITH","get_ambiguous_error_msg","variable_name","get_all_matches","regexp","str_strip","strip_comments","cline","combine_string_literals","backend_expression","prefix","dst_variables_map","matches","field_num","initialize","index","js_string_escape_column_name","quote_char","query_probably_has_dictionary_variable","continuous_name_segments","continuous_segment","column_names","dict_test_rgx","escaped_column_name","column_names_source","column_names_from_query","zero_based_idx","map_variables_directly","ensure_no_ambiguous_variables","input_column_names","join_column_names","join_column_names_set","parse_join_expression","invalid_join_syntax_error","variable_pairs","pair_rgx","and_rgx","resolve_join_variables","input_variables_map","join_variables_map","lhs_variables","rhs_indices","valid_join_syntax_msg","variable_pair","join_var_1","join_var_2","lhs_key_index","rhs_key_index","generate_common_init_code","base_var","attr_var","generate_init_statements","variables_map","indent","code_lines","simple_var_name_rgx","var_info","variable_declaration_keyword","replace_star_count","aggregate_expression","replace_star_vars","rbql_expression","replacement_expression","replace_star_vars_for_header_parsing","translate_update_expression","update_expression","first_assignment_error","assignment_looking_rgx","dst_var_name","var_index","current_indent","translate_select_expression","expression_without_counting_stars","translated","translated_for_header","separate_string_literals","rgx","format_parts","idx_before","literal_id","string_literal","start_index","lastIndex","format_expression","locate_statements","statement_groups","ig","is","statement","match_str","separate_actions","with_match","ordered_statements","statement_start","span_start","span_end","statement_params","new_span","find_top","rb_actions","select_action","translate_except_expression","except_expression","input_header","skip_vars","skip_indices","var_name","HashJoinMap","key_indices","hash_map","key_index","polymorphic_get_key","get_single_key","get_multi_key","ki","build","nf","key_records","cleanup_query","filter","remove_redundant_table_name","select_output_header","join_header","query_column_infos","query_has_star","query_has_column_alias","qci","output_header","handle_query_modifier","TableIterator","table","normalize_column_names","stopped","num_fields","TableWriter","external_table","SingleTableRegistry","shallow_parse_input_query","rhs_table_id","join_record_iterator","sql_join_type","select_expression_for_header","query_table","input_table","output_table","join_table","output_column_names","exception_to_error_info","exceptions_type_map","error_type","util","utf_decoding_error","rbql_init_source_path","readFileSync","name_record","index_path","content","lines","try_read_index","get_index_record","RecordQueue","push_stack","pull_stack","enqueue","dequeue","csv_path","first_record_should_be_emitted","header_preread_complete","decoder","TextDecoder","fatal","input_exhausted","started","utf8_bom_removed","partially_decoded_line","partially_decoded_line_ends_with_cr","resolve_current_record","reject_current_record","current_exception","produced_records_queue","process_line_polymorphic","process_partial_rfc_record_line","process_record_line_simple","modifier","reset_external_callbacks","try_propagate_exception","exception","store_or_propagate_exception","preread_first_record","pause","try_resolve_next_record","isPaused","resume","parent_iterator","current_record_promise","get_all_records","num_records","process_record_line","process_line","clean_line","assumed_source_encoding","remove_utf8_bom","process_data_stream_chunk","data_chunk","decoded_string","decode","first_line_index","process_data_bulk","data_blob","control_buffer","Buffer","compare","process_data_stream_end","last_line","destroy","readFile","close_stream_on_finish","setDefaultEncoding","error_obj","store_first_error","first_error","writer_error","_write_all","output_encoding","FileSystemCSVRegistry","interpret_named_csv_format","format_name","query_csv","require","possibleNames","out","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","child_process","rainbow_utils","ll_rainbow_utils","is_web_ext","web_extension_uri","scratch_buf_marker","aligned_files","result_set_parent_map","manual_comment_prefix_stoplist","rbql_status_bar_button","align_shrink_button","rainbow_off_status_bar_button","rainbow_on_status_bar_button","copy_back_button","column_info_button","dynamic_dialect_select_button","debug_log_output_channel","last_rbql_queries","client_html_template","dialect_selection_html_template","global_state","rbql_preview_panel","dialect_panel","doc_first_edit_subscription","keyboard_cursor_subscription","last_closed_rainbow_doc_info","_unit_test_last_rbql_report","_unit_test_last_warnings","cursor_timeout_handle","rainbow_token_event","comment_token_event","sticky_header_disposable","PLAINTEXT","DYNAMIC_CSV","WHITESPACE_POLICY","SIMPLE_POLICY","dynamic_document_dialects","custom_comment_prefixes","original_language_ids","reenable_rainbow_language_infos","autodetection_stoplist","autodetection_temporarily_disabled_for_rbql","dynamic_dialect_for_next_request","logging_enabled","logging_next_context_id","dialect_map","COMMENT_TOKEN","rainbow_token_types","all_token_types","tokens_legend","SemanticTokensLegend","is_eligible_doc","vscode_doc","uri","scheme","is_eligible_scheme","is_rainbow_dialect_doc","languageId","make_dialect_info","make_dynamic_dialect_key","save_dynamic_info","dialect_info","save_to_global_state","get_dynamic_info","get_from_global_state","safe_lower","src_str","get_default_policy","separator","map_dialect_to_language_id","absolute_path_map","show_single_line_error","error_msg","active_window","showErrorMessage","sleep","ms","report_progress","progress","status_message","report","default_value","update","replace_doc_content","new_content","invalid_range","full_range","validateRange","edit","make_header_key","make_with_headers_key","get_from_config","param_name","config","workspace","getConfiguration","StackContextLogWrapper","context_name","caller_context_id","context_id","log_doc_event","event_name","full_event","info","log_simple_event","get_header_from_document","_header_lnum","header_line","header_info","get_dialect","StickyHeaderProvider","provideDocumentSymbols","_delim","header_lnum","header_line_num","header_range","symbol_kind","SymbolKind","File","DocumentSymbol","reconfigure_sticky_header_provider","force","dispose","header_symbol_provider","document_selector","language","languages","registerDocumentSymbolProvider","enable_dynamic_semantic_tokenization","token_provider","RainbowTokenProvider","registerDocumentRangeSemanticTokensProvider","register_comment_tokenization_handler","CommentTokenProvider","choose_dynamic_separator","integration_test_options","log_wrapper","get_active_editor","get_active_doc","selected_separator","get_selected_separator","load_resource_file_universal","createWebviewPanel","ViewColumn","Beside","enableScripts","webview","html","adjust_webview_paths","onDidReceiveMessage","origin_doc","dialect_webview_panel","msg_type","init_msg","integration_test","postMessage","is_active_doc","enable_rainbow_features_if_csv","setTextDocumentLanguage","handle_dialect_selection_message","hide","disable_ui_elements","setLanguageConfiguration","lineComment","show_align_shrink_button","parent_table_path","parent_basename","show_rbql_copy_to_source_button","show_column_info_button","onDidChangeTextEditorSelection","handle_cursor_movement","enable_rainbow_ui","csv_lint","all_buttons","disable_rainbow_features_if_non_csv","activeTextEditor","enable_tooltip_column_names","Right","do_show_column_info_button","is_manual_op","_records","lint_result","csv_lint_cmd","run_internal_test_cmd","check_initialization_state","initialized","lazy_loaded","check_last_rbql_report","check_last_rbql_warnings","show_warnings","warnings","showWarningMessage","handle_rbql_result_file_node","text_doc","showTextDocument","file_path_to_query_key","run_command_and_parse_output","cmd","execution_result","stdout_data","stderr_data","spawn","data","stderr","code","command_async_wrapper","invocation_error","json_report","parse","run_first_working_interpreter_command_and_parse_output","interpreters_list","interpreter_cmd","send_report_to_webview","report_msg","set_header_line","_comment_prefix","raw_header","preserve_original_language_id_if_needed","original_language_id","set_comment_prefix","delete","restore_original_language","current_language_info","dynamic_dialect_info","remove_dynamic_info","reenable_rainbow_language","rainbow_language_info","set_join_table_name","showInputBox","set_virtual_header","old_header","old_header_str","quoted_fields","input_box_props","raw_new_header","new_header","column_edit","shrink_table","progress_options","location","ProgressLocation","Window","withProgress","shrinked_doc_text","align_table","double_width_alignment","aligned_doc_text","align_in_scratch_file","is_scratch_file","aligned_doc_cfg","scratch_doc","openTextDocument","copy_back","result_doc","parent_doc","parent_editor","query_result_doc","getText","do_copy_back","handle_rbql_client_message","message_type","path_key","input_document_path","history_list","header_for_ui","rbql_backend","rbql_query","integration_test_delay","input_table_dir","navig_direction","protocol_message","backend_language","output_dialect","old_index","update_query_history","interpreters_preference_list","input_table_path","rbql_output_dir","tmpdir","get_dst_table_dir","orig_extension","extname","delim_ext_map","dst_extension","result_table_name","get_dst_table_name","target_language_id","output_doc_cfg","handle_rbql_result_file_web","csv_options","cmd_safe_query","output_doc","run_rbql_query","udf_file_path","default_content","writeFileSync","udf_doc","preview_panel","client_html","paths_list","local_path","adjusted_webview_url","asWebviewUri","Uri","file","edit_rbql","orig_uri","isDirty","rnd_suffix","random","with_headers_by_default","Active","autodetect_dialect_frequency_based","candidate_separators","max_num_chars_to_test","best_dialect","best_separator","best_policy","best_dialect_frequency","frequency","dialect_id","try_autodetect_and_set_rainbow_filetype","logging_context_id","is_default_csv","endsWith","abs","now","timestamp","comment_prefix_for_autodetection","rainbow_csv_language_id","candidate_dialects","min_num_lines","best_dialect_first_trailing_space_line","best_dialect_num_columns","candidate_dialect","num_columns","autodetect_dialect","new_doc","handle_first_edit_for_an_empty_doc","change_event","handle_editor_switch","editor","_unused_cursor_event","handle_doc_open","isUntitled","onDidChangeTextDocument","filetype_changed","handle_doc_close","doc_to_close","handle_config_change","config_change_event","logging_enabled_before","make_preview","preview_mode","fsPath","size_limit","file_size_in_bytes","statSync","full_orig_doc","file_basename","out_path","open","fd","buffer","alloc","read_begin_pos","read","_num","buffer_str","lastIndexOf","includes","register_csv_hover_info_provider","context","hover_provider","registerHoverProvider","provideHover","token","cancellation_token","isCancellationRequested","_full_text","mds","MarkdownString","appendText","Hover","make_hover","subscriptions","provideDocumentRangeSemanticTokens","_token","builder","SemanticTokensBuilder","token_id","resource_path","resource_data","extension_uri","resource_uri","joinPath","bytes","load_resource_file_for_web","activate","globalState","extensionUri","asAbsolutePath","lint_cmd","commands","registerCommand","rbql_cmd","set_header_line_cmd","set_comment_prefix_cmd","edit_column_names_cmd","set_join_table_name_cmd","column_edit_before_cmd","column_edit_after_cmd","column_edit_select_cmd","set_separator_cmd","rainbow_off_cmd","rainbow_on_cmd","sample_head_cmd","sample_tail_cmd","align_cmd","shrink_cmd","copy_back_cmd","internal_test_cmd","doc_open_event","onDidOpenTextDocument","doc_close_event","onDidCloseTextDocument","onDidChangeConfiguration","switch_event","onDidChangeActiveTextEditor","createOutputChannel","deactivate"],"sourceRoot":""}